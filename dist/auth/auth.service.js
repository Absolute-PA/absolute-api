'use strict';const a35_0x1c7197=a35_0x3e66;function a35_0x4548(){const _0x25adf6=['590NJZMAu','AuthService','design:paramtypes','updatePassword','username','object','jwtService','2MBffZE','Injectable','assign','./verify','function','userService','3839983eXSzJl','roles','log','2814771bcreuF','length','decorate','email','UserService','__esModule','defineProperty','__metadata','@nestjs/jwt','_id','44379FLVqDb','10OxWSLj','JwtService','951660FIZHCJ','metadata','../user/user.service','749335CnXULZ','password','user.password,\x20password','login','sign','validateUser','4827552BmYyBs','__decorate','hash','611144FnZoxI'];a35_0x4548=function(){return _0x25adf6;};return a35_0x4548();}(function(_0x45f703,_0x3b6870){const _0x523f80=a35_0x3e66,_0xe3d1b7=_0x45f703();while(!![]){try{const _0x31e04f=parseInt(_0x523f80(0x144))/0x1+parseInt(_0x523f80(0x155))/0x2*(parseInt(_0x523f80(0x134))/0x3)+-parseInt(_0x523f80(0x141))/0x4*(-parseInt(_0x523f80(0x13f))/0x5)+-parseInt(_0x523f80(0x14a))/0x6+-parseInt(_0x523f80(0x15b))/0x7+parseInt(_0x523f80(0x14d))/0x8+-parseInt(_0x523f80(0x13e))/0x9*(parseInt(_0x523f80(0x14e))/0xa);if(_0x31e04f===_0x3b6870)break;else _0xe3d1b7['push'](_0xe3d1b7['shift']());}catch(_0x2bedbc){_0xe3d1b7['push'](_0xe3d1b7['shift']());}}}(a35_0x4548,0x9170d));function a35_0x3e66(_0x2bbbb7,_0x247854){const _0x4548cb=a35_0x4548();return a35_0x3e66=function(_0x3e66f4,_0x1442cd){_0x3e66f4=_0x3e66f4-0x134;let _0x143497=_0x4548cb[_0x3e66f4];return _0x143497;},a35_0x3e66(_0x2bbbb7,_0x247854);}var __decorate=this&&this[a35_0x1c7197(0x14b)]||function(_0x55ed5f,_0x1a9295,_0x96ad6f,_0x8980e8){const _0x49176d=a35_0x1c7197;var _0x36ac4a=arguments[_0x49176d(0x135)],_0x2104e8=_0x36ac4a<0x3?_0x1a9295:_0x8980e8===null?_0x8980e8=Object['getOwnPropertyDescriptor'](_0x1a9295,_0x96ad6f):_0x8980e8,_0x2c912c;if(typeof Reflect===_0x49176d(0x153)&&typeof Reflect['decorate']===_0x49176d(0x159))_0x2104e8=Reflect[_0x49176d(0x136)](_0x55ed5f,_0x1a9295,_0x96ad6f,_0x8980e8);else{for(var _0x4e24d4=_0x55ed5f[_0x49176d(0x135)]-0x1;_0x4e24d4>=0x0;_0x4e24d4--)if(_0x2c912c=_0x55ed5f[_0x4e24d4])_0x2104e8=(_0x36ac4a<0x3?_0x2c912c(_0x2104e8):_0x36ac4a>0x3?_0x2c912c(_0x1a9295,_0x96ad6f,_0x2104e8):_0x2c912c(_0x1a9295,_0x96ad6f))||_0x2104e8;}return _0x36ac4a>0x3&&_0x2104e8&&Object['defineProperty'](_0x1a9295,_0x96ad6f,_0x2104e8),_0x2104e8;},__metadata=this&&this[a35_0x1c7197(0x13b)]||function(_0x42a1b6,_0x1ce4c6){const _0x1cf5c5=a35_0x1c7197;if(typeof Reflect===_0x1cf5c5(0x153)&&typeof Reflect['metadata']===_0x1cf5c5(0x159))return Reflect[_0x1cf5c5(0x142)](_0x42a1b6,_0x1ce4c6);};Object[a35_0x1c7197(0x13a)](exports,a35_0x1c7197(0x139),{'value':!![]}),exports[a35_0x1c7197(0x14f)]=void 0x0;const common_1=require('@nestjs/common'),user_service_1=require(a35_0x1c7197(0x143)),jwt_1=require(a35_0x1c7197(0x13c)),verify_1=require(a35_0x1c7197(0x158));let AuthService=class AuthService{constructor(_0x3cb7c4,_0xd1f895){const _0x5658f2=a35_0x1c7197;this[_0x5658f2(0x15a)]=_0x3cb7c4,this[_0x5658f2(0x154)]=_0xd1f895;}async[a35_0x1c7197(0x149)](_0x35bda5,_0x44df20){const _0x54c0ae=a35_0x1c7197,_0x5b0600=await this[_0x54c0ae(0x15a)]['findUser'](_0x35bda5);if(!_0x5b0600)return null;console[_0x54c0ae(0x15d)](_0x5b0600['password'],_0x44df20,_0x54c0ae(0x146));const _0x16c61d=await(0x0,verify_1['verify'])(_0x44df20,_0x5b0600[_0x54c0ae(0x145)]);if(_0x5b0600&&_0x16c61d)return _0x5b0600;return null;}async[a35_0x1c7197(0x151)](_0x4a4e96,{newPassword:_0x22fb8b}){const _0x5cb739=a35_0x1c7197,_0x26eaf5=await(0x0,verify_1[_0x5cb739(0x14c)])(_0x22fb8b);return await this['userService']['updateUser'](_0x4a4e96['sub'],Object[_0x5cb739(0x157)](Object['assign']({},_0x4a4e96),{'password':_0x26eaf5}));}async[a35_0x1c7197(0x147)](_0x131509){const _0x284e0d=a35_0x1c7197,_0x41e8e9={'username':_0x131509[_0x284e0d(0x152)],'sub':_0x131509[_0x284e0d(0x13d)],'roles':_0x131509[_0x284e0d(0x15c)],'email':_0x131509[_0x284e0d(0x137)]};return{'access_token':this[_0x284e0d(0x154)][_0x284e0d(0x148)](_0x41e8e9)};}};AuthService=__decorate([(0x0,common_1[a35_0x1c7197(0x156)])(),__metadata(a35_0x1c7197(0x150),[user_service_1[a35_0x1c7197(0x138)],jwt_1[a35_0x1c7197(0x140)]])],AuthService),exports[a35_0x1c7197(0x14f)]=AuthService;