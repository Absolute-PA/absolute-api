'use strict';function a35_0x3980(){const _0xe5f498=['verify','__metadata','assign','5kbKFWp','function','14631579ZUNFKW','UserService','2213592QCAvSx','password','user.password,\x20password','metadata','decorate','length','282637KPxuWn','__esModule','1141472NaadsF','log','448689cVbaGg','validateUser','@nestjs/jwt','hash','object','login','design:paramtypes','updateUser','_id','638351uFHfVz','./verify','AuthService','Injectable','updatePassword','findUser','defineProperty','758408KZAGUW','__decorate','48HRqSUK','userService','jwtService'];a35_0x3980=function(){return _0xe5f498;};return a35_0x3980();}function a35_0x4231(_0x19b2d6,_0x9ab1a9){const _0x3980a0=a35_0x3980();return a35_0x4231=function(_0x4231ee,_0x2c5b70){_0x4231ee=_0x4231ee-0x1e7;let _0x1e58bb=_0x3980a0[_0x4231ee];return _0x1e58bb;},a35_0x4231(_0x19b2d6,_0x9ab1a9);}const a35_0xe33de4=a35_0x4231;(function(_0x5dc326,_0x2fb8b9){const _0x47702a=a35_0x4231,_0x39d727=_0x5dc326();while(!![]){try{const _0x15f51e=-parseInt(_0x47702a(0x1ec))/0x1+-parseInt(_0x47702a(0x200))/0x2+-parseInt(_0x47702a(0x1f0))/0x3+-parseInt(_0x47702a(0x1ee))/0x4*(parseInt(_0x47702a(0x208))/0x5)+parseInt(_0x47702a(0x20c))/0x6+parseInt(_0x47702a(0x1f9))/0x7*(-parseInt(_0x47702a(0x202))/0x8)+parseInt(_0x47702a(0x20a))/0x9;if(_0x15f51e===_0x2fb8b9)break;else _0x39d727['push'](_0x39d727['shift']());}catch(_0x45e9b4){_0x39d727['push'](_0x39d727['shift']());}}}(a35_0x3980,0x55a0d));var __decorate=this&&this[a35_0xe33de4(0x201)]||function(_0x5ba12f,_0x5a0625,_0x5e06ce,_0x14a4dc){const _0x4b2be9=a35_0xe33de4;var _0x3ad3c3=arguments[_0x4b2be9(0x1eb)],_0x25d5bd=_0x3ad3c3<0x3?_0x5a0625:_0x14a4dc===null?_0x14a4dc=Object['getOwnPropertyDescriptor'](_0x5a0625,_0x5e06ce):_0x14a4dc,_0x415d77;if(typeof Reflect===_0x4b2be9(0x1f4)&&typeof Reflect[_0x4b2be9(0x1ea)]===_0x4b2be9(0x209))_0x25d5bd=Reflect[_0x4b2be9(0x1ea)](_0x5ba12f,_0x5a0625,_0x5e06ce,_0x14a4dc);else{for(var _0x2c0587=_0x5ba12f[_0x4b2be9(0x1eb)]-0x1;_0x2c0587>=0x0;_0x2c0587--)if(_0x415d77=_0x5ba12f[_0x2c0587])_0x25d5bd=(_0x3ad3c3<0x3?_0x415d77(_0x25d5bd):_0x3ad3c3>0x3?_0x415d77(_0x5a0625,_0x5e06ce,_0x25d5bd):_0x415d77(_0x5a0625,_0x5e06ce))||_0x25d5bd;}return _0x3ad3c3>0x3&&_0x25d5bd&&Object[_0x4b2be9(0x1ff)](_0x5a0625,_0x5e06ce,_0x25d5bd),_0x25d5bd;},__metadata=this&&this[a35_0xe33de4(0x206)]||function(_0x45596e,_0x4acdeb){const _0x28da2a=a35_0xe33de4;if(typeof Reflect===_0x28da2a(0x1f4)&&typeof Reflect[_0x28da2a(0x1e9)]===_0x28da2a(0x209))return Reflect[_0x28da2a(0x1e9)](_0x45596e,_0x4acdeb);};Object[a35_0xe33de4(0x1ff)](exports,a35_0xe33de4(0x1ed),{'value':!![]}),exports[a35_0xe33de4(0x1fb)]=void 0x0;const common_1=require('@nestjs/common'),user_service_1=require('../user/user.service'),jwt_1=require(a35_0xe33de4(0x1f2)),verify_1=require(a35_0xe33de4(0x1fa));let AuthService=class AuthService{constructor(_0x2d9515,_0x55ccbe){const _0x53b3e5=a35_0xe33de4;this[_0x53b3e5(0x203)]=_0x2d9515,this['jwtService']=_0x55ccbe;}async[a35_0xe33de4(0x1f1)](_0x26884b,_0x462b5c){const _0x3e71d5=a35_0xe33de4,_0x220b35=await this[_0x3e71d5(0x203)][_0x3e71d5(0x1fe)](_0x26884b);if(!_0x220b35)return null;console[_0x3e71d5(0x1ef)](_0x220b35['password'],_0x462b5c,_0x3e71d5(0x1e8));const _0x4c5857=await(0x0,verify_1[_0x3e71d5(0x205)])(_0x462b5c,_0x220b35[_0x3e71d5(0x1e7)]);if(_0x220b35&&_0x4c5857)return _0x220b35;return null;}async[a35_0xe33de4(0x1fd)](_0x3ff3a0,{newPassword:_0x45a601}){const _0x41e8d7=a35_0xe33de4,_0x71bbe7=await(0x0,verify_1[_0x41e8d7(0x1f3)])(_0x45a601);return await this[_0x41e8d7(0x203)][_0x41e8d7(0x1f7)](_0x3ff3a0['sub'],Object[_0x41e8d7(0x207)](Object[_0x41e8d7(0x207)]({},_0x3ff3a0),{'password':_0x71bbe7}));}async[a35_0xe33de4(0x1f5)](_0x4e4d4d){const _0x1fa995=a35_0xe33de4,_0x490597={'username':_0x4e4d4d['username'],'sub':_0x4e4d4d[_0x1fa995(0x1f8)],'roles':_0x4e4d4d['roles'],'email':_0x4e4d4d['email']};return{'access_token':this[_0x1fa995(0x204)]['sign'](_0x490597)};}};AuthService=__decorate([(0x0,common_1[a35_0xe33de4(0x1fc)])(),__metadata(a35_0xe33de4(0x1f6),[user_service_1[a35_0xe33de4(0x20b)],jwt_1['JwtService']])],AuthService),exports[a35_0xe33de4(0x1fb)]=AuthService;