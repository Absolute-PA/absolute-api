'use strict';const a35_0x250382=a35_0x3f9f;function a35_0x49c3(){const _0x520d37=['@nestjs/jwt','1513754DmDjPb','metadata','object','jwtService','validateUser','length','224300EkqfZE','updateUser','login','password','../user/user.service','57bTFvev','decorate','updatePassword','function','9136gPmXCi','email','assign','45718iNAPQD','204bJtQcs','userService','defineProperty','AuthService','3514xUFtuT','__decorate','./verify','username','JwtService','1305BJtLYP','__esModule','65330uhXqaV','8094kUXtYv','6266810SHrnJQ','design:paramtypes','log','sub','Injectable','roles','_id'];a35_0x49c3=function(){return _0x520d37;};return a35_0x49c3();}(function(_0x1a2646,_0x43eab9){const _0x2b86d3=a35_0x3f9f,_0x597101=_0x1a2646();while(!![]){try{const _0x2f80aa=parseInt(_0x2b86d3(0xde))/0x1+-parseInt(_0x2b86d3(0xea))/0x2*(-parseInt(_0x2b86d3(0xe3))/0x3)+parseInt(_0x2b86d3(0xeb))/0x4*(-parseInt(_0x2b86d3(0xce))/0x5)+parseInt(_0x2b86d3(0xcf))/0x6*(parseInt(_0x2b86d3(0xc7))/0x7)+parseInt(_0x2b86d3(0xe7))/0x8*(parseInt(_0x2b86d3(0xcc))/0x9)+-parseInt(_0x2b86d3(0xd0))/0xa+parseInt(_0x2b86d3(0xd8))/0xb;if(_0x2f80aa===_0x43eab9)break;else _0x597101['push'](_0x597101['shift']());}catch(_0x448bee){_0x597101['push'](_0x597101['shift']());}}}(a35_0x49c3,0x54778));var __decorate=this&&this[a35_0x250382(0xc8)]||function(_0x48dbc4,_0x1d877e,_0x4fce8a,_0x48e49a){const _0x4bbbe6=a35_0x250382;var _0x5ddd73=arguments['length'],_0x134a4c=_0x5ddd73<0x3?_0x1d877e:_0x48e49a===null?_0x48e49a=Object['getOwnPropertyDescriptor'](_0x1d877e,_0x4fce8a):_0x48e49a,_0xf99115;if(typeof Reflect===_0x4bbbe6(0xda)&&typeof Reflect[_0x4bbbe6(0xe4)]===_0x4bbbe6(0xe6))_0x134a4c=Reflect['decorate'](_0x48dbc4,_0x1d877e,_0x4fce8a,_0x48e49a);else{for(var _0x330d05=_0x48dbc4[_0x4bbbe6(0xdd)]-0x1;_0x330d05>=0x0;_0x330d05--)if(_0xf99115=_0x48dbc4[_0x330d05])_0x134a4c=(_0x5ddd73<0x3?_0xf99115(_0x134a4c):_0x5ddd73>0x3?_0xf99115(_0x1d877e,_0x4fce8a,_0x134a4c):_0xf99115(_0x1d877e,_0x4fce8a))||_0x134a4c;}return _0x5ddd73>0x3&&_0x134a4c&&Object[_0x4bbbe6(0xc5)](_0x1d877e,_0x4fce8a,_0x134a4c),_0x134a4c;},__metadata=this&&this['__metadata']||function(_0x47cc4a,_0x5d969d){const _0x4057ce=a35_0x250382;if(typeof Reflect===_0x4057ce(0xda)&&typeof Reflect[_0x4057ce(0xd9)]==='function')return Reflect['metadata'](_0x47cc4a,_0x5d969d);};function a35_0x3f9f(_0x5562fd,_0x4e25d5){const _0x49c3cd=a35_0x49c3();return a35_0x3f9f=function(_0x3f9ff0,_0x2c4dd2){_0x3f9ff0=_0x3f9ff0-0xc5;let _0x23a491=_0x49c3cd[_0x3f9ff0];return _0x23a491;},a35_0x3f9f(_0x5562fd,_0x4e25d5);}Object[a35_0x250382(0xc5)](exports,a35_0x250382(0xcd),{'value':!![]}),exports[a35_0x250382(0xc6)]=void 0x0;const common_1=require('@nestjs/common'),user_service_1=require(a35_0x250382(0xe2)),jwt_1=require(a35_0x250382(0xd7)),verify_1=require(a35_0x250382(0xc9));let AuthService=class AuthService{constructor(_0x501499,_0xed684e){const _0x32ebe6=a35_0x250382;this['userService']=_0x501499,this[_0x32ebe6(0xdb)]=_0xed684e;}async[a35_0x250382(0xdc)](_0x17c766,_0x5d5bfd){const _0x2dcc69=a35_0x250382,_0x32c5cb=await this[_0x2dcc69(0xec)]['findUser'](_0x17c766);if(!_0x32c5cb)return null;console[_0x2dcc69(0xd2)](_0x32c5cb['password'],_0x5d5bfd,'user.password,\x20password');const _0x42b27a=await(0x0,verify_1['verify'])(_0x5d5bfd,_0x32c5cb[_0x2dcc69(0xe1)]);if(_0x32c5cb&&_0x42b27a)return _0x32c5cb;return null;}async[a35_0x250382(0xe5)](_0x4b0371,{newPassword:_0x29ff1c}){const _0x4c2117=a35_0x250382,_0xb6b61d=await(0x0,verify_1['hash'])(_0x29ff1c);return await this[_0x4c2117(0xec)][_0x4c2117(0xdf)](_0x4b0371[_0x4c2117(0xd3)],Object[_0x4c2117(0xe9)](Object[_0x4c2117(0xe9)]({},_0x4b0371),{'password':_0xb6b61d}));}async[a35_0x250382(0xe0)](_0x2fa55d){const _0x53ba2c=a35_0x250382,_0x9d7390={'username':_0x2fa55d[_0x53ba2c(0xca)],'sub':_0x2fa55d[_0x53ba2c(0xd6)],'roles':_0x2fa55d[_0x53ba2c(0xd5)],'email':_0x2fa55d[_0x53ba2c(0xe8)]};return{'access_token':this['jwtService']['sign'](_0x9d7390)};}};AuthService=__decorate([(0x0,common_1[a35_0x250382(0xd4)])(),__metadata(a35_0x250382(0xd1),[user_service_1['UserService'],jwt_1[a35_0x250382(0xcb)]])],AuthService),exports[a35_0x250382(0xc6)]=AuthService;