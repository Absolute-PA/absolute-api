'use strict';function a35_0xe08e(){const _0xe4db04=['assign','getOwnPropertyDescriptor','hash','../user/user.service','1848861DphIjx','2995137diBweM','function','validateUser','defineProperty','verify','length','password','metadata','jwtService','roles','object','2239956OMRzZp','3odxmaW','__decorate','1765520DhPOKG','JwtService','@nestjs/jwt','Injectable','updatePassword','AuthService','userService','updateUser','3478088IPLClC','sub','findUser','2618824VzCHtW','798549fNQMNy','decorate','_id','login','2dBPlDI','__metadata','UserService','__esModule','username','log'];a35_0xe08e=function(){return _0xe4db04;};return a35_0xe08e();}const a35_0x10c930=a35_0x4567;function a35_0x4567(_0x2a3dfc,_0x45f265){const _0xe08ece=a35_0xe08e();return a35_0x4567=function(_0x45676c,_0x17409e){_0x45676c=_0x45676c-0x145;let _0x240b68=_0xe08ece[_0x45676c];return _0x240b68;},a35_0x4567(_0x2a3dfc,_0x45f265);}(function(_0x584a80,_0x60c354){const _0x31dc79=a35_0x4567,_0x2da781=_0x584a80();while(!![]){try{const _0x17e735=-parseInt(_0x31dc79(0x14e))/0x1*(-parseInt(_0x31dc79(0x152))/0x2)+-parseInt(_0x31dc79(0x169))/0x3*(parseInt(_0x31dc79(0x14d))/0x4)+-parseInt(_0x31dc79(0x16b))/0x5+parseInt(_0x31dc79(0x168))/0x6+parseInt(_0x31dc79(0x15c))/0x7+parseInt(_0x31dc79(0x14a))/0x8+-parseInt(_0x31dc79(0x15d))/0x9;if(_0x17e735===_0x60c354)break;else _0x2da781['push'](_0x2da781['shift']());}catch(_0x2a4029){_0x2da781['push'](_0x2da781['shift']());}}}(a35_0xe08e,0x816ec));var __decorate=this&&this[a35_0x10c930(0x16a)]||function(_0x36920f,_0x5af1cf,_0x3ba13e,_0x51f991){const _0x450e97=a35_0x10c930;var _0x5f1c9e=arguments[_0x450e97(0x162)],_0x232a92=_0x5f1c9e<0x3?_0x5af1cf:_0x51f991===null?_0x51f991=Object[_0x450e97(0x159)](_0x5af1cf,_0x3ba13e):_0x51f991,_0x47b635;if(typeof Reflect===_0x450e97(0x167)&&typeof Reflect['decorate']==='function')_0x232a92=Reflect[_0x450e97(0x14f)](_0x36920f,_0x5af1cf,_0x3ba13e,_0x51f991);else{for(var _0x39264d=_0x36920f[_0x450e97(0x162)]-0x1;_0x39264d>=0x0;_0x39264d--)if(_0x47b635=_0x36920f[_0x39264d])_0x232a92=(_0x5f1c9e<0x3?_0x47b635(_0x232a92):_0x5f1c9e>0x3?_0x47b635(_0x5af1cf,_0x3ba13e,_0x232a92):_0x47b635(_0x5af1cf,_0x3ba13e))||_0x232a92;}return _0x5f1c9e>0x3&&_0x232a92&&Object[_0x450e97(0x160)](_0x5af1cf,_0x3ba13e,_0x232a92),_0x232a92;},__metadata=this&&this[a35_0x10c930(0x153)]||function(_0x468999,_0x1cd23c){const _0x2f4a81=a35_0x10c930;if(typeof Reflect===_0x2f4a81(0x167)&&typeof Reflect['metadata']===_0x2f4a81(0x15e))return Reflect[_0x2f4a81(0x164)](_0x468999,_0x1cd23c);};Object[a35_0x10c930(0x160)](exports,a35_0x10c930(0x155),{'value':!![]}),exports[a35_0x10c930(0x147)]=void 0x0;const common_1=require('@nestjs/common'),user_service_1=require(a35_0x10c930(0x15b)),jwt_1=require(a35_0x10c930(0x16d)),verify_1=require('./verify');let AuthService=class AuthService{constructor(_0x50acaf,_0x2cbc11){const _0x59f432=a35_0x10c930;this[_0x59f432(0x148)]=_0x50acaf,this['jwtService']=_0x2cbc11;}async[a35_0x10c930(0x15f)](_0x2dfbc2,_0x67f26c){const _0x4b624d=a35_0x10c930,_0xe009d6=await this['userService'][_0x4b624d(0x14c)](_0x2dfbc2);if(!_0xe009d6)return null;console[_0x4b624d(0x157)](_0xe009d6[_0x4b624d(0x163)],_0x67f26c,'user.password,\x20password');const _0x2979ca=await(0x0,verify_1[_0x4b624d(0x161)])(_0x67f26c,_0xe009d6[_0x4b624d(0x163)]);if(_0xe009d6&&_0x2979ca)return _0xe009d6;return null;}async[a35_0x10c930(0x146)](_0x27f9cf,{newPassword:_0x37fddd}){const _0x3b318d=a35_0x10c930,_0x2d64c0=await(0x0,verify_1[_0x3b318d(0x15a)])(_0x37fddd);return await this[_0x3b318d(0x148)][_0x3b318d(0x149)](_0x27f9cf[_0x3b318d(0x14b)],Object[_0x3b318d(0x158)](Object[_0x3b318d(0x158)]({},_0x27f9cf),{'password':_0x2d64c0}));}async[a35_0x10c930(0x151)](_0x2eec46){const _0x426b74=a35_0x10c930,_0x5c7b99={'username':_0x2eec46[_0x426b74(0x156)],'sub':_0x2eec46[_0x426b74(0x150)],'roles':_0x2eec46[_0x426b74(0x166)],'email':_0x2eec46['email']};return{'access_token':this[_0x426b74(0x165)]['sign'](_0x5c7b99)};}};AuthService=__decorate([(0x0,common_1[a35_0x10c930(0x145)])(),__metadata('design:paramtypes',[user_service_1[a35_0x10c930(0x154)],jwt_1[a35_0x10c930(0x16c)]])],AuthService),exports[a35_0x10c930(0x147)]=AuthService;