'use strict';function a123_0x34bc(_0x1db5ea,_0x3c62c7){const _0x575480=a123_0x5754();return a123_0x34bc=function(_0x34bc55,_0x35c882){_0x34bc55=_0x34bc55-0xff;let _0x3ef015=_0x575480[_0x34bc55];return _0x3ef015;},a123_0x34bc(_0x1db5ea,_0x3c62c7);}const a123_0x5b5ebb=a123_0x34bc;(function(_0x5d726,_0x402545){const _0x5b795a=a123_0x34bc,_0x513f0a=_0x5d726();while(!![]){try{const _0x544e71=parseInt(_0x5b795a(0x12c))/0x1*(-parseInt(_0x5b795a(0x140))/0x2)+-parseInt(_0x5b795a(0x112))/0x3+-parseInt(_0x5b795a(0x13c))/0x4*(parseInt(_0x5b795a(0x123))/0x5)+parseInt(_0x5b795a(0x10c))/0x6+-parseInt(_0x5b795a(0x105))/0x7+-parseInt(_0x5b795a(0x117))/0x8*(parseInt(_0x5b795a(0x133))/0x9)+parseInt(_0x5b795a(0x148))/0xa;if(_0x544e71===_0x402545)break;else _0x513f0a['push'](_0x513f0a['shift']());}catch(_0x541dea){_0x513f0a['push'](_0x513f0a['shift']());}}}(a123_0x5754,0x5dd11));var __decorate=this&&this[a123_0x5b5ebb(0x126)]||function(_0xe7227b,_0x5814ea,_0x4ea0d7,_0x32d0d3){const _0x5dcb40=a123_0x5b5ebb;var _0x416bea=arguments['length'],_0x3616a6=_0x416bea<0x3?_0x5814ea:_0x32d0d3===null?_0x32d0d3=Object[_0x5dcb40(0x100)](_0x5814ea,_0x4ea0d7):_0x32d0d3,_0x52bf26;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x5dcb40(0x12b))_0x3616a6=Reflect['decorate'](_0xe7227b,_0x5814ea,_0x4ea0d7,_0x32d0d3);else{for(var _0x173d82=_0xe7227b['length']-0x1;_0x173d82>=0x0;_0x173d82--)if(_0x52bf26=_0xe7227b[_0x173d82])_0x3616a6=(_0x416bea<0x3?_0x52bf26(_0x3616a6):_0x416bea>0x3?_0x52bf26(_0x5814ea,_0x4ea0d7,_0x3616a6):_0x52bf26(_0x5814ea,_0x4ea0d7))||_0x3616a6;}return _0x416bea>0x3&&_0x3616a6&&Object[_0x5dcb40(0x13a)](_0x5814ea,_0x4ea0d7,_0x3616a6),_0x3616a6;},__metadata=this&&this['__metadata']||function(_0x226977,_0x3644ba){const _0x44de24=a123_0x5b5ebb;if(typeof Reflect==='object'&&typeof Reflect[_0x44de24(0x13f)]===_0x44de24(0x12b))return Reflect[_0x44de24(0x13f)](_0x226977,_0x3644ba);},__param=this&&this[a123_0x5b5ebb(0x116)]||function(_0x3224b8,_0x3eec7d){return function(_0xa9ac95,_0x55a182){_0x3eec7d(_0xa9ac95,_0x55a182,_0x3224b8);};};Object[a123_0x5b5ebb(0x13a)](exports,a123_0x5b5ebb(0x10b),{'value':!![]}),exports['SettingController']=void 0x0;function a123_0x5754(){const _0xe81741=['isExpired','/update','schoolId','__param','48RYDEKH','stdout','UserSettingDto','expiryDate','settingService','../auth/decorators/roles.decorator','isValid','Success\x20request\x20update\x20app\x20to\x20latest\x20version','design:paramtypes','updateCode',':id/user-setting','data','20CuTfXq','findFirst',':id/license','__decorate','../auth/guards/roles.guard','Invalid\x20license\x20key','Body','exec','function','563099ayAZZt','maxUser','JwtAuthGuard','RolesGuard','SettingController','create','User','439191ZdjVKE','killJobs','Param','validateLicenseKey','updateUserSetting','update','Max\x20user\x20must\x20be\x20a\x20number','defineProperty','/kill-jobs','67440JgXzpv','stderr','error','metadata','2vcDvrQ','design:type','Master','./dto','@nestjs/common','userSetting','log','Roles','11197390bwDjmJ','Controller','BadRequestException','getOwnPropertyDescriptor','UseGuards','pm2\x20restart\x20startUI\x20startApi','prototype','Admin','1209985fIJQEH','SettingService','./dto/user-setting.dto','initalize','mapSettingDocumentToDto','Role','__esModule','4313976TKuEPl','Post','child_process','design:returntype','UpdateSettingDto','setting','1074822WyszvG'];a123_0x5754=function(){return _0xe81741;};return a123_0x5754();}const common_1=require(a123_0x5b5ebb(0x144)),setting_service_1=require('./setting.service'),dto_1=require(a123_0x5b5ebb(0x143)),roles_decorator_1=require(a123_0x5b5ebb(0x11c)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a123_0x5b5ebb(0x127)),setting_mapper_1=require('./mappers/setting.mapper'),child_process_1=require(a123_0x5b5ebb(0x10e)),user_setting_dto_1=require(a123_0x5b5ebb(0x107));let SettingController=class SettingController{constructor(_0x2627cb){const _0x4c7db9=a123_0x5b5ebb;this[_0x4c7db9(0x11b)]=_0x2627cb,this[_0x4c7db9(0x108)]();}async[a123_0x5b5ebb(0x124)](){const _0x3609a5=a123_0x5b5ebb,_0x496043=await this['settingService'][_0x3609a5(0x124)](),_0xd2d835=this[_0x3609a5(0x11b)][_0x3609a5(0x136)](_0x496043['licenseKey'],_0x496043[_0x3609a5(0x115)]);return(0x0,setting_mapper_1[_0x3609a5(0x109)])(_0x496043,_0xd2d835[_0x3609a5(0x11a)]);}async[a123_0x5b5ebb(0x120)](){const _0x38c13b=a123_0x5b5ebb,_0x3f64bc=(0x0,child_process_1[_0x38c13b(0x12a)])(_0x38c13b(0x102));return console[_0x38c13b(0x146)](_0x38c13b(0x11e)),_0x3f64bc[_0x38c13b(0x118)]['on'](_0x38c13b(0x13e),_0x9878a1=>{const _0x2d6f8c=_0x38c13b;console[_0x2d6f8c(0x146)](_0x9878a1);}),_0x3f64bc['stdin']['on'](_0x38c13b(0x13e),_0xbafa74=>{console['log'](_0xbafa74);}),_0x3f64bc[_0x38c13b(0x13d)]['on'](_0x38c13b(0x122),_0xb45a3=>{const _0x2180d4=_0x38c13b;console[_0x2180d4(0x146)](_0xb45a3);}),'Success\x20request\x20update\x20app\x20to\x20latest\x20version';}async[a123_0x5b5ebb(0x138)](_0x486a51,_0x2d537a){const _0x593889=a123_0x5b5ebb,_0x49a9f5=this[_0x593889(0x11b)][_0x593889(0x136)](_0x2d537a['licenseKey'],_0x2d537a[_0x593889(0x115)]);if(!_0x49a9f5[_0x593889(0x11d)])throw new common_1[(_0x593889(0xff))](_0x593889(0x128));_0x2d537a[_0x593889(0x113)]=![];const _0x1eadda=await this[_0x593889(0x11b)][_0x593889(0x138)](_0x486a51,_0x2d537a);return(0x0,setting_mapper_1[_0x593889(0x109)])(_0x1eadda,_0x49a9f5['expiryDate']);}async[a123_0x5b5ebb(0x137)](_0x3d8afb,_0x2cdf52){const _0x1e0574=a123_0x5b5ebb;_0x2cdf52[_0x1e0574(0x12d)]=+_0x2cdf52[_0x1e0574(0x12d)];if(isNaN(_0x2cdf52[_0x1e0574(0x12d)]))throw new common_1[(_0x1e0574(0xff))](_0x1e0574(0x139));const _0x43414=await this[_0x1e0574(0x11b)]['updateUserSetting'](_0x2cdf52);return _0x43414[_0x1e0574(0x145)];}async[a123_0x5b5ebb(0x134)](){const _0x5f1046=a123_0x5b5ebb;await this[_0x5f1046(0x11b)][_0x5f1046(0x134)]();}async[a123_0x5b5ebb(0x108)](){const _0x16d644=a123_0x5b5ebb,_0x28a990=await this['settingService']['findFirst']();!_0x28a990&&await this['settingService'][_0x16d644(0x131)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1['Get'])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x5b5ebb(0x12f)]),(0x0,roles_decorator_1[a123_0x5b5ebb(0x147)])(role_enum_1[a123_0x5b5ebb(0x10a)]['Admin'],role_enum_1[a123_0x5b5ebb(0x10a)]['User'],role_enum_1[a123_0x5b5ebb(0x10a)]['Viewer']),__metadata(a123_0x5b5ebb(0x141),Function),__metadata(a123_0x5b5ebb(0x11f),[]),__metadata('design:returntype',Promise)],SettingController[a123_0x5b5ebb(0x103)],'findFirst',null),__decorate([(0x0,common_1[a123_0x5b5ebb(0x10d)])(a123_0x5b5ebb(0x114)),(0x0,common_1[a123_0x5b5ebb(0x101)])(jwt_guard_1[a123_0x5b5ebb(0x12e)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x5b5ebb(0x147)])(role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x104)],role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x132)]),__metadata(a123_0x5b5ebb(0x141),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x5b5ebb(0x10f),Promise)],SettingController['prototype'],a123_0x5b5ebb(0x120),null),__decorate([(0x0,common_1['Patch'])(a123_0x5b5ebb(0x125)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x5b5ebb(0x12e)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x104)],role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x132)]),__param(0x0,(0x0,common_1[a123_0x5b5ebb(0x135)])('id')),__param(0x1,(0x0,common_1[a123_0x5b5ebb(0x129)])()),__metadata('design:type',Function),__metadata(a123_0x5b5ebb(0x11f),[String,dto_1[a123_0x5b5ebb(0x110)]]),__metadata(a123_0x5b5ebb(0x10f),Promise)],SettingController['prototype'],'update',null),__decorate([(0x0,common_1['Patch'])(a123_0x5b5ebb(0x121)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x5b5ebb(0x12e)],roles_guard_1[a123_0x5b5ebb(0x12f)]),(0x0,roles_decorator_1[a123_0x5b5ebb(0x147)])(role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x142)]),__param(0x0,(0x0,common_1[a123_0x5b5ebb(0x135)])('id')),__param(0x1,(0x0,common_1[a123_0x5b5ebb(0x129)])()),__metadata(a123_0x5b5ebb(0x141),Function),__metadata(a123_0x5b5ebb(0x11f),[String,user_setting_dto_1[a123_0x5b5ebb(0x119)]]),__metadata(a123_0x5b5ebb(0x10f),Promise)],SettingController[a123_0x5b5ebb(0x103)],a123_0x5b5ebb(0x137),null),__decorate([(0x0,common_1[a123_0x5b5ebb(0x10d)])(a123_0x5b5ebb(0x13b)),(0x0,common_1[a123_0x5b5ebb(0x101)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x5b5ebb(0x12f)]),(0x0,roles_decorator_1[a123_0x5b5ebb(0x147)])(role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x104)],role_enum_1[a123_0x5b5ebb(0x10a)][a123_0x5b5ebb(0x132)]),__metadata(a123_0x5b5ebb(0x141),Function),__metadata(a123_0x5b5ebb(0x11f),[]),__metadata(a123_0x5b5ebb(0x10f),Promise)],SettingController[a123_0x5b5ebb(0x103)],a123_0x5b5ebb(0x134),null),SettingController=__decorate([(0x0,common_1[a123_0x5b5ebb(0x149)])(a123_0x5b5ebb(0x111)),__metadata('design:paramtypes',[setting_service_1[a123_0x5b5ebb(0x106)]])],SettingController),exports[a123_0x5b5ebb(0x130)]=SettingController;