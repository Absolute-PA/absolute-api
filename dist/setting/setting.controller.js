'use strict';const a120_0x177fe4=a120_0x4367;(function(_0x1c396f,_0x5f2fdc){const _0x8eb5d5=a120_0x4367,_0x5343f5=_0x1c396f();while(!![]){try{const _0x5b9e13=-parseInt(_0x8eb5d5(0x1af))/0x1*(-parseInt(_0x8eb5d5(0x18b))/0x2)+-parseInt(_0x8eb5d5(0x191))/0x3*(parseInt(_0x8eb5d5(0x195))/0x4)+parseInt(_0x8eb5d5(0x19c))/0x5+parseInt(_0x8eb5d5(0x1a4))/0x6+-parseInt(_0x8eb5d5(0x18c))/0x7*(-parseInt(_0x8eb5d5(0x1ae))/0x8)+-parseInt(_0x8eb5d5(0x1a7))/0x9*(-parseInt(_0x8eb5d5(0x198))/0xa)+parseInt(_0x8eb5d5(0x18f))/0xb*(-parseInt(_0x8eb5d5(0x1ab))/0xc);if(_0x5b9e13===_0x5f2fdc)break;else _0x5343f5['push'](_0x5343f5['shift']());}catch(_0x4a3101){_0x5343f5['push'](_0x5343f5['shift']());}}}(a120_0x3d0d,0xb75ba));var __decorate=this&&this[a120_0x177fe4(0x189)]||function(_0x215ef5,_0x547e1d,_0x1db26f,_0x584019){const _0x43bd02=a120_0x177fe4;var _0x2d4fd8=arguments[_0x43bd02(0x1b4)],_0x4ad25d=_0x2d4fd8<0x3?_0x547e1d:_0x584019===null?_0x584019=Object[_0x43bd02(0x19a)](_0x547e1d,_0x1db26f):_0x584019,_0x1f4846;if(typeof Reflect===_0x43bd02(0x1a3)&&typeof Reflect['decorate']===_0x43bd02(0x1a2))_0x4ad25d=Reflect[_0x43bd02(0x177)](_0x215ef5,_0x547e1d,_0x1db26f,_0x584019);else{for(var _0x57da5a=_0x215ef5[_0x43bd02(0x1b4)]-0x1;_0x57da5a>=0x0;_0x57da5a--)if(_0x1f4846=_0x215ef5[_0x57da5a])_0x4ad25d=(_0x2d4fd8<0x3?_0x1f4846(_0x4ad25d):_0x2d4fd8>0x3?_0x1f4846(_0x547e1d,_0x1db26f,_0x4ad25d):_0x1f4846(_0x547e1d,_0x1db26f))||_0x4ad25d;}return _0x2d4fd8>0x3&&_0x4ad25d&&Object[_0x43bd02(0x1b9)](_0x547e1d,_0x1db26f,_0x4ad25d),_0x4ad25d;},__metadata=this&&this[a120_0x177fe4(0x1c0)]||function(_0x19e0cc,_0xb275d8){const _0x13a314=a120_0x177fe4;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x13a314(0x1b2)](_0x19e0cc,_0xb275d8);},__param=this&&this['__param']||function(_0x4394b9,_0x33325f){return function(_0x25881f,_0xb052eb){_0x33325f(_0x25881f,_0xb052eb,_0x4394b9);};};function a120_0x4367(_0x10e170,_0x3a4c04){const _0x3d0d99=a120_0x3d0d();return a120_0x4367=function(_0x436783,_0x25569c){_0x436783=_0x436783-0x172;let _0x159bb1=_0x3d0d99[_0x436783];return _0x159bb1;},a120_0x4367(_0x10e170,_0x3a4c04);}Object[a120_0x177fe4(0x1b9)](exports,a120_0x177fe4(0x1b5),{'value':!![]}),exports['SettingController']=void 0x0;const common_1=require(a120_0x177fe4(0x19b)),setting_service_1=require('./setting.service'),dto_1=require('./dto'),roles_decorator_1=require(a120_0x177fe4(0x174)),role_enum_1=require(a120_0x177fe4(0x172)),jwt_guard_1=require(a120_0x177fe4(0x1b3)),roles_guard_1=require(a120_0x177fe4(0x1ba)),setting_mapper_1=require(a120_0x177fe4(0x181)),child_process_1=require(a120_0x177fe4(0x192)),user_setting_dto_1=require(a120_0x177fe4(0x1a5));let SettingController=class SettingController{constructor(_0x4dffaf){const _0x4a45da=a120_0x177fe4;this[_0x4a45da(0x1bd)]=_0x4dffaf,this[_0x4a45da(0x1be)]();}async[a120_0x177fe4(0x1a1)](){const _0x4827d2=a120_0x177fe4,_0x183c39=await this[_0x4827d2(0x1bd)][_0x4827d2(0x1a1)](),_0x554758=this[_0x4827d2(0x1bd)][_0x4827d2(0x199)](_0x183c39['licenseKey'],_0x183c39[_0x4827d2(0x19e)]);return(0x0,setting_mapper_1[_0x4827d2(0x1bb)])(_0x183c39,_0x554758[_0x4827d2(0x173)]);}async[a120_0x177fe4(0x185)](){const _0x4d2504=a120_0x177fe4,_0xdcc443=(0x0,child_process_1[_0x4d2504(0x187)])(_0x4d2504(0x196));return console[_0x4d2504(0x175)](_0x4d2504(0x1b1)),_0xdcc443[_0x4d2504(0x186)]['on'](_0x4d2504(0x193),_0x595bb6=>{const _0x3e58d5=_0x4d2504;console[_0x3e58d5(0x175)](_0x595bb6);}),_0xdcc443['stdin']['on'](_0x4d2504(0x193),_0x38bad4=>{const _0x246802=_0x4d2504;console[_0x246802(0x175)](_0x38bad4);}),_0xdcc443[_0x4d2504(0x184)]['on']('data',_0x1b4157=>{const _0x5a787a=_0x4d2504;console[_0x5a787a(0x175)](_0x1b4157);}),_0x4d2504(0x1b1);}async[a120_0x177fe4(0x1b6)](_0x42b70a,_0x55e640){const _0x22b137=a120_0x177fe4,_0x57c135=this[_0x22b137(0x1bd)][_0x22b137(0x199)](_0x55e640['licenseKey'],_0x55e640[_0x22b137(0x19e)]);if(!_0x57c135[_0x22b137(0x18d)])throw new common_1['BadRequestException'](_0x22b137(0x18e));_0x55e640[_0x22b137(0x17f)]=![];const _0x245a3f=await this[_0x22b137(0x1bd)][_0x22b137(0x1b6)](_0x42b70a,_0x55e640);return(0x0,setting_mapper_1[_0x22b137(0x1bb)])(_0x245a3f,_0x57c135[_0x22b137(0x173)]);}async['updateUserSetting'](_0x4ad67e,_0x4dd917){const _0x5828b9=a120_0x177fe4;_0x4dd917[_0x5828b9(0x1a6)]=+_0x4dd917[_0x5828b9(0x1a6)];if(isNaN(_0x4dd917['maxUser']))throw new common_1['BadRequestException'](_0x5828b9(0x197));const _0x157527=await this[_0x5828b9(0x1bd)]['updateUserSetting'](_0x4dd917);return _0x157527[_0x5828b9(0x183)];}async['killJobs'](){const _0x369707=a120_0x177fe4;await this[_0x369707(0x1bd)][_0x369707(0x1c1)]();}async[a120_0x177fe4(0x1be)](){const _0x4ac63a=a120_0x177fe4,_0x3c27ee=await this['settingService'][_0x4ac63a(0x1a1)]();!_0x3c27ee&&await this[_0x4ac63a(0x1bd)][_0x4ac63a(0x17a)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a120_0x177fe4(0x19f)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x1bc)],role_enum_1[a120_0x177fe4(0x188)]['User'],role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x1a0)]),__metadata(a120_0x177fe4(0x190),Function),__metadata(a120_0x177fe4(0x19d),[]),__metadata(a120_0x177fe4(0x1a9),Promise)],SettingController[a120_0x177fe4(0x17d)],a120_0x177fe4(0x1a1),null),__decorate([(0x0,common_1[a120_0x177fe4(0x1bf)])(a120_0x177fe4(0x179)),(0x0,common_1[a120_0x177fe4(0x194)])(jwt_guard_1[a120_0x177fe4(0x18a)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role']['Admin'],role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x1b7)]),__metadata(a120_0x177fe4(0x190),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],SettingController[a120_0x177fe4(0x17d)],a120_0x177fe4(0x185),null),__decorate([(0x0,common_1[a120_0x177fe4(0x17b)])(':id/license'),(0x0,common_1[a120_0x177fe4(0x194)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a120_0x177fe4(0x17c)]),(0x0,roles_decorator_1[a120_0x177fe4(0x1b0)])(role_enum_1[a120_0x177fe4(0x188)]['Admin'],role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x1b7)]),__param(0x0,(0x0,common_1[a120_0x177fe4(0x1b8)])('id')),__param(0x1,(0x0,common_1[a120_0x177fe4(0x182)])()),__metadata(a120_0x177fe4(0x190),Function),__metadata(a120_0x177fe4(0x19d),[String,dto_1[a120_0x177fe4(0x1ad)]]),__metadata('design:returntype',Promise)],SettingController[a120_0x177fe4(0x17d)],a120_0x177fe4(0x1b6),null),__decorate([(0x0,common_1[a120_0x177fe4(0x17b)])(a120_0x177fe4(0x17e)),(0x0,common_1[a120_0x177fe4(0x194)])(jwt_guard_1[a120_0x177fe4(0x18a)],roles_guard_1[a120_0x177fe4(0x17c)]),(0x0,roles_decorator_1[a120_0x177fe4(0x1b0)])(role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x180)]),__param(0x0,(0x0,common_1[a120_0x177fe4(0x1b8)])('id')),__param(0x1,(0x0,common_1[a120_0x177fe4(0x182)])()),__metadata('design:type',Function),__metadata(a120_0x177fe4(0x19d),[String,user_setting_dto_1['UserSettingDto']]),__metadata(a120_0x177fe4(0x1a9),Promise)],SettingController[a120_0x177fe4(0x17d)],a120_0x177fe4(0x1aa),null),__decorate([(0x0,common_1[a120_0x177fe4(0x1bf)])(a120_0x177fe4(0x1a8)),(0x0,common_1[a120_0x177fe4(0x194)])(jwt_guard_1[a120_0x177fe4(0x18a)],roles_guard_1[a120_0x177fe4(0x17c)]),(0x0,roles_decorator_1[a120_0x177fe4(0x1b0)])(role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x1bc)],role_enum_1[a120_0x177fe4(0x188)][a120_0x177fe4(0x1b7)]),__metadata(a120_0x177fe4(0x190),Function),__metadata(a120_0x177fe4(0x19d),[]),__metadata(a120_0x177fe4(0x1a9),Promise)],SettingController['prototype'],a120_0x177fe4(0x1c1),null),SettingController=__decorate([(0x0,common_1['Controller'])(a120_0x177fe4(0x1ac)),__metadata(a120_0x177fe4(0x19d),[setting_service_1[a120_0x177fe4(0x178)]])],SettingController),exports[a120_0x177fe4(0x176)]=SettingController;function a120_0x3d0d(){const _0x346917=['mapSettingDocumentToDto','Admin','settingService','initalize','Post','__metadata','killJobs','../auth/enums/role.enum','expiryDate','../auth/decorators/roles.decorator','log','SettingController','decorate','SettingService','/update','create','Patch','RolesGuard','prototype',':id/user-setting','isExpired','Master','./mappers/setting.mapper','Body','userSetting','stderr','updateCode','stdout','exec','Role','__decorate','JwtAuthGuard','2fOLjtk','14ohzpQF','isValid','Invalid\x20license\x20key','4059176ayemSL','design:type','753jIuaWI','child_process','error','UseGuards','5832eCxSId','pm2\x20restart\x20startUI\x20startApi','Max\x20user\x20must\x20be\x20a\x20number','13483130nCwwdv','validateLicenseKey','getOwnPropertyDescriptor','@nestjs/common','3704260LdoAtV','design:paramtypes','schoolId','Get','Viewer','findFirst','function','object','1787316Kgfjtw','./dto/user-setting.dto','maxUser','9QfwOQV','/kill-jobs','design:returntype','updateUserSetting','108SnvqhB','setting','UpdateSettingDto','2694144aFdubX','1377549hFbxQt','Roles','Success\x20request\x20update\x20app\x20to\x20latest\x20version','metadata','../auth/guards/jwt.guard','length','__esModule','update','User','Param','defineProperty','../auth/guards/roles.guard'];a120_0x3d0d=function(){return _0x346917;};return a120_0x3d0d();}