'use strict';const a120_0x265cb2=a120_0x4d09;(function(_0x333b23,_0x4954d9){const _0x39bb18=a120_0x4d09,_0xb26cb3=_0x333b23();while(!![]){try{const _0x2f8239=parseInt(_0x39bb18(0x175))/0x1+parseInt(_0x39bb18(0x186))/0x2+parseInt(_0x39bb18(0x17e))/0x3*(parseInt(_0x39bb18(0x148))/0x4)+-parseInt(_0x39bb18(0x161))/0x5*(-parseInt(_0x39bb18(0x162))/0x6)+parseInt(_0x39bb18(0x179))/0x7*(-parseInt(_0x39bb18(0x185))/0x8)+-parseInt(_0x39bb18(0x152))/0x9*(parseInt(_0x39bb18(0x138))/0xa)+parseInt(_0x39bb18(0x16b))/0xb*(-parseInt(_0x39bb18(0x171))/0xc);if(_0x2f8239===_0x4954d9)break;else _0xb26cb3['push'](_0xb26cb3['shift']());}catch(_0x2d5df2){_0xb26cb3['push'](_0xb26cb3['shift']());}}}(a120_0x5068,0xaa9dd));var __decorate=this&&this[a120_0x265cb2(0x17c)]||function(_0x385141,_0x54c5a5,_0x21febb,_0x450f86){const _0x2af4e5=a120_0x265cb2;var _0x2ae4bf=arguments['length'],_0x396104=_0x2ae4bf<0x3?_0x54c5a5:_0x450f86===null?_0x450f86=Object[_0x2af4e5(0x169)](_0x54c5a5,_0x21febb):_0x450f86,_0x3a8bb2;if(typeof Reflect===_0x2af4e5(0x150)&&typeof Reflect[_0x2af4e5(0x17a)]===_0x2af4e5(0x174))_0x396104=Reflect[_0x2af4e5(0x17a)](_0x385141,_0x54c5a5,_0x21febb,_0x450f86);else{for(var _0x31aa9b=_0x385141['length']-0x1;_0x31aa9b>=0x0;_0x31aa9b--)if(_0x3a8bb2=_0x385141[_0x31aa9b])_0x396104=(_0x2ae4bf<0x3?_0x3a8bb2(_0x396104):_0x2ae4bf>0x3?_0x3a8bb2(_0x54c5a5,_0x21febb,_0x396104):_0x3a8bb2(_0x54c5a5,_0x21febb))||_0x396104;}return _0x2ae4bf>0x3&&_0x396104&&Object[_0x2af4e5(0x14a)](_0x54c5a5,_0x21febb,_0x396104),_0x396104;},__metadata=this&&this['__metadata']||function(_0x374154,_0x45e080){const _0xcab318=a120_0x265cb2;if(typeof Reflect===_0xcab318(0x150)&&typeof Reflect[_0xcab318(0x177)]===_0xcab318(0x174))return Reflect['metadata'](_0x374154,_0x45e080);},__param=this&&this[a120_0x265cb2(0x172)]||function(_0x264c97,_0x321104){return function(_0x23a53f,_0x4b5a25){_0x321104(_0x23a53f,_0x4b5a25,_0x264c97);};};Object[a120_0x265cb2(0x14a)](exports,a120_0x265cb2(0x153),{'value':!![]}),exports[a120_0x265cb2(0x180)]=void 0x0;const common_1=require(a120_0x265cb2(0x184)),setting_service_1=require(a120_0x265cb2(0x183)),dto_1=require(a120_0x265cb2(0x13e)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a120_0x265cb2(0x147)),roles_guard_1=require(a120_0x265cb2(0x168)),setting_mapper_1=require(a120_0x265cb2(0x170)),child_process_1=require('child_process'),user_setting_dto_1=require(a120_0x265cb2(0x14d));let SettingController=class SettingController{constructor(_0x47c952){const _0x167b36=a120_0x265cb2;this[_0x167b36(0x13a)]=_0x47c952,this[_0x167b36(0x15e)]();}async[a120_0x265cb2(0x159)](){const _0x1a9019=a120_0x265cb2,_0x2e9be2=await this[_0x1a9019(0x13a)]['findFirst'](),_0x43728f=this[_0x1a9019(0x13a)][_0x1a9019(0x15f)](_0x2e9be2[_0x1a9019(0x17f)],_0x2e9be2[_0x1a9019(0x16a)]);return(0x0,setting_mapper_1[_0x1a9019(0x17b)])(_0x2e9be2,_0x43728f[_0x1a9019(0x15a)]);}async['updateCode'](){const _0x569749=a120_0x265cb2,_0x21a683=(0x0,child_process_1[_0x569749(0x167)])(_0x569749(0x16f));return console[_0x569749(0x173)](_0x569749(0x166)),_0x21a683[_0x569749(0x178)]['on'](_0x569749(0x146),_0x52d8c=>{const _0x32ca79=_0x569749;console[_0x32ca79(0x173)](_0x52d8c);}),_0x21a683[_0x569749(0x139)]['on'](_0x569749(0x146),_0xba238f=>{const _0x2ce601=_0x569749;console[_0x2ce601(0x173)](_0xba238f);}),_0x21a683[_0x569749(0x176)]['on'](_0x569749(0x182),_0x452cb3=>{console['log'](_0x452cb3);}),_0x569749(0x166);}async[a120_0x265cb2(0x151)](_0x96045c,_0x5cac0b){const _0x152297=a120_0x265cb2,_0x2745e0=this[_0x152297(0x13a)]['validateLicenseKey'](_0x5cac0b[_0x152297(0x17f)],_0x5cac0b[_0x152297(0x16a)]);if(!_0x2745e0[_0x152297(0x154)])throw new common_1['BadRequestException']('Invalid\x20license\x20key');_0x5cac0b['isExpired']=![];const _0x78fb96=await this[_0x152297(0x13a)][_0x152297(0x151)](_0x96045c,_0x5cac0b);return(0x0,setting_mapper_1[_0x152297(0x17b)])(_0x78fb96,_0x2745e0[_0x152297(0x15a)]);}async[a120_0x265cb2(0x14b)](_0x22a5e6,_0x99c30){const _0x48b311=a120_0x265cb2;_0x99c30[_0x48b311(0x16e)]=+_0x99c30[_0x48b311(0x16e)];if(isNaN(_0x99c30['maxUser']))throw new common_1[(_0x48b311(0x15b))](_0x48b311(0x13d));const _0x1f8178=await this[_0x48b311(0x13a)][_0x48b311(0x14b)](_0x99c30);return _0x1f8178[_0x48b311(0x156)];}async[a120_0x265cb2(0x145)](){const _0x585600=a120_0x265cb2;await this[_0x585600(0x13a)][_0x585600(0x145)]();}async[a120_0x265cb2(0x15e)](){const _0x336972=a120_0x265cb2,_0x1a7fbd=await this[_0x336972(0x13a)][_0x336972(0x159)]();!_0x1a7fbd&&await this['settingService'][_0x336972(0x158)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};function a120_0x4d09(_0x3544ba,_0x3db0be){const _0x5068cb=a120_0x5068();return a120_0x4d09=function(_0x4d0925,_0x4d2f3a){_0x4d0925=_0x4d0925-0x137;let _0x20aadc=_0x5068cb[_0x4d0925];return _0x20aadc;},a120_0x4d09(_0x3544ba,_0x3db0be);}function a120_0x5068(){const _0x4c6ea2=['RolesGuard','data','./setting.service','@nestjs/common','6424iprtwW','534918cFSrJV','Post','216380vSavLa','stdin','settingService','JwtAuthGuard','prototype','Max\x20user\x20must\x20be\x20a\x20number','./dto','Param','/kill-jobs','UserSettingDto','Roles','User','design:type','killJobs','error','../auth/guards/jwt.guard','8fczhbt','Admin','defineProperty','updateUserSetting','Role','./dto/user-setting.dto','design:paramtypes','UpdateSettingDto','object','update','81GFnobi','__esModule','isValid','Patch','userSetting','design:returntype','create','findFirst','expiryDate','BadRequestException','updateCode','setting','initalize','validateLicenseKey','Body','207565MiYMrq','72aBgVgP','Viewer','/update','UseGuards','Success\x20request\x20update\x20app\x20to\x20latest\x20version','exec','../auth/guards/roles.guard','getOwnPropertyDescriptor','schoolId','11VHDLKd',':id/license','Controller','maxUser','pm2\x20restart\x20startUI\x20startApi','./mappers/setting.mapper','12491688fRrLow','__param','log','function','1115330elDWbE','stderr','metadata','stdout','5978neHQad','decorate','mapSettingDocumentToDto','__decorate','Master','1109067BmnEpO','licenseKey','SettingController'];a120_0x5068=function(){return _0x4c6ea2;};return a120_0x5068();}__decorate([(0x0,common_1['Get'])('/'),(0x0,common_1[a120_0x265cb2(0x165)])(jwt_guard_1[a120_0x265cb2(0x13b)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x265cb2(0x14c)][a120_0x265cb2(0x149)],role_enum_1[a120_0x265cb2(0x14c)][a120_0x265cb2(0x143)],role_enum_1['Role'][a120_0x265cb2(0x163)]),__metadata(a120_0x265cb2(0x144),Function),__metadata(a120_0x265cb2(0x14e),[]),__metadata('design:returntype',Promise)],SettingController[a120_0x265cb2(0x13c)],a120_0x265cb2(0x159),null),__decorate([(0x0,common_1['Post'])(a120_0x265cb2(0x164)),(0x0,common_1[a120_0x265cb2(0x165)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x265cb2(0x142)])(role_enum_1[a120_0x265cb2(0x14c)][a120_0x265cb2(0x149)],role_enum_1['Role'][a120_0x265cb2(0x143)]),__metadata(a120_0x265cb2(0x144),Function),__metadata(a120_0x265cb2(0x14e),[]),__metadata(a120_0x265cb2(0x157),Promise)],SettingController['prototype'],a120_0x265cb2(0x15c),null),__decorate([(0x0,common_1[a120_0x265cb2(0x155)])(a120_0x265cb2(0x16c)),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x265cb2(0x13b)],roles_guard_1[a120_0x265cb2(0x181)]),(0x0,roles_decorator_1[a120_0x265cb2(0x142)])(role_enum_1[a120_0x265cb2(0x14c)][a120_0x265cb2(0x149)],role_enum_1[a120_0x265cb2(0x14c)][a120_0x265cb2(0x143)]),__param(0x0,(0x0,common_1[a120_0x265cb2(0x13f)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a120_0x265cb2(0x144),Function),__metadata(a120_0x265cb2(0x14e),[String,dto_1[a120_0x265cb2(0x14f)]]),__metadata(a120_0x265cb2(0x157),Promise)],SettingController[a120_0x265cb2(0x13c)],a120_0x265cb2(0x151),null),__decorate([(0x0,common_1[a120_0x265cb2(0x155)])(':id/user-setting'),(0x0,common_1[a120_0x265cb2(0x165)])(jwt_guard_1[a120_0x265cb2(0x13b)],roles_guard_1[a120_0x265cb2(0x181)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a120_0x265cb2(0x17d)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a120_0x265cb2(0x160)])()),__metadata(a120_0x265cb2(0x144),Function),__metadata(a120_0x265cb2(0x14e),[String,user_setting_dto_1[a120_0x265cb2(0x141)]]),__metadata(a120_0x265cb2(0x157),Promise)],SettingController[a120_0x265cb2(0x13c)],a120_0x265cb2(0x14b),null),__decorate([(0x0,common_1[a120_0x265cb2(0x137)])(a120_0x265cb2(0x140)),(0x0,common_1[a120_0x265cb2(0x165)])(jwt_guard_1[a120_0x265cb2(0x13b)],roles_guard_1[a120_0x265cb2(0x181)]),(0x0,roles_decorator_1[a120_0x265cb2(0x142)])(role_enum_1['Role'][a120_0x265cb2(0x149)],role_enum_1['Role'][a120_0x265cb2(0x143)]),__metadata(a120_0x265cb2(0x144),Function),__metadata(a120_0x265cb2(0x14e),[]),__metadata('design:returntype',Promise)],SettingController[a120_0x265cb2(0x13c)],a120_0x265cb2(0x145),null),SettingController=__decorate([(0x0,common_1[a120_0x265cb2(0x16d)])(a120_0x265cb2(0x15d)),__metadata(a120_0x265cb2(0x14e),[setting_service_1['SettingService']])],SettingController),exports[a120_0x265cb2(0x180)]=SettingController;