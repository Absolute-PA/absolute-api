'use strict';function a123_0x55f9(){const _0x1bfafb=['function','expiryDate','117333UFbcSq','schoolId','./setting.service','initalize','1127490EStdhq','isExpired',':id/license','Roles','getOwnPropertyDescriptor','Post','Success\x20request\x20update\x20app\x20to\x20latest\x20version','2658012FSbCSy','Master','Controller','design:paramtypes','killJobs','maxUser','defineProperty','__metadata','isValid','error','26274qLFghk','validateLicenseKey','stdout','mapSettingDocumentToDto','update','1763824LKxayJ','./dto/user-setting.dto',':id/user-setting','4WGHvxq','updateUserSetting','/update','BadRequestException','Role','pm2\x20restart\x20startUI\x20startApi','/kill-jobs','UpdateSettingDto','exec','./mappers/setting.mapper','Body','prototype','Max\x20user\x20must\x20be\x20a\x20number','settingService','child_process','log','Get','object','stdin','JwtAuthGuard','Admin','__param','metadata','__decorate','Invalid\x20license\x20key','RolesGuard','licenseKey','length','SettingService','findFirst','UserSettingDto','SettingController','../auth/decorators/roles.decorator','design:returntype','Viewer','@nestjs/common','stderr','2120PzsxFz','Param','create','Patch','decorate','UseGuards','updateCode','User','3708305voBytE','design:type','./dto','674CcMupE'];a123_0x55f9=function(){return _0x1bfafb;};return a123_0x55f9();}const a123_0x1648a7=a123_0x54a5;(function(_0x5a99db,_0x50ea79){const _0x7338eb=a123_0x54a5,_0x58c0b1=_0x5a99db();while(!![]){try{const _0x2d4536=-parseInt(_0x7338eb(0x1e3))/0x1*(-parseInt(_0x7338eb(0x19e))/0x2)+parseInt(_0x7338eb(0x1b6))/0x3+parseInt(_0x7338eb(0x1be))/0x4*(-parseInt(_0x7338eb(0x1eb))/0x5)+-parseInt(_0x7338eb(0x1a5))/0x6+parseInt(_0x7338eb(0x1ac))/0x7+parseInt(_0x7338eb(0x1bb))/0x8+-parseInt(_0x7338eb(0x1a1))/0x9;if(_0x2d4536===_0x50ea79)break;else _0x58c0b1['push'](_0x58c0b1['shift']());}catch(_0x155dcf){_0x58c0b1['push'](_0x58c0b1['shift']());}}}(a123_0x55f9,0x5cf6b));function a123_0x54a5(_0x380c5f,_0x15b4c4){const _0x55f95b=a123_0x55f9();return a123_0x54a5=function(_0x54a5a,_0x8bb7e4){_0x54a5a=_0x54a5a-0x19d;let _0x547f54=_0x55f95b[_0x54a5a];return _0x547f54;},a123_0x54a5(_0x380c5f,_0x15b4c4);}var __decorate=this&&this[a123_0x1648a7(0x1d5)]||function(_0x847903,_0x43436a,_0x285d2f,_0x5f2e3e){const _0x18133c=a123_0x1648a7;var _0x3477db=arguments['length'],_0x26db61=_0x3477db<0x3?_0x43436a:_0x5f2e3e===null?_0x5f2e3e=Object[_0x18133c(0x1a9)](_0x43436a,_0x285d2f):_0x5f2e3e,_0x5319c7;if(typeof Reflect===_0x18133c(0x1cf)&&typeof Reflect[_0x18133c(0x1e7)]===_0x18133c(0x19f))_0x26db61=Reflect['decorate'](_0x847903,_0x43436a,_0x285d2f,_0x5f2e3e);else{for(var _0x172844=_0x847903[_0x18133c(0x1d9)]-0x1;_0x172844>=0x0;_0x172844--)if(_0x5319c7=_0x847903[_0x172844])_0x26db61=(_0x3477db<0x3?_0x5319c7(_0x26db61):_0x3477db>0x3?_0x5319c7(_0x43436a,_0x285d2f,_0x26db61):_0x5319c7(_0x43436a,_0x285d2f))||_0x26db61;}return _0x3477db>0x3&&_0x26db61&&Object[_0x18133c(0x1b2)](_0x43436a,_0x285d2f,_0x26db61),_0x26db61;},__metadata=this&&this[a123_0x1648a7(0x1b3)]||function(_0x479ce1,_0x107651){const _0x256cdf=a123_0x1648a7;if(typeof Reflect===_0x256cdf(0x1cf)&&typeof Reflect[_0x256cdf(0x1d4)]===_0x256cdf(0x19f))return Reflect[_0x256cdf(0x1d4)](_0x479ce1,_0x107651);},__param=this&&this[a123_0x1648a7(0x1d3)]||function(_0x5ff71a,_0x3edccb){return function(_0x4b01e7,_0x276700){_0x3edccb(_0x4b01e7,_0x276700,_0x5ff71a);};};Object[a123_0x1648a7(0x1b2)](exports,'__esModule',{'value':!![]}),exports['SettingController']=void 0x0;const common_1=require(a123_0x1648a7(0x1e1)),setting_service_1=require(a123_0x1648a7(0x1a3)),dto_1=require(a123_0x1648a7(0x19d)),roles_decorator_1=require(a123_0x1648a7(0x1de)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require('../auth/guards/roles.guard'),setting_mapper_1=require(a123_0x1648a7(0x1c7)),child_process_1=require(a123_0x1648a7(0x1cc)),user_setting_dto_1=require(a123_0x1648a7(0x1bc));let SettingController=class SettingController{constructor(_0x2bc5b9){const _0x3594bf=a123_0x1648a7;this[_0x3594bf(0x1cb)]=_0x2bc5b9,this[_0x3594bf(0x1a4)]();}async['findFirst'](){const _0x3c7666=a123_0x1648a7,_0x5a451b=await this[_0x3c7666(0x1cb)][_0x3c7666(0x1db)](),_0xa1b24=this[_0x3c7666(0x1cb)][_0x3c7666(0x1b7)](_0x5a451b['licenseKey'],_0x5a451b[_0x3c7666(0x1a2)]);return(0x0,setting_mapper_1[_0x3c7666(0x1b9)])(_0x5a451b,_0xa1b24[_0x3c7666(0x1a0)]);}async[a123_0x1648a7(0x1e9)](){const _0x459857=a123_0x1648a7,_0x164174=(0x0,child_process_1[_0x459857(0x1c6)])(_0x459857(0x1c3));return console[_0x459857(0x1cd)]('Success\x20request\x20update\x20app\x20to\x20latest\x20version'),_0x164174[_0x459857(0x1b8)]['on'](_0x459857(0x1b5),_0x85eb40=>{console['log'](_0x85eb40);}),_0x164174[_0x459857(0x1d0)]['on'](_0x459857(0x1b5),_0x2cf8a2=>{console['log'](_0x2cf8a2);}),_0x164174[_0x459857(0x1e2)]['on']('data',_0x2717ef=>{const _0x3e291c=_0x459857;console[_0x3e291c(0x1cd)](_0x2717ef);}),_0x459857(0x1ab);}async[a123_0x1648a7(0x1ba)](_0x5ba282,_0x6fb23){const _0x3dca55=a123_0x1648a7,_0x6a1574=this['settingService']['validateLicenseKey'](_0x6fb23[_0x3dca55(0x1d8)],_0x6fb23['schoolId']);if(!_0x6a1574[_0x3dca55(0x1b4)])throw new common_1[(_0x3dca55(0x1c1))](_0x3dca55(0x1d6));_0x6fb23[_0x3dca55(0x1a6)]=![];const _0x184c8e=await this[_0x3dca55(0x1cb)]['update'](_0x5ba282,_0x6fb23);return(0x0,setting_mapper_1[_0x3dca55(0x1b9)])(_0x184c8e,_0x6a1574[_0x3dca55(0x1a0)]);}async[a123_0x1648a7(0x1bf)](_0x2fa9de,_0x34851b){const _0x5c2ae0=a123_0x1648a7;_0x34851b['maxUser']=+_0x34851b[_0x5c2ae0(0x1b1)];if(isNaN(_0x34851b[_0x5c2ae0(0x1b1)]))throw new common_1[(_0x5c2ae0(0x1c1))](_0x5c2ae0(0x1ca));const _0x4f3de4=await this[_0x5c2ae0(0x1cb)][_0x5c2ae0(0x1bf)](_0x34851b);return _0x4f3de4['userSetting'];}async['killJobs'](){const _0x2c93f6=a123_0x1648a7;await this[_0x2c93f6(0x1cb)][_0x2c93f6(0x1b0)]();}async[a123_0x1648a7(0x1a4)](){const _0xad0f9c=a123_0x1648a7,_0x4f1e6e=await this['settingService'][_0xad0f9c(0x1db)]();!_0x4f1e6e&&await this[_0xad0f9c(0x1cb)][_0xad0f9c(0x1e5)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x1648a7(0x1ce)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x1648a7(0x1d1)],roles_guard_1[a123_0x1648a7(0x1d7)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x1648a7(0x1c2)][a123_0x1648a7(0x1d2)],role_enum_1[a123_0x1648a7(0x1c2)][a123_0x1648a7(0x1ea)],role_enum_1['Role'][a123_0x1648a7(0x1e0)]),__metadata(a123_0x1648a7(0x1ec),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x1648a7(0x1df),Promise)],SettingController[a123_0x1648a7(0x1c9)],a123_0x1648a7(0x1db),null),__decorate([(0x0,common_1[a123_0x1648a7(0x1aa)])(a123_0x1648a7(0x1c0)),(0x0,common_1[a123_0x1648a7(0x1e8)])(jwt_guard_1[a123_0x1648a7(0x1d1)],roles_guard_1[a123_0x1648a7(0x1d7)]),(0x0,roles_decorator_1[a123_0x1648a7(0x1a8)])(role_enum_1[a123_0x1648a7(0x1c2)]['Admin'],role_enum_1[a123_0x1648a7(0x1c2)]['User']),__metadata(a123_0x1648a7(0x1ec),Function),__metadata(a123_0x1648a7(0x1af),[]),__metadata(a123_0x1648a7(0x1df),Promise)],SettingController['prototype'],a123_0x1648a7(0x1e9),null),__decorate([(0x0,common_1['Patch'])(a123_0x1648a7(0x1a7)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x1648a7(0x1d1)],roles_guard_1[a123_0x1648a7(0x1d7)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x1648a7(0x1c2)][a123_0x1648a7(0x1d2)],role_enum_1['Role'][a123_0x1648a7(0x1ea)]),__param(0x0,(0x0,common_1[a123_0x1648a7(0x1e4)])('id')),__param(0x1,(0x0,common_1[a123_0x1648a7(0x1c8)])()),__metadata(a123_0x1648a7(0x1ec),Function),__metadata('design:paramtypes',[String,dto_1[a123_0x1648a7(0x1c5)]]),__metadata(a123_0x1648a7(0x1df),Promise)],SettingController[a123_0x1648a7(0x1c9)],a123_0x1648a7(0x1ba),null),__decorate([(0x0,common_1[a123_0x1648a7(0x1e6)])(a123_0x1648a7(0x1bd)),(0x0,common_1[a123_0x1648a7(0x1e8)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x1648a7(0x1d7)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x1648a7(0x1c2)][a123_0x1648a7(0x1ad)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a123_0x1648a7(0x1ec),Function),__metadata('design:paramtypes',[String,user_setting_dto_1[a123_0x1648a7(0x1dc)]]),__metadata(a123_0x1648a7(0x1df),Promise)],SettingController['prototype'],a123_0x1648a7(0x1bf),null),__decorate([(0x0,common_1[a123_0x1648a7(0x1aa)])(a123_0x1648a7(0x1c4)),(0x0,common_1[a123_0x1648a7(0x1e8)])(jwt_guard_1[a123_0x1648a7(0x1d1)],roles_guard_1[a123_0x1648a7(0x1d7)]),(0x0,roles_decorator_1[a123_0x1648a7(0x1a8)])(role_enum_1[a123_0x1648a7(0x1c2)]['Admin'],role_enum_1[a123_0x1648a7(0x1c2)][a123_0x1648a7(0x1ea)]),__metadata(a123_0x1648a7(0x1ec),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x1648a7(0x1df),Promise)],SettingController[a123_0x1648a7(0x1c9)],a123_0x1648a7(0x1b0),null),SettingController=__decorate([(0x0,common_1[a123_0x1648a7(0x1ae)])('setting'),__metadata('design:paramtypes',[setting_service_1[a123_0x1648a7(0x1da)]])],SettingController),exports[a123_0x1648a7(0x1dd)]=SettingController;