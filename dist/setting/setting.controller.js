'use strict';const a120_0x261aae=a120_0x55ab;(function(_0x5561a5,_0x1959d7){const _0x313f5c=a120_0x55ab,_0x18ec1b=_0x5561a5();while(!![]){try{const _0x2310fb=parseInt(_0x313f5c(0x1ed))/0x1+parseInt(_0x313f5c(0x209))/0x2+parseInt(_0x313f5c(0x1f7))/0x3+parseInt(_0x313f5c(0x1e5))/0x4*(parseInt(_0x313f5c(0x1db))/0x5)+-parseInt(_0x313f5c(0x1f0))/0x6+parseInt(_0x313f5c(0x21c))/0x7*(parseInt(_0x313f5c(0x201))/0x8)+-parseInt(_0x313f5c(0x207))/0x9;if(_0x2310fb===_0x1959d7)break;else _0x18ec1b['push'](_0x18ec1b['shift']());}catch(_0x39d2ed){_0x18ec1b['push'](_0x18ec1b['shift']());}}}(a120_0x484c,0xcd5e7));function a120_0x484c(){const _0xa4ec9a=['RolesGuard','findFirst','Param','16595919SPNujC',':id/license','937518nRSsIl','Invalid\x20license\x20key','initalize','Body','Master','./dto/user-setting.dto','maxUser','data','function','object','isExpired','UpdateSettingDto',':id/user-setting','Roles','prototype','schoolId','Patch','Viewer','stdout','7tuiaOA','exec','isValid','updateCode','__param','1366355yDxBqi','__metadata','create','SettingController','/update','design:type','licenseKey','../auth/guards/roles.guard','UserSettingDto','UseGuards','16mWAyEG','stderr','/kill-jobs','decorate','child_process','Controller','JwtAuthGuard','log','1244541wCNFWg','Post','error','3083196ShmZde','updateUserSetting','settingService','Admin','killJobs','expiryDate','validateLicenseKey','110673HcCRxE','User','defineProperty','design:paramtypes','length','Role','BadRequestException','../auth/decorators/roles.decorator','mapSettingDocumentToDto','update','2846184GbHVyX','design:returntype','userSetting'];a120_0x484c=function(){return _0xa4ec9a;};return a120_0x484c();}function a120_0x55ab(_0x39d2e1,_0x51493d){const _0x484c9c=a120_0x484c();return a120_0x55ab=function(_0x55ab12,_0x19a678){_0x55ab12=_0x55ab12-0x1d9;let _0x52ac69=_0x484c9c[_0x55ab12];return _0x52ac69;},a120_0x55ab(_0x39d2e1,_0x51493d);}var __decorate=this&&this['__decorate']||function(_0x23da07,_0x5d88fe,_0xa33ec8,_0x445e9f){const _0x550156=a120_0x55ab;var _0x582bd9=arguments[_0x550156(0x1fb)],_0x32666=_0x582bd9<0x3?_0x5d88fe:_0x445e9f===null?_0x445e9f=Object['getOwnPropertyDescriptor'](_0x5d88fe,_0xa33ec8):_0x445e9f,_0x26313d;if(typeof Reflect===_0x550156(0x212)&&typeof Reflect[_0x550156(0x1e8)]===_0x550156(0x211))_0x32666=Reflect['decorate'](_0x23da07,_0x5d88fe,_0xa33ec8,_0x445e9f);else{for(var _0x3cc8de=_0x23da07[_0x550156(0x1fb)]-0x1;_0x3cc8de>=0x0;_0x3cc8de--)if(_0x26313d=_0x23da07[_0x3cc8de])_0x32666=(_0x582bd9<0x3?_0x26313d(_0x32666):_0x582bd9>0x3?_0x26313d(_0x5d88fe,_0xa33ec8,_0x32666):_0x26313d(_0x5d88fe,_0xa33ec8))||_0x32666;}return _0x582bd9>0x3&&_0x32666&&Object[_0x550156(0x1f9)](_0x5d88fe,_0xa33ec8,_0x32666),_0x32666;},__metadata=this&&this[a120_0x261aae(0x1dc)]||function(_0x182da5,_0x51403c){const _0x41470a=a120_0x261aae;if(typeof Reflect===_0x41470a(0x212)&&typeof Reflect['metadata']===_0x41470a(0x211))return Reflect['metadata'](_0x182da5,_0x51403c);},__param=this&&this[a120_0x261aae(0x1da)]||function(_0x2de395,_0x56f879){return function(_0xb0b3d5,_0xb00522){_0x56f879(_0xb0b3d5,_0xb00522,_0x2de395);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SettingController']=void 0x0;const common_1=require('@nestjs/common'),setting_service_1=require('./setting.service'),dto_1=require('./dto'),roles_decorator_1=require(a120_0x261aae(0x1fe)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a120_0x261aae(0x1e2)),setting_mapper_1=require('./mappers/setting.mapper'),child_process_1=require(a120_0x261aae(0x1e9)),user_setting_dto_1=require(a120_0x261aae(0x20e));let SettingController=class SettingController{constructor(_0x28f944){const _0x106fa4=a120_0x261aae;this['settingService']=_0x28f944,this[_0x106fa4(0x20b)]();}async['findFirst'](){const _0x398340=a120_0x261aae,_0x3b4a1e=await this[_0x398340(0x1f2)][_0x398340(0x205)](),_0x26c132=this[_0x398340(0x1f2)][_0x398340(0x1f6)](_0x3b4a1e['licenseKey'],_0x3b4a1e[_0x398340(0x218)]);return(0x0,setting_mapper_1[_0x398340(0x1ff)])(_0x3b4a1e,_0x26c132['expiryDate']);}async[a120_0x261aae(0x1d9)](){const _0x2ae567=a120_0x261aae,_0xd8664e=(0x0,child_process_1[_0x2ae567(0x21d)])('pm2\x20restart\x20startUI\x20startApi');return console[_0x2ae567(0x1ec)]('Success\x20request\x20update\x20app\x20to\x20latest\x20version'),_0xd8664e[_0x2ae567(0x21b)]['on'](_0x2ae567(0x1ef),_0x5df4ab=>{const _0x45ca27=_0x2ae567;console[_0x45ca27(0x1ec)](_0x5df4ab);}),_0xd8664e['stdin']['on'](_0x2ae567(0x1ef),_0x2153e7=>{const _0x160f9e=_0x2ae567;console[_0x160f9e(0x1ec)](_0x2153e7);}),_0xd8664e[_0x2ae567(0x1e6)]['on'](_0x2ae567(0x210),_0x23c962=>{const _0x7a7ea6=_0x2ae567;console[_0x7a7ea6(0x1ec)](_0x23c962);}),'Success\x20request\x20update\x20app\x20to\x20latest\x20version';}async[a120_0x261aae(0x200)](_0x44e2d0,_0x156111){const _0x57ef5b=a120_0x261aae,_0x4da80d=this[_0x57ef5b(0x1f2)][_0x57ef5b(0x1f6)](_0x156111[_0x57ef5b(0x1e1)],_0x156111[_0x57ef5b(0x218)]);if(!_0x4da80d[_0x57ef5b(0x21e)])throw new common_1[(_0x57ef5b(0x1fd))](_0x57ef5b(0x20a));_0x156111[_0x57ef5b(0x213)]=![];const _0x47db79=await this[_0x57ef5b(0x1f2)][_0x57ef5b(0x200)](_0x44e2d0,_0x156111);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0x47db79,_0x4da80d[_0x57ef5b(0x1f5)]);}async[a120_0x261aae(0x1f1)](_0x2aa4b2,_0x3fd110){const _0x2f8d05=a120_0x261aae;_0x3fd110[_0x2f8d05(0x20f)]=+_0x3fd110[_0x2f8d05(0x20f)];if(isNaN(_0x3fd110[_0x2f8d05(0x20f)]))throw new common_1[(_0x2f8d05(0x1fd))]('Max\x20user\x20must\x20be\x20a\x20number');const _0x204cc5=await this[_0x2f8d05(0x1f2)][_0x2f8d05(0x1f1)](_0x3fd110);return _0x204cc5[_0x2f8d05(0x203)];}async['killJobs'](){const _0x23e307=a120_0x261aae;await this[_0x23e307(0x1f2)][_0x23e307(0x1f4)]();}async['initalize'](){const _0x3e991d=a120_0x261aae,_0x6a4ad5=await this[_0x3e991d(0x1f2)][_0x3e991d(0x205)]();!_0x6a4ad5&&await this[_0x3e991d(0x1f2)][_0x3e991d(0x1dd)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1['Get'])('/'),(0x0,common_1[a120_0x261aae(0x1e4)])(jwt_guard_1[a120_0x261aae(0x1eb)],roles_guard_1[a120_0x261aae(0x204)]),(0x0,roles_decorator_1[a120_0x261aae(0x216)])(role_enum_1['Role'][a120_0x261aae(0x1f3)],role_enum_1[a120_0x261aae(0x1fc)]['User'],role_enum_1['Role'][a120_0x261aae(0x21a)]),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],SettingController[a120_0x261aae(0x217)],a120_0x261aae(0x205),null),__decorate([(0x0,common_1['Post'])(a120_0x261aae(0x1df)),(0x0,common_1[a120_0x261aae(0x1e4)])(jwt_guard_1[a120_0x261aae(0x1eb)],roles_guard_1[a120_0x261aae(0x204)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x261aae(0x1fc)]['Admin'],role_enum_1[a120_0x261aae(0x1fc)][a120_0x261aae(0x1f8)]),__metadata(a120_0x261aae(0x1e0),Function),__metadata(a120_0x261aae(0x1fa),[]),__metadata(a120_0x261aae(0x202),Promise)],SettingController[a120_0x261aae(0x217)],a120_0x261aae(0x1d9),null),__decorate([(0x0,common_1[a120_0x261aae(0x219)])(a120_0x261aae(0x208)),(0x0,common_1[a120_0x261aae(0x1e4)])(jwt_guard_1[a120_0x261aae(0x1eb)],roles_guard_1[a120_0x261aae(0x204)]),(0x0,roles_decorator_1[a120_0x261aae(0x216)])(role_enum_1[a120_0x261aae(0x1fc)][a120_0x261aae(0x1f3)],role_enum_1['Role'][a120_0x261aae(0x1f8)]),__param(0x0,(0x0,common_1[a120_0x261aae(0x206)])('id')),__param(0x1,(0x0,common_1[a120_0x261aae(0x20c)])()),__metadata(a120_0x261aae(0x1e0),Function),__metadata('design:paramtypes',[String,dto_1[a120_0x261aae(0x214)]]),__metadata(a120_0x261aae(0x202),Promise)],SettingController['prototype'],'update',null),__decorate([(0x0,common_1[a120_0x261aae(0x219)])(a120_0x261aae(0x215)),(0x0,common_1[a120_0x261aae(0x1e4)])(jwt_guard_1[a120_0x261aae(0x1eb)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x261aae(0x216)])(role_enum_1[a120_0x261aae(0x1fc)][a120_0x261aae(0x20d)]),__param(0x0,(0x0,common_1[a120_0x261aae(0x206)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a120_0x261aae(0x1e0),Function),__metadata(a120_0x261aae(0x1fa),[String,user_setting_dto_1[a120_0x261aae(0x1e3)]]),__metadata(a120_0x261aae(0x202),Promise)],SettingController[a120_0x261aae(0x217)],a120_0x261aae(0x1f1),null),__decorate([(0x0,common_1[a120_0x261aae(0x1ee)])(a120_0x261aae(0x1e7)),(0x0,common_1[a120_0x261aae(0x1e4)])(jwt_guard_1[a120_0x261aae(0x1eb)],roles_guard_1[a120_0x261aae(0x204)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x261aae(0x1fc)][a120_0x261aae(0x1f3)],role_enum_1[a120_0x261aae(0x1fc)]['User']),__metadata(a120_0x261aae(0x1e0),Function),__metadata(a120_0x261aae(0x1fa),[]),__metadata('design:returntype',Promise)],SettingController['prototype'],a120_0x261aae(0x1f4),null),SettingController=__decorate([(0x0,common_1[a120_0x261aae(0x1ea)])('setting'),__metadata(a120_0x261aae(0x1fa),[setting_service_1['SettingService']])],SettingController),exports[a120_0x261aae(0x1de)]=SettingController;