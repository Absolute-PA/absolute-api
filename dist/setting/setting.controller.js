'use strict';const a120_0xdc68b=a120_0x1160;(function(_0xa9e7f2,_0x195927){const _0x2a8399=a120_0x1160,_0x56b972=_0xa9e7f2();while(!![]){try{const _0x1fe436=parseInt(_0x2a8399(0x231))/0x1*(-parseInt(_0x2a8399(0x1fc))/0x2)+-parseInt(_0x2a8399(0x23b))/0x3+-parseInt(_0x2a8399(0x237))/0x4*(-parseInt(_0x2a8399(0x23c))/0x5)+parseInt(_0x2a8399(0x223))/0x6+parseInt(_0x2a8399(0x22d))/0x7+-parseInt(_0x2a8399(0x213))/0x8+-parseInt(_0x2a8399(0x232))/0x9*(-parseInt(_0x2a8399(0x234))/0xa);if(_0x1fe436===_0x195927)break;else _0x56b972['push'](_0x56b972['shift']());}catch(_0x168b1f){_0x56b972['push'](_0x56b972['shift']());}}}(a120_0x5ca2,0xe85ed));function a120_0x5ca2(){const _0x5183f0=['exec','function','error','../auth/enums/role.enum','object','killJobs','9825004mMGHda','@nestjs/common','isValid',':id/user-setting','13781RdLtaO','36wXicTt','Invalid\x20license\x20key','3746980HFeYyf','Patch','Body','13636MnhyeY','userSetting','length','Role','4413693VNunQc','1815xnlDzE','findFirst','./dto/user-setting.dto','design:returntype','RolesGuard','defineProperty','create','Success\x20request\x20update\x20app\x20to\x20latest\x20version','maxUser','data','child_process','stdin','244Tqdkhp','isExpired','licenseKey','../auth/decorators/roles.decorator','UserSettingDto','UseGuards','decorate','mapSettingDocumentToDto','Roles','validateLicenseKey','Controller','stdout','User','/kill-jobs','SettingService','Get','stderr',':id/license','JwtAuthGuard','updateUserSetting','Max\x20user\x20must\x20be\x20a\x20number','log','Viewer','15024808DsJzwT','design:paramtypes','setting','BadRequestException','Param','update','Admin','schoolId','../auth/guards/jwt.guard','initalize','getOwnPropertyDescriptor','design:type','prototype','Post','UpdateSettingDto','expiryDate','11055432kewurb','settingService','updateCode','../auth/guards/roles.guard'];a120_0x5ca2=function(){return _0x5183f0;};return a120_0x5ca2();}var __decorate=this&&this['__decorate']||function(_0x4b66a5,_0x204dc7,_0x273cf5,_0x3ea9d9){const _0x171388=a120_0x1160;var _0x172d10=arguments[_0x171388(0x239)],_0x232a14=_0x172d10<0x3?_0x204dc7:_0x3ea9d9===null?_0x3ea9d9=Object[_0x171388(0x21d)](_0x204dc7,_0x273cf5):_0x3ea9d9,_0x40faee;if(typeof Reflect===_0x171388(0x22b)&&typeof Reflect[_0x171388(0x202)]===_0x171388(0x228))_0x232a14=Reflect[_0x171388(0x202)](_0x4b66a5,_0x204dc7,_0x273cf5,_0x3ea9d9);else{for(var _0x5968b4=_0x4b66a5[_0x171388(0x239)]-0x1;_0x5968b4>=0x0;_0x5968b4--)if(_0x40faee=_0x4b66a5[_0x5968b4])_0x232a14=(_0x172d10<0x3?_0x40faee(_0x232a14):_0x172d10>0x3?_0x40faee(_0x204dc7,_0x273cf5,_0x232a14):_0x40faee(_0x204dc7,_0x273cf5))||_0x232a14;}return _0x172d10>0x3&&_0x232a14&&Object[_0x171388(0x1f5)](_0x204dc7,_0x273cf5,_0x232a14),_0x232a14;},__metadata=this&&this['__metadata']||function(_0x989edb,_0x3b43e7){const _0x28c151=a120_0x1160;if(typeof Reflect===_0x28c151(0x22b)&&typeof Reflect['metadata']===_0x28c151(0x228))return Reflect['metadata'](_0x989edb,_0x3b43e7);},__param=this&&this['__param']||function(_0x20a33d,_0x108ca0){return function(_0x3343ab,_0x29aa4f){_0x108ca0(_0x3343ab,_0x29aa4f,_0x20a33d);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SettingController']=void 0x0;const common_1=require(a120_0xdc68b(0x22e)),setting_service_1=require('./setting.service'),dto_1=require('./dto'),roles_decorator_1=require(a120_0xdc68b(0x1ff)),role_enum_1=require(a120_0xdc68b(0x22a)),jwt_guard_1=require(a120_0xdc68b(0x21b)),roles_guard_1=require(a120_0xdc68b(0x226)),setting_mapper_1=require('./mappers/setting.mapper'),child_process_1=require(a120_0xdc68b(0x1fa)),user_setting_dto_1=require(a120_0xdc68b(0x1f2));function a120_0x1160(_0x44020a,_0xb6addc){const _0x5ca20a=a120_0x5ca2();return a120_0x1160=function(_0x116083,_0xe8b6f1){_0x116083=_0x116083-0x1f1;let _0x17aec5=_0x5ca20a[_0x116083];return _0x17aec5;},a120_0x1160(_0x44020a,_0xb6addc);}let SettingController=class SettingController{constructor(_0x38d021){const _0x463913=a120_0xdc68b;this[_0x463913(0x224)]=_0x38d021,this[_0x463913(0x21c)]();}async[a120_0xdc68b(0x1f1)](){const _0x23356f=a120_0xdc68b,_0x1f377f=await this[_0x23356f(0x224)][_0x23356f(0x1f1)](),_0x5e646b=this[_0x23356f(0x224)]['validateLicenseKey'](_0x1f377f[_0x23356f(0x1fe)],_0x1f377f['schoolId']);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0x1f377f,_0x5e646b[_0x23356f(0x222)]);}async[a120_0xdc68b(0x225)](){const _0x5362d6=a120_0xdc68b,_0x2db4b3=(0x0,child_process_1[_0x5362d6(0x227)])('pm2\x20restart\x20startUI\x20startApi');return console[_0x5362d6(0x211)](_0x5362d6(0x1f7)),_0x2db4b3[_0x5362d6(0x207)]['on'](_0x5362d6(0x229),_0x2a5d02=>{const _0x1057c2=_0x5362d6;console[_0x1057c2(0x211)](_0x2a5d02);}),_0x2db4b3[_0x5362d6(0x1fb)]['on'](_0x5362d6(0x229),_0x47ad37=>{const _0x50aa5f=_0x5362d6;console[_0x50aa5f(0x211)](_0x47ad37);}),_0x2db4b3[_0x5362d6(0x20c)]['on'](_0x5362d6(0x1f9),_0x5de9fe=>{const _0x3846c7=_0x5362d6;console[_0x3846c7(0x211)](_0x5de9fe);}),'Success\x20request\x20update\x20app\x20to\x20latest\x20version';}async['update'](_0x3226ef,_0x50da32){const _0x2e6bee=a120_0xdc68b,_0x26af0b=this['settingService'][_0x2e6bee(0x205)](_0x50da32['licenseKey'],_0x50da32[_0x2e6bee(0x21a)]);if(!_0x26af0b[_0x2e6bee(0x22f)])throw new common_1['BadRequestException'](_0x2e6bee(0x233));_0x50da32[_0x2e6bee(0x1fd)]=![];const _0x345666=await this[_0x2e6bee(0x224)][_0x2e6bee(0x218)](_0x3226ef,_0x50da32);return(0x0,setting_mapper_1[_0x2e6bee(0x203)])(_0x345666,_0x26af0b['expiryDate']);}async[a120_0xdc68b(0x20f)](_0x2915ae,_0x1ed8da){const _0x48658f=a120_0xdc68b;_0x1ed8da[_0x48658f(0x1f8)]=+_0x1ed8da[_0x48658f(0x1f8)];if(isNaN(_0x1ed8da[_0x48658f(0x1f8)]))throw new common_1[(_0x48658f(0x216))](_0x48658f(0x210));const _0x45e912=await this[_0x48658f(0x224)]['updateUserSetting'](_0x1ed8da);return _0x45e912[_0x48658f(0x238)];}async['killJobs'](){const _0x2d8816=a120_0xdc68b;await this[_0x2d8816(0x224)][_0x2d8816(0x22c)]();}async['initalize'](){const _0x5e2398=a120_0xdc68b,_0x2f2d93=await this[_0x5e2398(0x224)][_0x5e2398(0x1f1)]();!_0x2f2d93&&await this['settingService'][_0x5e2398(0x1f6)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a120_0xdc68b(0x20b)])('/'),(0x0,common_1[a120_0xdc68b(0x201)])(jwt_guard_1[a120_0xdc68b(0x20e)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0xdc68b(0x204)])(role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x219)],role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x208)],role_enum_1['Role'][a120_0xdc68b(0x212)]),__metadata('design:type',Function),__metadata(a120_0xdc68b(0x214),[]),__metadata(a120_0xdc68b(0x1f3),Promise)],SettingController['prototype'],a120_0xdc68b(0x1f1),null),__decorate([(0x0,common_1['Post'])('/update'),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0xdc68b(0x20e)],roles_guard_1[a120_0xdc68b(0x1f4)]),(0x0,roles_decorator_1[a120_0xdc68b(0x204)])(role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x219)],role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x208)]),__metadata(a120_0xdc68b(0x21e),Function),__metadata(a120_0xdc68b(0x214),[]),__metadata('design:returntype',Promise)],SettingController[a120_0xdc68b(0x21f)],a120_0xdc68b(0x225),null),__decorate([(0x0,common_1[a120_0xdc68b(0x235)])(a120_0xdc68b(0x20d)),(0x0,common_1[a120_0xdc68b(0x201)])(jwt_guard_1[a120_0xdc68b(0x20e)],roles_guard_1[a120_0xdc68b(0x1f4)]),(0x0,roles_decorator_1[a120_0xdc68b(0x204)])(role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x219)],role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x208)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a120_0xdc68b(0x236)])()),__metadata(a120_0xdc68b(0x21e),Function),__metadata(a120_0xdc68b(0x214),[String,dto_1[a120_0xdc68b(0x221)]]),__metadata('design:returntype',Promise)],SettingController[a120_0xdc68b(0x21f)],a120_0xdc68b(0x218),null),__decorate([(0x0,common_1[a120_0xdc68b(0x235)])(a120_0xdc68b(0x230)),(0x0,common_1[a120_0xdc68b(0x201)])(jwt_guard_1[a120_0xdc68b(0x20e)],roles_guard_1[a120_0xdc68b(0x1f4)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0xdc68b(0x23a)]['Master']),__param(0x0,(0x0,common_1[a120_0xdc68b(0x217)])('id')),__param(0x1,(0x0,common_1[a120_0xdc68b(0x236)])()),__metadata(a120_0xdc68b(0x21e),Function),__metadata(a120_0xdc68b(0x214),[String,user_setting_dto_1[a120_0xdc68b(0x200)]]),__metadata(a120_0xdc68b(0x1f3),Promise)],SettingController[a120_0xdc68b(0x21f)],a120_0xdc68b(0x20f),null),__decorate([(0x0,common_1[a120_0xdc68b(0x220)])(a120_0xdc68b(0x209)),(0x0,common_1[a120_0xdc68b(0x201)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a120_0xdc68b(0x1f4)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0xdc68b(0x23a)][a120_0xdc68b(0x219)],role_enum_1['Role']['User']),__metadata('design:type',Function),__metadata(a120_0xdc68b(0x214),[]),__metadata(a120_0xdc68b(0x1f3),Promise)],SettingController[a120_0xdc68b(0x21f)],'killJobs',null),SettingController=__decorate([(0x0,common_1[a120_0xdc68b(0x206)])(a120_0xdc68b(0x215)),__metadata('design:paramtypes',[setting_service_1[a120_0xdc68b(0x20a)]])],SettingController),exports['SettingController']=SettingController;