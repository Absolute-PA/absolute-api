'use strict';function a123_0x4ee1(){const _0x1903a1=['decorate','prototype','findFirst','settingService','2414496UwYDXQ','744ZpZnhd','../auth/guards/roles.guard','expiryDate','setting','mapSettingDocumentToDto','log','design:paramtypes','update','@nestjs/common','Role','userSetting','JwtAuthGuard','1118760KVSEJf','UpdateSettingDto','463995MLONrU',':id/license','Admin','Controller','./setting.service','Get','8EZdbdY','create','Body','__decorate','Invalid\x20license\x20key','Roles','updateUserSetting','SettingController','getOwnPropertyDescriptor','Post','stderr','UserSettingDto','stdin','maxUser','RolesGuard','validateLicenseKey','7015730YPcNgU','defineProperty','Master','isValid','data','child_process','/update','isExpired','569592DURxRR','1408875LrHTuk','Patch','../auth/guards/jwt.guard','object','__esModule','design:returntype','5578167WpmkHe','__metadata','User','initalize','__param','killJobs','licenseKey','exec','stdout','function','design:type','UseGuards','pm2\x20restart\x20startUI\x20startApi'];a123_0x4ee1=function(){return _0x1903a1;};return a123_0x4ee1();}const a123_0x52f9ff=a123_0x426f;(function(_0x1a7bce,_0x1b1927){const _0x13a9a2=a123_0x426f,_0x3eafbe=_0x1a7bce();while(!![]){try{const _0x4a2014=-parseInt(_0x13a9a2(0xa3))/0x1+-parseInt(_0x13a9a2(0x8a))/0x2*(parseInt(_0x13a9a2(0x82))/0x3)+-parseInt(_0x13a9a2(0xba))/0x4+-parseInt(_0x13a9a2(0x9a))/0x5+parseInt(_0x13a9a2(0xa2))/0x6+parseInt(_0x13a9a2(0xa9))/0x7+parseInt(_0x13a9a2(0xbb))/0x8*(parseInt(_0x13a9a2(0x84))/0x9);if(_0x4a2014===_0x1b1927)break;else _0x3eafbe['push'](_0x3eafbe['shift']());}catch(_0x6a969f){_0x3eafbe['push'](_0x3eafbe['shift']());}}}(a123_0x4ee1,0xbe35f));var __decorate=this&&this[a123_0x52f9ff(0x8d)]||function(_0xec4af9,_0x8fe50a,_0x51ac1a,_0x28ad18){const _0x523621=a123_0x52f9ff;var _0x70cd55=arguments['length'],_0x1a88b0=_0x70cd55<0x3?_0x8fe50a:_0x28ad18===null?_0x28ad18=Object[_0x523621(0x92)](_0x8fe50a,_0x51ac1a):_0x28ad18,_0x56fb7a;if(typeof Reflect===_0x523621(0xa6)&&typeof Reflect[_0x523621(0xb6)]===_0x523621(0xb2))_0x1a88b0=Reflect[_0x523621(0xb6)](_0xec4af9,_0x8fe50a,_0x51ac1a,_0x28ad18);else{for(var _0x332485=_0xec4af9['length']-0x1;_0x332485>=0x0;_0x332485--)if(_0x56fb7a=_0xec4af9[_0x332485])_0x1a88b0=(_0x70cd55<0x3?_0x56fb7a(_0x1a88b0):_0x70cd55>0x3?_0x56fb7a(_0x8fe50a,_0x51ac1a,_0x1a88b0):_0x56fb7a(_0x8fe50a,_0x51ac1a))||_0x1a88b0;}return _0x70cd55>0x3&&_0x1a88b0&&Object[_0x523621(0x9b)](_0x8fe50a,_0x51ac1a,_0x1a88b0),_0x1a88b0;},__metadata=this&&this[a123_0x52f9ff(0xaa)]||function(_0x57cdf8,_0x10bcac){const _0x5d8b9d=a123_0x52f9ff;if(typeof Reflect===_0x5d8b9d(0xa6)&&typeof Reflect['metadata']==='function')return Reflect['metadata'](_0x57cdf8,_0x10bcac);},__param=this&&this[a123_0x52f9ff(0xad)]||function(_0x3884ca,_0x3c6802){return function(_0x1abebe,_0x386a89){_0x3c6802(_0x1abebe,_0x386a89,_0x3884ca);};};Object[a123_0x52f9ff(0x9b)](exports,a123_0x52f9ff(0xa7),{'value':!![]}),exports[a123_0x52f9ff(0x91)]=void 0x0;const common_1=require(a123_0x52f9ff(0xc3)),setting_service_1=require(a123_0x52f9ff(0x88)),dto_1=require('./dto'),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a123_0x52f9ff(0xa5)),roles_guard_1=require(a123_0x52f9ff(0xbc)),setting_mapper_1=require('./mappers/setting.mapper'),child_process_1=require(a123_0x52f9ff(0x9f)),user_setting_dto_1=require('./dto/user-setting.dto');function a123_0x426f(_0x857665,_0x4f0bba){const _0x4ee132=a123_0x4ee1();return a123_0x426f=function(_0x426f34,_0x3ab36d){_0x426f34=_0x426f34-0x82;let _0x47702d=_0x4ee132[_0x426f34];return _0x47702d;},a123_0x426f(_0x857665,_0x4f0bba);}let SettingController=class SettingController{constructor(_0x5a8217){const _0x22fc54=a123_0x52f9ff;this['settingService']=_0x5a8217,this[_0x22fc54(0xac)]();}async[a123_0x52f9ff(0xb8)](){const _0x310337=a123_0x52f9ff,_0x2fc6b4=await this[_0x310337(0xb9)][_0x310337(0xb8)](),_0x47f966=this[_0x310337(0xb9)][_0x310337(0x99)](_0x2fc6b4['licenseKey'],_0x2fc6b4['schoolId']);return(0x0,setting_mapper_1[_0x310337(0xbf)])(_0x2fc6b4,_0x47f966[_0x310337(0xbd)]);}async['updateCode'](){const _0x679a81=a123_0x52f9ff,_0x4c4101=(0x0,child_process_1[_0x679a81(0xb0)])(_0x679a81(0xb5));return console[_0x679a81(0xc0)]('Success\x20request\x20update\x20app\x20to\x20latest\x20version'),_0x4c4101[_0x679a81(0xb1)]['on']('error',_0x47529b=>{const _0x11c5be=_0x679a81;console[_0x11c5be(0xc0)](_0x47529b);}),_0x4c4101[_0x679a81(0x96)]['on']('error',_0x2b45e3=>{const _0x44f025=_0x679a81;console[_0x44f025(0xc0)](_0x2b45e3);}),_0x4c4101[_0x679a81(0x94)]['on'](_0x679a81(0x9e),_0x5eba1f=>{const _0x4b160f=_0x679a81;console[_0x4b160f(0xc0)](_0x5eba1f);}),'Success\x20request\x20update\x20app\x20to\x20latest\x20version';}async[a123_0x52f9ff(0xc2)](_0x7d0da3,_0x3cbbcf){const _0x108ee6=a123_0x52f9ff,_0x453b20=this[_0x108ee6(0xb9)]['validateLicenseKey'](_0x3cbbcf[_0x108ee6(0xaf)],_0x3cbbcf['schoolId']);if(!_0x453b20[_0x108ee6(0x9d)])throw new common_1['BadRequestException'](_0x108ee6(0x8e));_0x3cbbcf[_0x108ee6(0xa1)]=![];const _0x4cb284=await this[_0x108ee6(0xb9)][_0x108ee6(0xc2)](_0x7d0da3,_0x3cbbcf);return(0x0,setting_mapper_1[_0x108ee6(0xbf)])(_0x4cb284,_0x453b20[_0x108ee6(0xbd)]);}async['updateUserSetting'](_0x400f38,_0x3ab90c){const _0x18ec9f=a123_0x52f9ff;_0x3ab90c[_0x18ec9f(0x97)]=+_0x3ab90c['maxUser'];if(isNaN(_0x3ab90c[_0x18ec9f(0x97)]))throw new common_1['BadRequestException']('Max\x20user\x20must\x20be\x20a\x20number');const _0x57c9d9=await this[_0x18ec9f(0xb9)][_0x18ec9f(0x90)](_0x3ab90c);return _0x57c9d9[_0x18ec9f(0xc5)];}async[a123_0x52f9ff(0xae)](){const _0x2963d=a123_0x52f9ff;await this[_0x2963d(0xb9)][_0x2963d(0xae)]();}async['initalize'](){const _0x5c53a3=a123_0x52f9ff,_0x2b1e78=await this['settingService'][_0x5c53a3(0xb8)]();!_0x2b1e78&&await this[_0x5c53a3(0xb9)][_0x5c53a3(0x8b)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x52f9ff(0x89)])('/'),(0x0,common_1[a123_0x52f9ff(0xb4)])(jwt_guard_1[a123_0x52f9ff(0xc6)],roles_guard_1[a123_0x52f9ff(0x98)]),(0x0,roles_decorator_1[a123_0x52f9ff(0x8f)])(role_enum_1['Role'][a123_0x52f9ff(0x86)],role_enum_1[a123_0x52f9ff(0xc4)]['User'],role_enum_1[a123_0x52f9ff(0xc4)]['Viewer']),__metadata(a123_0x52f9ff(0xb3),Function),__metadata(a123_0x52f9ff(0xc1),[]),__metadata(a123_0x52f9ff(0xa8),Promise)],SettingController[a123_0x52f9ff(0xb7)],a123_0x52f9ff(0xb8),null),__decorate([(0x0,common_1[a123_0x52f9ff(0x93)])(a123_0x52f9ff(0xa0)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x52f9ff(0xc6)],roles_guard_1[a123_0x52f9ff(0x98)]),(0x0,roles_decorator_1[a123_0x52f9ff(0x8f)])(role_enum_1[a123_0x52f9ff(0xc4)][a123_0x52f9ff(0x86)],role_enum_1[a123_0x52f9ff(0xc4)]['User']),__metadata(a123_0x52f9ff(0xb3),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],SettingController[a123_0x52f9ff(0xb7)],'updateCode',null),__decorate([(0x0,common_1['Patch'])(a123_0x52f9ff(0x85)),(0x0,common_1[a123_0x52f9ff(0xb4)])(jwt_guard_1[a123_0x52f9ff(0xc6)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x52f9ff(0x8f)])(role_enum_1['Role']['Admin'],role_enum_1[a123_0x52f9ff(0xc4)]['User']),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a123_0x52f9ff(0x8c)])()),__metadata('design:type',Function),__metadata(a123_0x52f9ff(0xc1),[String,dto_1[a123_0x52f9ff(0x83)]]),__metadata(a123_0x52f9ff(0xa8),Promise)],SettingController['prototype'],a123_0x52f9ff(0xc2),null),__decorate([(0x0,common_1[a123_0x52f9ff(0xa4)])(':id/user-setting'),(0x0,common_1[a123_0x52f9ff(0xb4)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x52f9ff(0x98)]),(0x0,roles_decorator_1[a123_0x52f9ff(0x8f)])(role_enum_1[a123_0x52f9ff(0xc4)][a123_0x52f9ff(0x9c)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a123_0x52f9ff(0x8c)])()),__metadata('design:type',Function),__metadata(a123_0x52f9ff(0xc1),[String,user_setting_dto_1[a123_0x52f9ff(0x95)]]),__metadata(a123_0x52f9ff(0xa8),Promise)],SettingController[a123_0x52f9ff(0xb7)],'updateUserSetting',null),__decorate([(0x0,common_1['Post'])('/kill-jobs'),(0x0,common_1[a123_0x52f9ff(0xb4)])(jwt_guard_1[a123_0x52f9ff(0xc6)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x52f9ff(0xc4)][a123_0x52f9ff(0x86)],role_enum_1[a123_0x52f9ff(0xc4)][a123_0x52f9ff(0xab)]),__metadata(a123_0x52f9ff(0xb3),Function),__metadata(a123_0x52f9ff(0xc1),[]),__metadata('design:returntype',Promise)],SettingController['prototype'],a123_0x52f9ff(0xae),null),SettingController=__decorate([(0x0,common_1[a123_0x52f9ff(0x87)])(a123_0x52f9ff(0xbe)),__metadata(a123_0x52f9ff(0xc1),[setting_service_1['SettingService']])],SettingController),exports['SettingController']=SettingController;