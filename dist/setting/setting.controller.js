'use strict';const a123_0x29adcb=a123_0x168a;function a123_0x168a(_0x2f2cb2,_0x7c9614){const _0x5760ce=a123_0x5760();return a123_0x168a=function(_0x168a0e,_0x3e93a4){_0x168a0e=_0x168a0e-0x172;let _0x284c86=_0x5760ce[_0x168a0e];return _0x284c86;},a123_0x168a(_0x2f2cb2,_0x7c9614);}(function(_0x318141,_0x21fd72){const _0x1ad399=a123_0x168a,_0xa90013=_0x318141();while(!![]){try{const _0x208c54=parseInt(_0x1ad399(0x180))/0x1+parseInt(_0x1ad399(0x1bb))/0x2*(parseInt(_0x1ad399(0x1b9))/0x3)+parseInt(_0x1ad399(0x175))/0x4+parseInt(_0x1ad399(0x193))/0x5+-parseInt(_0x1ad399(0x1b1))/0x6*(-parseInt(_0x1ad399(0x1ae))/0x7)+parseInt(_0x1ad399(0x18b))/0x8*(parseInt(_0x1ad399(0x1b4))/0x9)+parseInt(_0x1ad399(0x19a))/0xa*(-parseInt(_0x1ad399(0x197))/0xb);if(_0x208c54===_0x21fd72)break;else _0xa90013['push'](_0xa90013['shift']());}catch(_0x811f8e){_0xa90013['push'](_0xa90013['shift']());}}}(a123_0x5760,0x987b0));var __decorate=this&&this[a123_0x29adcb(0x1be)]||function(_0x261f49,_0xd94a70,_0x2b4d08,_0x6d5d93){const _0x3efe30=a123_0x29adcb;var _0x155120=arguments[_0x3efe30(0x1b7)],_0x5d7edf=_0x155120<0x3?_0xd94a70:_0x6d5d93===null?_0x6d5d93=Object[_0x3efe30(0x1b5)](_0xd94a70,_0x2b4d08):_0x6d5d93,_0x2a7087;if(typeof Reflect===_0x3efe30(0x1b8)&&typeof Reflect[_0x3efe30(0x199)]===_0x3efe30(0x182))_0x5d7edf=Reflect[_0x3efe30(0x199)](_0x261f49,_0xd94a70,_0x2b4d08,_0x6d5d93);else{for(var _0x31742=_0x261f49[_0x3efe30(0x1b7)]-0x1;_0x31742>=0x0;_0x31742--)if(_0x2a7087=_0x261f49[_0x31742])_0x5d7edf=(_0x155120<0x3?_0x2a7087(_0x5d7edf):_0x155120>0x3?_0x2a7087(_0xd94a70,_0x2b4d08,_0x5d7edf):_0x2a7087(_0xd94a70,_0x2b4d08))||_0x5d7edf;}return _0x155120>0x3&&_0x5d7edf&&Object['defineProperty'](_0xd94a70,_0x2b4d08,_0x5d7edf),_0x5d7edf;},__metadata=this&&this[a123_0x29adcb(0x198)]||function(_0x304635,_0x5e4685){const _0x1c7e61=a123_0x29adcb;if(typeof Reflect===_0x1c7e61(0x1b8)&&typeof Reflect[_0x1c7e61(0x19c)]==='function')return Reflect[_0x1c7e61(0x19c)](_0x304635,_0x5e4685);},__param=this&&this[a123_0x29adcb(0x1ad)]||function(_0x3e0b41,_0x3998d6){return function(_0x246812,_0x46c7e0){_0x3998d6(_0x246812,_0x46c7e0,_0x3e0b41);};};Object[a123_0x29adcb(0x195)](exports,a123_0x29adcb(0x190),{'value':!![]}),exports[a123_0x29adcb(0x18a)]=void 0x0;const common_1=require(a123_0x29adcb(0x1a0)),setting_service_1=require(a123_0x29adcb(0x19e)),dto_1=require(a123_0x29adcb(0x196)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a123_0x29adcb(0x1a7)),jwt_guard_1=require(a123_0x29adcb(0x178)),roles_guard_1=require(a123_0x29adcb(0x18e)),setting_mapper_1=require(a123_0x29adcb(0x1bf)),child_process_1=require('child_process'),user_setting_dto_1=require(a123_0x29adcb(0x181));let SettingController=class SettingController{constructor(_0x181042){const _0x3acedc=a123_0x29adcb;this[_0x3acedc(0x186)]=_0x181042,this['initalize']();}async['findFirst'](){const _0x20dda0=a123_0x29adcb,_0xaf5404=await this['settingService'][_0x20dda0(0x17a)](),_0x4ba296=this['settingService'][_0x20dda0(0x188)](_0xaf5404['licenseKey'],_0xaf5404[_0x20dda0(0x1b2)]);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0xaf5404,_0x4ba296[_0x20dda0(0x1b3)]);}async['updateCode'](){const _0x103094=a123_0x29adcb,_0x4e8158=(0x0,child_process_1[_0x103094(0x1ba)])(_0x103094(0x194));return console[_0x103094(0x1a8)](_0x103094(0x192)),_0x4e8158[_0x103094(0x1b0)]['on'](_0x103094(0x19d),_0x3508e6=>{const _0x1fff0a=_0x103094;console[_0x1fff0a(0x1a8)](_0x3508e6);}),_0x4e8158[_0x103094(0x1b6)]['on']('error',_0x581ac6=>{const _0x5815e4=_0x103094;console[_0x5815e4(0x1a8)](_0x581ac6);}),_0x4e8158[_0x103094(0x191)]['on']('data',_0x39b4a7=>{const _0x418e33=_0x103094;console[_0x418e33(0x1a8)](_0x39b4a7);}),_0x103094(0x192);}async[a123_0x29adcb(0x17e)](_0x890b71,_0x284293){const _0x9af67c=a123_0x29adcb,_0x1716d5=this[_0x9af67c(0x186)][_0x9af67c(0x188)](_0x284293[_0x9af67c(0x18c)],_0x284293['schoolId']);if(!_0x1716d5[_0x9af67c(0x18d)])throw new common_1[(_0x9af67c(0x1a4))](_0x9af67c(0x183));_0x284293['isExpired']=![];const _0x3cae26=await this[_0x9af67c(0x186)][_0x9af67c(0x17e)](_0x890b71,_0x284293);return(0x0,setting_mapper_1[_0x9af67c(0x1a6)])(_0x3cae26,_0x1716d5[_0x9af67c(0x1b3)]);}async[a123_0x29adcb(0x179)](_0x1252dc,_0x47685c){const _0x3ee93b=a123_0x29adcb;_0x47685c[_0x3ee93b(0x1bc)]=+_0x47685c[_0x3ee93b(0x1bc)];if(isNaN(_0x47685c[_0x3ee93b(0x1bc)]))throw new common_1[(_0x3ee93b(0x1a4))](_0x3ee93b(0x1c0));const _0xfbe41a=await this['settingService'][_0x3ee93b(0x179)](_0x47685c);return _0xfbe41a[_0x3ee93b(0x1ac)];}async['killJobs'](){const _0x3c9a72=a123_0x29adcb;await this['settingService'][_0x3c9a72(0x176)]();}async['initalize'](){const _0x10e4b5=a123_0x29adcb,_0x270618=await this[_0x10e4b5(0x186)]['findFirst']();!_0x270618&&await this[_0x10e4b5(0x186)]['create']({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x29adcb(0x1af)])('/'),(0x0,common_1[a123_0x29adcb(0x189)])(jwt_guard_1[a123_0x29adcb(0x177)],roles_guard_1[a123_0x29adcb(0x1a5)]),(0x0,roles_decorator_1[a123_0x29adcb(0x173)])(role_enum_1[a123_0x29adcb(0x185)][a123_0x29adcb(0x184)],role_enum_1['Role'][a123_0x29adcb(0x174)],role_enum_1[a123_0x29adcb(0x185)]['Viewer']),__metadata(a123_0x29adcb(0x19b),Function),__metadata(a123_0x29adcb(0x17b),[]),__metadata(a123_0x29adcb(0x1a3),Promise)],SettingController[a123_0x29adcb(0x19f)],'findFirst',null),__decorate([(0x0,common_1['Post'])(a123_0x29adcb(0x172)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x29adcb(0x177)],roles_guard_1[a123_0x29adcb(0x1a5)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x29adcb(0x185)][a123_0x29adcb(0x184)],role_enum_1[a123_0x29adcb(0x185)][a123_0x29adcb(0x174)]),__metadata(a123_0x29adcb(0x19b),Function),__metadata(a123_0x29adcb(0x17b),[]),__metadata('design:returntype',Promise)],SettingController[a123_0x29adcb(0x19f)],a123_0x29adcb(0x1a2),null),__decorate([(0x0,common_1['Patch'])(a123_0x29adcb(0x187)),(0x0,common_1[a123_0x29adcb(0x189)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x29adcb(0x1a5)]),(0x0,roles_decorator_1[a123_0x29adcb(0x173)])(role_enum_1[a123_0x29adcb(0x185)][a123_0x29adcb(0x184)],role_enum_1[a123_0x29adcb(0x185)]['User']),__param(0x0,(0x0,common_1[a123_0x29adcb(0x1bd)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a123_0x29adcb(0x19b),Function),__metadata(a123_0x29adcb(0x17b),[String,dto_1[a123_0x29adcb(0x1aa)]]),__metadata(a123_0x29adcb(0x1a3),Promise)],SettingController['prototype'],a123_0x29adcb(0x17e),null),__decorate([(0x0,common_1[a123_0x29adcb(0x17d)])(a123_0x29adcb(0x17f)),(0x0,common_1[a123_0x29adcb(0x189)])(jwt_guard_1[a123_0x29adcb(0x177)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x29adcb(0x173)])(role_enum_1[a123_0x29adcb(0x185)]['Master']),__param(0x0,(0x0,common_1[a123_0x29adcb(0x1bd)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a123_0x29adcb(0x19b),Function),__metadata(a123_0x29adcb(0x17b),[String,user_setting_dto_1[a123_0x29adcb(0x18f)]]),__metadata(a123_0x29adcb(0x1a3),Promise)],SettingController['prototype'],'updateUserSetting',null),__decorate([(0x0,common_1[a123_0x29adcb(0x1a9)])(a123_0x29adcb(0x1ab)),(0x0,common_1[a123_0x29adcb(0x189)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x29adcb(0x185)][a123_0x29adcb(0x184)],role_enum_1[a123_0x29adcb(0x185)][a123_0x29adcb(0x174)]),__metadata(a123_0x29adcb(0x19b),Function),__metadata(a123_0x29adcb(0x17b),[]),__metadata(a123_0x29adcb(0x1a3),Promise)],SettingController[a123_0x29adcb(0x19f)],a123_0x29adcb(0x176),null),SettingController=__decorate([(0x0,common_1['Controller'])(a123_0x29adcb(0x1a1)),__metadata('design:paramtypes',[setting_service_1[a123_0x29adcb(0x17c)]])],SettingController),exports['SettingController']=SettingController;function a123_0x5760(){const _0x33e5e1=['setting','updateCode','design:returntype','BadRequestException','RolesGuard','mapSettingDocumentToDto','../auth/enums/role.enum','log','Post','UpdateSettingDto','/kill-jobs','userSetting','__param','18319rTKeRW','Get','stdout','1452HkSOvF','schoolId','expiryDate','31401xjKSJi','getOwnPropertyDescriptor','stdin','length','object','57Iabzor','exec','74674HtUtLd','maxUser','Param','__decorate','./mappers/setting.mapper','Max\x20user\x20must\x20be\x20a\x20number','/update','Roles','User','1564696CFwRVl','killJobs','JwtAuthGuard','../auth/guards/jwt.guard','updateUserSetting','findFirst','design:paramtypes','SettingService','Patch','update',':id/user-setting','663700HSxdbF','./dto/user-setting.dto','function','Invalid\x20license\x20key','Admin','Role','settingService',':id/license','validateLicenseKey','UseGuards','SettingController','1432ZtGorX','licenseKey','isValid','../auth/guards/roles.guard','UserSettingDto','__esModule','stderr','Success\x20request\x20update\x20app\x20to\x20latest\x20version','2209520gYcjmE','pm2\x20restart\x20startUI\x20startApi','defineProperty','./dto','77ugtgpp','__metadata','decorate','4056380kUSnXz','design:type','metadata','error','./setting.service','prototype','@nestjs/common'];a123_0x5760=function(){return _0x33e5e1;};return a123_0x5760();}