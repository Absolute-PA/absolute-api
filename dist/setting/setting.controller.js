'use strict';const a120_0x422d36=a120_0x3a86;(function(_0x226e79,_0x5563fb){const _0x2decf5=a120_0x3a86,_0x9967a1=_0x226e79();while(!![]){try{const _0x2e93be=parseInt(_0x2decf5(0x12a))/0x1+parseInt(_0x2decf5(0x14e))/0x2+parseInt(_0x2decf5(0x13a))/0x3*(parseInt(_0x2decf5(0x148))/0x4)+-parseInt(_0x2decf5(0x15a))/0x5+-parseInt(_0x2decf5(0x11c))/0x6*(parseInt(_0x2decf5(0x128))/0x7)+parseInt(_0x2decf5(0x126))/0x8+parseInt(_0x2decf5(0x154))/0x9;if(_0x2e93be===_0x5563fb)break;else _0x9967a1['push'](_0x9967a1['shift']());}catch(_0x195520){_0x9967a1['push'](_0x9967a1['shift']());}}}(a120_0x5cbd,0x3224b));function a120_0x5cbd(){const _0x1629af=['userSetting','stderr','pm2\x20restart\x20startUI\x20startApi','data','Admin','118288qEAYLT','/update','length','object','stdout','design:paramtypes','3664170NLtedF','child_process','@nestjs/common','JwtAuthGuard','SettingController','Controller','887565zihbID','isExpired','decorate','Get','maxUser','findFirst','SettingService','Param','validateLicenseKey','Roles','BadRequestException','isValid','UseGuards','__metadata','__param','metadata','Viewer','mapSettingDocumentToDto','updateUserSetting','30qLrwgW','Body','initalize','./dto/user-setting.dto','Patch','RolesGuard','Post','./mappers/setting.mapper','design:returntype','UpdateSettingDto','377240iFyOYB','stdin','371399TiFxwn','killJobs','99293CpfMFk','schoolId','User','settingService','function','Success\x20request\x20update\x20app\x20to\x20latest\x20version','__decorate','setting','exec','Max\x20user\x20must\x20be\x20a\x20number','defineProperty','getOwnPropertyDescriptor','log','./setting.service','update','../auth/enums/role.enum','9UDQbRm','UserSettingDto','__esModule','Role','/kill-jobs','updateCode','../auth/guards/roles.guard','design:type','prototype','Master','../auth/decorators/roles.decorator','./dto','expiryDate','error','47284uvtEOT'];a120_0x5cbd=function(){return _0x1629af;};return a120_0x5cbd();}function a120_0x3a86(_0x24453f,_0x4fe932){const _0x5cbd16=a120_0x5cbd();return a120_0x3a86=function(_0x3a8645,_0x363743){_0x3a8645=_0x3a8645-0x11a;let _0x5ef0a1=_0x5cbd16[_0x3a8645];return _0x5ef0a1;},a120_0x3a86(_0x24453f,_0x4fe932);}var __decorate=this&&this[a120_0x422d36(0x130)]||function(_0x5d1b39,_0x57f8c9,_0x578ccc,_0x5b5a4b){const _0x222fcd=a120_0x422d36;var _0x583a46=arguments[_0x222fcd(0x150)],_0x5d2cd9=_0x583a46<0x3?_0x57f8c9:_0x5b5a4b===null?_0x5b5a4b=Object[_0x222fcd(0x135)](_0x57f8c9,_0x578ccc):_0x5b5a4b,_0x2d80fa;if(typeof Reflect===_0x222fcd(0x151)&&typeof Reflect[_0x222fcd(0x15c)]===_0x222fcd(0x12e))_0x5d2cd9=Reflect[_0x222fcd(0x15c)](_0x5d1b39,_0x57f8c9,_0x578ccc,_0x5b5a4b);else{for(var _0x1bdaf2=_0x5d1b39[_0x222fcd(0x150)]-0x1;_0x1bdaf2>=0x0;_0x1bdaf2--)if(_0x2d80fa=_0x5d1b39[_0x1bdaf2])_0x5d2cd9=(_0x583a46<0x3?_0x2d80fa(_0x5d2cd9):_0x583a46>0x3?_0x2d80fa(_0x57f8c9,_0x578ccc,_0x5d2cd9):_0x2d80fa(_0x57f8c9,_0x578ccc))||_0x5d2cd9;}return _0x583a46>0x3&&_0x5d2cd9&&Object[_0x222fcd(0x134)](_0x57f8c9,_0x578ccc,_0x5d2cd9),_0x5d2cd9;},__metadata=this&&this[a120_0x422d36(0x167)]||function(_0x3ef8ea,_0x1d9365){const _0x3b8961=a120_0x422d36;if(typeof Reflect===_0x3b8961(0x151)&&typeof Reflect[_0x3b8961(0x169)]===_0x3b8961(0x12e))return Reflect[_0x3b8961(0x169)](_0x3ef8ea,_0x1d9365);},__param=this&&this[a120_0x422d36(0x168)]||function(_0x1d90fb,_0x447862){return function(_0x283d84,_0x564921){_0x447862(_0x283d84,_0x564921,_0x1d90fb);};};Object[a120_0x422d36(0x134)](exports,a120_0x422d36(0x13c),{'value':!![]}),exports[a120_0x422d36(0x158)]=void 0x0;const common_1=require(a120_0x422d36(0x156)),setting_service_1=require(a120_0x422d36(0x137)),dto_1=require(a120_0x422d36(0x145)),roles_decorator_1=require(a120_0x422d36(0x144)),role_enum_1=require(a120_0x422d36(0x139)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a120_0x422d36(0x140)),setting_mapper_1=require(a120_0x422d36(0x123)),child_process_1=require(a120_0x422d36(0x155)),user_setting_dto_1=require(a120_0x422d36(0x11f));let SettingController=class SettingController{constructor(_0x5884bd){this['settingService']=_0x5884bd,this['initalize']();}async[a120_0x422d36(0x15f)](){const _0x6d14c=a120_0x422d36,_0x3d2a8b=await this[_0x6d14c(0x12d)]['findFirst'](),_0x289b16=this[_0x6d14c(0x12d)][_0x6d14c(0x162)](_0x3d2a8b['licenseKey'],_0x3d2a8b['schoolId']);return(0x0,setting_mapper_1[_0x6d14c(0x11a)])(_0x3d2a8b,_0x289b16[_0x6d14c(0x146)]);}async[a120_0x422d36(0x13f)](){const _0x462dcb=a120_0x422d36,_0x3066a4=(0x0,child_process_1[_0x462dcb(0x132)])(_0x462dcb(0x14b));return console[_0x462dcb(0x136)](_0x462dcb(0x12f)),_0x3066a4[_0x462dcb(0x152)]['on'](_0x462dcb(0x147),_0x371086=>{const _0x1cd01a=_0x462dcb;console[_0x1cd01a(0x136)](_0x371086);}),_0x3066a4[_0x462dcb(0x127)]['on']('error',_0x1213c7=>{const _0x41be9c=_0x462dcb;console[_0x41be9c(0x136)](_0x1213c7);}),_0x3066a4[_0x462dcb(0x14a)]['on'](_0x462dcb(0x14c),_0x47c081=>{const _0x1265d9=_0x462dcb;console[_0x1265d9(0x136)](_0x47c081);}),_0x462dcb(0x12f);}async['update'](_0x130519,_0x2a74e2){const _0x2b00ce=a120_0x422d36,_0x37a43c=this['settingService'][_0x2b00ce(0x162)](_0x2a74e2['licenseKey'],_0x2a74e2[_0x2b00ce(0x12b)]);if(!_0x37a43c[_0x2b00ce(0x165)])throw new common_1[(_0x2b00ce(0x164))]('Invalid\x20license\x20key');_0x2a74e2[_0x2b00ce(0x15b)]=![];const _0x121eeb=await this['settingService']['update'](_0x130519,_0x2a74e2);return(0x0,setting_mapper_1[_0x2b00ce(0x11a)])(_0x121eeb,_0x37a43c['expiryDate']);}async[a120_0x422d36(0x11b)](_0x565aa8,_0x496a4c){const _0x48abfb=a120_0x422d36;_0x496a4c['maxUser']=+_0x496a4c[_0x48abfb(0x15e)];if(isNaN(_0x496a4c[_0x48abfb(0x15e)]))throw new common_1[(_0x48abfb(0x164))](_0x48abfb(0x133));const _0x3a1e34=await this[_0x48abfb(0x12d)][_0x48abfb(0x11b)](_0x496a4c);return _0x3a1e34[_0x48abfb(0x149)];}async[a120_0x422d36(0x129)](){const _0x38bec9=a120_0x422d36;await this[_0x38bec9(0x12d)][_0x38bec9(0x129)]();}async[a120_0x422d36(0x11e)](){const _0x5e4467=a120_0x422d36,_0x4a1a7b=await this[_0x5e4467(0x12d)][_0x5e4467(0x15f)]();!_0x4a1a7b&&await this[_0x5e4467(0x12d)]['create']({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a120_0x422d36(0x15d)])('/'),(0x0,common_1[a120_0x422d36(0x166)])(jwt_guard_1[a120_0x422d36(0x157)],roles_guard_1[a120_0x422d36(0x121)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x14d)],role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x12c)],role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x16a)]),__metadata(a120_0x422d36(0x141),Function),__metadata(a120_0x422d36(0x153),[]),__metadata(a120_0x422d36(0x124),Promise)],SettingController['prototype'],a120_0x422d36(0x15f),null),__decorate([(0x0,common_1['Post'])(a120_0x422d36(0x14f)),(0x0,common_1[a120_0x422d36(0x166)])(jwt_guard_1[a120_0x422d36(0x157)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x14d)],role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x12c)]),__metadata(a120_0x422d36(0x141),Function),__metadata(a120_0x422d36(0x153),[]),__metadata(a120_0x422d36(0x124),Promise)],SettingController['prototype'],a120_0x422d36(0x13f),null),__decorate([(0x0,common_1[a120_0x422d36(0x120)])(':id/license'),(0x0,common_1[a120_0x422d36(0x166)])(jwt_guard_1[a120_0x422d36(0x157)],roles_guard_1[a120_0x422d36(0x121)]),(0x0,roles_decorator_1[a120_0x422d36(0x163)])(role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x14d)],role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x12c)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a120_0x422d36(0x11d)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[String,dto_1[a120_0x422d36(0x125)]]),__metadata(a120_0x422d36(0x124),Promise)],SettingController[a120_0x422d36(0x142)],a120_0x422d36(0x138),null),__decorate([(0x0,common_1[a120_0x422d36(0x120)])(':id/user-setting'),(0x0,common_1[a120_0x422d36(0x166)])(jwt_guard_1[a120_0x422d36(0x157)],roles_guard_1[a120_0x422d36(0x121)]),(0x0,roles_decorator_1[a120_0x422d36(0x163)])(role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x143)]),__param(0x0,(0x0,common_1[a120_0x422d36(0x161)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a120_0x422d36(0x141),Function),__metadata('design:paramtypes',[String,user_setting_dto_1[a120_0x422d36(0x13b)]]),__metadata(a120_0x422d36(0x124),Promise)],SettingController[a120_0x422d36(0x142)],'updateUserSetting',null),__decorate([(0x0,common_1[a120_0x422d36(0x122)])(a120_0x422d36(0x13e)),(0x0,common_1[a120_0x422d36(0x166)])(jwt_guard_1[a120_0x422d36(0x157)],roles_guard_1[a120_0x422d36(0x121)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x422d36(0x13d)]['Admin'],role_enum_1[a120_0x422d36(0x13d)][a120_0x422d36(0x12c)]),__metadata(a120_0x422d36(0x141),Function),__metadata(a120_0x422d36(0x153),[]),__metadata(a120_0x422d36(0x124),Promise)],SettingController[a120_0x422d36(0x142)],a120_0x422d36(0x129),null),SettingController=__decorate([(0x0,common_1[a120_0x422d36(0x159)])(a120_0x422d36(0x131)),__metadata(a120_0x422d36(0x153),[setting_service_1[a120_0x422d36(0x160)]])],SettingController),exports['SettingController']=SettingController;