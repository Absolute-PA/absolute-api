'use strict';function a123_0xc0ab(){const _0x1b1f27=['__metadata','User','Success\x20request\x20update\x20app\x20to\x20latest\x20version','72591mTLeOa','findFirst','design:returntype','UpdateSettingDto','3640HtnnTm','BadRequestException','Body','Get','schoolId','Post','log','./setting.service','pm2\x20restart\x20startUI\x20startApi','Patch','updateCode','userSetting','197624opdGKb','1089UqAfbV','design:type','18623QVRDdK','create','138xgzEDu','exec','updateUserSetting','settingService','Roles','length','defineProperty','mapSettingDocumentToDto','Viewer','decorate','metadata','298372JkdskF','JwtAuthGuard','14710392oFRSFs','UseGuards','stdin','design:paramtypes','isExpired','UserSettingDto','stderr','error','RolesGuard','child_process','SettingService','function','36qaibBK','Admin','./dto','./mappers/setting.mapper','../auth/guards/jwt.guard','Invalid\x20license\x20key','Param','153503bWpdvL','../auth/enums/role.enum','65wBMjtu','Role','prototype','__decorate','./dto/user-setting.dto','licenseKey','../auth/decorators/roles.decorator','data','/update','validateLicenseKey','getOwnPropertyDescriptor','killJobs','initalize','__esModule','setting','object','7048xXFhmO','update','isValid','maxUser','SettingController'];a123_0xc0ab=function(){return _0x1b1f27;};return a123_0xc0ab();}const a123_0x5200d0=a123_0x2727;(function(_0x19e6f7,_0x2f7a5b){const _0xc6d0b3=a123_0x2727,_0xb30ad=_0x19e6f7();while(!![]){try{const _0x438f41=parseInt(_0xc6d0b3(0x13b))/0x1+parseInt(_0xc6d0b3(0x149))/0x2*(parseInt(_0xc6d0b3(0x16a))/0x3)+-parseInt(_0xc6d0b3(0x17a))/0x4*(-parseInt(_0xc6d0b3(0x152))/0x5)+-parseInt(_0xc6d0b3(0x17f))/0x6*(parseInt(_0xc6d0b3(0x150))/0x7)+parseInt(_0xc6d0b3(0x162))/0x8*(parseInt(_0xc6d0b3(0x17b))/0x9)+-parseInt(_0xc6d0b3(0x16e))/0xa*(-parseInt(_0xc6d0b3(0x17d))/0xb)+-parseInt(_0xc6d0b3(0x13d))/0xc;if(_0x438f41===_0x2f7a5b)break;else _0xb30ad['push'](_0xb30ad['shift']());}catch(_0xe69306){_0xb30ad['push'](_0xb30ad['shift']());}}}(a123_0xc0ab,0x5a0b0));var __decorate=this&&this[a123_0x5200d0(0x155)]||function(_0x4e34a2,_0x2316fd,_0x15b466,_0x427b07){const _0x1b00a8=a123_0x5200d0;var _0x28d480=arguments[_0x1b00a8(0x184)],_0xa7134c=_0x28d480<0x3?_0x2316fd:_0x427b07===null?_0x427b07=Object[_0x1b00a8(0x15c)](_0x2316fd,_0x15b466):_0x427b07,_0x21d67d;if(typeof Reflect===_0x1b00a8(0x161)&&typeof Reflect[_0x1b00a8(0x188)]==='function')_0xa7134c=Reflect[_0x1b00a8(0x188)](_0x4e34a2,_0x2316fd,_0x15b466,_0x427b07);else{for(var _0x41efeb=_0x4e34a2[_0x1b00a8(0x184)]-0x1;_0x41efeb>=0x0;_0x41efeb--)if(_0x21d67d=_0x4e34a2[_0x41efeb])_0xa7134c=(_0x28d480<0x3?_0x21d67d(_0xa7134c):_0x28d480>0x3?_0x21d67d(_0x2316fd,_0x15b466,_0xa7134c):_0x21d67d(_0x2316fd,_0x15b466))||_0xa7134c;}return _0x28d480>0x3&&_0xa7134c&&Object[_0x1b00a8(0x185)](_0x2316fd,_0x15b466,_0xa7134c),_0xa7134c;},__metadata=this&&this[a123_0x5200d0(0x167)]||function(_0x3b1e8d,_0x48f914){const _0x54ef51=a123_0x5200d0;if(typeof Reflect===_0x54ef51(0x161)&&typeof Reflect[_0x54ef51(0x13a)]===_0x54ef51(0x148))return Reflect['metadata'](_0x3b1e8d,_0x48f914);},__param=this&&this['__param']||function(_0x22f2a5,_0x58dc05){return function(_0x3f1190,_0xd5b7d2){_0x58dc05(_0x3f1190,_0xd5b7d2,_0x22f2a5);};};function a123_0x2727(_0x2fbf56,_0x81ad51){const _0xc0abf5=a123_0xc0ab();return a123_0x2727=function(_0x272793,_0x1faebd){_0x272793=_0x272793-0x13a;let _0x4cab16=_0xc0abf5[_0x272793];return _0x4cab16;},a123_0x2727(_0x2fbf56,_0x81ad51);}Object[a123_0x5200d0(0x185)](exports,a123_0x5200d0(0x15f),{'value':!![]}),exports[a123_0x5200d0(0x166)]=void 0x0;const common_1=require('@nestjs/common'),setting_service_1=require(a123_0x5200d0(0x175)),dto_1=require(a123_0x5200d0(0x14b)),roles_decorator_1=require(a123_0x5200d0(0x158)),role_enum_1=require(a123_0x5200d0(0x151)),jwt_guard_1=require(a123_0x5200d0(0x14d)),roles_guard_1=require('../auth/guards/roles.guard'),setting_mapper_1=require(a123_0x5200d0(0x14c)),child_process_1=require(a123_0x5200d0(0x146)),user_setting_dto_1=require(a123_0x5200d0(0x156));let SettingController=class SettingController{constructor(_0x1e2de7){const _0x55dd1b=a123_0x5200d0;this[_0x55dd1b(0x182)]=_0x1e2de7,this[_0x55dd1b(0x15e)]();}async[a123_0x5200d0(0x16b)](){const _0xa8bd29=a123_0x5200d0,_0x371b96=await this[_0xa8bd29(0x182)][_0xa8bd29(0x16b)](),_0x45fe71=this[_0xa8bd29(0x182)][_0xa8bd29(0x15b)](_0x371b96['licenseKey'],_0x371b96[_0xa8bd29(0x172)]);return(0x0,setting_mapper_1[_0xa8bd29(0x186)])(_0x371b96,_0x45fe71['expiryDate']);}async[a123_0x5200d0(0x178)](){const _0x25a5c1=a123_0x5200d0,_0x3766c4=(0x0,child_process_1[_0x25a5c1(0x180)])(_0x25a5c1(0x176));return console[_0x25a5c1(0x174)](_0x25a5c1(0x169)),_0x3766c4['stdout']['on'](_0x25a5c1(0x144),_0xb5d82a=>{const _0x12392c=_0x25a5c1;console[_0x12392c(0x174)](_0xb5d82a);}),_0x3766c4[_0x25a5c1(0x13f)]['on']('error',_0x5f41d3=>{console['log'](_0x5f41d3);}),_0x3766c4[_0x25a5c1(0x143)]['on'](_0x25a5c1(0x159),_0xe250d5=>{const _0x16612b=_0x25a5c1;console[_0x16612b(0x174)](_0xe250d5);}),_0x25a5c1(0x169);}async[a123_0x5200d0(0x163)](_0x44560c,_0x503733){const _0x308b4e=a123_0x5200d0,_0x244b63=this['settingService'][_0x308b4e(0x15b)](_0x503733[_0x308b4e(0x157)],_0x503733[_0x308b4e(0x172)]);if(!_0x244b63[_0x308b4e(0x164)])throw new common_1['BadRequestException'](_0x308b4e(0x14e));_0x503733[_0x308b4e(0x141)]=![];const _0x2cfff0=await this[_0x308b4e(0x182)]['update'](_0x44560c,_0x503733);return(0x0,setting_mapper_1[_0x308b4e(0x186)])(_0x2cfff0,_0x244b63['expiryDate']);}async[a123_0x5200d0(0x181)](_0xd9012c,_0x4357d0){const _0x1eeb2e=a123_0x5200d0;_0x4357d0[_0x1eeb2e(0x165)]=+_0x4357d0[_0x1eeb2e(0x165)];if(isNaN(_0x4357d0[_0x1eeb2e(0x165)]))throw new common_1[(_0x1eeb2e(0x16f))]('Max\x20user\x20must\x20be\x20a\x20number');const _0x348658=await this[_0x1eeb2e(0x182)][_0x1eeb2e(0x181)](_0x4357d0);return _0x348658[_0x1eeb2e(0x179)];}async['killJobs'](){const _0x273b0f=a123_0x5200d0;await this[_0x273b0f(0x182)][_0x273b0f(0x15d)]();}async[a123_0x5200d0(0x15e)](){const _0x5d25bf=a123_0x5200d0,_0x1e8b12=await this[_0x5d25bf(0x182)]['findFirst']();!_0x1e8b12&&await this[_0x5d25bf(0x182)][_0x5d25bf(0x17e)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x5200d0(0x171)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x5200d0(0x183)])(role_enum_1[a123_0x5200d0(0x153)][a123_0x5200d0(0x14a)],role_enum_1[a123_0x5200d0(0x153)][a123_0x5200d0(0x168)],role_enum_1[a123_0x5200d0(0x153)][a123_0x5200d0(0x187)]),__metadata(a123_0x5200d0(0x17c),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x5200d0(0x16c),Promise)],SettingController['prototype'],a123_0x5200d0(0x16b),null),__decorate([(0x0,common_1['Post'])(a123_0x5200d0(0x15a)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x5200d0(0x13c)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x5200d0(0x153)][a123_0x5200d0(0x14a)],role_enum_1[a123_0x5200d0(0x153)]['User']),__metadata('design:type',Function),__metadata(a123_0x5200d0(0x140),[]),__metadata(a123_0x5200d0(0x16c),Promise)],SettingController['prototype'],'updateCode',null),__decorate([(0x0,common_1[a123_0x5200d0(0x177)])(':id/license'),(0x0,common_1[a123_0x5200d0(0x13e)])(jwt_guard_1[a123_0x5200d0(0x13c)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x5200d0(0x183)])(role_enum_1[a123_0x5200d0(0x153)][a123_0x5200d0(0x14a)],role_enum_1[a123_0x5200d0(0x153)]['User']),__param(0x0,(0x0,common_1[a123_0x5200d0(0x14f)])('id')),__param(0x1,(0x0,common_1[a123_0x5200d0(0x170)])()),__metadata('design:type',Function),__metadata(a123_0x5200d0(0x140),[String,dto_1[a123_0x5200d0(0x16d)]]),__metadata('design:returntype',Promise)],SettingController[a123_0x5200d0(0x154)],a123_0x5200d0(0x163),null),__decorate([(0x0,common_1['Patch'])(':id/user-setting'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x5200d0(0x145)]),(0x0,roles_decorator_1[a123_0x5200d0(0x183)])(role_enum_1[a123_0x5200d0(0x153)]['Master']),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a123_0x5200d0(0x170)])()),__metadata(a123_0x5200d0(0x17c),Function),__metadata(a123_0x5200d0(0x140),[String,user_setting_dto_1[a123_0x5200d0(0x142)]]),__metadata(a123_0x5200d0(0x16c),Promise)],SettingController[a123_0x5200d0(0x154)],a123_0x5200d0(0x181),null),__decorate([(0x0,common_1[a123_0x5200d0(0x173)])('/kill-jobs'),(0x0,common_1[a123_0x5200d0(0x13e)])(jwt_guard_1[a123_0x5200d0(0x13c)],roles_guard_1[a123_0x5200d0(0x145)]),(0x0,roles_decorator_1[a123_0x5200d0(0x183)])(role_enum_1[a123_0x5200d0(0x153)][a123_0x5200d0(0x14a)],role_enum_1[a123_0x5200d0(0x153)]['User']),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(a123_0x5200d0(0x16c),Promise)],SettingController[a123_0x5200d0(0x154)],a123_0x5200d0(0x15d),null),SettingController=__decorate([(0x0,common_1['Controller'])(a123_0x5200d0(0x160)),__metadata(a123_0x5200d0(0x140),[setting_service_1[a123_0x5200d0(0x147)]])],SettingController),exports[a123_0x5200d0(0x166)]=SettingController;