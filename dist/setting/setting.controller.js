'use strict';const a123_0x2a6c47=a123_0x1aa2;(function(_0x23f548,_0x4670fb){const _0x5c226a=a123_0x1aa2,_0x3f5aa0=_0x23f548();while(!![]){try{const _0x15144a=-parseInt(_0x5c226a(0xce))/0x1*(-parseInt(_0x5c226a(0xb6))/0x2)+-parseInt(_0x5c226a(0xd6))/0x3*(parseInt(_0x5c226a(0xbe))/0x4)+-parseInt(_0x5c226a(0xf0))/0x5+-parseInt(_0x5c226a(0xe1))/0x6*(-parseInt(_0x5c226a(0xc2))/0x7)+parseInt(_0x5c226a(0xcc))/0x8+parseInt(_0x5c226a(0xc1))/0x9+-parseInt(_0x5c226a(0xbd))/0xa*(parseInt(_0x5c226a(0xc0))/0xb);if(_0x15144a===_0x4670fb)break;else _0x3f5aa0['push'](_0x3f5aa0['shift']());}catch(_0x30af82){_0x3f5aa0['push'](_0x3f5aa0['shift']());}}}(a123_0x5d0b,0x9a179));var __decorate=this&&this[a123_0x2a6c47(0xdc)]||function(_0x52317e,_0x30a75c,_0x5d9e06,_0x33b59b){const _0x596ca6=a123_0x2a6c47;var _0x3fc5be=arguments[_0x596ca6(0xfd)],_0x654291=_0x3fc5be<0x3?_0x30a75c:_0x33b59b===null?_0x33b59b=Object['getOwnPropertyDescriptor'](_0x30a75c,_0x5d9e06):_0x33b59b,_0x24d7d1;if(typeof Reflect===_0x596ca6(0xf6)&&typeof Reflect[_0x596ca6(0xcf)]==='function')_0x654291=Reflect['decorate'](_0x52317e,_0x30a75c,_0x5d9e06,_0x33b59b);else{for(var _0x3bb75c=_0x52317e['length']-0x1;_0x3bb75c>=0x0;_0x3bb75c--)if(_0x24d7d1=_0x52317e[_0x3bb75c])_0x654291=(_0x3fc5be<0x3?_0x24d7d1(_0x654291):_0x3fc5be>0x3?_0x24d7d1(_0x30a75c,_0x5d9e06,_0x654291):_0x24d7d1(_0x30a75c,_0x5d9e06))||_0x654291;}return _0x3fc5be>0x3&&_0x654291&&Object[_0x596ca6(0xf9)](_0x30a75c,_0x5d9e06,_0x654291),_0x654291;},__metadata=this&&this['__metadata']||function(_0x42460f,_0x3214d5){const _0x1e2cbe=a123_0x2a6c47;if(typeof Reflect==='object'&&typeof Reflect[_0x1e2cbe(0x105)]===_0x1e2cbe(0xe4))return Reflect[_0x1e2cbe(0x105)](_0x42460f,_0x3214d5);},__param=this&&this[a123_0x2a6c47(0xc8)]||function(_0x5747f5,_0x13a96a){return function(_0x11478,_0x813a6){_0x13a96a(_0x11478,_0x813a6,_0x5747f5);};};function a123_0x1aa2(_0x2f8575,_0x176427){const _0x5d0b15=a123_0x5d0b();return a123_0x1aa2=function(_0x1aa26e,_0x5672a4){_0x1aa26e=_0x1aa26e-0xb6;let _0x4e9cf9=_0x5d0b15[_0x1aa26e];return _0x4e9cf9;},a123_0x1aa2(_0x2f8575,_0x176427);}Object[a123_0x2a6c47(0xf9)](exports,a123_0x2a6c47(0xbc),{'value':!![]}),exports[a123_0x2a6c47(0xd0)]=void 0x0;const common_1=require('@nestjs/common'),setting_service_1=require(a123_0x2a6c47(0xd1)),dto_1=require(a123_0x2a6c47(0xde)),roles_decorator_1=require(a123_0x2a6c47(0x100)),role_enum_1=require(a123_0x2a6c47(0xc9)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a123_0x2a6c47(0xcb)),setting_mapper_1=require(a123_0x2a6c47(0xe2)),child_process_1=require(a123_0x2a6c47(0xeb)),user_setting_dto_1=require(a123_0x2a6c47(0xba));function a123_0x5d0b(){const _0x4b08f1=['UserSettingDto','Param','Invalid\x20license\x20key','/update','__param','../auth/enums/role.enum','Get','../auth/guards/roles.guard','6313576drpZdp','initalize','7UYCHVC','decorate','SettingController','./setting.service','Master','Patch','Body','create','56853EWfceB','expiryDate','RolesGuard','isValid','schoolId','Roles','__decorate',':id/user-setting','./dto','JwtAuthGuard','stdin','6WTulRs','./mappers/setting.mapper','setting','function','Post','Role','exec','licenseKey','data','update','child_process','UpdateSettingDto','design:returntype','Max\x20user\x20must\x20be\x20a\x20number','Admin','4578595xnTDpC','mapSettingDocumentToDto','prototype','Success\x20request\x20update\x20app\x20to\x20latest\x20version','design:type','validateLicenseKey','object','design:paramtypes','updateCode','defineProperty','SettingService','pm2\x20restart\x20startUI\x20startApi','BadRequestException','length','User','Controller','../auth/decorators/roles.decorator','log','UseGuards','isExpired','error','metadata','findFirst','313594plFPsQ','killJobs','maxUser','Viewer','./dto/user-setting.dto','updateUserSetting','__esModule','1260eGAJSZ','204lggqWB','settingService','37620MsXCPs','3236832CFdoIP','4885139rRPARv','/kill-jobs'];a123_0x5d0b=function(){return _0x4b08f1;};return a123_0x5d0b();}let SettingController=class SettingController{constructor(_0x505816){const _0x27b739=a123_0x2a6c47;this['settingService']=_0x505816,this[_0x27b739(0xcd)]();}async[a123_0x2a6c47(0x106)](){const _0x188bfd=a123_0x2a6c47,_0x6cf063=await this['settingService'][_0x188bfd(0x106)](),_0x215bb5=this[_0x188bfd(0xbf)][_0x188bfd(0xf5)](_0x6cf063[_0x188bfd(0xe8)],_0x6cf063[_0x188bfd(0xda)]);return(0x0,setting_mapper_1[_0x188bfd(0xf1)])(_0x6cf063,_0x215bb5[_0x188bfd(0xd7)]);}async['updateCode'](){const _0x10c75b=a123_0x2a6c47,_0xda0939=(0x0,child_process_1[_0x10c75b(0xe7)])(_0x10c75b(0xfb));return console[_0x10c75b(0x101)](_0x10c75b(0xf3)),_0xda0939['stdout']['on'](_0x10c75b(0x104),_0x5951d2=>{const _0x3b0377=_0x10c75b;console[_0x3b0377(0x101)](_0x5951d2);}),_0xda0939[_0x10c75b(0xe0)]['on'](_0x10c75b(0x104),_0xe7eba2=>{const _0x50e09a=_0x10c75b;console[_0x50e09a(0x101)](_0xe7eba2);}),_0xda0939['stderr']['on'](_0x10c75b(0xe9),_0x1e89a9=>{const _0x440eaf=_0x10c75b;console[_0x440eaf(0x101)](_0x1e89a9);}),'Success\x20request\x20update\x20app\x20to\x20latest\x20version';}async[a123_0x2a6c47(0xea)](_0x4b95f9,_0x4745e9){const _0x13b1a7=a123_0x2a6c47,_0x38affd=this[_0x13b1a7(0xbf)][_0x13b1a7(0xf5)](_0x4745e9['licenseKey'],_0x4745e9[_0x13b1a7(0xda)]);if(!_0x38affd[_0x13b1a7(0xd9)])throw new common_1[(_0x13b1a7(0xfc))](_0x13b1a7(0xc6));_0x4745e9[_0x13b1a7(0x103)]=![];const _0x3f4a50=await this[_0x13b1a7(0xbf)][_0x13b1a7(0xea)](_0x4b95f9,_0x4745e9);return(0x0,setting_mapper_1[_0x13b1a7(0xf1)])(_0x3f4a50,_0x38affd['expiryDate']);}async[a123_0x2a6c47(0xbb)](_0x290224,_0x38fad0){const _0x266869=a123_0x2a6c47;_0x38fad0[_0x266869(0xb8)]=+_0x38fad0[_0x266869(0xb8)];if(isNaN(_0x38fad0[_0x266869(0xb8)]))throw new common_1['BadRequestException'](_0x266869(0xee));const _0x26c802=await this['settingService'][_0x266869(0xbb)](_0x38fad0);return _0x26c802['userSetting'];}async[a123_0x2a6c47(0xb7)](){const _0x46aca3=a123_0x2a6c47;await this[_0x46aca3(0xbf)]['killJobs']();}async[a123_0x2a6c47(0xcd)](){const _0x347423=a123_0x2a6c47,_0x45e0e3=await this['settingService'][_0x347423(0x106)]();!_0x45e0e3&&await this[_0x347423(0xbf)][_0x347423(0xd5)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x2a6c47(0xca)])('/'),(0x0,common_1[a123_0x2a6c47(0x102)])(jwt_guard_1[a123_0x2a6c47(0xdf)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x2a6c47(0xdb)])(role_enum_1['Role'][a123_0x2a6c47(0xef)],role_enum_1['Role']['User'],role_enum_1[a123_0x2a6c47(0xe6)][a123_0x2a6c47(0xb9)]),__metadata(a123_0x2a6c47(0xf4),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x2a6c47(0xed),Promise)],SettingController[a123_0x2a6c47(0xf2)],a123_0x2a6c47(0x106),null),__decorate([(0x0,common_1[a123_0x2a6c47(0xe5)])(a123_0x2a6c47(0xc7)),(0x0,common_1[a123_0x2a6c47(0x102)])(jwt_guard_1[a123_0x2a6c47(0xdf)],roles_guard_1[a123_0x2a6c47(0xd8)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role']['Admin'],role_enum_1['Role'][a123_0x2a6c47(0xfe)]),__metadata(a123_0x2a6c47(0xf4),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],SettingController['prototype'],a123_0x2a6c47(0xf8),null),__decorate([(0x0,common_1[a123_0x2a6c47(0xd3)])(':id/license'),(0x0,common_1[a123_0x2a6c47(0x102)])(jwt_guard_1[a123_0x2a6c47(0xdf)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x2a6c47(0xdb)])(role_enum_1[a123_0x2a6c47(0xe6)][a123_0x2a6c47(0xef)],role_enum_1[a123_0x2a6c47(0xe6)][a123_0x2a6c47(0xfe)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a123_0x2a6c47(0xd4)])()),__metadata(a123_0x2a6c47(0xf4),Function),__metadata(a123_0x2a6c47(0xf7),[String,dto_1[a123_0x2a6c47(0xec)]]),__metadata('design:returntype',Promise)],SettingController['prototype'],a123_0x2a6c47(0xea),null),__decorate([(0x0,common_1['Patch'])(a123_0x2a6c47(0xdd)),(0x0,common_1[a123_0x2a6c47(0x102)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x2a6c47(0xd8)]),(0x0,roles_decorator_1[a123_0x2a6c47(0xdb)])(role_enum_1[a123_0x2a6c47(0xe6)][a123_0x2a6c47(0xd2)]),__param(0x0,(0x0,common_1[a123_0x2a6c47(0xc5)])('id')),__param(0x1,(0x0,common_1[a123_0x2a6c47(0xd4)])()),__metadata(a123_0x2a6c47(0xf4),Function),__metadata(a123_0x2a6c47(0xf7),[String,user_setting_dto_1[a123_0x2a6c47(0xc4)]]),__metadata(a123_0x2a6c47(0xed),Promise)],SettingController['prototype'],a123_0x2a6c47(0xbb),null),__decorate([(0x0,common_1[a123_0x2a6c47(0xe5)])(a123_0x2a6c47(0xc3)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x2a6c47(0xdf)],roles_guard_1[a123_0x2a6c47(0xd8)]),(0x0,roles_decorator_1[a123_0x2a6c47(0xdb)])(role_enum_1[a123_0x2a6c47(0xe6)][a123_0x2a6c47(0xef)],role_enum_1['Role'][a123_0x2a6c47(0xfe)]),__metadata(a123_0x2a6c47(0xf4),Function),__metadata(a123_0x2a6c47(0xf7),[]),__metadata(a123_0x2a6c47(0xed),Promise)],SettingController['prototype'],a123_0x2a6c47(0xb7),null),SettingController=__decorate([(0x0,common_1[a123_0x2a6c47(0xff)])(a123_0x2a6c47(0xe3)),__metadata(a123_0x2a6c47(0xf7),[setting_service_1[a123_0x2a6c47(0xfa)]])],SettingController),exports['SettingController']=SettingController;