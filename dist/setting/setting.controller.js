'use strict';const a120_0x2bfc93=a120_0x5128;(function(_0x269db4,_0x45bac0){const _0xe309a8=a120_0x5128,_0x4c0d0c=_0x269db4();while(!![]){try{const _0x1b7091=parseInt(_0xe309a8(0xcf))/0x1+parseInt(_0xe309a8(0xa9))/0x2+parseInt(_0xe309a8(0x9d))/0x3*(-parseInt(_0xe309a8(0xc7))/0x4)+-parseInt(_0xe309a8(0x9e))/0x5+parseInt(_0xe309a8(0xd7))/0x6*(parseInt(_0xe309a8(0xbc))/0x7)+-parseInt(_0xe309a8(0xae))/0x8*(parseInt(_0xe309a8(0xc9))/0x9)+parseInt(_0xe309a8(0x95))/0xa*(parseInt(_0xe309a8(0xa4))/0xb);if(_0x1b7091===_0x45bac0)break;else _0x4c0d0c['push'](_0x4c0d0c['shift']());}catch(_0x4c0b69){_0x4c0d0c['push'](_0x4c0d0c['shift']());}}}(a120_0x2d66,0xf1b16));function a120_0x2d66(){const _0x668bd2=['SettingService','stdin','User','Invalid\x20license\x20key','initalize','../auth/decorators/roles.decorator','1662ahaffG','8854080lFSmDx','Body','updateUserSetting','userSetting','pm2\x20restart\x20startUI\x20startApi','design:type','1485mGkhAd','maxUser','Patch','updateCode','validateLicenseKey','2405380ZxTUFP','../auth/enums/role.enum','./setting.service','child_process','@nestjs/common','5288plMFal','function',':id/user-setting','schoolId','BadRequestException','__param','log','__metadata','update','/kill-jobs','prototype','licenseKey',':id/license','settingService','1855vmhUNI','design:returntype','SettingController','UseGuards','JwtAuthGuard','UserSettingDto','defineProperty','Viewer','design:paramtypes','stdout','Role','9388NcZdYJ','expiryDate','18162IuUgDY','Admin','Controller','Post','mapSettingDocumentToDto','getOwnPropertyDescriptor','1104946zVIPev','Get','findFirst','__decorate','decorate','setting','metadata','./dto','44094jpvrWT','error','length','object','Param','RolesGuard','Success\x20request\x20update\x20app\x20to\x20latest\x20version','killJobs','create','UpdateSettingDto','Roles','stderr','84430OGsnOA','data'];a120_0x2d66=function(){return _0x668bd2;};return a120_0x2d66();}var __decorate=this&&this[a120_0x2bfc93(0xd2)]||function(_0x41a7e3,_0x34bc5b,_0xbd55dc,_0x53a50c){const _0x43617c=a120_0x2bfc93;var _0x24399f=arguments[_0x43617c(0x8b)],_0x11e9a1=_0x24399f<0x3?_0x34bc5b:_0x53a50c===null?_0x53a50c=Object[_0x43617c(0xce)](_0x34bc5b,_0xbd55dc):_0x53a50c,_0x5b9e2a;if(typeof Reflect===_0x43617c(0x8c)&&typeof Reflect['decorate']==='function')_0x11e9a1=Reflect[_0x43617c(0xd3)](_0x41a7e3,_0x34bc5b,_0xbd55dc,_0x53a50c);else{for(var _0x25fd7e=_0x41a7e3[_0x43617c(0x8b)]-0x1;_0x25fd7e>=0x0;_0x25fd7e--)if(_0x5b9e2a=_0x41a7e3[_0x25fd7e])_0x11e9a1=(_0x24399f<0x3?_0x5b9e2a(_0x11e9a1):_0x24399f>0x3?_0x5b9e2a(_0x34bc5b,_0xbd55dc,_0x11e9a1):_0x5b9e2a(_0x34bc5b,_0xbd55dc))||_0x11e9a1;}return _0x24399f>0x3&&_0x11e9a1&&Object[_0x43617c(0xc2)](_0x34bc5b,_0xbd55dc,_0x11e9a1),_0x11e9a1;},__metadata=this&&this[a120_0x2bfc93(0xb5)]||function(_0x508509,_0x357c74){const _0x7a6176=a120_0x2bfc93;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x7a6176(0xaf))return Reflect[_0x7a6176(0xd5)](_0x508509,_0x357c74);},__param=this&&this[a120_0x2bfc93(0xb3)]||function(_0x210ab9,_0x1c627e){return function(_0x2829b7,_0x2f60fd){_0x1c627e(_0x2829b7,_0x2f60fd,_0x210ab9);};};function a120_0x5128(_0x215bf5,_0x31641a){const _0x2d6653=a120_0x2d66();return a120_0x5128=function(_0x512825,_0x5d0c61){_0x512825=_0x512825-0x8a;let _0x88431c=_0x2d6653[_0x512825];return _0x88431c;},a120_0x5128(_0x215bf5,_0x31641a);}Object[a120_0x2bfc93(0xc2)](exports,'__esModule',{'value':!![]}),exports[a120_0x2bfc93(0xbe)]=void 0x0;const common_1=require(a120_0x2bfc93(0xad)),setting_service_1=require(a120_0x2bfc93(0xab)),dto_1=require(a120_0x2bfc93(0xd6)),roles_decorator_1=require(a120_0x2bfc93(0x9c)),role_enum_1=require(a120_0x2bfc93(0xaa)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require('../auth/guards/roles.guard'),setting_mapper_1=require('./mappers/setting.mapper'),child_process_1=require(a120_0x2bfc93(0xac)),user_setting_dto_1=require('./dto/user-setting.dto');let SettingController=class SettingController{constructor(_0x1636ba){const _0x2595d5=a120_0x2bfc93;this['settingService']=_0x1636ba,this[_0x2595d5(0x9b)]();}async[a120_0x2bfc93(0xd1)](){const _0x1d0393=a120_0x2bfc93,_0x2930df=await this[_0x1d0393(0xbb)]['findFirst'](),_0x31a6dc=this[_0x1d0393(0xbb)][_0x1d0393(0xa8)](_0x2930df[_0x1d0393(0xb9)],_0x2930df[_0x1d0393(0xb1)]);return(0x0,setting_mapper_1[_0x1d0393(0xcd)])(_0x2930df,_0x31a6dc[_0x1d0393(0xc8)]);}async[a120_0x2bfc93(0xa7)](){const _0x3ba246=a120_0x2bfc93,_0x1f83e3=(0x0,child_process_1['exec'])(_0x3ba246(0xa2));return console[_0x3ba246(0xb4)](_0x3ba246(0x8f)),_0x1f83e3[_0x3ba246(0xc5)]['on'](_0x3ba246(0x8a),_0x2a8218=>{const _0x2c64e8=_0x3ba246;console[_0x2c64e8(0xb4)](_0x2a8218);}),_0x1f83e3[_0x3ba246(0x98)]['on'](_0x3ba246(0x8a),_0x3247dc=>{console['log'](_0x3247dc);}),_0x1f83e3[_0x3ba246(0x94)]['on'](_0x3ba246(0x96),_0x178cd8=>{const _0x531759=_0x3ba246;console[_0x531759(0xb4)](_0x178cd8);}),_0x3ba246(0x8f);}async[a120_0x2bfc93(0xb6)](_0x2ce583,_0xd0882c){const _0x1d4aa9=a120_0x2bfc93,_0x406dd6=this[_0x1d4aa9(0xbb)]['validateLicenseKey'](_0xd0882c[_0x1d4aa9(0xb9)],_0xd0882c[_0x1d4aa9(0xb1)]);if(!_0x406dd6['isValid'])throw new common_1[(_0x1d4aa9(0xb2))](_0x1d4aa9(0x9a));_0xd0882c['isExpired']=![];const _0x489001=await this['settingService']['update'](_0x2ce583,_0xd0882c);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0x489001,_0x406dd6[_0x1d4aa9(0xc8)]);}async[a120_0x2bfc93(0xa0)](_0x299f29,_0x14b931){const _0x5cc07c=a120_0x2bfc93;_0x14b931[_0x5cc07c(0xa5)]=+_0x14b931[_0x5cc07c(0xa5)];if(isNaN(_0x14b931[_0x5cc07c(0xa5)]))throw new common_1[(_0x5cc07c(0xb2))]('Max\x20user\x20must\x20be\x20a\x20number');const _0x2e3a0c=await this[_0x5cc07c(0xbb)][_0x5cc07c(0xa0)](_0x14b931);return _0x2e3a0c[_0x5cc07c(0xa1)];}async[a120_0x2bfc93(0x90)](){const _0x1a1748=a120_0x2bfc93;await this[_0x1a1748(0xbb)][_0x1a1748(0x90)]();}async[a120_0x2bfc93(0x9b)](){const _0x3ec308=a120_0x2bfc93,_0x246d5d=await this[_0x3ec308(0xbb)]['findFirst']();!_0x246d5d&&await this[_0x3ec308(0xbb)][_0x3ec308(0x91)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a120_0x2bfc93(0xd0)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x2bfc93(0xc0)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x2bfc93(0x93)])(role_enum_1[a120_0x2bfc93(0xc6)][a120_0x2bfc93(0xca)],role_enum_1[a120_0x2bfc93(0xc6)][a120_0x2bfc93(0x99)],role_enum_1[a120_0x2bfc93(0xc6)][a120_0x2bfc93(0xc3)]),__metadata('design:type',Function),__metadata(a120_0x2bfc93(0xc4),[]),__metadata('design:returntype',Promise)],SettingController[a120_0x2bfc93(0xb8)],a120_0x2bfc93(0xd1),null),__decorate([(0x0,common_1['Post'])('/update'),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x2bfc93(0xc0)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x2bfc93(0x93)])(role_enum_1['Role'][a120_0x2bfc93(0xca)],role_enum_1[a120_0x2bfc93(0xc6)]['User']),__metadata(a120_0x2bfc93(0xa3),Function),__metadata('design:paramtypes',[]),__metadata(a120_0x2bfc93(0xbd),Promise)],SettingController[a120_0x2bfc93(0xb8)],'updateCode',null),__decorate([(0x0,common_1[a120_0x2bfc93(0xa6)])(a120_0x2bfc93(0xba)),(0x0,common_1[a120_0x2bfc93(0xbf)])(jwt_guard_1[a120_0x2bfc93(0xc0)],roles_guard_1[a120_0x2bfc93(0x8e)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x2bfc93(0xc6)][a120_0x2bfc93(0xca)],role_enum_1['Role']['User']),__param(0x0,(0x0,common_1[a120_0x2bfc93(0x8d)])('id')),__param(0x1,(0x0,common_1[a120_0x2bfc93(0x9f)])()),__metadata(a120_0x2bfc93(0xa3),Function),__metadata(a120_0x2bfc93(0xc4),[String,dto_1[a120_0x2bfc93(0x92)]]),__metadata(a120_0x2bfc93(0xbd),Promise)],SettingController[a120_0x2bfc93(0xb8)],a120_0x2bfc93(0xb6),null),__decorate([(0x0,common_1[a120_0x2bfc93(0xa6)])(a120_0x2bfc93(0xb0)),(0x0,common_1[a120_0x2bfc93(0xbf)])(jwt_guard_1[a120_0x2bfc93(0xc0)],roles_guard_1[a120_0x2bfc93(0x8e)]),(0x0,roles_decorator_1[a120_0x2bfc93(0x93)])(role_enum_1[a120_0x2bfc93(0xc6)]['Master']),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a120_0x2bfc93(0x9f)])()),__metadata('design:type',Function),__metadata(a120_0x2bfc93(0xc4),[String,user_setting_dto_1[a120_0x2bfc93(0xc1)]]),__metadata('design:returntype',Promise)],SettingController[a120_0x2bfc93(0xb8)],a120_0x2bfc93(0xa0),null),__decorate([(0x0,common_1[a120_0x2bfc93(0xcc)])(a120_0x2bfc93(0xb7)),(0x0,common_1[a120_0x2bfc93(0xbf)])(jwt_guard_1[a120_0x2bfc93(0xc0)],roles_guard_1[a120_0x2bfc93(0x8e)]),(0x0,roles_decorator_1[a120_0x2bfc93(0x93)])(role_enum_1[a120_0x2bfc93(0xc6)][a120_0x2bfc93(0xca)],role_enum_1[a120_0x2bfc93(0xc6)][a120_0x2bfc93(0x99)]),__metadata(a120_0x2bfc93(0xa3),Function),__metadata(a120_0x2bfc93(0xc4),[]),__metadata(a120_0x2bfc93(0xbd),Promise)],SettingController['prototype'],a120_0x2bfc93(0x90),null),SettingController=__decorate([(0x0,common_1[a120_0x2bfc93(0xcb)])(a120_0x2bfc93(0xd4)),__metadata('design:paramtypes',[setting_service_1[a120_0x2bfc93(0x97)]])],SettingController),exports[a120_0x2bfc93(0xbe)]=SettingController;