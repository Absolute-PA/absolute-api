'use strict';const a123_0x57f684=a123_0x5f1f;function a123_0x3dd7(){const _0x1df147=['Admin','Master','@nestjs/common','4827FTumYJ','__esModule','initalize','Roles','expiryDate','userSetting','UpdateSettingDto','mapSettingDocumentToDto','exec','killJobs','Body','child_process','SettingController','RolesGuard','BadRequestException','UseGuards','22XqeUEz','maxUser','update','validateLicenseKey','10248696PUetHO','../auth/enums/role.enum','568465zMUyYv','Param',':id/license','661445yGbrId','560vGxWPY','stdout','JwtAuthGuard','/kill-jobs','Viewer','9WYRUOy','updateCode','design:returntype','./setting.service','12DeSdsC','error','settingService','__decorate','getOwnPropertyDescriptor','./dto/user-setting.dto','Invalid\x20license\x20key','__param','/update','Max\x20user\x20must\x20be\x20a\x20number','metadata','setting','length','updateUserSetting','stdin','licenseKey','../auth/guards/jwt.guard','4278170cmDWPi','Role','design:paramtypes','664hCiLhi','isValid','findFirst','SettingService','object','Controller','schoolId','pm2\x20restart\x20startUI\x20startApi',':id/user-setting','User','306348ZiNUFt','Success\x20request\x20update\x20app\x20to\x20latest\x20version','./mappers/setting.mapper','UserSettingDto','prototype','Patch','./dto','../auth/guards/roles.guard','32221NABpWt','design:type','log','../auth/decorators/roles.decorator','function'];a123_0x3dd7=function(){return _0x1df147;};return a123_0x3dd7();}(function(_0x4a4f02,_0x2677dc){const _0x56a0b1=a123_0x5f1f,_0x1f434f=_0x4a4f02();while(!![]){try{const _0x26048a=-parseInt(_0x56a0b1(0x229))/0x1+-parseInt(_0x56a0b1(0x22d))/0x2*(parseInt(_0x56a0b1(0x213))/0x3)+parseInt(_0x56a0b1(0x1e5))/0x4*(-parseInt(_0x56a0b1(0x22c))/0x5)+-parseInt(_0x56a0b1(0x203))/0x6+-parseInt(_0x56a0b1(0x20b))/0x7*(parseInt(_0x56a0b1(0x1f9))/0x8)+parseInt(_0x56a0b1(0x232))/0x9*(parseInt(_0x56a0b1(0x1f6))/0xa)+-parseInt(_0x56a0b1(0x223))/0xb*(-parseInt(_0x56a0b1(0x227))/0xc);if(_0x26048a===_0x2677dc)break;else _0x1f434f['push'](_0x1f434f['shift']());}catch(_0x2b7242){_0x1f434f['push'](_0x1f434f['shift']());}}}(a123_0x3dd7,0x460fe));var __decorate=this&&this[a123_0x57f684(0x1e8)]||function(_0x4739e4,_0x17a65f,_0x5e13ae,_0x2360ce){const _0x30a3aa=a123_0x57f684;var _0x67b8e6=arguments[_0x30a3aa(0x1f1)],_0x473a47=_0x67b8e6<0x3?_0x17a65f:_0x2360ce===null?_0x2360ce=Object[_0x30a3aa(0x1e9)](_0x17a65f,_0x5e13ae):_0x2360ce,_0x472352;if(typeof Reflect===_0x30a3aa(0x1fd)&&typeof Reflect['decorate']===_0x30a3aa(0x20f))_0x473a47=Reflect['decorate'](_0x4739e4,_0x17a65f,_0x5e13ae,_0x2360ce);else{for(var _0x122e52=_0x4739e4['length']-0x1;_0x122e52>=0x0;_0x122e52--)if(_0x472352=_0x4739e4[_0x122e52])_0x473a47=(_0x67b8e6<0x3?_0x472352(_0x473a47):_0x67b8e6>0x3?_0x472352(_0x17a65f,_0x5e13ae,_0x473a47):_0x472352(_0x17a65f,_0x5e13ae))||_0x473a47;}return _0x67b8e6>0x3&&_0x473a47&&Object['defineProperty'](_0x17a65f,_0x5e13ae,_0x473a47),_0x473a47;},__metadata=this&&this['__metadata']||function(_0x193936,_0x2c895b){const _0x1d48bd=a123_0x57f684;if(typeof Reflect==='object'&&typeof Reflect[_0x1d48bd(0x1ef)]===_0x1d48bd(0x20f))return Reflect['metadata'](_0x193936,_0x2c895b);},__param=this&&this[a123_0x57f684(0x1ec)]||function(_0x6e0d23,_0x4ac3b4){return function(_0x310fea,_0x4cf583){_0x4ac3b4(_0x310fea,_0x4cf583,_0x6e0d23);};};Object['defineProperty'](exports,a123_0x57f684(0x214),{'value':!![]}),exports[a123_0x57f684(0x21f)]=void 0x0;function a123_0x5f1f(_0x275038,_0x5172f2){const _0x3dd760=a123_0x3dd7();return a123_0x5f1f=function(_0x5f1f70,_0xbdc678){_0x5f1f70=_0x5f1f70-0x1e3;let _0xa61f83=_0x3dd760[_0x5f1f70];return _0xa61f83;},a123_0x5f1f(_0x275038,_0x5172f2);}const common_1=require(a123_0x57f684(0x212)),setting_service_1=require(a123_0x57f684(0x1e4)),dto_1=require(a123_0x57f684(0x209)),roles_decorator_1=require(a123_0x57f684(0x20e)),role_enum_1=require(a123_0x57f684(0x228)),jwt_guard_1=require(a123_0x57f684(0x1f5)),roles_guard_1=require(a123_0x57f684(0x20a)),setting_mapper_1=require(a123_0x57f684(0x205)),child_process_1=require(a123_0x57f684(0x21e)),user_setting_dto_1=require(a123_0x57f684(0x1ea));let SettingController=class SettingController{constructor(_0x417f0e){const _0x5500c6=a123_0x57f684;this[_0x5500c6(0x1e7)]=_0x417f0e,this[_0x5500c6(0x215)]();}async[a123_0x57f684(0x1fb)](){const _0x3f239e=a123_0x57f684,_0x4b5898=await this['settingService'][_0x3f239e(0x1fb)](),_0x103c82=this['settingService'][_0x3f239e(0x226)](_0x4b5898['licenseKey'],_0x4b5898['schoolId']);return(0x0,setting_mapper_1[_0x3f239e(0x21a)])(_0x4b5898,_0x103c82[_0x3f239e(0x217)]);}async[a123_0x57f684(0x233)](){const _0x22d831=a123_0x57f684,_0x252c3b=(0x0,child_process_1[_0x22d831(0x21b)])(_0x22d831(0x200));return console[_0x22d831(0x20d)](_0x22d831(0x204)),_0x252c3b[_0x22d831(0x22e)]['on'](_0x22d831(0x1e6),_0x57a7bb=>{console['log'](_0x57a7bb);}),_0x252c3b[_0x22d831(0x1f3)]['on'](_0x22d831(0x1e6),_0x233f06=>{const _0x301ebb=_0x22d831;console[_0x301ebb(0x20d)](_0x233f06);}),_0x252c3b['stderr']['on']('data',_0x53bb53=>{const _0x47ec90=_0x22d831;console[_0x47ec90(0x20d)](_0x53bb53);}),_0x22d831(0x204);}async[a123_0x57f684(0x225)](_0x208f3f,_0xc50b85){const _0x591bc2=a123_0x57f684,_0x225603=this[_0x591bc2(0x1e7)][_0x591bc2(0x226)](_0xc50b85[_0x591bc2(0x1f4)],_0xc50b85[_0x591bc2(0x1ff)]);if(!_0x225603[_0x591bc2(0x1fa)])throw new common_1[(_0x591bc2(0x221))](_0x591bc2(0x1eb));_0xc50b85['isExpired']=![];const _0x11f886=await this[_0x591bc2(0x1e7)][_0x591bc2(0x225)](_0x208f3f,_0xc50b85);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0x11f886,_0x225603[_0x591bc2(0x217)]);}async[a123_0x57f684(0x1f2)](_0x1fee9a,_0x285fc1){const _0x2e4ddb=a123_0x57f684;_0x285fc1[_0x2e4ddb(0x224)]=+_0x285fc1[_0x2e4ddb(0x224)];if(isNaN(_0x285fc1['maxUser']))throw new common_1[(_0x2e4ddb(0x221))](_0x2e4ddb(0x1ee));const _0x2c66fb=await this[_0x2e4ddb(0x1e7)][_0x2e4ddb(0x1f2)](_0x285fc1);return _0x2c66fb[_0x2e4ddb(0x218)];}async[a123_0x57f684(0x21c)](){const _0x539403=a123_0x57f684;await this['settingService'][_0x539403(0x21c)]();}async[a123_0x57f684(0x215)](){const _0x3e5d19=a123_0x57f684,_0x4d199a=await this[_0x3e5d19(0x1e7)]['findFirst']();!_0x4d199a&&await this[_0x3e5d19(0x1e7)]['create']({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1['Get'])('/'),(0x0,common_1[a123_0x57f684(0x222)])(jwt_guard_1[a123_0x57f684(0x22f)],roles_guard_1[a123_0x57f684(0x220)]),(0x0,roles_decorator_1[a123_0x57f684(0x216)])(role_enum_1[a123_0x57f684(0x1f7)]['Admin'],role_enum_1[a123_0x57f684(0x1f7)]['User'],role_enum_1[a123_0x57f684(0x1f7)][a123_0x57f684(0x231)]),__metadata(a123_0x57f684(0x20c),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x57f684(0x1e3),Promise)],SettingController[a123_0x57f684(0x207)],a123_0x57f684(0x1fb),null),__decorate([(0x0,common_1['Post'])(a123_0x57f684(0x1ed)),(0x0,common_1[a123_0x57f684(0x222)])(jwt_guard_1[a123_0x57f684(0x22f)],roles_guard_1[a123_0x57f684(0x220)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a123_0x57f684(0x210)],role_enum_1[a123_0x57f684(0x1f7)]['User']),__metadata(a123_0x57f684(0x20c),Function),__metadata(a123_0x57f684(0x1f8),[]),__metadata(a123_0x57f684(0x1e3),Promise)],SettingController[a123_0x57f684(0x207)],a123_0x57f684(0x233),null),__decorate([(0x0,common_1[a123_0x57f684(0x208)])(a123_0x57f684(0x22b)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x57f684(0x22f)],roles_guard_1[a123_0x57f684(0x220)]),(0x0,roles_decorator_1[a123_0x57f684(0x216)])(role_enum_1[a123_0x57f684(0x1f7)][a123_0x57f684(0x210)],role_enum_1[a123_0x57f684(0x1f7)][a123_0x57f684(0x202)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a123_0x57f684(0x21d)])()),__metadata(a123_0x57f684(0x20c),Function),__metadata('design:paramtypes',[String,dto_1[a123_0x57f684(0x219)]]),__metadata(a123_0x57f684(0x1e3),Promise)],SettingController[a123_0x57f684(0x207)],a123_0x57f684(0x225),null),__decorate([(0x0,common_1['Patch'])(a123_0x57f684(0x201)),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x57f684(0x220)]),(0x0,roles_decorator_1[a123_0x57f684(0x216)])(role_enum_1[a123_0x57f684(0x1f7)][a123_0x57f684(0x211)]),__param(0x0,(0x0,common_1[a123_0x57f684(0x22a)])('id')),__param(0x1,(0x0,common_1[a123_0x57f684(0x21d)])()),__metadata(a123_0x57f684(0x20c),Function),__metadata(a123_0x57f684(0x1f8),[String,user_setting_dto_1[a123_0x57f684(0x206)]]),__metadata(a123_0x57f684(0x1e3),Promise)],SettingController['prototype'],a123_0x57f684(0x1f2),null),__decorate([(0x0,common_1['Post'])(a123_0x57f684(0x230)),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x57f684(0x220)]),(0x0,roles_decorator_1[a123_0x57f684(0x216)])(role_enum_1[a123_0x57f684(0x1f7)][a123_0x57f684(0x210)],role_enum_1[a123_0x57f684(0x1f7)][a123_0x57f684(0x202)]),__metadata('design:type',Function),__metadata(a123_0x57f684(0x1f8),[]),__metadata(a123_0x57f684(0x1e3),Promise)],SettingController[a123_0x57f684(0x207)],a123_0x57f684(0x21c),null),SettingController=__decorate([(0x0,common_1[a123_0x57f684(0x1fe)])(a123_0x57f684(0x1f0)),__metadata(a123_0x57f684(0x1f8),[setting_service_1[a123_0x57f684(0x1fc)]])],SettingController),exports[a123_0x57f684(0x21f)]=SettingController;