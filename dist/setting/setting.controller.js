'use strict';const a123_0x1dc3a8=a123_0x47f6;function a123_0x47f6(_0x4cb08d,_0x301054){const _0x3367e2=a123_0x3367();return a123_0x47f6=function(_0x47f6a4,_0x412ce8){_0x47f6a4=_0x47f6a4-0xe4;let _0x43e990=_0x3367e2[_0x47f6a4];return _0x43e990;},a123_0x47f6(_0x4cb08d,_0x301054);}function a123_0x3367(){const _0x270a70=['__metadata','Get','User','Post','schoolId','defineProperty','UseGuards','Param','exec','SettingService','/update','validateLicenseKey','__esModule','Viewer','@nestjs/common','prototype','../auth/guards/jwt.guard','Admin','killJobs','log','Role','function','31278DlconG','isValid','UpdateSettingDto','169735oiEFjK','metadata',':id/user-setting','36nTzrWp','update','settingService','stdout','JwtAuthGuard','__decorate','Body','design:returntype','maxUser','Roles','mapSettingDocumentToDto','../auth/decorators/roles.decorator',':id/license','decorate','create','Success\x20request\x20update\x20app\x20to\x20latest\x20version','object','./setting.service','length','error','RolesGuard','SettingController','updateUserSetting','pm2\x20restart\x20startUI\x20startApi','design:paramtypes','Patch','9495fisfAI','__param','./mappers/setting.mapper','stdin','isExpired','initalize','Invalid\x20license\x20key','245FNRAGf','setting','./dto','findFirst','expiryDate','2143460uBuIFV','data','child_process','322218dzuxYY','userSetting','design:type','1604367TYyEcl','8iVKBnp','updateCode','Max\x20user\x20must\x20be\x20a\x20number','344090OaOcoy','stderr'];a123_0x3367=function(){return _0x270a70;};return a123_0x3367();}(function(_0x158dcf,_0x276d68){const _0x46fdd8=a123_0x47f6,_0xbc87c7=_0x158dcf();while(!![]){try{const _0x5c8728=-parseInt(_0x46fdd8(0x131))/0x1+parseInt(_0x46fdd8(0x116))/0x2+parseInt(_0x46fdd8(0x10f))/0x3+-parseInt(_0x46fdd8(0xe6))/0x4*(parseInt(_0x46fdd8(0x100))/0x5)+parseInt(_0x46fdd8(0x12e))/0x6*(parseInt(_0x46fdd8(0x107))/0x7)+-parseInt(_0x46fdd8(0x113))/0x8*(-parseInt(_0x46fdd8(0x112))/0x9)+-parseInt(_0x46fdd8(0x10c))/0xa;if(_0x5c8728===_0x276d68)break;else _0xbc87c7['push'](_0xbc87c7['shift']());}catch(_0x52c51f){_0xbc87c7['push'](_0xbc87c7['shift']());}}}(a123_0x3367,0x3a595));var __decorate=this&&this[a123_0x1dc3a8(0xeb)]||function(_0x4fce2f,_0x5ccd0c,_0xbbf1c8,_0x7cfb99){const _0x155064=a123_0x1dc3a8;var _0x47aba4=arguments[_0x155064(0xf8)],_0x34cd3f=_0x47aba4<0x3?_0x5ccd0c:_0x7cfb99===null?_0x7cfb99=Object['getOwnPropertyDescriptor'](_0x5ccd0c,_0xbbf1c8):_0x7cfb99,_0x17266d;if(typeof Reflect==='object'&&typeof Reflect[_0x155064(0xf3)]===_0x155064(0x12d))_0x34cd3f=Reflect[_0x155064(0xf3)](_0x4fce2f,_0x5ccd0c,_0xbbf1c8,_0x7cfb99);else{for(var _0x3ee550=_0x4fce2f[_0x155064(0xf8)]-0x1;_0x3ee550>=0x0;_0x3ee550--)if(_0x17266d=_0x4fce2f[_0x3ee550])_0x34cd3f=(_0x47aba4<0x3?_0x17266d(_0x34cd3f):_0x47aba4>0x3?_0x17266d(_0x5ccd0c,_0xbbf1c8,_0x34cd3f):_0x17266d(_0x5ccd0c,_0xbbf1c8))||_0x34cd3f;}return _0x47aba4>0x3&&_0x34cd3f&&Object['defineProperty'](_0x5ccd0c,_0xbbf1c8,_0x34cd3f),_0x34cd3f;},__metadata=this&&this[a123_0x1dc3a8(0x118)]||function(_0x3a9f67,_0x44ee08){const _0x5ac10d=a123_0x1dc3a8;if(typeof Reflect===_0x5ac10d(0xf6)&&typeof Reflect[_0x5ac10d(0xe4)]===_0x5ac10d(0x12d))return Reflect[_0x5ac10d(0xe4)](_0x3a9f67,_0x44ee08);},__param=this&&this[a123_0x1dc3a8(0x101)]||function(_0x2589f9,_0x5fe905){return function(_0x3cdb2e,_0x119092){_0x5fe905(_0x3cdb2e,_0x119092,_0x2589f9);};};Object[a123_0x1dc3a8(0x11d)](exports,a123_0x1dc3a8(0x124),{'value':!![]}),exports[a123_0x1dc3a8(0xfb)]=void 0x0;const common_1=require(a123_0x1dc3a8(0x126)),setting_service_1=require(a123_0x1dc3a8(0xf7)),dto_1=require(a123_0x1dc3a8(0x109)),roles_decorator_1=require(a123_0x1dc3a8(0xf1)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a123_0x1dc3a8(0x128)),roles_guard_1=require('../auth/guards/roles.guard'),setting_mapper_1=require(a123_0x1dc3a8(0x102)),child_process_1=require(a123_0x1dc3a8(0x10e)),user_setting_dto_1=require('./dto/user-setting.dto');let SettingController=class SettingController{constructor(_0x9e1240){const _0x218522=a123_0x1dc3a8;this[_0x218522(0xe8)]=_0x9e1240,this[_0x218522(0x105)]();}async['findFirst'](){const _0x6ebc1f=a123_0x1dc3a8,_0x1df44d=await this['settingService']['findFirst'](),_0x5d044a=this[_0x6ebc1f(0xe8)][_0x6ebc1f(0x123)](_0x1df44d['licenseKey'],_0x1df44d[_0x6ebc1f(0x11c)]);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0x1df44d,_0x5d044a[_0x6ebc1f(0x10b)]);}async[a123_0x1dc3a8(0x114)](){const _0x482678=a123_0x1dc3a8,_0x2998a2=(0x0,child_process_1[_0x482678(0x120)])(_0x482678(0xfd));return console[_0x482678(0x12b)](_0x482678(0xf5)),_0x2998a2[_0x482678(0xe9)]['on'](_0x482678(0xf9),_0x24736e=>{const _0x2b672b=_0x482678;console[_0x2b672b(0x12b)](_0x24736e);}),_0x2998a2[_0x482678(0x103)]['on'](_0x482678(0xf9),_0x345a4c=>{console['log'](_0x345a4c);}),_0x2998a2[_0x482678(0x117)]['on'](_0x482678(0x10d),_0x3bc9de=>{const _0x1f88ca=_0x482678;console[_0x1f88ca(0x12b)](_0x3bc9de);}),_0x482678(0xf5);}async['update'](_0x3a6714,_0x3fcf9c){const _0x272971=a123_0x1dc3a8,_0x1ecd9e=this[_0x272971(0xe8)][_0x272971(0x123)](_0x3fcf9c['licenseKey'],_0x3fcf9c[_0x272971(0x11c)]);if(!_0x1ecd9e[_0x272971(0x12f)])throw new common_1['BadRequestException'](_0x272971(0x106));_0x3fcf9c[_0x272971(0x104)]=![];const _0x337967=await this[_0x272971(0xe8)][_0x272971(0xe7)](_0x3a6714,_0x3fcf9c);return(0x0,setting_mapper_1[_0x272971(0xf0)])(_0x337967,_0x1ecd9e[_0x272971(0x10b)]);}async['updateUserSetting'](_0x279f28,_0x381c03){const _0x2f03e4=a123_0x1dc3a8;_0x381c03['maxUser']=+_0x381c03[_0x2f03e4(0xee)];if(isNaN(_0x381c03[_0x2f03e4(0xee)]))throw new common_1['BadRequestException'](_0x2f03e4(0x115));const _0x43664a=await this[_0x2f03e4(0xe8)][_0x2f03e4(0xfc)](_0x381c03);return _0x43664a[_0x2f03e4(0x110)];}async[a123_0x1dc3a8(0x12a)](){const _0x44c280=a123_0x1dc3a8;await this[_0x44c280(0xe8)][_0x44c280(0x12a)]();}async['initalize'](){const _0x85ca8c=a123_0x1dc3a8,_0x4ca747=await this['settingService'][_0x85ca8c(0x10a)]();!_0x4ca747&&await this[_0x85ca8c(0xe8)][_0x85ca8c(0xf4)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x1dc3a8(0x119)])('/'),(0x0,common_1[a123_0x1dc3a8(0x11e)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x1dc3a8(0xef)])(role_enum_1['Role'][a123_0x1dc3a8(0x129)],role_enum_1[a123_0x1dc3a8(0x12c)][a123_0x1dc3a8(0x11a)],role_enum_1[a123_0x1dc3a8(0x12c)][a123_0x1dc3a8(0x125)]),__metadata(a123_0x1dc3a8(0x111),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x1dc3a8(0xed),Promise)],SettingController[a123_0x1dc3a8(0x127)],a123_0x1dc3a8(0x10a),null),__decorate([(0x0,common_1[a123_0x1dc3a8(0x11b)])(a123_0x1dc3a8(0x122)),(0x0,common_1[a123_0x1dc3a8(0x11e)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x1dc3a8(0xfa)]),(0x0,roles_decorator_1[a123_0x1dc3a8(0xef)])(role_enum_1['Role'][a123_0x1dc3a8(0x129)],role_enum_1[a123_0x1dc3a8(0x12c)][a123_0x1dc3a8(0x11a)]),__metadata(a123_0x1dc3a8(0x111),Function),__metadata('design:paramtypes',[]),__metadata(a123_0x1dc3a8(0xed),Promise)],SettingController[a123_0x1dc3a8(0x127)],'updateCode',null),__decorate([(0x0,common_1[a123_0x1dc3a8(0xff)])(a123_0x1dc3a8(0xf2)),(0x0,common_1[a123_0x1dc3a8(0x11e)])(jwt_guard_1[a123_0x1dc3a8(0xea)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x1dc3a8(0xef)])(role_enum_1['Role'][a123_0x1dc3a8(0x129)],role_enum_1[a123_0x1dc3a8(0x12c)][a123_0x1dc3a8(0x11a)]),__param(0x0,(0x0,common_1[a123_0x1dc3a8(0x11f)])('id')),__param(0x1,(0x0,common_1[a123_0x1dc3a8(0xec)])()),__metadata(a123_0x1dc3a8(0x111),Function),__metadata(a123_0x1dc3a8(0xfe),[String,dto_1[a123_0x1dc3a8(0x130)]]),__metadata(a123_0x1dc3a8(0xed),Promise)],SettingController[a123_0x1dc3a8(0x127)],'update',null),__decorate([(0x0,common_1['Patch'])(a123_0x1dc3a8(0xe5)),(0x0,common_1[a123_0x1dc3a8(0x11e)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a123_0x1dc3a8(0xfa)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x1dc3a8(0x12c)]['Master']),__param(0x0,(0x0,common_1[a123_0x1dc3a8(0x11f)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(a123_0x1dc3a8(0xfe),[String,user_setting_dto_1['UserSettingDto']]),__metadata(a123_0x1dc3a8(0xed),Promise)],SettingController[a123_0x1dc3a8(0x127)],a123_0x1dc3a8(0xfc),null),__decorate([(0x0,common_1['Post'])('/kill-jobs'),(0x0,common_1[a123_0x1dc3a8(0x11e)])(jwt_guard_1[a123_0x1dc3a8(0xea)],roles_guard_1[a123_0x1dc3a8(0xfa)]),(0x0,roles_decorator_1[a123_0x1dc3a8(0xef)])(role_enum_1[a123_0x1dc3a8(0x12c)][a123_0x1dc3a8(0x129)],role_enum_1[a123_0x1dc3a8(0x12c)][a123_0x1dc3a8(0x11a)]),__metadata(a123_0x1dc3a8(0x111),Function),__metadata(a123_0x1dc3a8(0xfe),[]),__metadata('design:returntype',Promise)],SettingController[a123_0x1dc3a8(0x127)],a123_0x1dc3a8(0x12a),null),SettingController=__decorate([(0x0,common_1['Controller'])(a123_0x1dc3a8(0x108)),__metadata(a123_0x1dc3a8(0xfe),[setting_service_1[a123_0x1dc3a8(0x121)]])],SettingController),exports[a123_0x1dc3a8(0xfb)]=SettingController;