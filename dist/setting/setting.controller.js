'use strict';const a123_0x4930b1=a123_0x53a6;(function(_0x3f4f39,_0x8500b5){const _0xfc94d1=a123_0x53a6,_0x49460d=_0x3f4f39();while(!![]){try{const _0x3ecfd4=-parseInt(_0xfc94d1(0x1bf))/0x1*(-parseInt(_0xfc94d1(0x1fb))/0x2)+parseInt(_0xfc94d1(0x1d1))/0x3*(-parseInt(_0xfc94d1(0x1f3))/0x4)+parseInt(_0xfc94d1(0x207))/0x5*(parseInt(_0xfc94d1(0x1c1))/0x6)+-parseInt(_0xfc94d1(0x209))/0x7*(parseInt(_0xfc94d1(0x202))/0x8)+parseInt(_0xfc94d1(0x1f0))/0x9*(parseInt(_0xfc94d1(0x1ef))/0xa)+parseInt(_0xfc94d1(0x1f8))/0xb*(-parseInt(_0xfc94d1(0x1dc))/0xc)+-parseInt(_0xfc94d1(0x1e7))/0xd*(-parseInt(_0xfc94d1(0x1e0))/0xe);if(_0x3ecfd4===_0x8500b5)break;else _0x49460d['push'](_0x49460d['shift']());}catch(_0x100629){_0x49460d['push'](_0x49460d['shift']());}}}(a123_0x4edc,0x300f4));function a123_0x53a6(_0x12862e,_0x544ba1){const _0x4edc4b=a123_0x4edc();return a123_0x53a6=function(_0x53a610,_0x556a50){_0x53a610=_0x53a610-0x1bd;let _0x3f278a=_0x4edc4b[_0x53a610];return _0x3f278a;},a123_0x53a6(_0x12862e,_0x544ba1);}var __decorate=this&&this[a123_0x4930b1(0x1cf)]||function(_0xca510,_0xc22771,_0x47d172,_0x54c7f7){const _0x500854=a123_0x4930b1;var _0x29be40=arguments[_0x500854(0x1fa)],_0x359e36=_0x29be40<0x3?_0xc22771:_0x54c7f7===null?_0x54c7f7=Object[_0x500854(0x205)](_0xc22771,_0x47d172):_0x54c7f7,_0x326eca;if(typeof Reflect===_0x500854(0x1e8)&&typeof Reflect[_0x500854(0x1c9)]===_0x500854(0x1d5))_0x359e36=Reflect[_0x500854(0x1c9)](_0xca510,_0xc22771,_0x47d172,_0x54c7f7);else{for(var _0x12d359=_0xca510[_0x500854(0x1fa)]-0x1;_0x12d359>=0x0;_0x12d359--)if(_0x326eca=_0xca510[_0x12d359])_0x359e36=(_0x29be40<0x3?_0x326eca(_0x359e36):_0x29be40>0x3?_0x326eca(_0xc22771,_0x47d172,_0x359e36):_0x326eca(_0xc22771,_0x47d172))||_0x359e36;}return _0x29be40>0x3&&_0x359e36&&Object[_0x500854(0x1eb)](_0xc22771,_0x47d172,_0x359e36),_0x359e36;},__metadata=this&&this[a123_0x4930b1(0x1e3)]||function(_0x46b577,_0x41b7c4){const _0x30a911=a123_0x4930b1;if(typeof Reflect==='object'&&typeof Reflect[_0x30a911(0x1c8)]===_0x30a911(0x1d5))return Reflect[_0x30a911(0x1c8)](_0x46b577,_0x41b7c4);},__param=this&&this['__param']||function(_0x284085,_0x57969f){return function(_0x3593f3,_0x3e193a){_0x57969f(_0x3593f3,_0x3e193a,_0x284085);};};Object[a123_0x4930b1(0x1eb)](exports,a123_0x4930b1(0x1bd),{'value':!![]}),exports['SettingController']=void 0x0;function a123_0x4edc(){const _0x19ddad=['UserSettingDto','./setting.service','../auth/guards/roles.guard','Roles','error','updateCode','metadata','decorate','create','schoolId','isValid','setting','exec','__decorate','Body','35625LgXeik','expiryDate','initalize','./dto','function','stderr','Post','JwtAuthGuard','design:type','killJobs','update','1138608CKoZpr','updateUserSetting','Param','Invalid\x20license\x20key','118762IxEfWX','prototype','design:paramtypes','__metadata','RolesGuard','log','./mappers/setting.mapper','377JHrMvU','object','@nestjs/common','Admin','defineProperty','findFirst','design:returntype','Controller','20GImJxb','1378107nMgfII','User','../auth/decorators/roles.decorator','56gJMdRw','UseGuards','data','../auth/enums/role.enum','validateLicenseKey','44pIfQsC','maxUser','length','94IKBDSQ','BadRequestException','Success\x20request\x20update\x20app\x20to\x20latest\x20version','mapSettingDocumentToDto','settingService','SettingController','licenseKey','1418512RMuCiC','/update','pm2\x20restart\x20startUI\x20startApi','getOwnPropertyDescriptor','stdin','573915kQuVFu','Role','7FRFEmy','__esModule','stdout','2939AqaAiB','Get','12QuJywz'];a123_0x4edc=function(){return _0x19ddad;};return a123_0x4edc();}const common_1=require(a123_0x4930b1(0x1e9)),setting_service_1=require(a123_0x4930b1(0x1c3)),dto_1=require(a123_0x4930b1(0x1d4)),roles_decorator_1=require(a123_0x4930b1(0x1f2)),role_enum_1=require(a123_0x4930b1(0x1f6)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a123_0x4930b1(0x1c4)),setting_mapper_1=require(a123_0x4930b1(0x1e6)),child_process_1=require('child_process'),user_setting_dto_1=require('./dto/user-setting.dto');let SettingController=class SettingController{constructor(_0x1880fa){const _0x2b8e77=a123_0x4930b1;this[_0x2b8e77(0x1ff)]=_0x1880fa,this[_0x2b8e77(0x1d3)]();}async[a123_0x4930b1(0x1ec)](){const _0x729414=a123_0x4930b1,_0xa599db=await this[_0x729414(0x1ff)][_0x729414(0x1ec)](),_0xdda40=this['settingService'][_0x729414(0x1f7)](_0xa599db['licenseKey'],_0xa599db['schoolId']);return(0x0,setting_mapper_1[_0x729414(0x1fe)])(_0xa599db,_0xdda40['expiryDate']);}async[a123_0x4930b1(0x1c7)](){const _0x12d7f8=a123_0x4930b1,_0x3ad8fc=(0x0,child_process_1[_0x12d7f8(0x1ce)])(_0x12d7f8(0x204));return console[_0x12d7f8(0x1e5)](_0x12d7f8(0x1fd)),_0x3ad8fc[_0x12d7f8(0x1be)]['on'](_0x12d7f8(0x1c6),_0x55f31b=>{console['log'](_0x55f31b);}),_0x3ad8fc[_0x12d7f8(0x206)]['on'](_0x12d7f8(0x1c6),_0x407c2b=>{const _0xa46bae=_0x12d7f8;console[_0xa46bae(0x1e5)](_0x407c2b);}),_0x3ad8fc[_0x12d7f8(0x1d6)]['on'](_0x12d7f8(0x1f5),_0x25ad39=>{const _0x354af5=_0x12d7f8;console[_0x354af5(0x1e5)](_0x25ad39);}),_0x12d7f8(0x1fd);}async[a123_0x4930b1(0x1db)](_0x2cf00a,_0x15ba34){const _0x4ea2c7=a123_0x4930b1,_0x2ea1c7=this['settingService'][_0x4ea2c7(0x1f7)](_0x15ba34[_0x4ea2c7(0x201)],_0x15ba34[_0x4ea2c7(0x1cb)]);if(!_0x2ea1c7[_0x4ea2c7(0x1cc)])throw new common_1[(_0x4ea2c7(0x1fc))](_0x4ea2c7(0x1df));_0x15ba34['isExpired']=![];const _0x9805fe=await this[_0x4ea2c7(0x1ff)]['update'](_0x2cf00a,_0x15ba34);return(0x0,setting_mapper_1[_0x4ea2c7(0x1fe)])(_0x9805fe,_0x2ea1c7[_0x4ea2c7(0x1d2)]);}async['updateUserSetting'](_0x1ee7da,_0x1e1903){const _0x19f287=a123_0x4930b1;_0x1e1903[_0x19f287(0x1f9)]=+_0x1e1903[_0x19f287(0x1f9)];if(isNaN(_0x1e1903['maxUser']))throw new common_1[(_0x19f287(0x1fc))]('Max\x20user\x20must\x20be\x20a\x20number');const _0x1e5958=await this[_0x19f287(0x1ff)][_0x19f287(0x1dd)](_0x1e1903);return _0x1e5958['userSetting'];}async[a123_0x4930b1(0x1da)](){const _0x1df1f9=a123_0x4930b1;await this[_0x1df1f9(0x1ff)][_0x1df1f9(0x1da)]();}async[a123_0x4930b1(0x1d3)](){const _0x4fd9f2=a123_0x4930b1,_0x109959=await this[_0x4fd9f2(0x1ff)][_0x4fd9f2(0x1ec)]();!_0x109959&&await this['settingService'][_0x4fd9f2(0x1ca)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a123_0x4930b1(0x1c0)])('/'),(0x0,common_1[a123_0x4930b1(0x1f4)])(jwt_guard_1[a123_0x4930b1(0x1d8)],roles_guard_1[a123_0x4930b1(0x1e4)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x4930b1(0x208)][a123_0x4930b1(0x1ea)],role_enum_1[a123_0x4930b1(0x208)][a123_0x4930b1(0x1f1)],role_enum_1[a123_0x4930b1(0x208)]['Viewer']),__metadata(a123_0x4930b1(0x1d9),Function),__metadata(a123_0x4930b1(0x1e2),[]),__metadata(a123_0x4930b1(0x1ed),Promise)],SettingController['prototype'],a123_0x4930b1(0x1ec),null),__decorate([(0x0,common_1['Post'])(a123_0x4930b1(0x203)),(0x0,common_1['UseGuards'])(jwt_guard_1[a123_0x4930b1(0x1d8)],roles_guard_1[a123_0x4930b1(0x1e4)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a123_0x4930b1(0x208)]['Admin'],role_enum_1[a123_0x4930b1(0x208)]['User']),__metadata(a123_0x4930b1(0x1d9),Function),__metadata(a123_0x4930b1(0x1e2),[]),__metadata('design:returntype',Promise)],SettingController[a123_0x4930b1(0x1e1)],'updateCode',null),__decorate([(0x0,common_1['Patch'])(':id/license'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a123_0x4930b1(0x1c5)])(role_enum_1[a123_0x4930b1(0x208)][a123_0x4930b1(0x1ea)],role_enum_1[a123_0x4930b1(0x208)]['User']),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a123_0x4930b1(0x1d0)])()),__metadata('design:type',Function),__metadata(a123_0x4930b1(0x1e2),[String,dto_1['UpdateSettingDto']]),__metadata(a123_0x4930b1(0x1ed),Promise)],SettingController[a123_0x4930b1(0x1e1)],a123_0x4930b1(0x1db),null),__decorate([(0x0,common_1['Patch'])(':id/user-setting'),(0x0,common_1[a123_0x4930b1(0x1f4)])(jwt_guard_1[a123_0x4930b1(0x1d8)],roles_guard_1[a123_0x4930b1(0x1e4)]),(0x0,roles_decorator_1[a123_0x4930b1(0x1c5)])(role_enum_1[a123_0x4930b1(0x208)]['Master']),__param(0x0,(0x0,common_1[a123_0x4930b1(0x1de)])('id')),__param(0x1,(0x0,common_1[a123_0x4930b1(0x1d0)])()),__metadata(a123_0x4930b1(0x1d9),Function),__metadata('design:paramtypes',[String,user_setting_dto_1[a123_0x4930b1(0x1c2)]]),__metadata(a123_0x4930b1(0x1ed),Promise)],SettingController[a123_0x4930b1(0x1e1)],'updateUserSetting',null),__decorate([(0x0,common_1[a123_0x4930b1(0x1d7)])('/kill-jobs'),(0x0,common_1[a123_0x4930b1(0x1f4)])(jwt_guard_1[a123_0x4930b1(0x1d8)],roles_guard_1[a123_0x4930b1(0x1e4)]),(0x0,roles_decorator_1[a123_0x4930b1(0x1c5)])(role_enum_1[a123_0x4930b1(0x208)]['Admin'],role_enum_1['Role'][a123_0x4930b1(0x1f1)]),__metadata(a123_0x4930b1(0x1d9),Function),__metadata(a123_0x4930b1(0x1e2),[]),__metadata('design:returntype',Promise)],SettingController[a123_0x4930b1(0x1e1)],a123_0x4930b1(0x1da),null),SettingController=__decorate([(0x0,common_1[a123_0x4930b1(0x1ee)])(a123_0x4930b1(0x1cd)),__metadata('design:paramtypes',[setting_service_1['SettingService']])],SettingController),exports[a123_0x4930b1(0x200)]=SettingController;