'use strict';const a120_0x186fad=a120_0x54ce;(function(_0x388272,_0x22fbb4){const _0x1736d2=a120_0x54ce,_0x825a11=_0x388272();while(!![]){try{const _0x16fa39=-parseInt(_0x1736d2(0xf6))/0x1*(-parseInt(_0x1736d2(0x104))/0x2)+parseInt(_0x1736d2(0x122))/0x3*(-parseInt(_0x1736d2(0x129))/0x4)+-parseInt(_0x1736d2(0x11c))/0x5+parseInt(_0x1736d2(0x10e))/0x6+-parseInt(_0x1736d2(0xfe))/0x7*(-parseInt(_0x1736d2(0x12b))/0x8)+parseInt(_0x1736d2(0x10c))/0x9+-parseInt(_0x1736d2(0xf1))/0xa;if(_0x16fa39===_0x22fbb4)break;else _0x825a11['push'](_0x825a11['shift']());}catch(_0x367429){_0x825a11['push'](_0x825a11['shift']());}}}(a120_0x2c39,0x665a3));function a120_0x54ce(_0x519464,_0x573f5f){const _0x2c39b6=a120_0x2c39();return a120_0x54ce=function(_0x54ced4,_0x5a1607){_0x54ced4=_0x54ced4-0xe4;let _0x31ff8d=_0x2c39b6[_0x54ced4];return _0x31ff8d;},a120_0x54ce(_0x519464,_0x573f5f);}function a120_0x2c39(){const _0x1e105f=['UpdateSettingDto','../auth/decorators/roles.decorator','/update','20703830zOpmaa','JwtAuthGuard','@nestjs/common','RolesGuard','setting','588151aDaPqX','SettingController','metadata','exec','./dto','__decorate','isExpired','getOwnPropertyDescriptor','21kXqyvW','Body','mapSettingDocumentToDto','__esModule','User','Get','2eQSXDL','stdin',':id/license','decorate','update','Post','error','Invalid\x20license\x20key','6589566teRhNF','updateCode','4814928zRcHwH','UseGuards','stderr','function','Master','Patch','Viewer','defineProperty','Controller','maxUser','__metadata','killJobs','/kill-jobs','findFirst','1479655PqZOHj','Success\x20request\x20update\x20app\x20to\x20latest\x20version','log','Admin','../auth/guards/roles.guard','object','3OyNZzp','expiryDate','BadRequestException','pm2\x20restart\x20startUI\x20startApi','SettingService','length','prototype','659292HYqVLU','create','2206824aZTyvv','Role','design:paramtypes','settingService','./mappers/setting.mapper','licenseKey',':id/user-setting','design:returntype','initalize','isValid','updateUserSetting','validateLicenseKey','Roles','design:type','../auth/guards/jwt.guard','Param','schoolId','./dto/user-setting.dto'];a120_0x2c39=function(){return _0x1e105f;};return a120_0x2c39();}var __decorate=this&&this[a120_0x186fad(0xfb)]||function(_0x4473e7,_0x94c746,_0x103196,_0xe0c7b1){const _0xce07c2=a120_0x186fad;var _0x11613d=arguments['length'],_0x17f2bc=_0x11613d<0x3?_0x94c746:_0xe0c7b1===null?_0xe0c7b1=Object[_0xce07c2(0xfd)](_0x94c746,_0x103196):_0xe0c7b1,_0x4bf9b7;if(typeof Reflect===_0xce07c2(0x121)&&typeof Reflect[_0xce07c2(0x107)]===_0xce07c2(0x111))_0x17f2bc=Reflect['decorate'](_0x4473e7,_0x94c746,_0x103196,_0xe0c7b1);else{for(var _0x1ccaab=_0x4473e7[_0xce07c2(0x127)]-0x1;_0x1ccaab>=0x0;_0x1ccaab--)if(_0x4bf9b7=_0x4473e7[_0x1ccaab])_0x17f2bc=(_0x11613d<0x3?_0x4bf9b7(_0x17f2bc):_0x11613d>0x3?_0x4bf9b7(_0x94c746,_0x103196,_0x17f2bc):_0x4bf9b7(_0x94c746,_0x103196))||_0x17f2bc;}return _0x11613d>0x3&&_0x17f2bc&&Object['defineProperty'](_0x94c746,_0x103196,_0x17f2bc),_0x17f2bc;},__metadata=this&&this[a120_0x186fad(0x118)]||function(_0x310814,_0x341f23){const _0x14baf8=a120_0x186fad;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x14baf8(0x111))return Reflect[_0x14baf8(0xf8)](_0x310814,_0x341f23);},__param=this&&this['__param']||function(_0x3bc048,_0x5df0eb){return function(_0x1bd73a,_0x5eec0b){_0x5df0eb(_0x1bd73a,_0x5eec0b,_0x3bc048);};};Object[a120_0x186fad(0x115)](exports,a120_0x186fad(0x101),{'value':!![]}),exports['SettingController']=void 0x0;const common_1=require(a120_0x186fad(0xf3)),setting_service_1=require('./setting.service'),dto_1=require(a120_0x186fad(0xfa)),roles_decorator_1=require(a120_0x186fad(0xef)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a120_0x186fad(0xea)),roles_guard_1=require(a120_0x186fad(0x120)),setting_mapper_1=require(a120_0x186fad(0x12f)),child_process_1=require('child_process'),user_setting_dto_1=require(a120_0x186fad(0xed));let SettingController=class SettingController{constructor(_0x11a154){const _0x44d4c4=a120_0x186fad;this[_0x44d4c4(0x12e)]=_0x11a154,this[_0x44d4c4(0xe4)]();}async[a120_0x186fad(0x11b)](){const _0x38870f=a120_0x186fad,_0x5dbd0a=await this[_0x38870f(0x12e)][_0x38870f(0x11b)](),_0x34ca3a=this[_0x38870f(0x12e)][_0x38870f(0xe7)](_0x5dbd0a['licenseKey'],_0x5dbd0a[_0x38870f(0xec)]);return(0x0,setting_mapper_1['mapSettingDocumentToDto'])(_0x5dbd0a,_0x34ca3a[_0x38870f(0x123)]);}async[a120_0x186fad(0x10d)](){const _0x512e32=a120_0x186fad,_0x33476e=(0x0,child_process_1[_0x512e32(0xf9)])(_0x512e32(0x125));return console[_0x512e32(0x11e)](_0x512e32(0x11d)),_0x33476e['stdout']['on'](_0x512e32(0x10a),_0x5ee757=>{const _0x3ab35f=_0x512e32;console[_0x3ab35f(0x11e)](_0x5ee757);}),_0x33476e[_0x512e32(0x105)]['on']('error',_0x3bd10e=>{const _0x343398=_0x512e32;console[_0x343398(0x11e)](_0x3bd10e);}),_0x33476e[_0x512e32(0x110)]['on']('data',_0x2bfc8a=>{const _0x163619=_0x512e32;console[_0x163619(0x11e)](_0x2bfc8a);}),_0x512e32(0x11d);}async['update'](_0x30e214,_0x163d6d){const _0x1d16df=a120_0x186fad,_0x172216=this[_0x1d16df(0x12e)]['validateLicenseKey'](_0x163d6d[_0x1d16df(0x130)],_0x163d6d['schoolId']);if(!_0x172216[_0x1d16df(0xe5)])throw new common_1['BadRequestException'](_0x1d16df(0x10b));_0x163d6d[_0x1d16df(0xfc)]=![];const _0x6e8fc2=await this[_0x1d16df(0x12e)][_0x1d16df(0x108)](_0x30e214,_0x163d6d);return(0x0,setting_mapper_1[_0x1d16df(0x100)])(_0x6e8fc2,_0x172216[_0x1d16df(0x123)]);}async[a120_0x186fad(0xe6)](_0x19b4f2,_0x2d9572){const _0x59620c=a120_0x186fad;_0x2d9572[_0x59620c(0x117)]=+_0x2d9572[_0x59620c(0x117)];if(isNaN(_0x2d9572[_0x59620c(0x117)]))throw new common_1[(_0x59620c(0x124))]('Max\x20user\x20must\x20be\x20a\x20number');const _0x174e42=await this['settingService'][_0x59620c(0xe6)](_0x2d9572);return _0x174e42['userSetting'];}async[a120_0x186fad(0x119)](){const _0x541b8b=a120_0x186fad;await this[_0x541b8b(0x12e)][_0x541b8b(0x119)]();}async[a120_0x186fad(0xe4)](){const _0x5d0d68=a120_0x186fad,_0xce0011=await this[_0x5d0d68(0x12e)][_0x5d0d68(0x11b)]();!_0xce0011&&await this[_0x5d0d68(0x12e)][_0x5d0d68(0x12a)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a120_0x186fad(0x103)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x186fad(0xf2)],roles_guard_1[a120_0x186fad(0xf4)]),(0x0,roles_decorator_1[a120_0x186fad(0xe8)])(role_enum_1[a120_0x186fad(0x12c)][a120_0x186fad(0x11f)],role_enum_1[a120_0x186fad(0x12c)][a120_0x186fad(0x102)],role_enum_1[a120_0x186fad(0x12c)][a120_0x186fad(0x114)]),__metadata(a120_0x186fad(0xe9),Function),__metadata(a120_0x186fad(0x12d),[]),__metadata(a120_0x186fad(0x132),Promise)],SettingController[a120_0x186fad(0x128)],a120_0x186fad(0x11b),null),__decorate([(0x0,common_1[a120_0x186fad(0x109)])(a120_0x186fad(0xf0)),(0x0,common_1[a120_0x186fad(0x10f)])(jwt_guard_1[a120_0x186fad(0xf2)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x186fad(0xe8)])(role_enum_1[a120_0x186fad(0x12c)]['Admin'],role_enum_1[a120_0x186fad(0x12c)][a120_0x186fad(0x102)]),__metadata(a120_0x186fad(0xe9),Function),__metadata('design:paramtypes',[]),__metadata(a120_0x186fad(0x132),Promise)],SettingController[a120_0x186fad(0x128)],a120_0x186fad(0x10d),null),__decorate([(0x0,common_1[a120_0x186fad(0x113)])(a120_0x186fad(0x106)),(0x0,common_1[a120_0x186fad(0x10f)])(jwt_guard_1[a120_0x186fad(0xf2)],roles_guard_1[a120_0x186fad(0xf4)]),(0x0,roles_decorator_1[a120_0x186fad(0xe8)])(role_enum_1['Role'][a120_0x186fad(0x11f)],role_enum_1['Role'][a120_0x186fad(0x102)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a120_0x186fad(0xff)])()),__metadata('design:type',Function),__metadata(a120_0x186fad(0x12d),[String,dto_1[a120_0x186fad(0xee)]]),__metadata(a120_0x186fad(0x132),Promise)],SettingController[a120_0x186fad(0x128)],a120_0x186fad(0x108),null),__decorate([(0x0,common_1[a120_0x186fad(0x113)])(a120_0x186fad(0x131)),(0x0,common_1[a120_0x186fad(0x10f)])(jwt_guard_1[a120_0x186fad(0xf2)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x186fad(0xe8)])(role_enum_1[a120_0x186fad(0x12c)][a120_0x186fad(0x112)]),__param(0x0,(0x0,common_1[a120_0x186fad(0xeb)])('id')),__param(0x1,(0x0,common_1[a120_0x186fad(0xff)])()),__metadata('design:type',Function),__metadata(a120_0x186fad(0x12d),[String,user_setting_dto_1['UserSettingDto']]),__metadata(a120_0x186fad(0x132),Promise)],SettingController[a120_0x186fad(0x128)],a120_0x186fad(0xe6),null),__decorate([(0x0,common_1['Post'])(a120_0x186fad(0x11a)),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x186fad(0xf2)],roles_guard_1[a120_0x186fad(0xf4)]),(0x0,roles_decorator_1[a120_0x186fad(0xe8)])(role_enum_1['Role'][a120_0x186fad(0x11f)],role_enum_1[a120_0x186fad(0x12c)][a120_0x186fad(0x102)]),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],SettingController[a120_0x186fad(0x128)],a120_0x186fad(0x119),null),SettingController=__decorate([(0x0,common_1[a120_0x186fad(0x116)])(a120_0x186fad(0xf5)),__metadata(a120_0x186fad(0x12d),[setting_service_1[a120_0x186fad(0x126)]])],SettingController),exports[a120_0x186fad(0xf7)]=SettingController;