'use strict';const a120_0x543686=a120_0x47df;function a120_0x47df(_0x54717c,_0x54e870){const _0x5a9c4f=a120_0x5a9c();return a120_0x47df=function(_0x47df30,_0x550409){_0x47df30=_0x47df30-0x18a;let _0x2e89a9=_0x5a9c4f[_0x47df30];return _0x2e89a9;},a120_0x47df(_0x54717c,_0x54e870);}(function(_0x4499bf,_0x2f01ab){const _0x7e92b4=a120_0x47df,_0x3cd88c=_0x4499bf();while(!![]){try{const _0x28eb5c=-parseInt(_0x7e92b4(0x19c))/0x1*(-parseInt(_0x7e92b4(0x196))/0x2)+parseInt(_0x7e92b4(0x197))/0x3+parseInt(_0x7e92b4(0x1cc))/0x4*(-parseInt(_0x7e92b4(0x1c9))/0x5)+-parseInt(_0x7e92b4(0x1c0))/0x6+parseInt(_0x7e92b4(0x195))/0x7+-parseInt(_0x7e92b4(0x1b3))/0x8*(-parseInt(_0x7e92b4(0x1be))/0x9)+-parseInt(_0x7e92b4(0x19b))/0xa;if(_0x28eb5c===_0x2f01ab)break;else _0x3cd88c['push'](_0x3cd88c['shift']());}catch(_0x11580e){_0x3cd88c['push'](_0x3cd88c['shift']());}}}(a120_0x5a9c,0xa589d));var __decorate=this&&this[a120_0x543686(0x1aa)]||function(_0x1904a2,_0xf194b1,_0x13366e,_0x27317f){const _0x4351c6=a120_0x543686;var _0x2183be=arguments[_0x4351c6(0x1bb)],_0x1a428c=_0x2183be<0x3?_0xf194b1:_0x27317f===null?_0x27317f=Object[_0x4351c6(0x19f)](_0xf194b1,_0x13366e):_0x27317f,_0x5373a4;if(typeof Reflect===_0x4351c6(0x1c8)&&typeof Reflect['decorate']===_0x4351c6(0x1a9))_0x1a428c=Reflect['decorate'](_0x1904a2,_0xf194b1,_0x13366e,_0x27317f);else{for(var _0x2be247=_0x1904a2[_0x4351c6(0x1bb)]-0x1;_0x2be247>=0x0;_0x2be247--)if(_0x5373a4=_0x1904a2[_0x2be247])_0x1a428c=(_0x2183be<0x3?_0x5373a4(_0x1a428c):_0x2183be>0x3?_0x5373a4(_0xf194b1,_0x13366e,_0x1a428c):_0x5373a4(_0xf194b1,_0x13366e))||_0x1a428c;}return _0x2183be>0x3&&_0x1a428c&&Object['defineProperty'](_0xf194b1,_0x13366e,_0x1a428c),_0x1a428c;},__metadata=this&&this[a120_0x543686(0x1a8)]||function(_0x4106f9,_0x3cf160){const _0x22e8f0=a120_0x543686;if(typeof Reflect==='object'&&typeof Reflect[_0x22e8f0(0x1cb)]===_0x22e8f0(0x1a9))return Reflect['metadata'](_0x4106f9,_0x3cf160);},__param=this&&this[a120_0x543686(0x1af)]||function(_0xf494ff,_0x5311d0){return function(_0x39988c,_0x3291b1){_0x5311d0(_0x39988c,_0x3291b1,_0xf494ff);};};function a120_0x5a9c(){const _0x416a63=['settingService','User','8106847oFIMmn','79370hvFPmm','3660633hnYOos','Role','BadRequestException','killJobs','20138450aBWGQP','19KQMjCf','update','design:paramtypes','getOwnPropertyDescriptor','Body','Admin','Param','mapSettingDocumentToDto','stdout',':id/license','SettingService','error','__metadata','function','__decorate','schoolId','../auth/enums/role.enum','Roles','validateLicenseKey','__param','../auth/decorators/roles.decorator','JwtAuthGuard','isExpired','24VmRYeZ','SettingController','./dto/user-setting.dto','initalize','../auth/guards/jwt.guard','prototype','findFirst','defineProperty','length','log','exec','2767599WLOMrD','Post','4623372qZXExW','UserSettingDto','userSetting','updateUserSetting','stderr','setting','expiryDate','__esModule','object','5VLeEVd','data','metadata','2369712WOfLay','child_process','/update','UseGuards','licenseKey','RolesGuard','maxUser','design:returntype','Patch','stdin','Get','design:type','UpdateSettingDto','../auth/guards/roles.guard','./setting.service','create','isValid'];a120_0x5a9c=function(){return _0x416a63;};return a120_0x5a9c();}Object[a120_0x543686(0x1ba)](exports,a120_0x543686(0x1c7),{'value':!![]}),exports['SettingController']=void 0x0;const common_1=require('@nestjs/common'),setting_service_1=require(a120_0x543686(0x190)),dto_1=require('./dto'),roles_decorator_1=require(a120_0x543686(0x1b0)),role_enum_1=require(a120_0x543686(0x1ac)),jwt_guard_1=require(a120_0x543686(0x1b7)),roles_guard_1=require(a120_0x543686(0x18f)),setting_mapper_1=require('./mappers/setting.mapper'),child_process_1=require(a120_0x543686(0x1cd)),user_setting_dto_1=require(a120_0x543686(0x1b5));let SettingController=class SettingController{constructor(_0x3a7af4){const _0xa74181=a120_0x543686;this['settingService']=_0x3a7af4,this[_0xa74181(0x1b6)]();}async[a120_0x543686(0x1b9)](){const _0x694b78=a120_0x543686,_0x27ba79=await this[_0x694b78(0x193)][_0x694b78(0x1b9)](),_0x1d7593=this[_0x694b78(0x193)][_0x694b78(0x1ae)](_0x27ba79['licenseKey'],_0x27ba79[_0x694b78(0x1ab)]);return(0x0,setting_mapper_1[_0x694b78(0x1a3)])(_0x27ba79,_0x1d7593['expiryDate']);}async['updateCode'](){const _0x23179a=a120_0x543686,_0x3469ac=(0x0,child_process_1[_0x23179a(0x1bd)])('pm2\x20restart\x20startUI\x20startApi');return console['log']('Success\x20request\x20update\x20app\x20to\x20latest\x20version'),_0x3469ac[_0x23179a(0x1a4)]['on'](_0x23179a(0x1a7),_0x3e87c6=>{const _0x5eca14=_0x23179a;console[_0x5eca14(0x1bc)](_0x3e87c6);}),_0x3469ac[_0x23179a(0x18b)]['on'](_0x23179a(0x1a7),_0x692de6=>{console['log'](_0x692de6);}),_0x3469ac[_0x23179a(0x1c4)]['on'](_0x23179a(0x1ca),_0x4e2c7b=>{const _0x327289=_0x23179a;console[_0x327289(0x1bc)](_0x4e2c7b);}),'Success\x20request\x20update\x20app\x20to\x20latest\x20version';}async[a120_0x543686(0x19d)](_0x2a5ca8,_0x578593){const _0xda2916=a120_0x543686,_0x28f391=this[_0xda2916(0x193)][_0xda2916(0x1ae)](_0x578593[_0xda2916(0x1d0)],_0x578593[_0xda2916(0x1ab)]);if(!_0x28f391[_0xda2916(0x192)])throw new common_1[(_0xda2916(0x199))]('Invalid\x20license\x20key');_0x578593[_0xda2916(0x1b2)]=![];const _0x345360=await this[_0xda2916(0x193)]['update'](_0x2a5ca8,_0x578593);return(0x0,setting_mapper_1[_0xda2916(0x1a3)])(_0x345360,_0x28f391[_0xda2916(0x1c6)]);}async[a120_0x543686(0x1c3)](_0x1161e4,_0x33ee41){const _0x288939=a120_0x543686;_0x33ee41[_0x288939(0x1d2)]=+_0x33ee41[_0x288939(0x1d2)];if(isNaN(_0x33ee41['maxUser']))throw new common_1[(_0x288939(0x199))]('Max\x20user\x20must\x20be\x20a\x20number');const _0x5c4c74=await this['settingService'][_0x288939(0x1c3)](_0x33ee41);return _0x5c4c74[_0x288939(0x1c2)];}async['killJobs'](){const _0x42aa7e=a120_0x543686;await this[_0x42aa7e(0x193)][_0x42aa7e(0x19a)]();}async[a120_0x543686(0x1b6)](){const _0x1ef216=a120_0x543686,_0x3a4426=await this[_0x1ef216(0x193)][_0x1ef216(0x1b9)]();!_0x3a4426&&await this[_0x1ef216(0x193)][_0x1ef216(0x191)]({'schoolId':'','licenseKey':'','isExpired':!![]});}};__decorate([(0x0,common_1[a120_0x543686(0x18c)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x543686(0x1b1)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a120_0x543686(0x1ad)])(role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x1a1)],role_enum_1['Role'][a120_0x543686(0x194)],role_enum_1[a120_0x543686(0x198)]['Viewer']),__metadata('design:type',Function),__metadata(a120_0x543686(0x19e),[]),__metadata(a120_0x543686(0x1d3),Promise)],SettingController[a120_0x543686(0x1b8)],a120_0x543686(0x1b9),null),__decorate([(0x0,common_1[a120_0x543686(0x1bf)])(a120_0x543686(0x1ce)),(0x0,common_1[a120_0x543686(0x1cf)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a120_0x543686(0x1d1)]),(0x0,roles_decorator_1[a120_0x543686(0x1ad)])(role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x1a1)],role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x194)]),__metadata(a120_0x543686(0x18d),Function),__metadata(a120_0x543686(0x19e),[]),__metadata('design:returntype',Promise)],SettingController['prototype'],'updateCode',null),__decorate([(0x0,common_1['Patch'])(a120_0x543686(0x1a5)),(0x0,common_1[a120_0x543686(0x1cf)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a120_0x543686(0x1d1)]),(0x0,roles_decorator_1[a120_0x543686(0x1ad)])(role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x1a1)],role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x194)]),__param(0x0,(0x0,common_1[a120_0x543686(0x1a2)])('id')),__param(0x1,(0x0,common_1[a120_0x543686(0x1a0)])()),__metadata('design:type',Function),__metadata(a120_0x543686(0x19e),[String,dto_1[a120_0x543686(0x18e)]]),__metadata('design:returntype',Promise)],SettingController[a120_0x543686(0x1b8)],a120_0x543686(0x19d),null),__decorate([(0x0,common_1[a120_0x543686(0x18a)])(':id/user-setting'),(0x0,common_1[a120_0x543686(0x1cf)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a120_0x543686(0x1d1)]),(0x0,roles_decorator_1[a120_0x543686(0x1ad)])(role_enum_1[a120_0x543686(0x198)]['Master']),__param(0x0,(0x0,common_1[a120_0x543686(0x1a2)])('id')),__param(0x1,(0x0,common_1[a120_0x543686(0x1a0)])()),__metadata(a120_0x543686(0x18d),Function),__metadata(a120_0x543686(0x19e),[String,user_setting_dto_1[a120_0x543686(0x1c1)]]),__metadata(a120_0x543686(0x1d3),Promise)],SettingController[a120_0x543686(0x1b8)],a120_0x543686(0x1c3),null),__decorate([(0x0,common_1[a120_0x543686(0x1bf)])('/kill-jobs'),(0x0,common_1['UseGuards'])(jwt_guard_1[a120_0x543686(0x1b1)],roles_guard_1[a120_0x543686(0x1d1)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x1a1)],role_enum_1[a120_0x543686(0x198)][a120_0x543686(0x194)]),__metadata('design:type',Function),__metadata(a120_0x543686(0x19e),[]),__metadata(a120_0x543686(0x1d3),Promise)],SettingController[a120_0x543686(0x1b8)],'killJobs',null),SettingController=__decorate([(0x0,common_1['Controller'])(a120_0x543686(0x1c5)),__metadata(a120_0x543686(0x19e),[setting_service_1[a120_0x543686(0x1a6)]])],SettingController),exports[a120_0x543686(0x1b4)]=SettingController;