'use strict';const a122_0x510d41=a122_0x4cc5;(function(_0x54ee49,_0x206749){const _0xb8ad14=a122_0x4cc5,_0x454af4=_0x54ee49();while(!![]){try{const _0x415f2f=parseInt(_0xb8ad14(0x145))/0x1*(-parseInt(_0xb8ad14(0x156))/0x2)+-parseInt(_0xb8ad14(0x178))/0x3*(parseInt(_0xb8ad14(0x166))/0x4)+parseInt(_0xb8ad14(0x153))/0x5*(parseInt(_0xb8ad14(0x16d))/0x6)+-parseInt(_0xb8ad14(0x14d))/0x7*(-parseInt(_0xb8ad14(0x14c))/0x8)+parseInt(_0xb8ad14(0x17b))/0x9+-parseInt(_0xb8ad14(0x148))/0xa+parseInt(_0xb8ad14(0x151))/0xb*(-parseInt(_0xb8ad14(0x14f))/0xc);if(_0x415f2f===_0x206749)break;else _0x454af4['push'](_0x454af4['shift']());}catch(_0x2d1c5a){_0x454af4['push'](_0x454af4['shift']());}}}(a122_0x20f7,0x5974a));var __decorate=this&&this[a122_0x510d41(0x176)]||function(_0x5eb240,_0x469235,_0xb6aa9d,_0x3fc13d){const _0x1a72fa=a122_0x510d41;var _0x2d280d=arguments[_0x1a72fa(0x147)],_0x104386=_0x2d280d<0x3?_0x469235:_0x3fc13d===null?_0x3fc13d=Object[_0x1a72fa(0x146)](_0x469235,_0xb6aa9d):_0x3fc13d,_0x55a18e;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x1a72fa(0x168))_0x104386=Reflect[_0x1a72fa(0x174)](_0x5eb240,_0x469235,_0xb6aa9d,_0x3fc13d);else{for(var _0x506aa7=_0x5eb240[_0x1a72fa(0x147)]-0x1;_0x506aa7>=0x0;_0x506aa7--)if(_0x55a18e=_0x5eb240[_0x506aa7])_0x104386=(_0x2d280d<0x3?_0x55a18e(_0x104386):_0x2d280d>0x3?_0x55a18e(_0x469235,_0xb6aa9d,_0x104386):_0x55a18e(_0x469235,_0xb6aa9d))||_0x104386;}return _0x2d280d>0x3&&_0x104386&&Object[_0x1a72fa(0x150)](_0x469235,_0xb6aa9d,_0x104386),_0x104386;},__metadata=this&&this[a122_0x510d41(0x17d)]||function(_0x596fad,_0x5fac48){const _0x5b9fab=a122_0x510d41;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x5b9fab(0x168))return Reflect[_0x5b9fab(0x172)](_0x596fad,_0x5fac48);},__param=this&&this[a122_0x510d41(0x14e)]||function(_0x182df2,_0x23aa02){return function(_0x2f23a3,_0x8fe1c3){_0x23aa02(_0x2f23a3,_0x8fe1c3,_0x182df2);};};function a122_0x4cc5(_0x5cef4c,_0x637ccd){const _0x20f77a=a122_0x20f7();return a122_0x4cc5=function(_0x4cc50d,_0xa4b16d){_0x4cc50d=_0x4cc50d-0x144;let _0x4d1e5e=_0x20f77a[_0x4cc50d];return _0x4d1e5e;},a122_0x4cc5(_0x5cef4c,_0x637ccd);}Object[a122_0x510d41(0x150)](exports,a122_0x510d41(0x17e),{'value':!![]}),exports[a122_0x510d41(0x16c)]=void 0x0;const common_1=require(a122_0x510d41(0x17c)),mongoose_1=require(a122_0x510d41(0x175)),mongoose_2=require('mongoose'),CryptoJS=require(a122_0x510d41(0x16b)),dayjs=require(a122_0x510d41(0x14a)),crypto_1=require(a122_0x510d41(0x16f)),job_1=require(a122_0x510d41(0x164)),constants_1=require(a122_0x510d41(0x144)),SECRET='QVBFVFVMT1NCQQ==';function a122_0x20f7(){const _0x284e51=['decorate','@nestjs/mongoose','__decorate','validTo','1545HTlgvu','enc','toObject','3441204IbtePV','@nestjs/common','__metadata','__esModule','killJobs','./constants','3494TIiUhy','getOwnPropertyDescriptor','length','1803410NcAROi','decrypt','dayjs','DEFAULT_MAX_USER','112hwrcdL','301385HcTUKd','__param','227988ZPrDqX','defineProperty','77kRNYPe','design:paramtypes','175zBRTTX','validateLicenseKey','Setting','76oKOTLU','findFirst','DD/MM/YYYY','updateUserSetting','findByIdAndUpdate','Injectable','userSetting','Base64','updateExpiryStatus','find','create','PROCESS_CACHE','save','update','../common/job','Model','1404YocNMc','_id','function','InjectModel','assign','crypto-js','SettingService','1398nyvlmZ','schoolId','../common/crypto','licenseKey','toString','metadata','settingModel'];a122_0x20f7=function(){return _0x284e51;};return a122_0x20f7();}let SettingService=class SettingService{constructor(_0x4091d8){const _0x39f43c=a122_0x510d41;this[_0x39f43c(0x173)]=_0x4091d8;}async[a122_0x510d41(0x160)](_0x2014ed){const _0x4ea557=a122_0x510d41,_0x6496d9=new this['settingModel'](_0x2014ed);return _0x6496d9[_0x4ea557(0x162)]();}async['findFirst'](){const _0xae8e5e=a122_0x510d41;var _0x23749b,_0x30c27e;const _0xa3155e=await this[_0xae8e5e(0x173)][_0xae8e5e(0x15f)]()['exec'](),_0x557280=_0xa3155e[0x0][_0xae8e5e(0x17a)]();return Object[_0xae8e5e(0x16a)](Object[_0xae8e5e(0x16a)]({},_0x557280),{'userSetting':Object[_0xae8e5e(0x16a)](Object[_0xae8e5e(0x16a)]({},_0x557280[_0xae8e5e(0x15c)]),{'maxUser':(_0x30c27e=(_0x23749b=_0x557280[_0xae8e5e(0x15c)])===null||_0x23749b===void 0x0?void 0x0:_0x23749b['maxUser'])!==null&&_0x30c27e!==void 0x0?_0x30c27e:constants_1[_0xae8e5e(0x14b)]})});}async[a122_0x510d41(0x163)](_0x346332,_0x37c54b){const _0x4ffb7f=a122_0x510d41,_0x4b2a59=await this[_0x4ffb7f(0x173)][_0x4ffb7f(0x15a)](_0x346332,Object[_0x4ffb7f(0x16a)](Object['assign']({},_0x37c54b),{'updatedAtUtc':new Date()}),{'new':!![]})['exec']();return _0x4b2a59;}async[a122_0x510d41(0x15e)](){const _0x28427b=a122_0x510d41,_0x37b346=await this[_0x28427b(0x157)](),_0x29ed56=this['validateLicenseKey'](_0x37b346[_0x28427b(0x170)],_0x37b346[_0x28427b(0x16e)]);return this[_0x28427b(0x163)](_0x37b346[_0x28427b(0x167)],{'isExpired':!_0x29ed56['isValid']});}async[a122_0x510d41(0x159)](_0x182495){const _0x481d15=a122_0x510d41,_0x1705fc=await this[_0x481d15(0x157)]();return console['log'](_0x1705fc,'setting'),this[_0x481d15(0x163)](_0x1705fc['_id'],{'userSetting':_0x182495});}[a122_0x510d41(0x154)](_0x24b379,_0x5633db){const _0x14a319=a122_0x510d41;try{if(!_0x24b379)return{'isValid':![],'expiryDate':''};const _0x2d5e3a=(0x0,crypto_1[_0x14a319(0x149)])(_0x24b379,CryptoJS[_0x14a319(0x179)][_0x14a319(0x15d)]['parse'](SECRET)[_0x14a319(0x171)](CryptoJS['enc']['Utf8']));if(_0x2d5e3a['schoolId']!==_0x5633db)return{'isValid':![],'expiryDate':''};const _0x400cae=dayjs(_0x2d5e3a['validFrom'],_0x14a319(0x158))['toDate'](),_0x207be4=dayjs(_0x2d5e3a[_0x14a319(0x177)],_0x14a319(0x158))['toDate'](),_0x59426c=dayjs()['toDate']();if(_0x59426c<_0x400cae||_0x59426c>_0x207be4)return{'isValid':![],'expiryDate':_0x2d5e3a[_0x14a319(0x177)]};return{'isValid':!![],'expiryDate':_0x2d5e3a['validTo']};}catch(_0x432ca4){return{'isValid':![],'expiryDate':''};}}async[a122_0x510d41(0x17f)](){const _0x3fe8e3=a122_0x510d41;job_1[_0x3fe8e3(0x161)]['killAll']();}};SettingService=__decorate([(0x0,common_1[a122_0x510d41(0x15b)])(),__param(0x0,(0x0,mongoose_1[a122_0x510d41(0x169)])(a122_0x510d41(0x155))),__metadata(a122_0x510d41(0x152),[mongoose_2[a122_0x510d41(0x165)]])],SettingService),exports[a122_0x510d41(0x16c)]=SettingService;