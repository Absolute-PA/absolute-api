'use strict';const a122_0xe79e63=a122_0x21b5;(function(_0x447988,_0x85800e){const _0x5cdd9b=a122_0x21b5,_0xf10ed3=_0x447988();while(!![]){try{const _0x35ff2b=-parseInt(_0x5cdd9b(0x10d))/0x1*(-parseInt(_0x5cdd9b(0xf8))/0x2)+-parseInt(_0x5cdd9b(0xf0))/0x3*(-parseInt(_0x5cdd9b(0x104))/0x4)+parseInt(_0x5cdd9b(0xff))/0x5+parseInt(_0x5cdd9b(0x116))/0x6+-parseInt(_0x5cdd9b(0xef))/0x7*(-parseInt(_0x5cdd9b(0x110))/0x8)+-parseInt(_0x5cdd9b(0x112))/0x9*(-parseInt(_0x5cdd9b(0xf9))/0xa)+parseInt(_0x5cdd9b(0xfc))/0xb*(-parseInt(_0x5cdd9b(0x103))/0xc);if(_0x35ff2b===_0x85800e)break;else _0xf10ed3['push'](_0xf10ed3['shift']());}catch(_0x168dd6){_0xf10ed3['push'](_0xf10ed3['shift']());}}}(a122_0xd04e,0x89b13));var __decorate=this&&this[a122_0xe79e63(0xe9)]||function(_0x3fe49a,_0x5d437d,_0xd0f5e5,_0xf1fcc7){const _0x34a3ac=a122_0xe79e63;var _0x52461b=arguments['length'],_0x5341=_0x52461b<0x3?_0x5d437d:_0xf1fcc7===null?_0xf1fcc7=Object[_0x34a3ac(0x101)](_0x5d437d,_0xd0f5e5):_0xf1fcc7,_0x85ea02;if(typeof Reflect===_0x34a3ac(0x102)&&typeof Reflect[_0x34a3ac(0xe0)]===_0x34a3ac(0xea))_0x5341=Reflect[_0x34a3ac(0xe0)](_0x3fe49a,_0x5d437d,_0xd0f5e5,_0xf1fcc7);else{for(var _0xb4ee71=_0x3fe49a[_0x34a3ac(0xf7)]-0x1;_0xb4ee71>=0x0;_0xb4ee71--)if(_0x85ea02=_0x3fe49a[_0xb4ee71])_0x5341=(_0x52461b<0x3?_0x85ea02(_0x5341):_0x52461b>0x3?_0x85ea02(_0x5d437d,_0xd0f5e5,_0x5341):_0x85ea02(_0x5d437d,_0xd0f5e5))||_0x5341;}return _0x52461b>0x3&&_0x5341&&Object[_0x34a3ac(0x10f)](_0x5d437d,_0xd0f5e5,_0x5341),_0x5341;},__metadata=this&&this[a122_0xe79e63(0x114)]||function(_0x5daf9d,_0x45c58a){const _0x5aecc3=a122_0xe79e63;if(typeof Reflect===_0x5aecc3(0x102)&&typeof Reflect[_0x5aecc3(0x107)]===_0x5aecc3(0xea))return Reflect[_0x5aecc3(0x107)](_0x5daf9d,_0x45c58a);},__param=this&&this['__param']||function(_0x5b5aa2,_0x3cee3d){return function(_0x4db884,_0x9c9d5){_0x3cee3d(_0x4db884,_0x9c9d5,_0x5b5aa2);};};function a122_0x21b5(_0x2d933d,_0x4237da){const _0xd04e3e=a122_0xd04e();return a122_0x21b5=function(_0x21b5a3,_0x435c6a){_0x21b5a3=_0x21b5a3-0xde;let _0x5d5cf3=_0xd04e3e[_0x21b5a3];return _0x5d5cf3;},a122_0x21b5(_0x2d933d,_0x4237da);}Object[a122_0xe79e63(0x10f)](exports,'__esModule',{'value':!![]}),exports[a122_0xe79e63(0xfa)]=void 0x0;const common_1=require(a122_0xe79e63(0xfb)),mongoose_1=require(a122_0xe79e63(0xf2)),mongoose_2=require(a122_0xe79e63(0xfd)),CryptoJS=require(a122_0xe79e63(0x100)),dayjs=require(a122_0xe79e63(0x10e)),crypto_1=require(a122_0xe79e63(0x111)),job_1=require(a122_0xe79e63(0x106)),constants_1=require('./constants'),SECRET=a122_0xe79e63(0xed);let SettingService=class SettingService{constructor(_0x29db9e){const _0x4a5457=a122_0xe79e63;this[_0x4a5457(0xec)]=_0x29db9e;}async[a122_0xe79e63(0xf4)](_0x188652){const _0x10958b=a122_0xe79e63,_0x1963be=new this[(_0x10958b(0xec))](_0x188652);return _0x1963be['save']();}async['findFirst'](){const _0x22abfc=a122_0xe79e63;var _0x2c6d96,_0x2dda87,_0x32bc22;const _0x433b20=await this[_0x22abfc(0xec)]['find']()['exec'](),_0x4bf2b3=(_0x2c6d96=_0x433b20[0x0])===null||_0x2c6d96===void 0x0?void 0x0:_0x2c6d96[_0x22abfc(0xf6)]();if(!_0x4bf2b3)return;return Object[_0x22abfc(0xde)](Object[_0x22abfc(0xde)]({},_0x4bf2b3),{'userSetting':Object['assign'](Object[_0x22abfc(0xde)]({},_0x4bf2b3['userSetting']),{'maxUser':(_0x32bc22=(_0x2dda87=_0x4bf2b3['userSetting'])===null||_0x2dda87===void 0x0?void 0x0:_0x2dda87[_0x22abfc(0xe4)])!==null&&_0x32bc22!==void 0x0?_0x32bc22:constants_1[_0x22abfc(0x118)]})});}async[a122_0xe79e63(0xe5)](_0x42482e,_0x587717){const _0x15bbd1=a122_0xe79e63,_0x2b6127=await this[_0x15bbd1(0xec)][_0x15bbd1(0xeb)](_0x42482e,Object[_0x15bbd1(0xde)](Object[_0x15bbd1(0xde)]({},_0x587717),{'updatedAtUtc':new Date()}),{'new':!![]})['exec']();return _0x2b6127;}async['updateExpiryStatus'](){const _0x1a65e4=a122_0xe79e63,_0x2c6264=await this[_0x1a65e4(0x113)](),_0x5b46ed=this['validateLicenseKey'](_0x2c6264[_0x1a65e4(0x10b)],_0x2c6264[_0x1a65e4(0xe3)]);return this[_0x1a65e4(0xe5)](_0x2c6264[_0x1a65e4(0x10a)],{'isExpired':!_0x5b46ed[_0x1a65e4(0xe2)]});}async['updateUserSetting'](_0x286f79){const _0x29f8b9=a122_0xe79e63,_0x551690=await this[_0x29f8b9(0x113)]();return console[_0x29f8b9(0xee)](_0x551690,_0x29f8b9(0xdf)),this[_0x29f8b9(0xe5)](_0x551690['_id'],{'userSetting':_0x286f79});}[a122_0xe79e63(0xf1)](_0x3cfd72,_0x476a14){const _0x47b74f=a122_0xe79e63;try{if(!_0x3cfd72)return{'isValid':![],'expiryDate':''};const _0x1db9f9=(0x0,crypto_1[_0x47b74f(0x115)])(_0x3cfd72,CryptoJS[_0x47b74f(0x117)][_0x47b74f(0xe1)]['parse'](SECRET)['toString'](CryptoJS[_0x47b74f(0x117)]['Utf8']));if(_0x1db9f9[_0x47b74f(0xe3)]!==_0x476a14)return{'isValid':![],'expiryDate':''};const _0xb2b1cf=dayjs(_0x1db9f9[_0x47b74f(0xe7)],_0x47b74f(0x10c))[_0x47b74f(0x108)](),_0x297d54=dayjs(_0x1db9f9['validTo'],'DD/MM/YYYY')['toDate'](),_0x426772=dayjs()[_0x47b74f(0x108)]();if(_0x426772<_0xb2b1cf||_0x426772>_0x297d54)return{'isValid':![],'expiryDate':_0x1db9f9[_0x47b74f(0xfe)]};return{'isValid':!![],'expiryDate':_0x1db9f9[_0x47b74f(0xfe)]};}catch(_0xf9ed07){return{'isValid':![],'expiryDate':''};}}async[a122_0xe79e63(0x105)](){const _0x338061=a122_0xe79e63;job_1[_0x338061(0xe6)][_0x338061(0xf5)]();}};SettingService=__decorate([(0x0,common_1[a122_0xe79e63(0xe8)])(),__param(0x0,(0x0,mongoose_1[a122_0xe79e63(0xf3)])(a122_0xe79e63(0x109))),__metadata('design:paramtypes',[mongoose_2['Model']])],SettingService),exports['SettingService']=SettingService;function a122_0xd04e(){const _0x427c58=['killAll','toObject','length','116qpKIzp','20DhgEze','SettingService','@nestjs/common','25234uABIqH','mongoose','validTo','1443525ARXGjb','crypto-js','getOwnPropertyDescriptor','object','11304ZesnnI','4qHrhkt','killJobs','../common/job','metadata','toDate','Setting','_id','licenseKey','DD/MM/YYYY','1754rUvcsN','dayjs','defineProperty','7856XlonFT','../common/crypto','2784519AEOQsM','findFirst','__metadata','decrypt','2773560rxPXTA','enc','DEFAULT_MAX_USER','assign','setting','decorate','Base64','isValid','schoolId','maxUser','update','PROCESS_CACHE','validFrom','Injectable','__decorate','function','findByIdAndUpdate','settingModel','QVBFVFVMT1NCQQ==','log','7679qiHifX','528606LHwyTV','validateLicenseKey','@nestjs/mongoose','InjectModel','create'];a122_0xd04e=function(){return _0x427c58;};return a122_0xd04e();}