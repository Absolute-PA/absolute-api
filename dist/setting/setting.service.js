'use strict';const a125_0x32c7a7=a125_0x4d4c;(function(_0x5aa0b1,_0x59b3e4){const _0x121437=a125_0x4d4c,_0x299a5f=_0x5aa0b1();while(!![]){try{const _0x19618d=-parseInt(_0x121437(0x11a))/0x1*(-parseInt(_0x121437(0x107))/0x2)+parseInt(_0x121437(0x10f))/0x3+-parseInt(_0x121437(0x100))/0x4+-parseInt(_0x121437(0xf4))/0x5+parseInt(_0x121437(0xff))/0x6+parseInt(_0x121437(0x10d))/0x7*(parseInt(_0x121437(0xf9))/0x8)+-parseInt(_0x121437(0xf5))/0x9;if(_0x19618d===_0x59b3e4)break;else _0x299a5f['push'](_0x299a5f['shift']());}catch(_0x4b6975){_0x299a5f['push'](_0x299a5f['shift']());}}}(a125_0x5341,0xc84f3));function a125_0x4d4c(_0x164acb,_0x9dfd84){const _0x53419f=a125_0x5341();return a125_0x4d4c=function(_0x4d4c0e,_0xe83371){_0x4d4c0e=_0x4d4c0e-0xe6;let _0x4b52b4=_0x53419f[_0x4d4c0e];return _0x4b52b4;},a125_0x4d4c(_0x164acb,_0x9dfd84);}var __decorate=this&&this[a125_0x32c7a7(0xec)]||function(_0x182b7c,_0x1c37ff,_0x4c231b,_0x4964cc){const _0x4150b6=a125_0x32c7a7;var _0x566468=arguments[_0x4150b6(0xfe)],_0x2e284f=_0x566468<0x3?_0x1c37ff:_0x4964cc===null?_0x4964cc=Object[_0x4150b6(0x10a)](_0x1c37ff,_0x4c231b):_0x4964cc,_0x2e7c0e;if(typeof Reflect==='object'&&typeof Reflect[_0x4150b6(0xef)]===_0x4150b6(0x10b))_0x2e284f=Reflect[_0x4150b6(0xef)](_0x182b7c,_0x1c37ff,_0x4c231b,_0x4964cc);else{for(var _0x173bf3=_0x182b7c[_0x4150b6(0xfe)]-0x1;_0x173bf3>=0x0;_0x173bf3--)if(_0x2e7c0e=_0x182b7c[_0x173bf3])_0x2e284f=(_0x566468<0x3?_0x2e7c0e(_0x2e284f):_0x566468>0x3?_0x2e7c0e(_0x1c37ff,_0x4c231b,_0x2e284f):_0x2e7c0e(_0x1c37ff,_0x4c231b))||_0x2e284f;}return _0x566468>0x3&&_0x2e284f&&Object[_0x4150b6(0x113)](_0x1c37ff,_0x4c231b,_0x2e284f),_0x2e284f;},__metadata=this&&this[a125_0x32c7a7(0x109)]||function(_0x201707,_0x41700a){const _0x3f1cd9=a125_0x32c7a7;if(typeof Reflect===_0x3f1cd9(0xea)&&typeof Reflect[_0x3f1cd9(0xf8)]===_0x3f1cd9(0x10b))return Reflect['metadata'](_0x201707,_0x41700a);},__param=this&&this[a125_0x32c7a7(0x101)]||function(_0x24921d,_0x221d1c){return function(_0x12d267,_0x419481){_0x221d1c(_0x12d267,_0x419481,_0x24921d);};};Object[a125_0x32c7a7(0x113)](exports,'__esModule',{'value':!![]}),exports['SettingService']=void 0x0;const common_1=require(a125_0x32c7a7(0xe9)),mongoose_1=require(a125_0x32c7a7(0x108)),mongoose_2=require(a125_0x32c7a7(0x11b)),CryptoJS=require(a125_0x32c7a7(0xe6)),dayjs=require(a125_0x32c7a7(0xe7)),crypto_1=require('../common/crypto'),job_1=require(a125_0x32c7a7(0x119)),constants_1=require(a125_0x32c7a7(0x11f)),SECRET=a125_0x32c7a7(0xf0);let SettingService=class SettingService{constructor(_0x34970f){const _0x5eddfc=a125_0x32c7a7;this[_0x5eddfc(0xfb)]=_0x34970f;}async[a125_0x32c7a7(0xfd)](_0x2b7364){const _0x45bef7=a125_0x32c7a7,_0x134a18=new this[(_0x45bef7(0xfb))](_0x2b7364);return _0x134a18['save']();}async[a125_0x32c7a7(0x103)](){const _0x52e3a5=a125_0x32c7a7;var _0x27fbf8,_0x5691b0,_0x337e0e;const _0xb02134=await this['settingModel']['find']()['exec'](),_0x51dd3b=(_0x27fbf8=_0xb02134[0x0])===null||_0x27fbf8===void 0x0?void 0x0:_0x27fbf8[_0x52e3a5(0xf6)]();if(!_0x51dd3b)return;return Object[_0x52e3a5(0x112)](Object[_0x52e3a5(0x112)]({},_0x51dd3b),{'userSetting':Object[_0x52e3a5(0x112)](Object[_0x52e3a5(0x112)]({},_0x51dd3b[_0x52e3a5(0x111)]),{'maxUser':(_0x337e0e=(_0x5691b0=_0x51dd3b[_0x52e3a5(0x111)])===null||_0x5691b0===void 0x0?void 0x0:_0x5691b0[_0x52e3a5(0x106)])!==null&&_0x337e0e!==void 0x0?_0x337e0e:constants_1[_0x52e3a5(0x115)]})});}async[a125_0x32c7a7(0x104)](_0x349826,_0x3f0224){const _0x44fd25=a125_0x32c7a7,_0x1726a8=await this[_0x44fd25(0xfb)][_0x44fd25(0xf3)](_0x349826,Object['assign'](Object[_0x44fd25(0x112)]({},_0x3f0224),{'updatedAtUtc':new Date()}),{'new':!![]})['exec']();return _0x1726a8;}async[a125_0x32c7a7(0xf2)](){const _0x32d42f=a125_0x32c7a7,_0x829619=await this['findFirst'](),_0x16cc38=this[_0x32d42f(0x10c)](_0x829619[_0x32d42f(0xf1)],_0x829619[_0x32d42f(0xfa)]);return this['update'](_0x829619[_0x32d42f(0xf7)],{'isExpired':!_0x16cc38[_0x32d42f(0x11e)]});}async[a125_0x32c7a7(0x114)](_0x15c80c){const _0x40c2b7=a125_0x32c7a7,_0x2585f6=await this[_0x40c2b7(0x103)]();return console[_0x40c2b7(0x118)](_0x2585f6,_0x40c2b7(0x10e)),this[_0x40c2b7(0x104)](_0x2585f6['_id'],{'userSetting':_0x15c80c});}['validateLicenseKey'](_0x5c98e3,_0x222757){const _0x2e81f1=a125_0x32c7a7;try{if(!_0x5c98e3)return{'isValid':![],'expiryDate':''};const _0x33b870=(0x0,crypto_1[_0x2e81f1(0xeb)])(_0x5c98e3,CryptoJS['enc']['Base64']['parse'](SECRET)[_0x2e81f1(0x11d)](CryptoJS['enc']['Utf8']));if(_0x33b870[_0x2e81f1(0xfa)]!==_0x222757)return{'isValid':![],'expiryDate':''};const _0x2eb29d=dayjs(_0x33b870['validFrom'],'DD/MM/YYYY')[_0x2e81f1(0xe8)](),_0x2e2259=dayjs(_0x33b870[_0x2e81f1(0xed)],_0x2e81f1(0xee))[_0x2e81f1(0xe8)](),_0x3d797e=dayjs()['toDate']();if(_0x3d797e<_0x2eb29d||_0x3d797e>_0x2e2259)return{'isValid':![],'expiryDate':_0x33b870[_0x2e81f1(0xed)]};return{'isValid':!![],'expiryDate':_0x33b870[_0x2e81f1(0xed)]};}catch(_0x499d9b){return{'isValid':![],'expiryDate':''};}}async[a125_0x32c7a7(0x116)](){const _0x391cd6=a125_0x32c7a7;job_1['PROCESS_CACHE'][_0x391cd6(0xfc)]();}};SettingService=__decorate([(0x0,common_1[a125_0x32c7a7(0x11c)])(),__param(0x0,(0x0,mongoose_1[a125_0x32c7a7(0x102)])('Setting')),__metadata(a125_0x32c7a7(0x117),[mongoose_2[a125_0x32c7a7(0x105)]])],SettingService),exports[a125_0x32c7a7(0x110)]=SettingService;function a125_0x5341(){const _0x2f435b=['dayjs','toDate','@nestjs/common','object','decrypt','__decorate','validTo','DD/MM/YYYY','decorate','QVBFVFVMT1NCQQ==','licenseKey','updateExpiryStatus','findByIdAndUpdate','3579825DzasNH','4099842jBOMja','toObject','_id','metadata','14248pteNYj','schoolId','settingModel','killAll','create','length','1327380UtyKPS','1990472KMdanp','__param','InjectModel','findFirst','update','Model','maxUser','1194fFTlsd','@nestjs/mongoose','__metadata','getOwnPropertyDescriptor','function','validateLicenseKey','3626zTBqUP','setting','306747cRQGPn','SettingService','userSetting','assign','defineProperty','updateUserSetting','DEFAULT_MAX_USER','killJobs','design:paramtypes','log','../common/job','2083UxcwnY','mongoose','Injectable','toString','isValid','./constants','crypto-js'];a125_0x5341=function(){return _0x2f435b;};return a125_0x5341();}