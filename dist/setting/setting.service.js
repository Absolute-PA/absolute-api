'use strict';const a125_0x2e0b70=a125_0x374e;(function(_0xc97e1a,_0x5bb0a7){const _0x1f8b48=a125_0x374e,_0x430584=_0xc97e1a();while(!![]){try{const _0x5864b7=-parseInt(_0x1f8b48(0xc2))/0x1*(parseInt(_0x1f8b48(0xa9))/0x2)+parseInt(_0x1f8b48(0x8f))/0x3*(parseInt(_0x1f8b48(0x8d))/0x4)+parseInt(_0x1f8b48(0xc1))/0x5*(parseInt(_0x1f8b48(0x96))/0x6)+-parseInt(_0x1f8b48(0xaa))/0x7+-parseInt(_0x1f8b48(0xc7))/0x8+parseInt(_0x1f8b48(0x8c))/0x9+parseInt(_0x1f8b48(0x98))/0xa;if(_0x5864b7===_0x5bb0a7)break;else _0x430584['push'](_0x430584['shift']());}catch(_0x519f53){_0x430584['push'](_0x430584['shift']());}}}(a125_0x13ba,0xdc5e7));var __decorate=this&&this[a125_0x2e0b70(0xa7)]||function(_0x2a3bf9,_0x3c4a00,_0x4764a2,_0x298254){const _0xa4d25d=a125_0x2e0b70;var _0x1fb831=arguments[_0xa4d25d(0x99)],_0x3f01c4=_0x1fb831<0x3?_0x3c4a00:_0x298254===null?_0x298254=Object[_0xa4d25d(0xc9)](_0x3c4a00,_0x4764a2):_0x298254,_0x166827;if(typeof Reflect==='object'&&typeof Reflect[_0xa4d25d(0xa0)]==='function')_0x3f01c4=Reflect[_0xa4d25d(0xa0)](_0x2a3bf9,_0x3c4a00,_0x4764a2,_0x298254);else{for(var _0x4bcd62=_0x2a3bf9[_0xa4d25d(0x99)]-0x1;_0x4bcd62>=0x0;_0x4bcd62--)if(_0x166827=_0x2a3bf9[_0x4bcd62])_0x3f01c4=(_0x1fb831<0x3?_0x166827(_0x3f01c4):_0x1fb831>0x3?_0x166827(_0x3c4a00,_0x4764a2,_0x3f01c4):_0x166827(_0x3c4a00,_0x4764a2))||_0x3f01c4;}return _0x1fb831>0x3&&_0x3f01c4&&Object[_0xa4d25d(0xb9)](_0x3c4a00,_0x4764a2,_0x3f01c4),_0x3f01c4;},__metadata=this&&this['__metadata']||function(_0x3b4282,_0x46d0ee){const _0x273ba9=a125_0x2e0b70;if(typeof Reflect===_0x273ba9(0xa1)&&typeof Reflect[_0x273ba9(0x95)]===_0x273ba9(0xab))return Reflect[_0x273ba9(0x95)](_0x3b4282,_0x46d0ee);},__param=this&&this[a125_0x2e0b70(0xbc)]||function(_0x279ea9,_0x4359b6){return function(_0x4449ce,_0x4c047d){_0x4359b6(_0x4449ce,_0x4c047d,_0x279ea9);};};Object[a125_0x2e0b70(0xb9)](exports,a125_0x2e0b70(0xbf),{'value':!![]}),exports[a125_0x2e0b70(0xb0)]=void 0x0;const common_1=require(a125_0x2e0b70(0xa8)),mongoose_1=require(a125_0x2e0b70(0xa6)),mongoose_2=require(a125_0x2e0b70(0xb7)),CryptoJS=require(a125_0x2e0b70(0xb5)),dayjs=require(a125_0x2e0b70(0xa5)),crypto_1=require(a125_0x2e0b70(0x9d)),job_1=require(a125_0x2e0b70(0xae)),constants_1=require(a125_0x2e0b70(0xbb)),SECRET='QVBFVFVMT1NCQQ==';let SettingService=class SettingService{constructor(_0x3d43c8){const _0x2e19d7=a125_0x2e0b70;this[_0x2e19d7(0xc6)]=_0x3d43c8;}async[a125_0x2e0b70(0x90)](_0x5e5339){const _0x17328a=a125_0x2e0b70,_0x5d7058=new this[(_0x17328a(0xc6))](_0x5e5339);return _0x5d7058[_0x17328a(0x91)]();}async[a125_0x2e0b70(0xc4)](){const _0x41edbb=a125_0x2e0b70;var _0x43ad29,_0x51d592,_0x18c381;const _0xf587ad=await this[_0x41edbb(0xc6)][_0x41edbb(0xbe)]()[_0x41edbb(0x9e)](),_0x194c5a=(_0x43ad29=_0xf587ad[0x0])===null||_0x43ad29===void 0x0?void 0x0:_0x43ad29[_0x41edbb(0x97)]();if(!_0x194c5a)return;return Object[_0x41edbb(0xc5)](Object[_0x41edbb(0xc5)]({},_0x194c5a),{'userSetting':Object[_0x41edbb(0xc5)](Object[_0x41edbb(0xc5)]({},_0x194c5a['userSetting']),{'maxUser':(_0x18c381=(_0x51d592=_0x194c5a['userSetting'])===null||_0x51d592===void 0x0?void 0x0:_0x51d592['maxUser'])!==null&&_0x18c381!==void 0x0?_0x18c381:constants_1[_0x41edbb(0xbd)]})});}async[a125_0x2e0b70(0xac)](_0x9844b8,_0x35635b){const _0x4adc17=a125_0x2e0b70,_0x8f056=await this[_0x4adc17(0xc6)][_0x4adc17(0x9a)](_0x9844b8,Object[_0x4adc17(0xc5)](Object[_0x4adc17(0xc5)]({},_0x35635b),{'updatedAtUtc':new Date()}),{'new':!![]})[_0x4adc17(0x9e)]();return _0x8f056;}async['updateExpiryStatus'](){const _0x27976b=a125_0x2e0b70,_0x41f727=await this[_0x27976b(0xc4)](),_0x5c0a6d=this[_0x27976b(0x94)](_0x41f727[_0x27976b(0xb8)],_0x41f727['schoolId']);return this[_0x27976b(0xac)](_0x41f727[_0x27976b(0xa3)],{'isExpired':!_0x5c0a6d[_0x27976b(0xc0)]});}async[a125_0x2e0b70(0x9c)](_0x421ecf){const _0x544284=a125_0x2e0b70,_0x59795f=await this[_0x544284(0xc4)]();return console[_0x544284(0x8b)](_0x59795f,_0x544284(0xad)),this[_0x544284(0xac)](_0x59795f[_0x544284(0xa3)],{'userSetting':_0x421ecf});}[a125_0x2e0b70(0x94)](_0x183803,_0x183385){const _0x38f740=a125_0x2e0b70;try{if(!_0x183803)return{'isValid':![],'expiryDate':''};const _0x4c9dc3=(0x0,crypto_1[_0x38f740(0xaf)])(_0x183803,CryptoJS[_0x38f740(0xb3)][_0x38f740(0xb1)][_0x38f740(0xc8)](SECRET)[_0x38f740(0x9b)](CryptoJS[_0x38f740(0xb3)][_0x38f740(0xb6)]));if(_0x4c9dc3[_0x38f740(0x92)]!==_0x183385)return{'isValid':![],'expiryDate':''};const _0x4c6d20=dayjs(_0x4c9dc3['validFrom'],_0x38f740(0x93))['toDate'](),_0x4cc806=dayjs(_0x4c9dc3[_0x38f740(0x9f)],_0x38f740(0x93))[_0x38f740(0xb4)](),_0x773ae1=dayjs()['toDate']();if(_0x773ae1<_0x4c6d20||_0x773ae1>_0x4cc806)return{'isValid':![],'expiryDate':_0x4c9dc3[_0x38f740(0x9f)]};return{'isValid':!![],'expiryDate':_0x4c9dc3['validTo']};}catch(_0x585211){return{'isValid':![],'expiryDate':''};}}async[a125_0x2e0b70(0xc3)](){const _0x53da5f=a125_0x2e0b70;job_1[_0x53da5f(0xba)][_0x53da5f(0xb2)]();}};SettingService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_1[a125_0x2e0b70(0xa4)])('Setting')),__metadata(a125_0x2e0b70(0x8e),[mongoose_2[a125_0x2e0b70(0xa2)]])],SettingService),exports['SettingService']=SettingService;function a125_0x374e(_0x32ca34,_0x24f024){const _0x13ba22=a125_0x13ba();return a125_0x374e=function(_0x374e3e,_0xf652e9){_0x374e3e=_0x374e3e-0x8b;let _0x5e15bd=_0x13ba22[_0x374e3e];return _0x5e15bd;},a125_0x374e(_0x32ca34,_0x24f024);}function a125_0x13ba(){const _0xf1898c=['updateUserSetting','../common/crypto','exec','validTo','decorate','object','Model','_id','InjectModel','dayjs','@nestjs/mongoose','__decorate','@nestjs/common','3902LxKQzB','7906829KRYNZC','function','update','setting','../common/job','decrypt','SettingService','Base64','killAll','enc','toDate','crypto-js','Utf8','mongoose','licenseKey','defineProperty','PROCESS_CACHE','./constants','__param','DEFAULT_MAX_USER','find','__esModule','isValid','43045dIKPiI','454vZHKBR','killJobs','findFirst','assign','settingModel','12268184zRmVLh','parse','getOwnPropertyDescriptor','log','10509957MKVrWg','4832qvtKhW','design:paramtypes','1980YgtPdW','create','save','schoolId','DD/MM/YYYY','validateLicenseKey','metadata','1122XmIQpX','toObject','8765190cWsygQ','length','findByIdAndUpdate','toString'];a125_0x13ba=function(){return _0xf1898c;};return a125_0x13ba();}