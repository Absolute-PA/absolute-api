'use strict';const a125_0x43384c=a125_0x4f78;(function(_0xc07142,_0x379439){const _0x357536=a125_0x4f78,_0x3c0402=_0xc07142();while(!![]){try{const _0x414439=-parseInt(_0x357536(0xf4))/0x1*(parseInt(_0x357536(0xce))/0x2)+-parseInt(_0x357536(0xbc))/0x3*(parseInt(_0x357536(0xe7))/0x4)+-parseInt(_0x357536(0xc4))/0x5*(parseInt(_0x357536(0xc2))/0x6)+-parseInt(_0x357536(0xe4))/0x7*(-parseInt(_0x357536(0xdf))/0x8)+-parseInt(_0x357536(0xe9))/0x9+parseInt(_0x357536(0xbd))/0xa*(-parseInt(_0x357536(0xe8))/0xb)+parseInt(_0x357536(0xb9))/0xc;if(_0x414439===_0x379439)break;else _0x3c0402['push'](_0x3c0402['shift']());}catch(_0x2bd2d1){_0x3c0402['push'](_0x3c0402['shift']());}}}(a125_0x2830,0x3e7fd));var __decorate=this&&this[a125_0x43384c(0xd5)]||function(_0x457f2e,_0x1e1f8d,_0x199093,_0x41437f){const _0x4fc3ee=a125_0x43384c;var _0x2a7d9a=arguments['length'],_0x17c2d4=_0x2a7d9a<0x3?_0x1e1f8d:_0x41437f===null?_0x41437f=Object[_0x4fc3ee(0xc3)](_0x1e1f8d,_0x199093):_0x41437f,_0x392bf6;if(typeof Reflect===_0x4fc3ee(0xca)&&typeof Reflect[_0x4fc3ee(0xf0)]===_0x4fc3ee(0xd6))_0x17c2d4=Reflect[_0x4fc3ee(0xf0)](_0x457f2e,_0x1e1f8d,_0x199093,_0x41437f);else{for(var _0x589515=_0x457f2e[_0x4fc3ee(0xd9)]-0x1;_0x589515>=0x0;_0x589515--)if(_0x392bf6=_0x457f2e[_0x589515])_0x17c2d4=(_0x2a7d9a<0x3?_0x392bf6(_0x17c2d4):_0x2a7d9a>0x3?_0x392bf6(_0x1e1f8d,_0x199093,_0x17c2d4):_0x392bf6(_0x1e1f8d,_0x199093))||_0x17c2d4;}return _0x2a7d9a>0x3&&_0x17c2d4&&Object['defineProperty'](_0x1e1f8d,_0x199093,_0x17c2d4),_0x17c2d4;},__metadata=this&&this[a125_0x43384c(0xdb)]||function(_0x286e2b,_0x5b888f){const _0x96bb45=a125_0x43384c;if(typeof Reflect===_0x96bb45(0xca)&&typeof Reflect['metadata']===_0x96bb45(0xd6))return Reflect[_0x96bb45(0xd1)](_0x286e2b,_0x5b888f);},__param=this&&this['__param']||function(_0x2da877,_0x5c0991){return function(_0x294c6b,_0x52fb08){_0x5c0991(_0x294c6b,_0x52fb08,_0x2da877);};};function a125_0x2830(){const _0x28d734=['isValid','exec','log','create','Setting','decorate','findByIdAndUpdate','settingModel','Injectable','31811kmBoSW','__esModule','SettingService','19194732RTpBtX','validFrom','./constants','3GYHEOG','589480nzOhCR','userSetting','killJobs','_id','validateLicenseKey','738996cSltaU','getOwnPropertyDescriptor','10NxznvZ','@nestjs/common','licenseKey','setting','dayjs','assign','object','../common/job','validTo','@nestjs/mongoose','26BjmrYo','parse','find','metadata','QVBFVFVMT1NCQQ==','updateUserSetting','decrypt','__decorate','function','findFirst','crypto-js','length','maxUser','__metadata','defineProperty','DEFAULT_MAX_USER','update','79872UFaabL','toDate','Base64','schoolId','PROCESS_CACHE','7cjXduC','design:paramtypes','Utf8','292252oDBIJY','22YjoKzN','4524426FiknMd','toString'];a125_0x2830=function(){return _0x28d734;};return a125_0x2830();}Object[a125_0x43384c(0xdc)](exports,a125_0x43384c(0xb7),{'value':!![]}),exports[a125_0x43384c(0xb8)]=void 0x0;function a125_0x4f78(_0x18db2c,_0x115d49){const _0x2830ff=a125_0x2830();return a125_0x4f78=function(_0x4f7862,_0x32079c){_0x4f7862=_0x4f7862-0xb7;let _0x1489a6=_0x2830ff[_0x4f7862];return _0x1489a6;},a125_0x4f78(_0x18db2c,_0x115d49);}const common_1=require(a125_0x43384c(0xc5)),mongoose_1=require(a125_0x43384c(0xcd)),mongoose_2=require('mongoose'),CryptoJS=require(a125_0x43384c(0xd8)),dayjs=require(a125_0x43384c(0xc8)),crypto_1=require('../common/crypto'),job_1=require(a125_0x43384c(0xcb)),constants_1=require(a125_0x43384c(0xbb)),SECRET=a125_0x43384c(0xd2);let SettingService=class SettingService{constructor(_0x11015d){const _0x2b577d=a125_0x43384c;this[_0x2b577d(0xf2)]=_0x11015d;}async[a125_0x43384c(0xee)](_0x43fdc8){const _0x4871aa=a125_0x43384c,_0x371efb=new this[(_0x4871aa(0xf2))](_0x43fdc8);return _0x371efb['save']();}async[a125_0x43384c(0xd7)](){const _0x550a43=a125_0x43384c;var _0x5a62bc,_0x4f880f,_0x555fa0;const _0x52148e=await this['settingModel'][_0x550a43(0xd0)]()[_0x550a43(0xec)](),_0x162890=(_0x5a62bc=_0x52148e[0x0])===null||_0x5a62bc===void 0x0?void 0x0:_0x5a62bc['toObject']();if(!_0x162890)return;return Object[_0x550a43(0xc9)](Object[_0x550a43(0xc9)]({},_0x162890),{'userSetting':Object['assign'](Object[_0x550a43(0xc9)]({},_0x162890[_0x550a43(0xbe)]),{'maxUser':(_0x555fa0=(_0x4f880f=_0x162890[_0x550a43(0xbe)])===null||_0x4f880f===void 0x0?void 0x0:_0x4f880f[_0x550a43(0xda)])!==null&&_0x555fa0!==void 0x0?_0x555fa0:constants_1[_0x550a43(0xdd)]})});}async[a125_0x43384c(0xde)](_0x3824e5,_0x3f9cac){const _0x498806=a125_0x43384c,_0x4ba9c5=await this[_0x498806(0xf2)][_0x498806(0xf1)](_0x3824e5,Object[_0x498806(0xc9)](Object[_0x498806(0xc9)]({},_0x3f9cac),{'updatedAtUtc':new Date()}),{'new':!![]})[_0x498806(0xec)]();return _0x4ba9c5;}async['updateExpiryStatus'](){const _0x387647=a125_0x43384c,_0x5610d7=await this['findFirst'](),_0x5baaf4=this[_0x387647(0xc1)](_0x5610d7[_0x387647(0xc6)],_0x5610d7[_0x387647(0xe2)]);return this[_0x387647(0xde)](_0x5610d7[_0x387647(0xc0)],{'isExpired':!_0x5baaf4[_0x387647(0xeb)]});}async[a125_0x43384c(0xd3)](_0x474a8e){const _0x546938=a125_0x43384c,_0x24a50a=await this['findFirst']();return console[_0x546938(0xed)](_0x24a50a,_0x546938(0xc7)),this[_0x546938(0xde)](_0x24a50a[_0x546938(0xc0)],{'userSetting':_0x474a8e});}[a125_0x43384c(0xc1)](_0x502335,_0x39789a){const _0x28b95e=a125_0x43384c;try{if(!_0x502335)return{'isValid':![],'expiryDate':''};const _0x3d6b49=(0x0,crypto_1[_0x28b95e(0xd4)])(_0x502335,CryptoJS['enc'][_0x28b95e(0xe1)][_0x28b95e(0xcf)](SECRET)[_0x28b95e(0xea)](CryptoJS['enc'][_0x28b95e(0xe6)]));if(_0x3d6b49[_0x28b95e(0xe2)]!==_0x39789a)return{'isValid':![],'expiryDate':''};const _0x47ea56=dayjs(_0x3d6b49[_0x28b95e(0xba)],'DD/MM/YYYY')[_0x28b95e(0xe0)](),_0x5eb978=dayjs(_0x3d6b49[_0x28b95e(0xcc)],'DD/MM/YYYY')[_0x28b95e(0xe0)](),_0xaaa484=dayjs()[_0x28b95e(0xe0)]();if(_0xaaa484<_0x47ea56||_0xaaa484>_0x5eb978)return{'isValid':![],'expiryDate':_0x3d6b49['validTo']};return{'isValid':!![],'expiryDate':_0x3d6b49[_0x28b95e(0xcc)]};}catch(_0x2cda2d){return{'isValid':![],'expiryDate':''};}}async[a125_0x43384c(0xbf)](){const _0x1a2b1e=a125_0x43384c;job_1[_0x1a2b1e(0xe3)]['killAll']();}};SettingService=__decorate([(0x0,common_1[a125_0x43384c(0xf3)])(),__param(0x0,(0x0,mongoose_1['InjectModel'])(a125_0x43384c(0xef))),__metadata(a125_0x43384c(0xe5),[mongoose_2['Model']])],SettingService),exports[a125_0x43384c(0xb8)]=SettingService;