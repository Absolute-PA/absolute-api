'use strict';const a122_0x4125a5=a122_0x4c13;(function(_0x36ef55,_0x292081){const _0x45131e=a122_0x4c13,_0xe5cde1=_0x36ef55();while(!![]){try{const _0x5bc862=-parseInt(_0x45131e(0x193))/0x1*(parseInt(_0x45131e(0x189))/0x2)+-parseInt(_0x45131e(0x18a))/0x3+parseInt(_0x45131e(0x1c2))/0x4+parseInt(_0x45131e(0x194))/0x5*(parseInt(_0x45131e(0x181))/0x6)+parseInt(_0x45131e(0x198))/0x7*(parseInt(_0x45131e(0x1a2))/0x8)+-parseInt(_0x45131e(0x187))/0x9*(-parseInt(_0x45131e(0x1ad))/0xa)+-parseInt(_0x45131e(0x1a4))/0xb*(parseInt(_0x45131e(0x19f))/0xc);if(_0x5bc862===_0x292081)break;else _0xe5cde1['push'](_0xe5cde1['shift']());}catch(_0x4c18da){_0xe5cde1['push'](_0xe5cde1['shift']());}}}(a122_0x2810,0xabcd1));var __decorate=this&&this[a122_0x4125a5(0x1c1)]||function(_0x1d484d,_0x6b6f08,_0x29438f,_0x54294a){const _0x385667=a122_0x4125a5;var _0x35d38b=arguments[_0x385667(0x19c)],_0x573262=_0x35d38b<0x3?_0x6b6f08:_0x54294a===null?_0x54294a=Object[_0x385667(0x1ae)](_0x6b6f08,_0x29438f):_0x54294a,_0x137fa7;if(typeof Reflect===_0x385667(0x1b9)&&typeof Reflect[_0x385667(0x182)]==='function')_0x573262=Reflect[_0x385667(0x182)](_0x1d484d,_0x6b6f08,_0x29438f,_0x54294a);else{for(var _0x55fc98=_0x1d484d['length']-0x1;_0x55fc98>=0x0;_0x55fc98--)if(_0x137fa7=_0x1d484d[_0x55fc98])_0x573262=(_0x35d38b<0x3?_0x137fa7(_0x573262):_0x35d38b>0x3?_0x137fa7(_0x6b6f08,_0x29438f,_0x573262):_0x137fa7(_0x6b6f08,_0x29438f))||_0x573262;}return _0x35d38b>0x3&&_0x573262&&Object[_0x385667(0x199)](_0x6b6f08,_0x29438f,_0x573262),_0x573262;},__metadata=this&&this[a122_0x4125a5(0x1a5)]||function(_0x4fa831,_0x2557b3){const _0x5993ad=a122_0x4125a5;if(typeof Reflect===_0x5993ad(0x1b9)&&typeof Reflect[_0x5993ad(0x186)]===_0x5993ad(0x184))return Reflect[_0x5993ad(0x186)](_0x4fa831,_0x2557b3);},__param=this&&this[a122_0x4125a5(0x1a8)]||function(_0x6a361e,_0x4c0df7){return function(_0x47bc81,_0x18ace0){_0x4c0df7(_0x47bc81,_0x18ace0,_0x6a361e);};};Object[a122_0x4125a5(0x199)](exports,a122_0x4125a5(0x1c0),{'value':!![]}),exports[a122_0x4125a5(0x1ba)]=void 0x0;const common_1=require('@nestjs/common'),mongoose_1=require(a122_0x4125a5(0x195)),mongoose_2=require(a122_0x4125a5(0x18d)),CryptoJS=require(a122_0x4125a5(0x17e)),dayjs=require(a122_0x4125a5(0x1a9)),crypto_1=require(a122_0x4125a5(0x1aa)),job_1=require(a122_0x4125a5(0x1bb)),constants_1=require(a122_0x4125a5(0x1a7)),SECRET=a122_0x4125a5(0x19a);function a122_0x4c13(_0x3eca5d,_0x33962a){const _0x281089=a122_0x2810();return a122_0x4c13=function(_0x4c1386,_0x1ca1a6){_0x4c1386=_0x4c1386-0x17e;let _0xae6d0d=_0x281089[_0x4c1386];return _0xae6d0d;},a122_0x4c13(_0x3eca5d,_0x33962a);}let SettingService=class SettingService{constructor(_0x1ab8c2){const _0x2646e3=a122_0x4125a5;this[_0x2646e3(0x1a1)]=_0x1ab8c2;}async['create'](_0xa08526){const _0x46edf8=a122_0x4125a5,_0x15294f=new this[(_0x46edf8(0x1a1))](_0xa08526);return _0x15294f[_0x46edf8(0x191)]();}async[a122_0x4125a5(0x1af)](){const _0x48e1dd=a122_0x4125a5;var _0x175265,_0x32806d,_0x225b32;const _0x162c04=await this[_0x48e1dd(0x1a1)][_0x48e1dd(0x19e)]()[_0x48e1dd(0x1b7)](),_0x34df08=(_0x175265=_0x162c04[0x0])===null||_0x175265===void 0x0?void 0x0:_0x175265[_0x48e1dd(0x19d)]();if(!_0x34df08)return;return Object[_0x48e1dd(0x1a3)](Object['assign']({},_0x34df08),{'userSetting':Object['assign'](Object['assign']({},_0x34df08['userSetting']),{'maxUser':(_0x225b32=(_0x32806d=_0x34df08[_0x48e1dd(0x1a6)])===null||_0x32806d===void 0x0?void 0x0:_0x32806d[_0x48e1dd(0x1b5)])!==null&&_0x225b32!==void 0x0?_0x225b32:constants_1[_0x48e1dd(0x1b2)]})});}async[a122_0x4125a5(0x1bc)](_0x2ba307,_0x41b54e){const _0x524a2f=a122_0x4125a5,_0x403001=await this['settingModel'][_0x524a2f(0x19b)](_0x2ba307,Object[_0x524a2f(0x1a3)](Object[_0x524a2f(0x1a3)]({},_0x41b54e),{'updatedAtUtc':new Date()}),{'new':!![]})[_0x524a2f(0x1b7)]();return _0x403001;}async[a122_0x4125a5(0x196)](){const _0x5466b2=a122_0x4125a5,_0x4eebf8=await this[_0x5466b2(0x1af)](),_0x20a6d8=this[_0x5466b2(0x1be)](_0x4eebf8[_0x5466b2(0x18e)],_0x4eebf8[_0x5466b2(0x18f)]);return this[_0x5466b2(0x1bc)](_0x4eebf8[_0x5466b2(0x1b0)],{'isExpired':!_0x20a6d8['isValid']});}async[a122_0x4125a5(0x1b6)](_0x385b08){const _0x12d67b=a122_0x4125a5,_0x37ba0a=await this[_0x12d67b(0x1af)]();return console[_0x12d67b(0x1b3)](_0x37ba0a,_0x12d67b(0x1ac)),this['update'](_0x37ba0a[_0x12d67b(0x1b0)],{'userSetting':_0x385b08});}[a122_0x4125a5(0x1be)](_0x48042a,_0x24e49b){const _0x410e0d=a122_0x4125a5;try{if(!_0x48042a)return{'isValid':![],'expiryDate':''};const _0x29ceae=(0x0,crypto_1[_0x410e0d(0x1b1)])(_0x48042a,CryptoJS[_0x410e0d(0x18c)][_0x410e0d(0x1b4)][_0x410e0d(0x192)](SECRET)[_0x410e0d(0x18b)](CryptoJS[_0x410e0d(0x18c)][_0x410e0d(0x1ab)]));if(_0x29ceae[_0x410e0d(0x18f)]!==_0x24e49b)return{'isValid':![],'expiryDate':''};const _0x1c4afd=dayjs(_0x29ceae[_0x410e0d(0x197)],_0x410e0d(0x1b8))[_0x410e0d(0x1bf)](),_0x71adf7=dayjs(_0x29ceae[_0x410e0d(0x1bd)],_0x410e0d(0x1b8))['toDate'](),_0x379a75=dayjs()[_0x410e0d(0x1bf)]();if(_0x379a75<_0x1c4afd||_0x379a75>_0x71adf7)return{'isValid':![],'expiryDate':_0x29ceae[_0x410e0d(0x1bd)]};return{'isValid':!![],'expiryDate':_0x29ceae['validTo']};}catch(_0x1f7337){return{'isValid':![],'expiryDate':''};}}async[a122_0x4125a5(0x180)](){const _0x4f5243=a122_0x4125a5;job_1[_0x4f5243(0x1a0)][_0x4f5243(0x183)]();}};SettingService=__decorate([(0x0,common_1[a122_0x4125a5(0x188)])(),__param(0x0,(0x0,mongoose_1[a122_0x4125a5(0x185)])(a122_0x4125a5(0x190))),__metadata(a122_0x4125a5(0x17f),[mongoose_2['Model']])],SettingService),exports['SettingService']=SettingService;function a122_0x2810(){const _0x37d1c4=['decorate','killAll','function','InjectModel','metadata','54kXKgTk','Injectable','2zLuNBX','1968033leNBtu','toString','enc','mongoose','licenseKey','schoolId','Setting','save','parse','1124769uiowSu','10FrUjMY','@nestjs/mongoose','updateExpiryStatus','validFrom','1255576KEudrY','defineProperty','QVBFVFVMT1NCQQ==','findByIdAndUpdate','length','toObject','find','228hkTfvd','PROCESS_CACHE','settingModel','40JqSgkI','assign','785279JBqeNt','__metadata','userSetting','./constants','__param','dayjs','../common/crypto','Utf8','setting','2013320nJvhlt','getOwnPropertyDescriptor','findFirst','_id','decrypt','DEFAULT_MAX_USER','log','Base64','maxUser','updateUserSetting','exec','DD/MM/YYYY','object','SettingService','../common/job','update','validTo','validateLicenseKey','toDate','__esModule','__decorate','2050872ZQYmNm','crypto-js','design:paramtypes','killJobs','3669954zzYgkG'];a122_0x2810=function(){return _0x37d1c4;};return a122_0x2810();}