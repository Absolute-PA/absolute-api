'use strict';const a125_0x46b655=a125_0x4435;(function(_0x1b6a45,_0x5d0e79){const _0x9a6a9f=a125_0x4435,_0x2a4786=_0x1b6a45();while(!![]){try{const _0x45ea9f=-parseInt(_0x9a6a9f(0x1ac))/0x1+-parseInt(_0x9a6a9f(0x1ae))/0x2*(parseInt(_0x9a6a9f(0x1bc))/0x3)+-parseInt(_0x9a6a9f(0x180))/0x4*(parseInt(_0x9a6a9f(0x17f))/0x5)+-parseInt(_0x9a6a9f(0x1b3))/0x6*(parseInt(_0x9a6a9f(0x1ad))/0x7)+parseInt(_0x9a6a9f(0x1ba))/0x8+parseInt(_0x9a6a9f(0x19f))/0x9+-parseInt(_0x9a6a9f(0x1af))/0xa*(-parseInt(_0x9a6a9f(0x1be))/0xb);if(_0x45ea9f===_0x5d0e79)break;else _0x2a4786['push'](_0x2a4786['shift']());}catch(_0x37d1ab){_0x2a4786['push'](_0x2a4786['shift']());}}}(a125_0x5148,0x4bfd5));var __decorate=this&&this[a125_0x46b655(0x19a)]||function(_0xb9cece,_0x228bb4,_0x399c14,_0x3c9d2c){const _0x2604bd=a125_0x46b655;var _0x2ed36d=arguments['length'],_0x5a6fb2=_0x2ed36d<0x3?_0x228bb4:_0x3c9d2c===null?_0x3c9d2c=Object[_0x2604bd(0x1b6)](_0x228bb4,_0x399c14):_0x3c9d2c,_0x3c54a9;if(typeof Reflect===_0x2604bd(0x1b8)&&typeof Reflect[_0x2604bd(0x18c)]===_0x2604bd(0x1b5))_0x5a6fb2=Reflect[_0x2604bd(0x18c)](_0xb9cece,_0x228bb4,_0x399c14,_0x3c9d2c);else{for(var _0x181f30=_0xb9cece[_0x2604bd(0x1a6)]-0x1;_0x181f30>=0x0;_0x181f30--)if(_0x3c54a9=_0xb9cece[_0x181f30])_0x5a6fb2=(_0x2ed36d<0x3?_0x3c54a9(_0x5a6fb2):_0x2ed36d>0x3?_0x3c54a9(_0x228bb4,_0x399c14,_0x5a6fb2):_0x3c54a9(_0x228bb4,_0x399c14))||_0x5a6fb2;}return _0x2ed36d>0x3&&_0x5a6fb2&&Object['defineProperty'](_0x228bb4,_0x399c14,_0x5a6fb2),_0x5a6fb2;},__metadata=this&&this['__metadata']||function(_0xb0bf2,_0x47ac3d){const _0x68aa15=a125_0x46b655;if(typeof Reflect===_0x68aa15(0x1b8)&&typeof Reflect['metadata']===_0x68aa15(0x1b5))return Reflect['metadata'](_0xb0bf2,_0x47ac3d);},__param=this&&this[a125_0x46b655(0x1a0)]||function(_0x1bb242,_0x40e1c5){return function(_0x3af965,_0x19f204){_0x40e1c5(_0x3af965,_0x19f204,_0x1bb242);};};function a125_0x5148(){const _0x4c6413=['DD/MM/YYYY','settingModel','Utf8','./constants','1792989WAsGfW','__param','enc','log','_id','mongoose','find','length','save','../common/crypto','Injectable','userSetting','killAll','480465RZhyAD','65128KpdWvN','50LlfAro','7310rWdNBv','maxUser','validTo','design:paramtypes','378BDagvw','toDate','function','getOwnPropertyDescriptor','defineProperty','object','SettingService','811888uLSLKv','validFrom','44433gmVZIU','assign','28556LgUNSf','10QEbcAd','900476oRvNmv','toObject','toString','findByIdAndUpdate','Model','Base64','@nestjs/common','validateLicenseKey','PROCESS_CACHE','update','dayjs','__esModule','decorate','parse','findFirst','InjectModel','updateExpiryStatus','schoolId','create','@nestjs/mongoose','licenseKey','Setting','DEFAULT_MAX_USER','exec','setting','decrypt','__decorate'];a125_0x5148=function(){return _0x4c6413;};return a125_0x5148();}Object[a125_0x46b655(0x1b7)](exports,a125_0x46b655(0x18b),{'value':!![]}),exports[a125_0x46b655(0x1b9)]=void 0x0;const common_1=require(a125_0x46b655(0x186)),mongoose_1=require(a125_0x46b655(0x193)),mongoose_2=require(a125_0x46b655(0x1a4)),CryptoJS=require('crypto-js'),dayjs=require(a125_0x46b655(0x18a)),crypto_1=require(a125_0x46b655(0x1a8)),job_1=require('../common/job'),constants_1=require(a125_0x46b655(0x19e)),SECRET='QVBFVFVMT1NCQQ==';let SettingService=class SettingService{constructor(_0x37d9b8){const _0x22d027=a125_0x46b655;this[_0x22d027(0x19c)]=_0x37d9b8;}async[a125_0x46b655(0x192)](_0x5c7bae){const _0x2127b5=a125_0x46b655,_0x37045c=new this[(_0x2127b5(0x19c))](_0x5c7bae);return _0x37045c[_0x2127b5(0x1a7)]();}async[a125_0x46b655(0x18e)](){const _0x5b4eb6=a125_0x46b655;var _0x20daa7,_0x4978fd,_0xe080a8;const _0x327a10=await this[_0x5b4eb6(0x19c)][_0x5b4eb6(0x1a5)]()[_0x5b4eb6(0x197)](),_0x4be839=(_0x20daa7=_0x327a10[0x0])===null||_0x20daa7===void 0x0?void 0x0:_0x20daa7[_0x5b4eb6(0x181)]();if(!_0x4be839)return;return Object[_0x5b4eb6(0x1bd)](Object[_0x5b4eb6(0x1bd)]({},_0x4be839),{'userSetting':Object[_0x5b4eb6(0x1bd)](Object[_0x5b4eb6(0x1bd)]({},_0x4be839[_0x5b4eb6(0x1aa)]),{'maxUser':(_0xe080a8=(_0x4978fd=_0x4be839[_0x5b4eb6(0x1aa)])===null||_0x4978fd===void 0x0?void 0x0:_0x4978fd[_0x5b4eb6(0x1b0)])!==null&&_0xe080a8!==void 0x0?_0xe080a8:constants_1[_0x5b4eb6(0x196)]})});}async[a125_0x46b655(0x189)](_0x6d5f90,_0x2b5cc5){const _0x3df8e6=a125_0x46b655,_0x5e2507=await this['settingModel'][_0x3df8e6(0x183)](_0x6d5f90,Object['assign'](Object[_0x3df8e6(0x1bd)]({},_0x2b5cc5),{'updatedAtUtc':new Date()}),{'new':!![]})[_0x3df8e6(0x197)]();return _0x5e2507;}async[a125_0x46b655(0x190)](){const _0x5bf224=a125_0x46b655,_0x23e27a=await this[_0x5bf224(0x18e)](),_0x13658b=this[_0x5bf224(0x187)](_0x23e27a[_0x5bf224(0x194)],_0x23e27a[_0x5bf224(0x191)]);return this[_0x5bf224(0x189)](_0x23e27a[_0x5bf224(0x1a3)],{'isExpired':!_0x13658b['isValid']});}async['updateUserSetting'](_0x3aeebb){const _0x4213d4=a125_0x46b655,_0x324791=await this['findFirst']();return console[_0x4213d4(0x1a2)](_0x324791,_0x4213d4(0x198)),this[_0x4213d4(0x189)](_0x324791['_id'],{'userSetting':_0x3aeebb});}[a125_0x46b655(0x187)](_0x3b6f4a,_0x4d4e96){const _0x9d5d08=a125_0x46b655;try{if(!_0x3b6f4a)return{'isValid':![],'expiryDate':''};const _0x455009=(0x0,crypto_1[_0x9d5d08(0x199)])(_0x3b6f4a,CryptoJS[_0x9d5d08(0x1a1)][_0x9d5d08(0x185)][_0x9d5d08(0x18d)](SECRET)[_0x9d5d08(0x182)](CryptoJS[_0x9d5d08(0x1a1)][_0x9d5d08(0x19d)]));if(_0x455009[_0x9d5d08(0x191)]!==_0x4d4e96)return{'isValid':![],'expiryDate':''};const _0x1dad12=dayjs(_0x455009[_0x9d5d08(0x1bb)],_0x9d5d08(0x19b))[_0x9d5d08(0x1b4)](),_0x1018a1=dayjs(_0x455009['validTo'],_0x9d5d08(0x19b))[_0x9d5d08(0x1b4)](),_0x2ebe91=dayjs()[_0x9d5d08(0x1b4)]();if(_0x2ebe91<_0x1dad12||_0x2ebe91>_0x1018a1)return{'isValid':![],'expiryDate':_0x455009[_0x9d5d08(0x1b1)]};return{'isValid':!![],'expiryDate':_0x455009['validTo']};}catch(_0x567cb9){return{'isValid':![],'expiryDate':''};}}async['killJobs'](){const _0x54d075=a125_0x46b655;job_1[_0x54d075(0x188)][_0x54d075(0x1ab)]();}};function a125_0x4435(_0x1efb9b,_0x5d65cc){const _0x5148c6=a125_0x5148();return a125_0x4435=function(_0x443560,_0x1ce457){_0x443560=_0x443560-0x17f;let _0x3987a0=_0x5148c6[_0x443560];return _0x3987a0;},a125_0x4435(_0x1efb9b,_0x5d65cc);}SettingService=__decorate([(0x0,common_1[a125_0x46b655(0x1a9)])(),__param(0x0,(0x0,mongoose_1[a125_0x46b655(0x18f)])(a125_0x46b655(0x195))),__metadata(a125_0x46b655(0x1b2),[mongoose_2[a125_0x46b655(0x184)]])],SettingService),exports['SettingService']=SettingService;