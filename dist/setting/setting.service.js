'use strict';const a125_0xbc469e=a125_0x1d01;(function(_0xdee9b1,_0xab89e3){const _0x349267=a125_0x1d01,_0x1b8996=_0xdee9b1();while(!![]){try{const _0x3433d5=-parseInt(_0x349267(0xea))/0x1+parseInt(_0x349267(0xcb))/0x2*(parseInt(_0x349267(0xf1))/0x3)+parseInt(_0x349267(0xc2))/0x4*(-parseInt(_0x349267(0xe4))/0x5)+-parseInt(_0x349267(0xe9))/0x6*(parseInt(_0x349267(0xda))/0x7)+-parseInt(_0x349267(0xd7))/0x8+parseInt(_0x349267(0xdc))/0x9+parseInt(_0x349267(0xd1))/0xa*(parseInt(_0x349267(0xc0))/0xb);if(_0x3433d5===_0xab89e3)break;else _0x1b8996['push'](_0x1b8996['shift']());}catch(_0x4f8514){_0x1b8996['push'](_0x1b8996['shift']());}}}(a125_0x46d5,0x731fa));function a125_0x1d01(_0x1e87bc,_0x2aa404){const _0x46d516=a125_0x46d5();return a125_0x1d01=function(_0x1d011e,_0x3e6a9d){_0x1d011e=_0x1d011e-0xba;let _0x5b8ff4=_0x46d516[_0x1d011e];return _0x5b8ff4;},a125_0x1d01(_0x1e87bc,_0x2aa404);}function a125_0x46d5(){const _0x2b8a07=['decorate','save','exec','settingModel','findByIdAndUpdate','Utf8','2adOpSu','killAll','@nestjs/mongoose','isValid','update','../common/crypto','530ULJuLR','schoolId','maxUser','Model','userSetting','toDate','7061504Ebyyth','function','findFirst','14sVHsWZ','parse','6029703XIAecg','./constants','InjectModel','design:paramtypes','SettingService','length','DEFAULT_MAX_USER','__metadata','54220hbXDOh','metadata','decrypt','validateLicenseKey','defineProperty','47826KXwHII','374090zanNyr','Base64','validTo','DD/MM/YYYY','find','enc','licenseKey','604593wcNchF','killJobs','updateExpiryStatus','validFrom','toString','PROCESS_CACHE','create','__param','object','setting','../common/job','@nestjs/common','updateUserSetting','228404rtTvfI','log','84rLOqNj','_id','assign'];a125_0x46d5=function(){return _0x2b8a07;};return a125_0x46d5();}var __decorate=this&&this['__decorate']||function(_0x69de93,_0x3a1f43,_0x1add3f,_0x5d2d07){const _0x10be1a=a125_0x1d01;var _0x33f996=arguments[_0x10be1a(0xe1)],_0x1394e7=_0x33f996<0x3?_0x3a1f43:_0x5d2d07===null?_0x5d2d07=Object['getOwnPropertyDescriptor'](_0x3a1f43,_0x1add3f):_0x5d2d07,_0x37149b;if(typeof Reflect==='object'&&typeof Reflect[_0x10be1a(0xc5)]==='function')_0x1394e7=Reflect[_0x10be1a(0xc5)](_0x69de93,_0x3a1f43,_0x1add3f,_0x5d2d07);else{for(var _0x922abe=_0x69de93['length']-0x1;_0x922abe>=0x0;_0x922abe--)if(_0x37149b=_0x69de93[_0x922abe])_0x1394e7=(_0x33f996<0x3?_0x37149b(_0x1394e7):_0x33f996>0x3?_0x37149b(_0x3a1f43,_0x1add3f,_0x1394e7):_0x37149b(_0x3a1f43,_0x1add3f))||_0x1394e7;}return _0x33f996>0x3&&_0x1394e7&&Object[_0x10be1a(0xe8)](_0x3a1f43,_0x1add3f,_0x1394e7),_0x1394e7;},__metadata=this&&this[a125_0xbc469e(0xe3)]||function(_0x2e8ca1,_0x48598b){const _0x16a503=a125_0xbc469e;if(typeof Reflect===_0x16a503(0xbb)&&typeof Reflect[_0x16a503(0xe5)]===_0x16a503(0xd8))return Reflect[_0x16a503(0xe5)](_0x2e8ca1,_0x48598b);},__param=this&&this[a125_0xbc469e(0xba)]||function(_0x480bd4,_0x402113){return function(_0x12ec96,_0x194568){_0x402113(_0x12ec96,_0x194568,_0x480bd4);};};Object[a125_0xbc469e(0xe8)](exports,'__esModule',{'value':!![]}),exports[a125_0xbc469e(0xe0)]=void 0x0;const common_1=require(a125_0xbc469e(0xbe)),mongoose_1=require(a125_0xbc469e(0xcd)),mongoose_2=require('mongoose'),CryptoJS=require('crypto-js'),dayjs=require('dayjs'),crypto_1=require(a125_0xbc469e(0xd0)),job_1=require(a125_0xbc469e(0xbd)),constants_1=require(a125_0xbc469e(0xdd)),SECRET='QVBFVFVMT1NCQQ==';let SettingService=class SettingService{constructor(_0x42b3da){const _0x2b1115=a125_0xbc469e;this[_0x2b1115(0xc8)]=_0x42b3da;}async[a125_0xbc469e(0xf7)](_0x33ab38){const _0x567b4a=a125_0xbc469e,_0x102e08=new this['settingModel'](_0x33ab38);return _0x102e08[_0x567b4a(0xc6)]();}async['findFirst'](){const _0x2cc976=a125_0xbc469e;var _0xaf9b6d,_0x1de809,_0x8789ed;const _0xd5ccb9=await this[_0x2cc976(0xc8)][_0x2cc976(0xee)]()[_0x2cc976(0xc7)](),_0x562e34=(_0xaf9b6d=_0xd5ccb9[0x0])===null||_0xaf9b6d===void 0x0?void 0x0:_0xaf9b6d['toObject']();if(!_0x562e34)return;return Object['assign'](Object[_0x2cc976(0xc4)]({},_0x562e34),{'userSetting':Object[_0x2cc976(0xc4)](Object['assign']({},_0x562e34[_0x2cc976(0xd5)]),{'maxUser':(_0x8789ed=(_0x1de809=_0x562e34[_0x2cc976(0xd5)])===null||_0x1de809===void 0x0?void 0x0:_0x1de809[_0x2cc976(0xd3)])!==null&&_0x8789ed!==void 0x0?_0x8789ed:constants_1[_0x2cc976(0xe2)]})});}async[a125_0xbc469e(0xcf)](_0x50aba9,_0x23ce22){const _0x37f115=a125_0xbc469e,_0x1ee56a=await this['settingModel'][_0x37f115(0xc9)](_0x50aba9,Object[_0x37f115(0xc4)](Object['assign']({},_0x23ce22),{'updatedAtUtc':new Date()}),{'new':!![]})[_0x37f115(0xc7)]();return _0x1ee56a;}async[a125_0xbc469e(0xf3)](){const _0x101b5d=a125_0xbc469e,_0x37f2bf=await this[_0x101b5d(0xd9)](),_0xc39b4c=this[_0x101b5d(0xe7)](_0x37f2bf[_0x101b5d(0xf0)],_0x37f2bf['schoolId']);return this[_0x101b5d(0xcf)](_0x37f2bf[_0x101b5d(0xc3)],{'isExpired':!_0xc39b4c[_0x101b5d(0xce)]});}async[a125_0xbc469e(0xbf)](_0x48f21c){const _0x1ef438=a125_0xbc469e,_0x195687=await this['findFirst']();return console[_0x1ef438(0xc1)](_0x195687,_0x1ef438(0xbc)),this['update'](_0x195687[_0x1ef438(0xc3)],{'userSetting':_0x48f21c});}[a125_0xbc469e(0xe7)](_0x3df7ca,_0x376e03){const _0xf9ea02=a125_0xbc469e;try{if(!_0x3df7ca)return{'isValid':![],'expiryDate':''};const _0x1517ea=(0x0,crypto_1[_0xf9ea02(0xe6)])(_0x3df7ca,CryptoJS[_0xf9ea02(0xef)][_0xf9ea02(0xeb)][_0xf9ea02(0xdb)](SECRET)[_0xf9ea02(0xf5)](CryptoJS[_0xf9ea02(0xef)][_0xf9ea02(0xca)]));if(_0x1517ea[_0xf9ea02(0xd2)]!==_0x376e03)return{'isValid':![],'expiryDate':''};const _0x3e07a4=dayjs(_0x1517ea[_0xf9ea02(0xf4)],_0xf9ea02(0xed))['toDate'](),_0x433dee=dayjs(_0x1517ea[_0xf9ea02(0xec)],_0xf9ea02(0xed))[_0xf9ea02(0xd6)](),_0x4d7aa1=dayjs()[_0xf9ea02(0xd6)]();if(_0x4d7aa1<_0x3e07a4||_0x4d7aa1>_0x433dee)return{'isValid':![],'expiryDate':_0x1517ea[_0xf9ea02(0xec)]};return{'isValid':!![],'expiryDate':_0x1517ea[_0xf9ea02(0xec)]};}catch(_0x4a2310){return{'isValid':![],'expiryDate':''};}}async[a125_0xbc469e(0xf2)](){const _0x2a4b4d=a125_0xbc469e;job_1[_0x2a4b4d(0xf6)][_0x2a4b4d(0xcc)]();}};SettingService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_1[a125_0xbc469e(0xde)])('Setting')),__metadata(a125_0xbc469e(0xdf),[mongoose_2[a125_0xbc469e(0xd4)]])],SettingService),exports[a125_0xbc469e(0xe0)]=SettingService;