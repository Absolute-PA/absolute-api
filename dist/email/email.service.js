'use strict';var a79_0x33eaf3=a79_0x240e;(function(_0x24aec6,_0xdcb0e5){var _0x5b5df4=a79_0x240e,_0x3063dd=_0x24aec6();while(!![]){try{var _0x5d7ff4=parseInt(_0x5b5df4(0xd9))/0x1+-parseInt(_0x5b5df4(0xe3))/0x2+-parseInt(_0x5b5df4(0xcf))/0x3+parseInt(_0x5b5df4(0xcb))/0x4+-parseInt(_0x5b5df4(0xf8))/0x5+parseInt(_0x5b5df4(0xdb))/0x6*(-parseInt(_0x5b5df4(0xcd))/0x7)+parseInt(_0x5b5df4(0xf0))/0x8;if(_0x5d7ff4===_0xdcb0e5)break;else _0x3063dd['push'](_0x3063dd['shift']());}catch(_0x4ea807){_0x3063dd['push'](_0x3063dd['shift']());}}}(a79_0x21e1,0x49bdd));function a79_0x21e1(){var _0xa19e53=['</pre>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<h3>Request\x20Body:</h3>\x0a\x20\x20\x20\x20\x20\x20<pre\x20style=\x22background-color:\x20#f5f5f5;\x20padding:\x2010px;\x20border-radius:\x204px;\x20overflow:\x20auto;\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<h3>Exception\x20Message:</h3>\x0a\x20\x20\x20\x20\x20\x20<pre\x20style=\x22background-color:\x20#f5f5f5;\x20padding:\x2010px;\x20border-radius:\x204px;\x20overflow:\x20auto;\x22>','method','object','error','\x0aUnhandled\x20Exception\x20Notification\x0a\x0aDevice:\x20','\x0a\x20\x20\x20\x20\x20\x20<h2>Unhandled\x20Exception\x20Notification</h2>\x0a\x20\x20\x20\x20\x20\x20<p><strong>Device:</strong>\x20','defineProperty','debug','Unknown','body','timestamp','Logger','@nestjs/common','Email\x20not\x20configured,\x20skipping\x20exception\x20notification','__decorate',']\x20Unhandled\x20Exception\x20Occurred','EmailService','\x0a\x0aRequest\x20Headers:\x0a','\x22Exception\x20Notifier\x22\x20<no-reply@absolutepa.com>','2107120wFanwE','design:paramtypes','56lIwvsg','\x0aRequest\x20Method:\x20','1539909mlDiNA','name','SMTP_HOST','url','stringify','formatExceptionEmailHtml','EXCEPTION_NOTIFY_EMAIL','N/A','</pre>\x0a\x20\x20\x20\x20','headers','487203VhihLY','trim','233346rzEsJW','nodemailer','piName','SMTP_USER','metadata','__esModule','</p>\x0a\x20\x20\x20\x20\x20\x20<p><strong>Timestamp:</strong>\x20','env','335032ajPNJs','587','message','Exception\x20notification\x20email\x20sent\x20successfully','function','true','toISOString','createTransport','createTransporter','logger','length','\x0a\x0aRequest\x20Body:\x0a','SMTP_PASS','6874096KNQZar','</p>\x0a\x20\x20\x20\x20\x20\x20<p><strong>Request\x20URL:</strong>\x20','Email\x20configuration\x20not\x20found.\x20Exception\x20email\x20notifications\x20will\x20be\x20disabled.','decorate','\x0aRequest\x20URL:\x20','transporter','isEmailConfigured','getOwnPropertyDescriptor','2896265hinNkM'];a79_0x21e1=function(){return _0xa19e53;};return a79_0x21e1();}function a79_0x240e(_0x14fed1,_0x20c214){var _0x21e1fb=a79_0x21e1();return a79_0x240e=function(_0x240ede,_0x5d07e5){_0x240ede=_0x240ede-0xc6;var _0x471f47=_0x21e1fb[_0x240ede];return _0x471f47;},a79_0x240e(_0x14fed1,_0x20c214);}var __decorate=this&&this[a79_0x33eaf3(0xc6)]||function(_0x17eff4,_0x20d1e7,_0x3de61b,_0x1fc0b4){var _0x38648e=a79_0x33eaf3,_0x48ab9d=arguments['length'],_0x1897d5=_0x48ab9d<0x3?_0x20d1e7:_0x1fc0b4===null?_0x1fc0b4=Object[_0x38648e(0xf7)](_0x20d1e7,_0x3de61b):_0x1fc0b4,_0x29dca0;if(typeof Reflect===_0x38648e(0xfc)&&typeof Reflect[_0x38648e(0xf3)]===_0x38648e(0xe7))_0x1897d5=Reflect[_0x38648e(0xf3)](_0x17eff4,_0x20d1e7,_0x3de61b,_0x1fc0b4);else{for(var _0x8f2fc1=_0x17eff4[_0x38648e(0xed)]-0x1;_0x8f2fc1>=0x0;_0x8f2fc1--)if(_0x29dca0=_0x17eff4[_0x8f2fc1])_0x1897d5=(_0x48ab9d<0x3?_0x29dca0(_0x1897d5):_0x48ab9d>0x3?_0x29dca0(_0x20d1e7,_0x3de61b,_0x1897d5):_0x29dca0(_0x20d1e7,_0x3de61b))||_0x1897d5;}return _0x48ab9d>0x3&&_0x1897d5&&Object[_0x38648e(0x100)](_0x20d1e7,_0x3de61b,_0x1897d5),_0x1897d5;},__metadata=this&&this['__metadata']||function(_0x11f63d,_0x42a68d){var _0x474dfd=a79_0x33eaf3;if(typeof Reflect==='object'&&typeof Reflect[_0x474dfd(0xdf)]===_0x474dfd(0xe7))return Reflect['metadata'](_0x11f63d,_0x42a68d);},EmailService_1;Object['defineProperty'](exports,a79_0x33eaf3(0xe0),{'value':!![]}),exports[a79_0x33eaf3(0xc8)]=void 0x0;const common_1=require(a79_0x33eaf3(0x106)),nodemailer=require(a79_0x33eaf3(0xdc));let EmailService=EmailService_1=class EmailService{constructor(){var _0x227b57=a79_0x33eaf3;this['logger']=new common_1[(_0x227b57(0x105))](EmailService_1[_0x227b57(0xd0)]),this[_0x227b57(0xeb)]();}[a79_0x33eaf3(0xeb)](){var _0x5eaf31=a79_0x33eaf3;this[_0x5eaf31(0xf6)]()?this['transporter']=nodemailer[_0x5eaf31(0xea)]({'host':process['env'][_0x5eaf31(0xd1)],'port':parseInt(process[_0x5eaf31(0xe2)]['SMTP_PORT']||_0x5eaf31(0xe4)),'secure':process[_0x5eaf31(0xe2)]['SMTP_SECURE']===_0x5eaf31(0xe8),'auth':{'user':process[_0x5eaf31(0xe2)]['SMTP_USER'],'pass':process['env'][_0x5eaf31(0xef)]}}):this[_0x5eaf31(0xec)]['warn'](_0x5eaf31(0xf2));}[a79_0x33eaf3(0xf6)](){var _0x2aee0e=a79_0x33eaf3;return!!(process[_0x2aee0e(0xe2)][_0x2aee0e(0xd1)]&&process['env'][_0x2aee0e(0xde)]&&process[_0x2aee0e(0xe2)]['SMTP_PASS']&&process[_0x2aee0e(0xe2)][_0x2aee0e(0xd5)]);}async['sendExceptionNotification'](_0x42475f){var _0x8ada73=a79_0x33eaf3;if(!this[_0x8ada73(0xf5)]||!this['isEmailConfigured']()){this[_0x8ada73(0xec)][_0x8ada73(0x101)](_0x8ada73(0x107));return;}try{const _0x18afbd=this['formatExceptionEmail'](_0x42475f);await this['transporter']['sendMail']({'from':process[_0x8ada73(0xe2)]['SMTP_FROM']||_0x8ada73(0xca),'to':process[_0x8ada73(0xe2)][_0x8ada73(0xd5)],'subject':'['+(_0x42475f['piName']||'Unknown\x20Device')+_0x8ada73(0xc7),'text':_0x18afbd,'html':this[_0x8ada73(0xd4)](_0x42475f)}),this[_0x8ada73(0xec)]['log'](_0x8ada73(0xe6));}catch(_0x359644){this['logger'][_0x8ada73(0xfd)]('Failed\x20to\x20send\x20exception\x20notification\x20email:',_0x359644);}}['formatExceptionEmail'](_0x568281){var _0x2be251=a79_0x33eaf3;return(_0x2be251(0xfe)+(_0x568281[_0x2be251(0xdd)]||'Unknown')+'\x0aTimestamp:\x20'+(_0x568281[_0x2be251(0x104)]||new Date()[_0x2be251(0xe9)]())+_0x2be251(0xf4)+(_0x568281['url']||_0x2be251(0xd6))+_0x2be251(0xce)+(_0x568281[_0x2be251(0xfb)]||_0x2be251(0xd6))+'\x0a\x0aException\x20Message:\x0a'+_0x568281[_0x2be251(0xe5)]+_0x2be251(0xee)+(_0x568281[_0x2be251(0x103)]?JSON[_0x2be251(0xd3)](_0x568281[_0x2be251(0x103)],null,0x2):_0x2be251(0xd6))+_0x2be251(0xc9)+(_0x568281[_0x2be251(0xd8)]?JSON['stringify'](_0x568281[_0x2be251(0xd8)],null,0x2):'N/A')+'\x0a\x20\x20\x20\x20')[_0x2be251(0xda)]();}[a79_0x33eaf3(0xd4)](_0x1f589f){var _0x193dc2=a79_0x33eaf3;return _0x193dc2(0xff)+(_0x1f589f['piName']||_0x193dc2(0x102))+_0x193dc2(0xe1)+(_0x1f589f[_0x193dc2(0x104)]||new Date()[_0x193dc2(0xe9)]())+_0x193dc2(0xf1)+(_0x1f589f[_0x193dc2(0xd2)]||_0x193dc2(0xd6))+'</p>\x0a\x20\x20\x20\x20\x20\x20<p><strong>Request\x20Method:</strong>\x20'+(_0x1f589f[_0x193dc2(0xfb)]||_0x193dc2(0xd6))+_0x193dc2(0xfa)+_0x1f589f['message']+_0x193dc2(0xf9)+(_0x1f589f[_0x193dc2(0x103)]?JSON['stringify'](_0x1f589f[_0x193dc2(0x103)],null,0x2):_0x193dc2(0xd6))+'</pre>\x0a\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20<h3>Request\x20Headers:</h3>\x0a\x20\x20\x20\x20\x20\x20<pre\x20style=\x22background-color:\x20#f5f5f5;\x20padding:\x2010px;\x20border-radius:\x204px;\x20overflow:\x20auto;\x22>'+(_0x1f589f[_0x193dc2(0xd8)]?JSON[_0x193dc2(0xd3)](_0x1f589f[_0x193dc2(0xd8)],null,0x2):_0x193dc2(0xd6))+_0x193dc2(0xd7);}};EmailService=EmailService_1=__decorate([(0x0,common_1['Injectable'])(),__metadata(a79_0x33eaf3(0xcc),[])],EmailService),exports[a79_0x33eaf3(0xc8)]=EmailService;