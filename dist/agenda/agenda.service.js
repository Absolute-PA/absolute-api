'use strict';function a2_0x468c(_0x116ea4,_0x3f0a64){const _0x3a60a0=a2_0x3a60();return a2_0x468c=function(_0x468c04,_0x3bc7c1){_0x468c04=_0x468c04-0x7f;let _0x1c464e=_0x3a60a0[_0x468c04];return _0x1c464e;},a2_0x468c(_0x116ea4,_0x3f0a64);}const a2_0x410b03=a2_0x468c;(function(_0x44729f,_0x3642ae){const _0x164670=a2_0x468c,_0xb76a9d=_0x44729f();while(!![]){try{const _0x1f3c53=-parseInt(_0x164670(0x83))/0x1+-parseInt(_0x164670(0xba))/0x2*(-parseInt(_0x164670(0xca))/0x3)+parseInt(_0x164670(0xa5))/0x4*(parseInt(_0x164670(0x8a))/0x5)+parseInt(_0x164670(0x99))/0x6+parseInt(_0x164670(0xbe))/0x7+parseInt(_0x164670(0x9f))/0x8+-parseInt(_0x164670(0xc0))/0x9;if(_0x1f3c53===_0x3642ae)break;else _0xb76a9d['push'](_0xb76a9d['shift']());}catch(_0x4b78c9){_0xb76a9d['push'](_0xb76a9d['shift']());}}}(a2_0x3a60,0xceb80));var __decorate=this&&this[a2_0x410b03(0xb6)]||function(_0x52cf02,_0x814a85,_0x2d2e6b,_0x59379c){const _0x40098c=a2_0x410b03;var _0x22c0f6=arguments[_0x40098c(0x97)],_0x5a7913=_0x22c0f6<0x3?_0x814a85:_0x59379c===null?_0x59379c=Object[_0x40098c(0xb1)](_0x814a85,_0x2d2e6b):_0x59379c,_0x49a22d;if(typeof Reflect===_0x40098c(0xac)&&typeof Reflect[_0x40098c(0x9a)]===_0x40098c(0xb7))_0x5a7913=Reflect[_0x40098c(0x9a)](_0x52cf02,_0x814a85,_0x2d2e6b,_0x59379c);else{for(var _0x128a70=_0x52cf02[_0x40098c(0x97)]-0x1;_0x128a70>=0x0;_0x128a70--)if(_0x49a22d=_0x52cf02[_0x128a70])_0x5a7913=(_0x22c0f6<0x3?_0x49a22d(_0x5a7913):_0x22c0f6>0x3?_0x49a22d(_0x814a85,_0x2d2e6b,_0x5a7913):_0x49a22d(_0x814a85,_0x2d2e6b))||_0x5a7913;}return _0x22c0f6>0x3&&_0x5a7913&&Object['defineProperty'](_0x814a85,_0x2d2e6b,_0x5a7913),_0x5a7913;},__metadata=this&&this[a2_0x410b03(0x8c)]||function(_0xf921f7,_0x4d7c2b){const _0x5146b9=a2_0x410b03;if(typeof Reflect===_0x5146b9(0xac)&&typeof Reflect[_0x5146b9(0xc1)]==='function')return Reflect[_0x5146b9(0xc1)](_0xf921f7,_0x4d7c2b);},AgendaService_1;Object[a2_0x410b03(0x9e)](exports,a2_0x410b03(0x87),{'value':!![]}),exports[a2_0x410b03(0x86)]=void 0x0;const common_1=require(a2_0x410b03(0x90)),nestjs_agenda_1=require(a2_0x410b03(0xaa)),event_emitter_1=require(a2_0x410b03(0x9b)),mongodb_1=require(a2_0x410b03(0xc5)),enums_1=require(a2_0x410b03(0x89)),events_1=require(a2_0x410b03(0x96)),job_1=require(a2_0x410b03(0xab)),dtos_1=require(a2_0x410b03(0x95)),mappers_1=require('./mappers'),voice_mapper_1=require(a2_0x410b03(0x9d)),textToAudio_mapper_1=require(a2_0x410b03(0xc3));let AgendaService=AgendaService_1=class AgendaService{constructor(_0x12989e){const _0x617400=a2_0x410b03;this[_0x617400(0xa2)]=_0x12989e,this['logger']=new common_1[(_0x617400(0xcc))](AgendaService_1[_0x617400(0xa4)]),this[_0x617400(0xa3)]();}async[a2_0x410b03(0xa3)](){const _0x47fcb7=a2_0x410b03;await this['agendaAgent'][_0x47fcb7(0x8e)](),this[_0x47fcb7(0xa2)][_0x47fcb7(0x80)]('0\x200\x20*\x20*\x20*',enums_1[_0x47fcb7(0xaf)][_0x47fcb7(0xcb)]),this[_0x47fcb7(0xa2)][_0x47fcb7(0x80)](_0x47fcb7(0xc6),enums_1[_0x47fcb7(0xaf)]['PurgeTempUploadedFiles']),this['agendaAgent'][_0x47fcb7(0x81)](enums_1[_0x47fcb7(0xaf)][_0x47fcb7(0xcb)],null);}async[a2_0x410b03(0xa8)](){const _0x8b0e9=a2_0x410b03;this[_0x8b0e9(0x91)][_0x8b0e9(0xb5)](_0x8b0e9(0x92)),await this[_0x8b0e9(0xa2)][_0x8b0e9(0xbf)]({'name':{'$in':Object['values'](enums_1[_0x8b0e9(0xa9)])}}),this[_0x8b0e9(0xa2)][_0x8b0e9(0x81)](enums_1[_0x8b0e9(0xaf)][_0x8b0e9(0xcb)],null);}async[a2_0x410b03(0xad)](){const _0x212a10=a2_0x410b03,_0x3eff11=await this[_0x212a10(0xa2)][_0x212a10(0xb4)]({'nextRunAt':{'$exists':!![],'$ne':null}});return _0x3eff11;}async[a2_0x410b03(0x98)](_0x269113){const _0x498f33=a2_0x410b03,_0x30fc09=this[_0x498f33(0xa7)](_0x269113),_0x1a9295=(0x0,dtos_1[_0x498f33(0xc2)])(_0x269113),_0x25fa39=_0x1a9295?_0x269113['when']:_0x269113['every'];let _0x1d42d7;return _0x1a9295?_0x1d42d7=await this['agendaAgent']['schedule'](_0x25fa39,_0x269113[_0x498f33(0x9c)],_0x30fc09):_0x1d42d7=await this[_0x498f33(0xa2)][_0x498f33(0x80)](_0x25fa39,_0x269113['jobType'],_0x30fc09,{'startDate':new Date(_0x269113['startDate']),'endDate':new Date(_0x269113['endDate']),'skipImmediate':!![]}),{'jobId':_0x1d42d7[_0x498f33(0xbb)][_0x498f33(0xa0)][_0x498f33(0xc8)]()};}async[a2_0x410b03(0xc4)](_0x27c2bb){const _0x3110c7=a2_0x410b03,_0x626b72=await this['agendaAgent'][_0x3110c7(0xb4)]({'_id':new mongodb_1[(_0x3110c7(0x85))](_0x27c2bb)});if(!_0x626b72[_0x3110c7(0x97)])return{'success':!![],'message':_0x3110c7(0x88)+_0x27c2bb+_0x3110c7(0xc9)};const _0x2e3695=await this[_0x3110c7(0xa2)][_0x3110c7(0xbf)]({'_id':new mongodb_1[(_0x3110c7(0x85))](_0x27c2bb)});job_1[_0x3110c7(0xbc)]['killProcess'](_0x27c2bb);if(_0x2e3695)return{'success':!![],'message':_0x3110c7(0x88)+_0x27c2bb+'\x20is\x20cancelled'};return{'success':![],'message':_0x3110c7(0xcd)+_0x27c2bb};}async['rescheduleJob'](_0x2f66af,_0x2400ed){const _0x290181=a2_0x410b03;return await this[_0x290181(0xc4)](_0x2f66af),await this[_0x290181(0x98)](_0x2400ed);}[a2_0x410b03(0xa7)](_0xdcec8a){const _0x2e8f66=a2_0x410b03;switch(_0xdcec8a[_0x2e8f66(0x9c)]){case enums_1[_0x2e8f66(0xa9)][_0x2e8f66(0x93)]:{return(0x0,mappers_1[_0x2e8f66(0xb3)])(_0xdcec8a);}case enums_1['JobType'][_0x2e8f66(0xce)]:{return(0x0,mappers_1[_0x2e8f66(0xc7)])(_0xdcec8a);}case enums_1[_0x2e8f66(0xa9)][_0x2e8f66(0xa6)]:{return(0x0,voice_mapper_1['toPlayVoiceCommand'])(_0xdcec8a);}case enums_1[_0x2e8f66(0xa9)][_0x2e8f66(0xb9)]:{return(0x0,textToAudio_mapper_1[_0x2e8f66(0xae)])(_0xdcec8a);}default:throw new common_1[(_0x2e8f66(0x94))](_0x2e8f66(0x84));}}};__decorate([(0x0,event_emitter_1['OnEvent'])(events_1[a2_0x410b03(0x8d)]['Updated']),(0x0,event_emitter_1[a2_0x410b03(0xa1)])(events_1[a2_0x410b03(0x8d)][a2_0x410b03(0xb0)]),(0x0,event_emitter_1['OnEvent'])(events_1[a2_0x410b03(0x7f)][a2_0x410b03(0xb2)]),(0x0,event_emitter_1[a2_0x410b03(0xa1)])(events_1[a2_0x410b03(0x7f)][a2_0x410b03(0x8f)]),(0x0,event_emitter_1[a2_0x410b03(0xa1)])(events_1['EventChangedEvent'][a2_0x410b03(0xb0)]),__metadata(a2_0x410b03(0xb8),Function),__metadata('design:paramtypes',[]),__metadata(a2_0x410b03(0x8b),Promise)],AgendaService['prototype'],a2_0x410b03(0xa8),null),AgendaService=AgendaService_1=__decorate([(0x0,common_1[a2_0x410b03(0x82)])(),__metadata(a2_0x410b03(0xbd),[nestjs_agenda_1[a2_0x410b03(0x86)]])],AgendaService),exports[a2_0x410b03(0x86)]=AgendaService;function a2_0x3a60(){const _0x1dc789=['Job\x20','../common/enums','5OEQzVZ','design:returntype','__metadata','ScheduleChangedEvent','purge','Updated','@nestjs/common','logger','Scheduling\x20events...','PlaySound','NotFoundException','./dtos','../common/events','length','scheduleJob','7352334OjDErz','decorate','@nestjs/event-emitter','jobType','./mappers/voice.mapper','defineProperty','8498344lTBSri','_id','OnEvent','agendaAgent','initialize','name','3819828nAFqgJ','PlayVoiceRecorded','getJobPayload','rescheduleEvents','JobType','@agent-ly/nestjs-agenda','../common/job','object','getJobs','toPlayTextToAudioCommand','BackgroundJobType','Deleted','getOwnPropertyDescriptor','Created','toPlaySoundCommand','jobs','log','__decorate','function','design:type','PlayTextToAudio','1144072teYvCP','attrs','PROCESS_CACHE','design:paramtypes','2058056muaYKP','cancel','22840470dSNdNb','metadata','isScheduleJobDTO','./mappers/textToAudio.mapper','cancelJob','mongodb','0\x200\x20*\x20*\x20*','toPlayMusicCommand','toString','\x20not\x20found','3uWFqao','CheckEvent','Logger','Failed\x20to\x20cancel\x20job\x20','PlayMusic','EventChangedEvent','every','now','Injectable','724133PppoNP','Job\x20type\x20not\x20found','ObjectId','AgendaService','__esModule'];a2_0x3a60=function(){return _0x1dc789;};return a2_0x3a60();}