'use strict';const a9_0x2d455c=a9_0x113b;(function(_0x197e15,_0x60fb88){const _0x11896b=a9_0x113b,_0x17a3d6=_0x197e15();while(!![]){try{const _0x55b901=-parseInt(_0x11896b(0x142))/0x1+parseInt(_0x11896b(0x16a))/0x2*(-parseInt(_0x11896b(0x14d))/0x3)+parseInt(_0x11896b(0x143))/0x4*(-parseInt(_0x11896b(0x183))/0x5)+parseInt(_0x11896b(0x13c))/0x6*(-parseInt(_0x11896b(0x16e))/0x7)+-parseInt(_0x11896b(0x17e))/0x8*(parseInt(_0x11896b(0x15c))/0x9)+parseInt(_0x11896b(0x15e))/0xa+parseInt(_0x11896b(0x145))/0xb;if(_0x55b901===_0x60fb88)break;else _0x17a3d6['push'](_0x17a3d6['shift']());}catch(_0x2e5fd2){_0x17a3d6['push'](_0x17a3d6['shift']());}}}(a9_0x36aa,0xe8830));function a9_0x113b(_0x4c9c96,_0x33265b){const _0x36aab4=a9_0x36aa();return a9_0x113b=function(_0x113b6b,_0x352e0b){_0x113b6b=_0x113b6b-0x13c;let _0x18d17d=_0x36aab4[_0x113b6b];return _0x18d17d;},a9_0x113b(_0x4c9c96,_0x33265b);}var __decorate=this&&this[a9_0x2d455c(0x167)]||function(_0x24ed19,_0x2ecd62,_0xb1713f,_0x54615b){const _0x2e0335=a9_0x2d455c;var _0x3f2f67=arguments[_0x2e0335(0x186)],_0x4508b7=_0x3f2f67<0x3?_0x2ecd62:_0x54615b===null?_0x54615b=Object['getOwnPropertyDescriptor'](_0x2ecd62,_0xb1713f):_0x54615b,_0x1bef0a;if(typeof Reflect===_0x2e0335(0x14a)&&typeof Reflect[_0x2e0335(0x17b)]===_0x2e0335(0x185))_0x4508b7=Reflect[_0x2e0335(0x17b)](_0x24ed19,_0x2ecd62,_0xb1713f,_0x54615b);else{for(var _0x389885=_0x24ed19[_0x2e0335(0x186)]-0x1;_0x389885>=0x0;_0x389885--)if(_0x1bef0a=_0x24ed19[_0x389885])_0x4508b7=(_0x3f2f67<0x3?_0x1bef0a(_0x4508b7):_0x3f2f67>0x3?_0x1bef0a(_0x2ecd62,_0xb1713f,_0x4508b7):_0x1bef0a(_0x2ecd62,_0xb1713f))||_0x4508b7;}return _0x3f2f67>0x3&&_0x4508b7&&Object[_0x2e0335(0x175)](_0x2ecd62,_0xb1713f,_0x4508b7),_0x4508b7;},__metadata=this&&this[a9_0x2d455c(0x16d)]||function(_0x3bde08,_0x119c57){const _0x1b8f2b=a9_0x2d455c;if(typeof Reflect==='object'&&typeof Reflect[_0x1b8f2b(0x144)]==='function')return Reflect['metadata'](_0x3bde08,_0x119c57);},JobProccessor_1;function a9_0x36aa(){const _0x581a34=['10806vWeNdt','\x20-\x20Schedule:\x20','scheduleService','getMinutes','prototype','BackgroundJobType','PlayTextToAudio','jobType','Logger','NODE_ENV','settingService','../schedule/schedule.service','setMinutes','@agent-ly/nestjs-agenda','design:returntype','38457mTYyaQ','Fetching\x20today\x20schedule...','4055710nLSnXS','log','Processor','cancel','attrs','single','name','error','../setting/setting.service','__decorate','AuditActor','design:paramtypes','1012ncYKHH','findEligibleSchedule','purgeTempUploadedFiles','__metadata','3740261yOwlta','__esModule','PlayMusic','split','Scheduling\x20event:\x20','Job','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','defineProperty','JobProccessor','updateExpiryStatus','Event:\x20','../common/file','setHours','decorate','deleteFilesInFolder','getSeconds','1904OKPoyk','agenda','checkEvent','CheckEvent','PlayVoiceRecorded','3127095LnLyjK','schedule','function','length','AgendaService','Canceling\x20all\x20old\x20background\x20checks...','ScheduleService','isExpired','\x20-\x20','data','SettingService','@nestjs/common','agendaService','6hOwhGI','PurgeTempUploadedFiles','events','Eligible\x20schedule:\x20','PlaySound','JobType','337392QsGfpq','12btTcdL','metadata','67477905UAImGG','time','setSeconds','TMP_UPLOAD_DIR','Server\x20time:\x20','object','logger','design:type'];a9_0x36aa=function(){return _0x581a34;};return a9_0x36aa();}Object[a9_0x2d455c(0x175)](exports,a9_0x2d455c(0x16f),{'value':!![]}),exports[a9_0x2d455c(0x176)]=void 0x0;const common_1=require(a9_0x2d455c(0x18e)),agenda_1=require(a9_0x2d455c(0x17f)),nestjs_agenda_1=require(a9_0x2d455c(0x15a)),enums_1=require('../common/enums'),schedule_service_1=require(a9_0x2d455c(0x158)),setting_service_1=require(a9_0x2d455c(0x166)),file_1=require(a9_0x2d455c(0x179)),constants_1=require('../common/constants');let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x48ada4,_0x1ac3d0,_0x97be77){const _0x385b4b=a9_0x2d455c;this[_0x385b4b(0x18f)]=_0x48ada4,this[_0x385b4b(0x14f)]=_0x1ac3d0,this[_0x385b4b(0x157)]=_0x97be77,this[_0x385b4b(0x14b)]=new common_1[(_0x385b4b(0x155))](JobProccessor_1[_0x385b4b(0x164)]);}async[a9_0x2d455c(0x180)](_0x149ca5){const _0x3fee8e=a9_0x2d455c;this[_0x3fee8e(0x14b)][_0x3fee8e(0x15f)](_0x3fee8e(0x149)+new Date()+'.\x20Job:\x20'+_0x149ca5[_0x3fee8e(0x162)][_0x3fee8e(0x164)]);const _0x5c57b8=await this[_0x3fee8e(0x157)][_0x3fee8e(0x177)]();if(_0x5c57b8[_0x3fee8e(0x18a)]){this['logger'][_0x3fee8e(0x15f)]('Invalid\x20or\x20expired\x20license\x20key!');if(process['env'][_0x3fee8e(0x156)]!=='development')return;}this[_0x3fee8e(0x14b)][_0x3fee8e(0x15f)](_0x3fee8e(0x188)),await this[_0x3fee8e(0x18f)][_0x3fee8e(0x161)]({'name':{'$nin':[enums_1[_0x3fee8e(0x152)][_0x3fee8e(0x181)],enums_1[_0x3fee8e(0x152)][_0x3fee8e(0x13d)]]},'type':_0x3fee8e(0x163)}),this['logger'][_0x3fee8e(0x15f)](_0x3fee8e(0x15d));const _0x494c49=await this[_0x3fee8e(0x14f)][_0x3fee8e(0x16b)](new Date());this['logger'][_0x3fee8e(0x15f)](_0x3fee8e(0x13f)+(_0x494c49===null||_0x494c49===void 0x0?void 0x0:_0x494c49['name']));if(!_0x494c49||!_0x494c49[_0x3fee8e(0x13e)]||_0x494c49[_0x3fee8e(0x13e)][_0x3fee8e(0x186)]===0x0)return;_0x494c49[_0x3fee8e(0x13e)]['forEach'](_0x5ccb46=>{const _0x283c1f=_0x3fee8e;this[_0x283c1f(0x14b)][_0x283c1f(0x15f)](_0x283c1f(0x172)+_0x5ccb46[_0x283c1f(0x146)]+_0x283c1f(0x18b)+_0x5ccb46[_0x283c1f(0x154)]+_0x283c1f(0x18b)+_0x5ccb46[_0x283c1f(0x164)]);const _0x2108e8=new Date(),_0x441c68=_0x2108e8['getHours'](),_0x3fcd97=_0x2108e8[_0x283c1f(0x150)](),_0x293cd4=_0x2108e8[_0x283c1f(0x17d)](),[_0x58a090,_0x191741,_0x1f3538]=_0x5ccb46[_0x283c1f(0x146)][_0x283c1f(0x171)](':');if(+_0x58a090<_0x441c68||+_0x58a090===_0x441c68&&+_0x191741<_0x3fcd97||+_0x58a090===_0x441c68&&+_0x191741===_0x3fcd97&&+_0x1f3538<_0x293cd4)return;_0x2108e8[_0x283c1f(0x17a)](+_0x58a090),_0x2108e8[_0x283c1f(0x159)](+_0x191741),_0x2108e8[_0x283c1f(0x147)](+_0x1f3538);switch(_0x5ccb46[_0x283c1f(0x154)]){case enums_1['JobType'][_0x283c1f(0x140)]:{const {soundId:_0x53dfc5,durationInSecond:_0x34c4f6}=_0x5ccb46[_0x283c1f(0x18c)];if(!_0x53dfc5)return;const _0x472259={'soundId':_0x53dfc5,'durationInSecond':_0x34c4f6,'audit':{'actor':enums_1[_0x283c1f(0x168)][_0x283c1f(0x173)],'name':enums_1['JobType']['PlaySound'],'message':_0x283c1f(0x178)+_0x5ccb46[_0x283c1f(0x164)]+'\x20-\x20Schedule:\x20'+_0x494c49[_0x283c1f(0x164)]}};this[_0x283c1f(0x18f)][_0x283c1f(0x184)](_0x2108e8,enums_1[_0x283c1f(0x141)][_0x283c1f(0x140)],_0x472259);break;}case enums_1[_0x283c1f(0x141)][_0x283c1f(0x170)]:{const {playlistId:_0x17e566,durationInSecond:_0xe7b246}=_0x5ccb46[_0x283c1f(0x18c)];if(!_0x17e566)return;const _0x225e68={'playlistId':_0x17e566,'durationInSecond':_0xe7b246,'audit':{'actor':enums_1[_0x283c1f(0x168)][_0x283c1f(0x173)],'name':enums_1['JobType'][_0x283c1f(0x170)],'message':_0x283c1f(0x178)+_0x5ccb46[_0x283c1f(0x164)]+_0x283c1f(0x14e)+_0x494c49[_0x283c1f(0x164)]}};this[_0x283c1f(0x18f)][_0x283c1f(0x184)](_0x2108e8,enums_1[_0x283c1f(0x141)][_0x283c1f(0x170)],_0x225e68);break;}case enums_1['JobType'][_0x283c1f(0x182)]:{const {voiceId:_0x58e2c9,durationInSecond:_0x13ea0b}=_0x5ccb46['data'];if(!_0x58e2c9)return;const _0x53bf4={'voiceId':_0x58e2c9,'durationInSecond':_0x13ea0b,'audit':{'actor':enums_1[_0x283c1f(0x168)][_0x283c1f(0x173)],'name':enums_1[_0x283c1f(0x141)][_0x283c1f(0x182)],'message':_0x283c1f(0x178)+_0x5ccb46[_0x283c1f(0x164)]+_0x283c1f(0x14e)+_0x494c49[_0x283c1f(0x164)]}};this[_0x283c1f(0x18f)][_0x283c1f(0x184)](_0x2108e8,enums_1[_0x283c1f(0x141)]['PlayVoiceRecorded'],_0x53bf4);break;}case enums_1['JobType']['PlayTextToAudio']:{const {textToAudioId:_0x33815c,durationInSecond:_0x76f30d}=_0x5ccb46[_0x283c1f(0x18c)];if(!_0x33815c)return;const _0x1f1d9f={'textToAudioId':_0x33815c,'durationInSecond':_0x76f30d,'audit':{'actor':enums_1['AuditActor'][_0x283c1f(0x173)],'name':enums_1[_0x283c1f(0x141)][_0x283c1f(0x153)],'message':_0x283c1f(0x178)+_0x5ccb46['name']+_0x283c1f(0x14e)+_0x494c49[_0x283c1f(0x164)]}};this[_0x283c1f(0x18f)][_0x283c1f(0x184)](_0x2108e8,enums_1[_0x283c1f(0x141)][_0x283c1f(0x153)],_0x1f1d9f);break;}default:return;}}),this[_0x3fee8e(0x14b)][_0x3fee8e(0x15f)]('Events\x20scheduled!');}async[a9_0x2d455c(0x16c)](_0x2f5949){const _0x467691=a9_0x2d455c;this[_0x467691(0x14b)][_0x467691(0x15f)]('Purging\x20temp\x20uploaded\x20files...');const {success:_0x2cb9ac,message:_0x4c75de}=await(0x0,file_1[_0x467691(0x17c)])(constants_1[_0x467691(0x148)]);!_0x2cb9ac&&this[_0x467691(0x14b)][_0x467691(0x165)](_0x467691(0x174)+_0x4c75de);}};__decorate([(0x0,nestjs_agenda_1['Define'])(enums_1['BackgroundJobType'][a9_0x2d455c(0x181)]),__metadata(a9_0x2d455c(0x14c),Function),__metadata(a9_0x2d455c(0x169),[agenda_1[a9_0x2d455c(0x173)]]),__metadata(a9_0x2d455c(0x15b),Promise)],JobProccessor[a9_0x2d455c(0x151)],a9_0x2d455c(0x180),null),__decorate([(0x0,nestjs_agenda_1['Define'])(enums_1[a9_0x2d455c(0x152)]['PurgeTempUploadedFiles']),__metadata('design:type',Function),__metadata(a9_0x2d455c(0x169),[agenda_1[a9_0x2d455c(0x173)]]),__metadata(a9_0x2d455c(0x15b),Promise)],JobProccessor[a9_0x2d455c(0x151)],'purgeTempUploadedFiles',null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1[a9_0x2d455c(0x160)])(),__metadata(a9_0x2d455c(0x169),[nestjs_agenda_1[a9_0x2d455c(0x187)],schedule_service_1[a9_0x2d455c(0x189)],setting_service_1[a9_0x2d455c(0x18d)]])],JobProccessor),exports[a9_0x2d455c(0x176)]=JobProccessor;