'use strict';const a9_0x3d0a66=a9_0x4365;(function(_0x1a5541,_0xae9dce){const _0x12bf32=a9_0x4365,_0x3c34dd=_0x1a5541();while(!![]){try{const _0x3a548a=parseInt(_0x12bf32(0x1f5))/0x1+-parseInt(_0x12bf32(0x1d5))/0x2+parseInt(_0x12bf32(0x20c))/0x3*(parseInt(_0x12bf32(0x1ca))/0x4)+parseInt(_0x12bf32(0x1cb))/0x5*(parseInt(_0x12bf32(0x1cd))/0x6)+parseInt(_0x12bf32(0x210))/0x7+parseInt(_0x12bf32(0x1e3))/0x8+-parseInt(_0x12bf32(0x1ff))/0x9*(parseInt(_0x12bf32(0x1e5))/0xa);if(_0x3a548a===_0xae9dce)break;else _0x3c34dd['push'](_0x3c34dd['shift']());}catch(_0x3cd69d){_0x3c34dd['push'](_0x3c34dd['shift']());}}}(a9_0x39da,0x3d42a));function a9_0x4365(_0x114cd9,_0x53be20){const _0x39da49=a9_0x39da();return a9_0x4365=function(_0x4365c5,_0x2bf569){_0x4365c5=_0x4365c5-0x1c0;let _0xdb9721=_0x39da49[_0x4365c5];return _0xdb9721;},a9_0x4365(_0x114cd9,_0x53be20);}var __decorate=this&&this[a9_0x3d0a66(0x204)]||function(_0x2e440d,_0x3d48a5,_0x4c6466,_0x11e38f){const _0x43bd98=a9_0x3d0a66;var _0x43888a=arguments[_0x43bd98(0x1dc)],_0x2a1549=_0x43888a<0x3?_0x3d48a5:_0x11e38f===null?_0x11e38f=Object[_0x43bd98(0x1fb)](_0x3d48a5,_0x4c6466):_0x11e38f,_0xf3b87;if(typeof Reflect===_0x43bd98(0x202)&&typeof Reflect[_0x43bd98(0x20d)]===_0x43bd98(0x1fc))_0x2a1549=Reflect[_0x43bd98(0x20d)](_0x2e440d,_0x3d48a5,_0x4c6466,_0x11e38f);else{for(var _0x2c0bdb=_0x2e440d['length']-0x1;_0x2c0bdb>=0x0;_0x2c0bdb--)if(_0xf3b87=_0x2e440d[_0x2c0bdb])_0x2a1549=(_0x43888a<0x3?_0xf3b87(_0x2a1549):_0x43888a>0x3?_0xf3b87(_0x3d48a5,_0x4c6466,_0x2a1549):_0xf3b87(_0x3d48a5,_0x4c6466))||_0x2a1549;}return _0x43888a>0x3&&_0x2a1549&&Object['defineProperty'](_0x3d48a5,_0x4c6466,_0x2a1549),_0x2a1549;},__metadata=this&&this[a9_0x3d0a66(0x1e8)]||function(_0x420e6c,_0x5b8b7e){const _0xc1e484=a9_0x3d0a66;if(typeof Reflect==='object'&&typeof Reflect[_0xc1e484(0x20f)]===_0xc1e484(0x1fc))return Reflect['metadata'](_0x420e6c,_0x5b8b7e);},JobProccessor_1;Object[a9_0x3d0a66(0x1d1)](exports,a9_0x3d0a66(0x1e4),{'value':!![]}),exports[a9_0x3d0a66(0x1f1)]=void 0x0;const common_1=require(a9_0x3d0a66(0x1c5)),agenda_1=require('agenda'),nestjs_agenda_1=require(a9_0x3d0a66(0x203)),enums_1=require('../common/enums'),schedule_service_1=require(a9_0x3d0a66(0x1ef)),setting_service_1=require(a9_0x3d0a66(0x1fa)),file_1=require(a9_0x3d0a66(0x208)),constants_1=require('../common/constants');let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x762f06,_0x5072af,_0x126324){const _0x26ce6d=a9_0x3d0a66;this[_0x26ce6d(0x1db)]=_0x762f06,this[_0x26ce6d(0x209)]=_0x5072af,this[_0x26ce6d(0x20b)]=_0x126324,this[_0x26ce6d(0x1d4)]=new common_1['Logger'](JobProccessor_1[_0x26ce6d(0x1da)]);}async['checkEvent'](_0x37bce6){const _0x3a7f7d=a9_0x3d0a66;this[_0x3a7f7d(0x1d4)][_0x3a7f7d(0x1f2)](_0x3a7f7d(0x1f9)+new Date()+'.\x20Job:\x20'+_0x37bce6[_0x3a7f7d(0x1cf)][_0x3a7f7d(0x1da)]);const _0x241fef=await this[_0x3a7f7d(0x20b)]['updateExpiryStatus']();if(_0x241fef['isExpired']){this['logger'][_0x3a7f7d(0x1f2)](_0x3a7f7d(0x1f3));if(process[_0x3a7f7d(0x1c8)][_0x3a7f7d(0x1c9)]!==_0x3a7f7d(0x200))return;}this[_0x3a7f7d(0x1d4)]['log'](_0x3a7f7d(0x207)),await this[_0x3a7f7d(0x1db)]['cancel']({'name':{'$nin':[enums_1[_0x3a7f7d(0x1c6)]['CheckEvent'],enums_1['BackgroundJobType'][_0x3a7f7d(0x201)]]},'type':_0x3a7f7d(0x1cc)}),this[_0x3a7f7d(0x1d4)][_0x3a7f7d(0x1f2)]('Fetching\x20today\x20schedule...');const _0x11f396=await this[_0x3a7f7d(0x209)][_0x3a7f7d(0x1c1)](new Date());this[_0x3a7f7d(0x1d4)][_0x3a7f7d(0x1f2)](_0x3a7f7d(0x1d9)+(_0x11f396===null||_0x11f396===void 0x0?void 0x0:_0x11f396[_0x3a7f7d(0x1da)]));if(!_0x11f396||!_0x11f396[_0x3a7f7d(0x1f8)]||_0x11f396['events'][_0x3a7f7d(0x1dc)]===0x0)return;_0x11f396[_0x3a7f7d(0x1f8)][_0x3a7f7d(0x1fd)](_0xe9c0b5=>{const _0x16e707=_0x3a7f7d;this[_0x16e707(0x1d4)][_0x16e707(0x1f2)](_0x16e707(0x1d3)+_0xe9c0b5[_0x16e707(0x1c4)]+'\x20-\x20'+_0xe9c0b5[_0x16e707(0x1ce)]+_0x16e707(0x1d8)+_0xe9c0b5['name']);const _0x1cb702=new Date(),_0x30762f=_0x1cb702[_0x16e707(0x1e1)](),_0x52426e=_0x1cb702[_0x16e707(0x1e0)](),_0x5b72d9=_0x1cb702[_0x16e707(0x1dd)](),[_0x477a42,_0x4a8177,_0x147935]=_0xe9c0b5['time'][_0x16e707(0x1f4)](':');if(+_0x477a42<_0x30762f||+_0x477a42===_0x30762f&&+_0x4a8177<_0x52426e||+_0x477a42===_0x30762f&&+_0x4a8177===_0x52426e&&+_0x147935<_0x5b72d9)return;_0x1cb702[_0x16e707(0x1c3)](+_0x477a42),_0x1cb702[_0x16e707(0x1eb)](+_0x4a8177),_0x1cb702[_0x16e707(0x1e2)](+_0x147935);switch(_0xe9c0b5[_0x16e707(0x1ce)]){case enums_1[_0x16e707(0x1de)][_0x16e707(0x1fe)]:{const {soundId:_0x48aab6,durationInSecond:_0x182415}=_0xe9c0b5['data'];if(!_0x48aab6)return;const _0x26e59b={'soundId':_0x48aab6,'durationInSecond':_0x182415,'audit':{'actor':enums_1[_0x16e707(0x1d7)][_0x16e707(0x20e)],'name':enums_1[_0x16e707(0x1de)][_0x16e707(0x1fe)],'message':'Event:\x20'+_0xe9c0b5[_0x16e707(0x1da)]+'\x20-\x20Schedule:\x20'+_0x11f396[_0x16e707(0x1da)]}};this['agendaService'][_0x16e707(0x1f7)](_0x1cb702,enums_1['JobType'][_0x16e707(0x1fe)],_0x26e59b);break;}case enums_1[_0x16e707(0x1de)][_0x16e707(0x1e6)]:{const {playlistId:_0x32d572,durationInSecond:_0x2f07c0}=_0xe9c0b5[_0x16e707(0x1d2)];if(!_0x32d572)return;const _0x28644e={'playlistId':_0x32d572,'durationInSecond':_0x2f07c0,'audit':{'actor':enums_1[_0x16e707(0x1d7)][_0x16e707(0x20e)],'name':enums_1[_0x16e707(0x1de)][_0x16e707(0x1e6)],'message':'Event:\x20'+_0xe9c0b5[_0x16e707(0x1da)]+'\x20-\x20Schedule:\x20'+_0x11f396[_0x16e707(0x1da)]}};this[_0x16e707(0x1db)][_0x16e707(0x1f7)](_0x1cb702,enums_1[_0x16e707(0x1de)][_0x16e707(0x1e6)],_0x28644e);break;}case enums_1[_0x16e707(0x1de)][_0x16e707(0x1f6)]:{const {voiceId:_0x33436c,durationInSecond:_0x3f7aea}=_0xe9c0b5[_0x16e707(0x1d2)];if(!_0x33436c)return;const _0x110082={'voiceId':_0x33436c,'durationInSecond':_0x3f7aea,'audit':{'actor':enums_1[_0x16e707(0x1d7)][_0x16e707(0x20e)],'name':enums_1[_0x16e707(0x1de)][_0x16e707(0x1f6)],'message':_0x16e707(0x1ed)+_0xe9c0b5['name']+'\x20-\x20Schedule:\x20'+_0x11f396[_0x16e707(0x1da)]}};this[_0x16e707(0x1db)]['schedule'](_0x1cb702,enums_1[_0x16e707(0x1de)][_0x16e707(0x1f6)],_0x110082);break;}case enums_1[_0x16e707(0x1de)][_0x16e707(0x212)]:{const {textToAudioId:_0x5429ee,durationInSecond:_0x3f493a}=_0xe9c0b5[_0x16e707(0x1d2)];if(!_0x5429ee)return;const _0x21442c={'textToAudioId':_0x5429ee,'durationInSecond':_0x3f493a,'audit':{'actor':enums_1[_0x16e707(0x1d7)][_0x16e707(0x20e)],'name':enums_1[_0x16e707(0x1de)][_0x16e707(0x212)],'message':_0x16e707(0x1ed)+_0xe9c0b5['name']+'\x20-\x20Schedule:\x20'+_0x11f396['name']}};this['agendaService'][_0x16e707(0x1f7)](_0x1cb702,enums_1['JobType'][_0x16e707(0x212)],_0x21442c);break;}default:return;}}),this[_0x3a7f7d(0x1d4)][_0x3a7f7d(0x1f2)]('Events\x20scheduled!');}async['purgeTempUploadedFiles'](_0x4cabcd){const _0x599d70=a9_0x3d0a66;this[_0x599d70(0x1d4)][_0x599d70(0x1f2)](_0x599d70(0x1c2));const {success:_0x32f4e1,message:_0x3e9db1}=await(0x0,file_1[_0x599d70(0x211)])(constants_1[_0x599d70(0x1df)]);!_0x32f4e1&&this[_0x599d70(0x1d4)][_0x599d70(0x1d0)](_0x599d70(0x1e7)+_0x3e9db1);}};function a9_0x39da(){const _0x5f2b76=['../schedule/schedule.service','purgeTempUploadedFiles','JobProccessor','log','Invalid\x20or\x20expired\x20license\x20key!','split','183066MASjCf','PlayVoiceRecorded','schedule','events','Server\x20time:\x20','../setting/setting.service','getOwnPropertyDescriptor','function','forEach','PlaySound','18PiQDGC','development','PurgeTempUploadedFiles','object','@agent-ly/nestjs-agenda','__decorate','prototype','ScheduleService','Canceling\x20all\x20old\x20background\x20checks...','../common/file','scheduleService','checkEvent','settingService','3QcDNzr','decorate','Job','metadata','80787OnHKNp','deleteFilesInFolder','PlayTextToAudio','design:type','findEligibleSchedule','Purging\x20temp\x20uploaded\x20files...','setHours','time','@nestjs/common','BackgroundJobType','CheckEvent','env','NODE_ENV','1817332rFmvUX','2227405KyhOJx','single','6nrPrPr','jobType','attrs','error','defineProperty','data','Scheduling\x20event:\x20','logger','169560nKiMgk','design:returntype','AuditActor','\x20-\x20','Eligible\x20schedule:\x20','name','agendaService','length','getSeconds','JobType','TMP_UPLOAD_DIR','getMinutes','getHours','setSeconds','3604120XNosqb','__esModule','6046170zZHVJq','PlayMusic','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','__metadata','Processor','Define','setMinutes','design:paramtypes','Event:\x20','AgendaService'];a9_0x39da=function(){return _0x5f2b76;};return a9_0x39da();}__decorate([(0x0,nestjs_agenda_1['Define'])(enums_1[a9_0x3d0a66(0x1c6)][a9_0x3d0a66(0x1c7)]),__metadata('design:type',Function),__metadata(a9_0x3d0a66(0x1ec),[agenda_1[a9_0x3d0a66(0x20e)]]),__metadata(a9_0x3d0a66(0x1d6),Promise)],JobProccessor[a9_0x3d0a66(0x205)],a9_0x3d0a66(0x20a),null),__decorate([(0x0,nestjs_agenda_1[a9_0x3d0a66(0x1ea)])(enums_1['BackgroundJobType'][a9_0x3d0a66(0x201)]),__metadata(a9_0x3d0a66(0x1c0),Function),__metadata(a9_0x3d0a66(0x1ec),[agenda_1['Job']]),__metadata(a9_0x3d0a66(0x1d6),Promise)],JobProccessor['prototype'],a9_0x3d0a66(0x1f0),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1[a9_0x3d0a66(0x1e9)])(),__metadata(a9_0x3d0a66(0x1ec),[nestjs_agenda_1[a9_0x3d0a66(0x1ee)],schedule_service_1[a9_0x3d0a66(0x206)],setting_service_1['SettingService']])],JobProccessor),exports['JobProccessor']=JobProccessor;