'use strict';const a9_0x3596a6=a9_0xf732;(function(_0x17f1ec,_0x2c4eab){const _0x39371d=a9_0xf732,_0x250b6c=_0x17f1ec();while(!![]){try{const _0x4a5de3=parseInt(_0x39371d(0x16e))/0x1+-parseInt(_0x39371d(0x18d))/0x2+-parseInt(_0x39371d(0x17f))/0x3*(-parseInt(_0x39371d(0x16b))/0x4)+-parseInt(_0x39371d(0x1a1))/0x5+parseInt(_0x39371d(0x166))/0x6*(-parseInt(_0x39371d(0x19a))/0x7)+parseInt(_0x39371d(0x18c))/0x8*(parseInt(_0x39371d(0x197))/0x9)+-parseInt(_0x39371d(0x1a5))/0xa*(-parseInt(_0x39371d(0x19e))/0xb);if(_0x4a5de3===_0x2c4eab)break;else _0x250b6c['push'](_0x250b6c['shift']());}catch(_0x2fe77b){_0x250b6c['push'](_0x250b6c['shift']());}}}(a9_0x4f9b,0x3c93d));function a9_0xf732(_0x27e57b,_0x2bc4c3){const _0x4f9bdb=a9_0x4f9b();return a9_0xf732=function(_0xf7321d,_0x1ae0d1){_0xf7321d=_0xf7321d-0x163;let _0x5ab03c=_0x4f9bdb[_0xf7321d];return _0x5ab03c;},a9_0xf732(_0x27e57b,_0x2bc4c3);}function a9_0x4f9b(){const _0x1f4ffd=['__decorate','design:paramtypes','settingService','BackgroundJobType','attrs','PlayVoiceRecorded','design:type','12EcyALw','Processor','design:returntype','getHours','Event:\x20','6440dXfBOf','agenda','ScheduleService','203990dojwmM','.\x20Job:\x20','updateExpiryStatus','object','log','agendaService','Fetching\x20today\x20schedule...','isExpired','../common/file','Job','PlayTextToAudio','defineProperty','data','PlayMusic','logger','schedule','Purging\x20temp\x20uploaded\x20files...','237LyJxRk','Define','setSeconds','jobType','Logger','cancel','split','scheduleService','NODE_ENV','AuditActor','Events\x20scheduled!','single','decorate','1105240tjjDey','991540JtRiuR','\x20-\x20Schedule:\x20','prototype','checkEvent','__esModule','PurgeTempUploadedFiles','../setting/setting.service','\x20-\x20','../common/constants','time','9ollyix','env','TMP_UPLOAD_DIR','108360meuqKS','../schedule/schedule.service','deleteFilesInFolder','Invalid\x20or\x20expired\x20license\x20key!','5418611rJrnSD','JobProccessor','CheckEvent','935405coWscu','../common/enums','Server\x20time:\x20','setMinutes','10MRfGwk','purgeTempUploadedFiles','name','JobType','error','PlaySound','__metadata','function','@agent-ly/nestjs-agenda','Scheduling\x20event:\x20','metadata','getMinutes','findEligibleSchedule','setHours','length','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','events'];a9_0x4f9b=function(){return _0x1f4ffd;};return a9_0x4f9b();}var __decorate=this&&this[a9_0x3596a6(0x1b6)]||function(_0x2b4eda,_0x3f25c2,_0x4ef589,_0x5e95fa){const _0x15d20e=a9_0x3596a6;var _0x392f52=arguments[_0x15d20e(0x1b3)],_0x6af7bd=_0x392f52<0x3?_0x3f25c2:_0x5e95fa===null?_0x5e95fa=Object['getOwnPropertyDescriptor'](_0x3f25c2,_0x4ef589):_0x5e95fa,_0x5cb0ce;if(typeof Reflect===_0x15d20e(0x171)&&typeof Reflect[_0x15d20e(0x18b)]===_0x15d20e(0x1ac))_0x6af7bd=Reflect[_0x15d20e(0x18b)](_0x2b4eda,_0x3f25c2,_0x4ef589,_0x5e95fa);else{for(var _0x50c96d=_0x2b4eda['length']-0x1;_0x50c96d>=0x0;_0x50c96d--)if(_0x5cb0ce=_0x2b4eda[_0x50c96d])_0x6af7bd=(_0x392f52<0x3?_0x5cb0ce(_0x6af7bd):_0x392f52>0x3?_0x5cb0ce(_0x3f25c2,_0x4ef589,_0x6af7bd):_0x5cb0ce(_0x3f25c2,_0x4ef589))||_0x6af7bd;}return _0x392f52>0x3&&_0x6af7bd&&Object[_0x15d20e(0x179)](_0x3f25c2,_0x4ef589,_0x6af7bd),_0x6af7bd;},__metadata=this&&this[a9_0x3596a6(0x1ab)]||function(_0x506f33,_0x436e33){const _0x326640=a9_0x3596a6;if(typeof Reflect===_0x326640(0x171)&&typeof Reflect[_0x326640(0x1af)]===_0x326640(0x1ac))return Reflect[_0x326640(0x1af)](_0x506f33,_0x436e33);},JobProccessor_1;Object[a9_0x3596a6(0x179)](exports,a9_0x3596a6(0x191),{'value':!![]}),exports[a9_0x3596a6(0x19f)]=void 0x0;const common_1=require('@nestjs/common'),agenda_1=require(a9_0x3596a6(0x16c)),nestjs_agenda_1=require(a9_0x3596a6(0x1ad)),enums_1=require(a9_0x3596a6(0x1a2)),schedule_service_1=require(a9_0x3596a6(0x19b)),setting_service_1=require(a9_0x3596a6(0x193)),file_1=require(a9_0x3596a6(0x176)),constants_1=require(a9_0x3596a6(0x195));let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x1196e7,_0x51981b,_0x5b5584){const _0x2eee16=a9_0x3596a6;this[_0x2eee16(0x173)]=_0x1196e7,this['scheduleService']=_0x51981b,this[_0x2eee16(0x1b8)]=_0x5b5584,this['logger']=new common_1[(_0x2eee16(0x183))](JobProccessor_1[_0x2eee16(0x1a7)]);}async[a9_0x3596a6(0x190)](_0x5f0593){const _0x4ed9cd=a9_0x3596a6;this[_0x4ed9cd(0x17c)][_0x4ed9cd(0x172)](_0x4ed9cd(0x1a3)+new Date()+_0x4ed9cd(0x16f)+_0x5f0593[_0x4ed9cd(0x163)][_0x4ed9cd(0x1a7)]);const _0x209060=await this['settingService'][_0x4ed9cd(0x170)]();if(_0x209060[_0x4ed9cd(0x175)]){this['logger'][_0x4ed9cd(0x172)](_0x4ed9cd(0x19d));if(process[_0x4ed9cd(0x198)][_0x4ed9cd(0x187)]!=='development')return;}this[_0x4ed9cd(0x17c)]['log']('Canceling\x20all\x20old\x20background\x20checks...'),await this['agendaService'][_0x4ed9cd(0x184)]({'name':{'$nin':[enums_1[_0x4ed9cd(0x1b9)][_0x4ed9cd(0x1a0)],enums_1[_0x4ed9cd(0x1b9)][_0x4ed9cd(0x192)]]},'type':_0x4ed9cd(0x18a)}),this[_0x4ed9cd(0x17c)][_0x4ed9cd(0x172)](_0x4ed9cd(0x174));const _0x4a45d4=await this[_0x4ed9cd(0x186)][_0x4ed9cd(0x1b1)](new Date());this['logger'][_0x4ed9cd(0x172)]('Eligible\x20schedule:\x20'+(_0x4a45d4===null||_0x4a45d4===void 0x0?void 0x0:_0x4a45d4[_0x4ed9cd(0x1a7)]));if(!_0x4a45d4||!_0x4a45d4[_0x4ed9cd(0x1b5)]||_0x4a45d4['events']['length']===0x0)return;_0x4a45d4[_0x4ed9cd(0x1b5)]['forEach'](_0x2f546e=>{const _0x5311c3=_0x4ed9cd;this[_0x5311c3(0x17c)][_0x5311c3(0x172)](_0x5311c3(0x1ae)+_0x2f546e[_0x5311c3(0x196)]+_0x5311c3(0x194)+_0x2f546e[_0x5311c3(0x182)]+'\x20-\x20'+_0x2f546e[_0x5311c3(0x1a7)]);const _0x5ed1fb=new Date(),_0x414533=_0x5ed1fb[_0x5311c3(0x169)](),_0x40989c=_0x5ed1fb[_0x5311c3(0x1b0)](),_0x5d4208=_0x5ed1fb['getSeconds'](),[_0x303252,_0x204bbc,_0xcc53b]=_0x2f546e[_0x5311c3(0x196)][_0x5311c3(0x185)](':');if(+_0x303252<_0x414533||+_0x303252===_0x414533&&+_0x204bbc<_0x40989c||+_0x303252===_0x414533&&+_0x204bbc===_0x40989c&&+_0xcc53b<_0x5d4208)return;_0x5ed1fb[_0x5311c3(0x1b2)](+_0x303252),_0x5ed1fb[_0x5311c3(0x1a4)](+_0x204bbc),_0x5ed1fb[_0x5311c3(0x181)](+_0xcc53b);switch(_0x2f546e[_0x5311c3(0x182)]){case enums_1['JobType'][_0x5311c3(0x1aa)]:{const {soundId:_0xee8a32,durationInSecond:_0x55aaab}=_0x2f546e[_0x5311c3(0x17a)];if(!_0xee8a32)return;const _0x397922={'soundId':_0xee8a32,'durationInSecond':_0x55aaab,'audit':{'actor':enums_1['AuditActor'][_0x5311c3(0x177)],'name':enums_1[_0x5311c3(0x1a8)][_0x5311c3(0x1aa)],'message':_0x5311c3(0x16a)+_0x2f546e[_0x5311c3(0x1a7)]+_0x5311c3(0x18e)+_0x4a45d4[_0x5311c3(0x1a7)]}};this['agendaService'][_0x5311c3(0x17d)](_0x5ed1fb,enums_1[_0x5311c3(0x1a8)]['PlaySound'],_0x397922);break;}case enums_1['JobType']['PlayMusic']:{const {playlistId:_0x40bbc5,durationInSecond:_0xedfed}=_0x2f546e[_0x5311c3(0x17a)];if(!_0x40bbc5)return;const _0x2e3d3d={'playlistId':_0x40bbc5,'durationInSecond':_0xedfed,'audit':{'actor':enums_1['AuditActor']['Job'],'name':enums_1['JobType']['PlayMusic'],'message':_0x5311c3(0x16a)+_0x2f546e[_0x5311c3(0x1a7)]+_0x5311c3(0x18e)+_0x4a45d4[_0x5311c3(0x1a7)]}};this['agendaService']['schedule'](_0x5ed1fb,enums_1['JobType'][_0x5311c3(0x17b)],_0x2e3d3d);break;}case enums_1[_0x5311c3(0x1a8)][_0x5311c3(0x164)]:{const {voiceId:_0x58ca06,durationInSecond:_0x229d47}=_0x2f546e['data'];if(!_0x58ca06)return;const _0x4f86ec={'voiceId':_0x58ca06,'durationInSecond':_0x229d47,'audit':{'actor':enums_1['AuditActor']['Job'],'name':enums_1[_0x5311c3(0x1a8)][_0x5311c3(0x164)],'message':_0x5311c3(0x16a)+_0x2f546e[_0x5311c3(0x1a7)]+_0x5311c3(0x18e)+_0x4a45d4[_0x5311c3(0x1a7)]}};this[_0x5311c3(0x173)][_0x5311c3(0x17d)](_0x5ed1fb,enums_1[_0x5311c3(0x1a8)]['PlayVoiceRecorded'],_0x4f86ec);break;}case enums_1['JobType'][_0x5311c3(0x178)]:{const {textToAudioId:_0x4ab9b1,durationInSecond:_0x387822}=_0x2f546e[_0x5311c3(0x17a)];if(!_0x4ab9b1)return;const _0x1b5329={'textToAudioId':_0x4ab9b1,'durationInSecond':_0x387822,'audit':{'actor':enums_1[_0x5311c3(0x188)][_0x5311c3(0x177)],'name':enums_1[_0x5311c3(0x1a8)]['PlayTextToAudio'],'message':_0x5311c3(0x16a)+_0x2f546e['name']+'\x20-\x20Schedule:\x20'+_0x4a45d4[_0x5311c3(0x1a7)]}};this['agendaService'][_0x5311c3(0x17d)](_0x5ed1fb,enums_1['JobType'][_0x5311c3(0x178)],_0x1b5329);break;}default:return;}}),this['logger'][_0x4ed9cd(0x172)](_0x4ed9cd(0x189));}async[a9_0x3596a6(0x1a6)](_0x259930){const _0x27394c=a9_0x3596a6;this['logger']['log'](_0x27394c(0x17e));const {success:_0x56619a,message:_0xda976c}=await(0x0,file_1[_0x27394c(0x19c)])(constants_1[_0x27394c(0x199)]);!_0x56619a&&this[_0x27394c(0x17c)][_0x27394c(0x1a9)](_0x27394c(0x1b4)+_0xda976c);}};__decorate([(0x0,nestjs_agenda_1[a9_0x3596a6(0x180)])(enums_1['BackgroundJobType'][a9_0x3596a6(0x1a0)]),__metadata('design:type',Function),__metadata(a9_0x3596a6(0x1b7),[agenda_1[a9_0x3596a6(0x177)]]),__metadata(a9_0x3596a6(0x168),Promise)],JobProccessor['prototype'],a9_0x3596a6(0x190),null),__decorate([(0x0,nestjs_agenda_1[a9_0x3596a6(0x180)])(enums_1[a9_0x3596a6(0x1b9)][a9_0x3596a6(0x192)]),__metadata(a9_0x3596a6(0x165),Function),__metadata(a9_0x3596a6(0x1b7),[agenda_1[a9_0x3596a6(0x177)]]),__metadata(a9_0x3596a6(0x168),Promise)],JobProccessor[a9_0x3596a6(0x18f)],a9_0x3596a6(0x1a6),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1[a9_0x3596a6(0x167)])(),__metadata(a9_0x3596a6(0x1b7),[nestjs_agenda_1['AgendaService'],schedule_service_1[a9_0x3596a6(0x16d)],setting_service_1['SettingService']])],JobProccessor),exports[a9_0x3596a6(0x19f)]=JobProccessor;