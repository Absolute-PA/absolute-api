'use strict';function a9_0xd4a7(){const _0x492dcc=['Scheduling\x20event:\x20','114FQbFRg','Invalid\x20or\x20expired\x20license\x20key!','design:paramtypes','isExpired','setMinutes','196015WFBhUE','cancel','@agent-ly/nestjs-agenda','attrs','Fetching\x20today\x20schedule...','PlayVoiceRecorded','../schedule/schedule.service','Event:\x20','findEligibleSchedule','Define','\x20-\x20Schedule:\x20','object','logger','prototype','split','schedule','3kRMyQH','jobType','single','.\x20Job:\x20','forEach','JobProccessor','setSeconds','1086102xPJLQT','Canceling\x20all\x20old\x20background\x20checks...','NODE_ENV','error','__esModule','AgendaService','CheckEvent','PlayTextToAudio','PlaySound','8276070nHPcDq','BackgroundJobType','scheduleService','getOwnPropertyDescriptor','length','Eligible\x20schedule:\x20','deleteFilesInFolder','settingService','decorate','getHours','env','data','JobType','Purging\x20temp\x20uploaded\x20files...','PurgeTempUploadedFiles','2123360iBFdUF','\x20-\x20','design:type','Events\x20scheduled!','log','time','development','setHours','507348pmUEmT','../common/enums','__metadata','530888OERBqe','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','agendaService','../setting/setting.service','AuditActor','923942ZCnXNZ','../common/constants','checkEvent','purgeTempUploadedFiles','events','PlayMusic','design:returntype','Job','defineProperty','metadata','agenda','name','Logger','getSeconds','14YMMwQE','updateExpiryStatus'];a9_0xd4a7=function(){return _0x492dcc;};return a9_0xd4a7();}const a9_0x1ea2c9=a9_0x15b5;(function(_0x229f67,_0x9f2c78){const _0x772fee=a9_0x15b5,_0x27b91c=_0x229f67();while(!![]){try{const _0x52c92a=parseInt(_0x772fee(0x13c))/0x1+parseInt(_0x772fee(0x181))/0x2+-parseInt(_0x772fee(0x162))/0x3*(-parseInt(_0x772fee(0x189))/0x4)+parseInt(_0x772fee(0x152))/0x5*(-parseInt(_0x772fee(0x14d))/0x6)+parseInt(_0x772fee(0x14a))/0x7*(parseInt(_0x772fee(0x18c))/0x8)+-parseInt(_0x772fee(0x169))/0x9+-parseInt(_0x772fee(0x172))/0xa;if(_0x52c92a===_0x9f2c78)break;else _0x27b91c['push'](_0x27b91c['shift']());}catch(_0xc7a219){_0x27b91c['push'](_0x27b91c['shift']());}}}(a9_0xd4a7,0x86c67));var __decorate=this&&this['__decorate']||function(_0x28df5c,_0x163acf,_0x87f1a5,_0x7440f0){const _0x22fd42=a9_0x15b5;var _0x1f714b=arguments['length'],_0x304c0c=_0x1f714b<0x3?_0x163acf:_0x7440f0===null?_0x7440f0=Object[_0x22fd42(0x175)](_0x163acf,_0x87f1a5):_0x7440f0,_0x37a1cf;if(typeof Reflect===_0x22fd42(0x15d)&&typeof Reflect[_0x22fd42(0x17a)]==='function')_0x304c0c=Reflect['decorate'](_0x28df5c,_0x163acf,_0x87f1a5,_0x7440f0);else{for(var _0x2b4b11=_0x28df5c[_0x22fd42(0x176)]-0x1;_0x2b4b11>=0x0;_0x2b4b11--)if(_0x37a1cf=_0x28df5c[_0x2b4b11])_0x304c0c=(_0x1f714b<0x3?_0x37a1cf(_0x304c0c):_0x1f714b>0x3?_0x37a1cf(_0x163acf,_0x87f1a5,_0x304c0c):_0x37a1cf(_0x163acf,_0x87f1a5))||_0x304c0c;}return _0x1f714b>0x3&&_0x304c0c&&Object[_0x22fd42(0x144)](_0x163acf,_0x87f1a5,_0x304c0c),_0x304c0c;},__metadata=this&&this[a9_0x1ea2c9(0x18b)]||function(_0x1b843e,_0x13dde4){const _0x189b39=a9_0x1ea2c9;if(typeof Reflect===_0x189b39(0x15d)&&typeof Reflect[_0x189b39(0x145)]==='function')return Reflect[_0x189b39(0x145)](_0x1b843e,_0x13dde4);},JobProccessor_1;Object[a9_0x1ea2c9(0x144)](exports,a9_0x1ea2c9(0x16d),{'value':!![]}),exports[a9_0x1ea2c9(0x167)]=void 0x0;function a9_0x15b5(_0x49d9ba,_0x5a1654){const _0xd4a76e=a9_0xd4a7();return a9_0x15b5=function(_0x15b5c9,_0x3f00a3){_0x15b5c9=_0x15b5c9-0x138;let _0x3563cd=_0xd4a76e[_0x15b5c9];return _0x3563cd;},a9_0x15b5(_0x49d9ba,_0x5a1654);}const common_1=require('@nestjs/common'),agenda_1=require(a9_0x1ea2c9(0x146)),nestjs_agenda_1=require(a9_0x1ea2c9(0x154)),enums_1=require(a9_0x1ea2c9(0x18a)),schedule_service_1=require(a9_0x1ea2c9(0x158)),setting_service_1=require(a9_0x1ea2c9(0x13a)),file_1=require('../common/file'),constants_1=require(a9_0x1ea2c9(0x13d));let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x15d475,_0x2df3b9,_0x5195a1){const _0x3d3a70=a9_0x1ea2c9;this[_0x3d3a70(0x139)]=_0x15d475,this[_0x3d3a70(0x174)]=_0x2df3b9,this[_0x3d3a70(0x179)]=_0x5195a1,this[_0x3d3a70(0x15e)]=new common_1[(_0x3d3a70(0x148))](JobProccessor_1[_0x3d3a70(0x147)]);}async[a9_0x1ea2c9(0x13e)](_0x89cf2){const _0x1376dc=a9_0x1ea2c9;this['logger'][_0x1376dc(0x185)]('Server\x20time:\x20'+new Date()+_0x1376dc(0x165)+_0x89cf2[_0x1376dc(0x155)][_0x1376dc(0x147)]);const _0x2b6c99=await this[_0x1376dc(0x179)][_0x1376dc(0x14b)]();if(_0x2b6c99[_0x1376dc(0x150)]){this[_0x1376dc(0x15e)]['log'](_0x1376dc(0x14e));if(process[_0x1376dc(0x17c)][_0x1376dc(0x16b)]!==_0x1376dc(0x187))return;}this[_0x1376dc(0x15e)][_0x1376dc(0x185)](_0x1376dc(0x16a)),await this[_0x1376dc(0x139)][_0x1376dc(0x153)]({'name':{'$nin':[enums_1[_0x1376dc(0x173)][_0x1376dc(0x16f)],enums_1[_0x1376dc(0x173)][_0x1376dc(0x180)]]},'type':_0x1376dc(0x164)}),this[_0x1376dc(0x15e)][_0x1376dc(0x185)](_0x1376dc(0x156));const _0x34a428=await this[_0x1376dc(0x174)][_0x1376dc(0x15a)](new Date());this['logger'][_0x1376dc(0x185)](_0x1376dc(0x177)+(_0x34a428===null||_0x34a428===void 0x0?void 0x0:_0x34a428[_0x1376dc(0x147)]));if(!_0x34a428||!_0x34a428[_0x1376dc(0x140)]||_0x34a428[_0x1376dc(0x140)][_0x1376dc(0x176)]===0x0)return;_0x34a428[_0x1376dc(0x140)][_0x1376dc(0x166)](_0x26b95f=>{const _0x5d649b=_0x1376dc;this[_0x5d649b(0x15e)]['log'](_0x5d649b(0x14c)+_0x26b95f[_0x5d649b(0x186)]+_0x5d649b(0x182)+_0x26b95f['jobType']+_0x5d649b(0x182)+_0x26b95f[_0x5d649b(0x147)]);const _0x3f8364=new Date(),_0x2a1cc1=_0x3f8364[_0x5d649b(0x17b)](),_0x4c9788=_0x3f8364['getMinutes'](),_0x1ff11b=_0x3f8364[_0x5d649b(0x149)](),[_0x57e65d,_0x18c40c,_0x522880]=_0x26b95f[_0x5d649b(0x186)][_0x5d649b(0x160)](':');if(+_0x57e65d<_0x2a1cc1||+_0x57e65d===_0x2a1cc1&&+_0x18c40c<_0x4c9788||+_0x57e65d===_0x2a1cc1&&+_0x18c40c===_0x4c9788&&+_0x522880<_0x1ff11b)return;_0x3f8364[_0x5d649b(0x188)](+_0x57e65d),_0x3f8364[_0x5d649b(0x151)](+_0x18c40c),_0x3f8364[_0x5d649b(0x168)](+_0x522880);switch(_0x26b95f[_0x5d649b(0x163)]){case enums_1[_0x5d649b(0x17e)]['PlaySound']:{const {soundId:_0x5b9e97,durationInSecond:_0x1f0708}=_0x26b95f[_0x5d649b(0x17d)];if(!_0x5b9e97)return;const _0x17ba3c={'soundId':_0x5b9e97,'durationInSecond':_0x1f0708,'audit':{'actor':enums_1[_0x5d649b(0x13b)][_0x5d649b(0x143)],'name':enums_1[_0x5d649b(0x17e)][_0x5d649b(0x171)],'message':_0x5d649b(0x159)+_0x26b95f[_0x5d649b(0x147)]+_0x5d649b(0x15c)+_0x34a428['name']}};this['agendaService'][_0x5d649b(0x161)](_0x3f8364,enums_1[_0x5d649b(0x17e)][_0x5d649b(0x171)],_0x17ba3c);break;}case enums_1[_0x5d649b(0x17e)][_0x5d649b(0x141)]:{const {playlistId:_0x8dd5ca,durationInSecond:_0x190cb6}=_0x26b95f[_0x5d649b(0x17d)];if(!_0x8dd5ca)return;const _0x33d834={'playlistId':_0x8dd5ca,'durationInSecond':_0x190cb6,'audit':{'actor':enums_1[_0x5d649b(0x13b)][_0x5d649b(0x143)],'name':enums_1[_0x5d649b(0x17e)]['PlayMusic'],'message':_0x5d649b(0x159)+_0x26b95f['name']+_0x5d649b(0x15c)+_0x34a428[_0x5d649b(0x147)]}};this['agendaService'][_0x5d649b(0x161)](_0x3f8364,enums_1['JobType'][_0x5d649b(0x141)],_0x33d834);break;}case enums_1[_0x5d649b(0x17e)][_0x5d649b(0x157)]:{const {voiceId:_0x2ab9d5,durationInSecond:_0x20e546}=_0x26b95f[_0x5d649b(0x17d)];if(!_0x2ab9d5)return;const _0x2ec091={'voiceId':_0x2ab9d5,'durationInSecond':_0x20e546,'audit':{'actor':enums_1[_0x5d649b(0x13b)][_0x5d649b(0x143)],'name':enums_1[_0x5d649b(0x17e)][_0x5d649b(0x157)],'message':_0x5d649b(0x159)+_0x26b95f[_0x5d649b(0x147)]+'\x20-\x20Schedule:\x20'+_0x34a428[_0x5d649b(0x147)]}};this[_0x5d649b(0x139)][_0x5d649b(0x161)](_0x3f8364,enums_1[_0x5d649b(0x17e)][_0x5d649b(0x157)],_0x2ec091);break;}case enums_1[_0x5d649b(0x17e)][_0x5d649b(0x170)]:{const {textToAudioId:_0x293849,durationInSecond:_0x2574ee}=_0x26b95f[_0x5d649b(0x17d)];if(!_0x293849)return;const _0x5c1a11={'textToAudioId':_0x293849,'durationInSecond':_0x2574ee,'audit':{'actor':enums_1[_0x5d649b(0x13b)]['Job'],'name':enums_1[_0x5d649b(0x17e)][_0x5d649b(0x170)],'message':_0x5d649b(0x159)+_0x26b95f[_0x5d649b(0x147)]+_0x5d649b(0x15c)+_0x34a428[_0x5d649b(0x147)]}};this[_0x5d649b(0x139)][_0x5d649b(0x161)](_0x3f8364,enums_1[_0x5d649b(0x17e)][_0x5d649b(0x170)],_0x5c1a11);break;}default:return;}}),this[_0x1376dc(0x15e)][_0x1376dc(0x185)](_0x1376dc(0x184));}async[a9_0x1ea2c9(0x13f)](_0x2e9587){const _0xf7a3e9=a9_0x1ea2c9;this[_0xf7a3e9(0x15e)][_0xf7a3e9(0x185)](_0xf7a3e9(0x17f));const {success:_0x1e3439,message:_0x48601b}=await(0x0,file_1[_0xf7a3e9(0x178)])(constants_1['TMP_UPLOAD_DIR']);!_0x1e3439&&this['logger'][_0xf7a3e9(0x16c)](_0xf7a3e9(0x138)+_0x48601b);}};__decorate([(0x0,nestjs_agenda_1['Define'])(enums_1[a9_0x1ea2c9(0x173)]['CheckEvent']),__metadata(a9_0x1ea2c9(0x183),Function),__metadata(a9_0x1ea2c9(0x14f),[agenda_1['Job']]),__metadata(a9_0x1ea2c9(0x142),Promise)],JobProccessor['prototype'],a9_0x1ea2c9(0x13e),null),__decorate([(0x0,nestjs_agenda_1[a9_0x1ea2c9(0x15b)])(enums_1[a9_0x1ea2c9(0x173)][a9_0x1ea2c9(0x180)]),__metadata(a9_0x1ea2c9(0x183),Function),__metadata(a9_0x1ea2c9(0x14f),[agenda_1[a9_0x1ea2c9(0x143)]]),__metadata(a9_0x1ea2c9(0x142),Promise)],JobProccessor[a9_0x1ea2c9(0x15f)],a9_0x1ea2c9(0x13f),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1['Processor'])(),__metadata(a9_0x1ea2c9(0x14f),[nestjs_agenda_1[a9_0x1ea2c9(0x16e)],schedule_service_1['ScheduleService'],setting_service_1['SettingService']])],JobProccessor),exports[a9_0x1ea2c9(0x167)]=JobProccessor;