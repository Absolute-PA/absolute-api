'use strict';const a9_0x4f4415=a9_0x30b1;function a9_0x30b1(_0xa311d2,_0x56fd84){const _0x4d686e=a9_0x4d68();return a9_0x30b1=function(_0x30b1bd,_0x219b84){_0x30b1bd=_0x30b1bd-0x18a;let _0x93abd8=_0x4d686e[_0x30b1bd];return _0x93abd8;},a9_0x30b1(_0xa311d2,_0x56fd84);}(function(_0x14d775,_0x1da800){const _0x579c32=a9_0x30b1,_0x5f0bf8=_0x14d775();while(!![]){try{const _0x453602=-parseInt(_0x579c32(0x1cb))/0x1+-parseInt(_0x579c32(0x1d7))/0x2*(-parseInt(_0x579c32(0x1aa))/0x3)+parseInt(_0x579c32(0x1bc))/0x4*(-parseInt(_0x579c32(0x1b1))/0x5)+parseInt(_0x579c32(0x1a1))/0x6*(-parseInt(_0x579c32(0x1de))/0x7)+parseInt(_0x579c32(0x1a4))/0x8+-parseInt(_0x579c32(0x1be))/0x9*(-parseInt(_0x579c32(0x1c8))/0xa)+-parseInt(_0x579c32(0x18a))/0xb;if(_0x453602===_0x1da800)break;else _0x5f0bf8['push'](_0x5f0bf8['shift']());}catch(_0x380be5){_0x5f0bf8['push'](_0x5f0bf8['shift']());}}}(a9_0x4d68,0x6b7cc));var __decorate=this&&this[a9_0x4f4415(0x1b0)]||function(_0x2d32d0,_0x1128d5,_0x1c72a3,_0x42c171){const _0x5b6b10=a9_0x4f4415;var _0x1fd686=arguments[_0x5b6b10(0x1e1)],_0xca73fd=_0x1fd686<0x3?_0x1128d5:_0x42c171===null?_0x42c171=Object[_0x5b6b10(0x1d3)](_0x1128d5,_0x1c72a3):_0x42c171,_0x2591d3;if(typeof Reflect===_0x5b6b10(0x1d0)&&typeof Reflect[_0x5b6b10(0x1ce)]==='function')_0xca73fd=Reflect[_0x5b6b10(0x1ce)](_0x2d32d0,_0x1128d5,_0x1c72a3,_0x42c171);else{for(var _0x95e84c=_0x2d32d0[_0x5b6b10(0x1e1)]-0x1;_0x95e84c>=0x0;_0x95e84c--)if(_0x2591d3=_0x2d32d0[_0x95e84c])_0xca73fd=(_0x1fd686<0x3?_0x2591d3(_0xca73fd):_0x1fd686>0x3?_0x2591d3(_0x1128d5,_0x1c72a3,_0xca73fd):_0x2591d3(_0x1128d5,_0x1c72a3))||_0xca73fd;}return _0x1fd686>0x3&&_0xca73fd&&Object[_0x5b6b10(0x193)](_0x1128d5,_0x1c72a3,_0xca73fd),_0xca73fd;},__metadata=this&&this[a9_0x4f4415(0x1ae)]||function(_0xa5f323,_0x118113){const _0x357c89=a9_0x4f4415;if(typeof Reflect===_0x357c89(0x1d0)&&typeof Reflect[_0x357c89(0x1dd)]===_0x357c89(0x1c1))return Reflect[_0x357c89(0x1dd)](_0xa5f323,_0x118113);},JobProccessor_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a9_0x4f4415(0x1b7)]=void 0x0;const common_1=require(a9_0x4f4415(0x1ca)),agenda_1=require(a9_0x4f4415(0x1c5)),nestjs_agenda_1=require(a9_0x4f4415(0x19d)),enums_1=require(a9_0x4f4415(0x1ba)),schedule_service_1=require(a9_0x4f4415(0x19f)),setting_service_1=require(a9_0x4f4415(0x1b2)),file_1=require(a9_0x4f4415(0x1b3)),constants_1=require(a9_0x4f4415(0x18c));function a9_0x4d68(){const _0x3115b2=['PlayVoiceRecorded','__decorate','730xzmdvK','../setting/setting.service','../common/file','getHours','setSeconds','Event:\x20','JobProccessor','deleteFilesInFolder','purgeTempUploadedFiles','../common/enums','prototype','2980TXqwZZ','settingService','7551nWredi','NODE_ENV','error','function','\x20-\x20Schedule:\x20','\x20-\x20','scheduleService','agenda','design:returntype','design:type','9870ccerMV','events','@nestjs/common','323274oTZAFS','findEligibleSchedule','getMinutes','decorate','BackgroundJobType','object','checkEvent','Events\x20scheduled!','getOwnPropertyDescriptor','Define','Processor','PlaySound','796RiLEog','design:paramtypes','Eligible\x20schedule:\x20','jobType','Job','setMinutes','metadata','62489emdCJm','.\x20Job:\x20','Invalid\x20or\x20expired\x20license\x20key!','length','forEach','TMP_UPLOAD_DIR','11285593MfdRhY','JobType','../common/constants','Scheduling\x20event:\x20','CheckEvent','getSeconds','Server\x20time:\x20','updateExpiryStatus','split','defineProperty','single','PlayTextToAudio','schedule','PurgeTempUploadedFiles','AgendaService','data','name','Fetching\x20today\x20schedule...','Purging\x20temp\x20uploaded\x20files...','@agent-ly/nestjs-agenda','log','../schedule/schedule.service','ScheduleService','30uyksLv','time','Logger','3215992XeXmiK','setHours','PlayMusic','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','Canceling\x20all\x20old\x20background\x20checks...','logger','5373DADRvp','AuditActor','development','agendaService','__metadata'];a9_0x4d68=function(){return _0x3115b2;};return a9_0x4d68();}let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x90e88e,_0x84fc1b,_0x1aec1d){const _0x7565c6=a9_0x4f4415;this[_0x7565c6(0x1ad)]=_0x90e88e,this['scheduleService']=_0x84fc1b,this['settingService']=_0x1aec1d,this['logger']=new common_1[(_0x7565c6(0x1a3))](JobProccessor_1[_0x7565c6(0x19a)]);}async[a9_0x4f4415(0x1d1)](_0x206fa7){const _0x3f446b=a9_0x4f4415;this[_0x3f446b(0x1a9)][_0x3f446b(0x19e)](_0x3f446b(0x190)+new Date()+_0x3f446b(0x1df)+_0x206fa7['attrs'][_0x3f446b(0x19a)]);const _0x270e37=await this[_0x3f446b(0x1bd)][_0x3f446b(0x191)]();if(_0x270e37['isExpired']){this['logger'][_0x3f446b(0x19e)](_0x3f446b(0x1e0));if(process['env'][_0x3f446b(0x1bf)]!==_0x3f446b(0x1ac))return;}this[_0x3f446b(0x1a9)]['log'](_0x3f446b(0x1a8)),await this[_0x3f446b(0x1ad)]['cancel']({'name':{'$nin':[enums_1[_0x3f446b(0x1cf)][_0x3f446b(0x18e)],enums_1[_0x3f446b(0x1cf)][_0x3f446b(0x197)]]},'type':_0x3f446b(0x194)}),this[_0x3f446b(0x1a9)][_0x3f446b(0x19e)](_0x3f446b(0x19b));const _0x54b894=await this[_0x3f446b(0x1c4)][_0x3f446b(0x1cc)](new Date());this['logger']['log'](_0x3f446b(0x1d9)+(_0x54b894===null||_0x54b894===void 0x0?void 0x0:_0x54b894[_0x3f446b(0x19a)]));if(!_0x54b894||!_0x54b894[_0x3f446b(0x1c9)]||_0x54b894[_0x3f446b(0x1c9)][_0x3f446b(0x1e1)]===0x0)return;_0x54b894['events'][_0x3f446b(0x1e2)](_0x19599b=>{const _0x508fd4=_0x3f446b;this['logger'][_0x508fd4(0x19e)](_0x508fd4(0x18d)+_0x19599b['time']+_0x508fd4(0x1c3)+_0x19599b[_0x508fd4(0x1da)]+_0x508fd4(0x1c3)+_0x19599b[_0x508fd4(0x19a)]);const _0x3dd540=new Date(),_0x35a76e=_0x3dd540[_0x508fd4(0x1b4)](),_0x4e463a=_0x3dd540[_0x508fd4(0x1cd)](),_0x34f6d3=_0x3dd540[_0x508fd4(0x18f)](),[_0x38b759,_0x3165e7,_0x5e33ce]=_0x19599b[_0x508fd4(0x1a2)][_0x508fd4(0x192)](':');if(+_0x38b759<_0x35a76e||+_0x38b759===_0x35a76e&&+_0x3165e7<_0x4e463a||+_0x38b759===_0x35a76e&&+_0x3165e7===_0x4e463a&&+_0x5e33ce<_0x34f6d3)return;_0x3dd540[_0x508fd4(0x1a5)](+_0x38b759),_0x3dd540[_0x508fd4(0x1dc)](+_0x3165e7),_0x3dd540[_0x508fd4(0x1b5)](+_0x5e33ce);switch(_0x19599b[_0x508fd4(0x1da)]){case enums_1[_0x508fd4(0x18b)][_0x508fd4(0x1d6)]:{const {soundId:_0x529f40,durationInSecond:_0x1881d4}=_0x19599b['data'];if(!_0x529f40)return;const _0x379876={'soundId':_0x529f40,'durationInSecond':_0x1881d4,'audit':{'actor':enums_1[_0x508fd4(0x1ab)][_0x508fd4(0x1db)],'name':enums_1[_0x508fd4(0x18b)][_0x508fd4(0x1d6)],'message':'Event:\x20'+_0x19599b[_0x508fd4(0x19a)]+'\x20-\x20Schedule:\x20'+_0x54b894['name']}};this['agendaService']['schedule'](_0x3dd540,enums_1[_0x508fd4(0x18b)]['PlaySound'],_0x379876);break;}case enums_1[_0x508fd4(0x18b)][_0x508fd4(0x1a6)]:{const {playlistId:_0x4a01da,durationInSecond:_0x2ee38a}=_0x19599b['data'];if(!_0x4a01da)return;const _0xfa1b93={'playlistId':_0x4a01da,'durationInSecond':_0x2ee38a,'audit':{'actor':enums_1[_0x508fd4(0x1ab)][_0x508fd4(0x1db)],'name':enums_1[_0x508fd4(0x18b)][_0x508fd4(0x1a6)],'message':'Event:\x20'+_0x19599b['name']+_0x508fd4(0x1c2)+_0x54b894[_0x508fd4(0x19a)]}};this[_0x508fd4(0x1ad)][_0x508fd4(0x196)](_0x3dd540,enums_1[_0x508fd4(0x18b)][_0x508fd4(0x1a6)],_0xfa1b93);break;}case enums_1[_0x508fd4(0x18b)]['PlayVoiceRecorded']:{const {voiceId:_0x2720da,durationInSecond:_0x59b42b}=_0x19599b[_0x508fd4(0x199)];if(!_0x2720da)return;const _0x197fe6={'voiceId':_0x2720da,'durationInSecond':_0x59b42b,'audit':{'actor':enums_1[_0x508fd4(0x1ab)][_0x508fd4(0x1db)],'name':enums_1[_0x508fd4(0x18b)]['PlayVoiceRecorded'],'message':_0x508fd4(0x1b6)+_0x19599b[_0x508fd4(0x19a)]+_0x508fd4(0x1c2)+_0x54b894[_0x508fd4(0x19a)]}};this['agendaService'][_0x508fd4(0x196)](_0x3dd540,enums_1[_0x508fd4(0x18b)][_0x508fd4(0x1af)],_0x197fe6);break;}case enums_1[_0x508fd4(0x18b)][_0x508fd4(0x195)]:{const {textToAudioId:_0x47e9c9,durationInSecond:_0x36b91c}=_0x19599b[_0x508fd4(0x199)];if(!_0x47e9c9)return;const _0x158982={'textToAudioId':_0x47e9c9,'durationInSecond':_0x36b91c,'audit':{'actor':enums_1[_0x508fd4(0x1ab)][_0x508fd4(0x1db)],'name':enums_1['JobType']['PlayTextToAudio'],'message':'Event:\x20'+_0x19599b[_0x508fd4(0x19a)]+_0x508fd4(0x1c2)+_0x54b894[_0x508fd4(0x19a)]}};this['agendaService'][_0x508fd4(0x196)](_0x3dd540,enums_1['JobType'][_0x508fd4(0x195)],_0x158982);break;}default:return;}}),this[_0x3f446b(0x1a9)][_0x3f446b(0x19e)](_0x3f446b(0x1d2));}async[a9_0x4f4415(0x1b9)](_0x55ef86){const _0x3f021f=a9_0x4f4415;this[_0x3f021f(0x1a9)][_0x3f021f(0x19e)](_0x3f021f(0x19c));const {success:_0x39739a,message:_0x317732}=await(0x0,file_1[_0x3f021f(0x1b8)])(constants_1[_0x3f021f(0x1e3)]);!_0x39739a&&this[_0x3f021f(0x1a9)][_0x3f021f(0x1c0)](_0x3f021f(0x1a7)+_0x317732);}};__decorate([(0x0,nestjs_agenda_1[a9_0x4f4415(0x1d4)])(enums_1[a9_0x4f4415(0x1cf)][a9_0x4f4415(0x18e)]),__metadata(a9_0x4f4415(0x1c7),Function),__metadata('design:paramtypes',[agenda_1[a9_0x4f4415(0x1db)]]),__metadata(a9_0x4f4415(0x1c6),Promise)],JobProccessor[a9_0x4f4415(0x1bb)],a9_0x4f4415(0x1d1),null),__decorate([(0x0,nestjs_agenda_1[a9_0x4f4415(0x1d4)])(enums_1[a9_0x4f4415(0x1cf)]['PurgeTempUploadedFiles']),__metadata(a9_0x4f4415(0x1c7),Function),__metadata(a9_0x4f4415(0x1d8),[agenda_1[a9_0x4f4415(0x1db)]]),__metadata(a9_0x4f4415(0x1c6),Promise)],JobProccessor['prototype'],a9_0x4f4415(0x1b9),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1[a9_0x4f4415(0x1d5)])(),__metadata(a9_0x4f4415(0x1d8),[nestjs_agenda_1[a9_0x4f4415(0x198)],schedule_service_1[a9_0x4f4415(0x1a0)],setting_service_1['SettingService']])],JobProccessor),exports[a9_0x4f4415(0x1b7)]=JobProccessor;