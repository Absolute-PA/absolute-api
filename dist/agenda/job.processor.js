'use strict';function a9_0x2c9b(_0x4e528b,_0x34c989){const _0x394c0d=a9_0x394c();return a9_0x2c9b=function(_0x2c9bdd,_0x5dbd7f){_0x2c9bdd=_0x2c9bdd-0x1b7;let _0x312cd5=_0x394c0d[_0x2c9bdd];return _0x312cd5;},a9_0x2c9b(_0x4e528b,_0x34c989);}const a9_0x3d3c93=a9_0x2c9b;(function(_0x4dd09b,_0x43ffc4){const _0x44f7ea=a9_0x2c9b,_0x17bf1e=_0x4dd09b();while(!![]){try{const _0x532c7b=parseInt(_0x44f7ea(0x1c2))/0x1*(-parseInt(_0x44f7ea(0x1f2))/0x2)+parseInt(_0x44f7ea(0x1e0))/0x3+parseInt(_0x44f7ea(0x1cc))/0x4*(-parseInt(_0x44f7ea(0x1c5))/0x5)+-parseInt(_0x44f7ea(0x1f5))/0x6+-parseInt(_0x44f7ea(0x1e3))/0x7+parseInt(_0x44f7ea(0x1e4))/0x8+parseInt(_0x44f7ea(0x1d6))/0x9;if(_0x532c7b===_0x43ffc4)break;else _0x17bf1e['push'](_0x17bf1e['shift']());}catch(_0x4139df){_0x17bf1e['push'](_0x17bf1e['shift']());}}}(a9_0x394c,0x29840));var __decorate=this&&this['__decorate']||function(_0xc89dad,_0x31e84b,_0x247800,_0x509b1d){const _0x1dba54=a9_0x2c9b;var _0x34fcf4=arguments[_0x1dba54(0x1ea)],_0x5bdf9b=_0x34fcf4<0x3?_0x31e84b:_0x509b1d===null?_0x509b1d=Object[_0x1dba54(0x206)](_0x31e84b,_0x247800):_0x509b1d,_0x119635;if(typeof Reflect===_0x1dba54(0x1ee)&&typeof Reflect['decorate']==='function')_0x5bdf9b=Reflect[_0x1dba54(0x1d7)](_0xc89dad,_0x31e84b,_0x247800,_0x509b1d);else{for(var _0x5c3bc5=_0xc89dad[_0x1dba54(0x1ea)]-0x1;_0x5c3bc5>=0x0;_0x5c3bc5--)if(_0x119635=_0xc89dad[_0x5c3bc5])_0x5bdf9b=(_0x34fcf4<0x3?_0x119635(_0x5bdf9b):_0x34fcf4>0x3?_0x119635(_0x31e84b,_0x247800,_0x5bdf9b):_0x119635(_0x31e84b,_0x247800))||_0x5bdf9b;}return _0x34fcf4>0x3&&_0x5bdf9b&&Object['defineProperty'](_0x31e84b,_0x247800,_0x5bdf9b),_0x5bdf9b;},__metadata=this&&this[a9_0x3d3c93(0x1c9)]||function(_0x48220d,_0x369b65){const _0x5cddd6=a9_0x3d3c93;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x5cddd6(0x1ef))return Reflect[_0x5cddd6(0x203)](_0x48220d,_0x369b65);},JobProccessor_1;Object['defineProperty'](exports,a9_0x3d3c93(0x1d5),{'value':!![]}),exports[a9_0x3d3c93(0x1be)]=void 0x0;const common_1=require(a9_0x3d3c93(0x1ed)),agenda_1=require(a9_0x3d3c93(0x1d3)),nestjs_agenda_1=require(a9_0x3d3c93(0x201)),enums_1=require('../common/enums'),schedule_service_1=require(a9_0x3d3c93(0x1c6)),setting_service_1=require(a9_0x3d3c93(0x1f8)),file_1=require(a9_0x3d3c93(0x1e5)),constants_1=require(a9_0x3d3c93(0x1f6));let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x26122f,_0x5a41b8,_0x22e513){const _0x559db3=a9_0x3d3c93;this[_0x559db3(0x1d1)]=_0x26122f,this[_0x559db3(0x1b8)]=_0x5a41b8,this[_0x559db3(0x1e1)]=_0x22e513,this['logger']=new common_1[(_0x559db3(0x1e2))](JobProccessor_1[_0x559db3(0x1fd)]);}async[a9_0x3d3c93(0x1bf)](_0x44630f){const _0x234087=a9_0x3d3c93;this[_0x234087(0x1e6)][_0x234087(0x1cd)]('Server\x20time:\x20'+new Date()+_0x234087(0x1db)+_0x44630f[_0x234087(0x1da)][_0x234087(0x1fd)]);const _0x94f339=await this[_0x234087(0x1e1)][_0x234087(0x1df)]();if(_0x94f339[_0x234087(0x1f0)]){this[_0x234087(0x1e6)][_0x234087(0x1cd)]('Invalid\x20or\x20expired\x20license\x20key!');if(process[_0x234087(0x207)][_0x234087(0x204)]!=='development')return;}this[_0x234087(0x1e6)][_0x234087(0x1cd)](_0x234087(0x200)),await this[_0x234087(0x1d1)]['cancel']({'name':{'$nin':[enums_1[_0x234087(0x1ce)][_0x234087(0x1e8)],enums_1[_0x234087(0x1ce)][_0x234087(0x202)]]},'type':_0x234087(0x1e7)}),this[_0x234087(0x1e6)][_0x234087(0x1cd)](_0x234087(0x1f7));const _0x5da3b1=await this[_0x234087(0x1b8)][_0x234087(0x1f9)](new Date());this['logger'][_0x234087(0x1cd)](_0x234087(0x1ec)+(_0x5da3b1===null||_0x5da3b1===void 0x0?void 0x0:_0x5da3b1[_0x234087(0x1fd)]));if(!_0x5da3b1||!_0x5da3b1[_0x234087(0x1bd)]||_0x5da3b1[_0x234087(0x1bd)][_0x234087(0x1ea)]===0x0)return;_0x5da3b1['events'][_0x234087(0x1d2)](_0xbcb3bb=>{const _0x2120e0=_0x234087;this[_0x2120e0(0x1e6)][_0x2120e0(0x1cd)](_0x2120e0(0x1c1)+_0xbcb3bb[_0x2120e0(0x1de)]+_0x2120e0(0x1b9)+_0xbcb3bb[_0x2120e0(0x205)]+_0x2120e0(0x1b9)+_0xbcb3bb[_0x2120e0(0x1fd)]);const _0x473db7=new Date(),_0x4779fe=_0x473db7[_0x2120e0(0x1c7)](),_0x2a0607=_0x473db7[_0x2120e0(0x1fa)](),_0x19f007=_0x473db7['getSeconds'](),[_0xd4abf6,_0x51777a,_0x4d3e7f]=_0xbcb3bb[_0x2120e0(0x1de)]['split'](':');if(+_0xd4abf6<_0x4779fe||+_0xd4abf6===_0x4779fe&&+_0x51777a<_0x2a0607||+_0xd4abf6===_0x4779fe&&+_0x51777a===_0x2a0607&&+_0x4d3e7f<_0x19f007)return;_0x473db7[_0x2120e0(0x1d9)](+_0xd4abf6),_0x473db7[_0x2120e0(0x1eb)](+_0x51777a),_0x473db7[_0x2120e0(0x1dc)](+_0x4d3e7f);switch(_0xbcb3bb[_0x2120e0(0x205)]){case enums_1['JobType'][_0x2120e0(0x1fb)]:{const {soundId:_0x25eaaf,durationInSecond:_0x44f60c}=_0xbcb3bb[_0x2120e0(0x1f3)];if(!_0x25eaaf)return;const _0x4a30e0={'soundId':_0x25eaaf,'durationInSecond':_0x44f60c,'audit':{'actor':enums_1[_0x2120e0(0x1fe)][_0x2120e0(0x1ca)],'name':enums_1[_0x2120e0(0x1c4)][_0x2120e0(0x1fb)],'message':_0x2120e0(0x1d0)+_0xbcb3bb[_0x2120e0(0x1fd)]+_0x2120e0(0x1c0)+_0x5da3b1[_0x2120e0(0x1fd)]}};this['agendaService'][_0x2120e0(0x1f4)](_0x473db7,enums_1[_0x2120e0(0x1c4)]['PlaySound'],_0x4a30e0);break;}case enums_1['JobType'][_0x2120e0(0x1cf)]:{const {playlistId:_0x370506,durationInSecond:_0x13ce3b}=_0xbcb3bb['data'];if(!_0x370506)return;const _0x423bd0={'playlistId':_0x370506,'durationInSecond':_0x13ce3b,'audit':{'actor':enums_1[_0x2120e0(0x1fe)][_0x2120e0(0x1ca)],'name':enums_1['JobType']['PlayMusic'],'message':_0x2120e0(0x1d0)+_0xbcb3bb[_0x2120e0(0x1fd)]+_0x2120e0(0x1c0)+_0x5da3b1[_0x2120e0(0x1fd)]}};this['agendaService']['schedule'](_0x473db7,enums_1[_0x2120e0(0x1c4)][_0x2120e0(0x1cf)],_0x423bd0);break;}case enums_1[_0x2120e0(0x1c4)][_0x2120e0(0x1ff)]:{const {voiceId:_0x4da636,durationInSecond:_0x252102}=_0xbcb3bb['data'];if(!_0x4da636)return;const _0x50bbfc={'voiceId':_0x4da636,'durationInSecond':_0x252102,'audit':{'actor':enums_1['AuditActor'][_0x2120e0(0x1ca)],'name':enums_1[_0x2120e0(0x1c4)]['PlayVoiceRecorded'],'message':_0x2120e0(0x1d0)+_0xbcb3bb[_0x2120e0(0x1fd)]+_0x2120e0(0x1c0)+_0x5da3b1[_0x2120e0(0x1fd)]}};this[_0x2120e0(0x1d1)][_0x2120e0(0x1f4)](_0x473db7,enums_1[_0x2120e0(0x1c4)]['PlayVoiceRecorded'],_0x50bbfc);break;}case enums_1[_0x2120e0(0x1c4)][_0x2120e0(0x1e9)]:{const {textToAudioId:_0x216860,durationInSecond:_0x2e9d46}=_0xbcb3bb[_0x2120e0(0x1f3)];if(!_0x216860)return;const _0x105b82={'textToAudioId':_0x216860,'durationInSecond':_0x2e9d46,'audit':{'actor':enums_1[_0x2120e0(0x1fe)]['Job'],'name':enums_1['JobType']['PlayTextToAudio'],'message':_0x2120e0(0x1d0)+_0xbcb3bb[_0x2120e0(0x1fd)]+_0x2120e0(0x1c0)+_0x5da3b1[_0x2120e0(0x1fd)]}};this['agendaService'][_0x2120e0(0x1f4)](_0x473db7,enums_1[_0x2120e0(0x1c4)][_0x2120e0(0x1e9)],_0x105b82);break;}default:return;}}),this[_0x234087(0x1e6)][_0x234087(0x1cd)](_0x234087(0x1dd));}async[a9_0x3d3c93(0x1c8)](_0x1f9655){const _0x122ebb=a9_0x3d3c93;this[_0x122ebb(0x1e6)][_0x122ebb(0x1cd)]('Purging\x20temp\x20uploaded\x20files...');const {success:_0x5c94da,message:_0x59d070}=await(0x0,file_1[_0x122ebb(0x1bc)])(constants_1[_0x122ebb(0x1cb)]);!_0x5c94da&&this[_0x122ebb(0x1e6)][_0x122ebb(0x1c3)](_0x122ebb(0x1f1)+_0x59d070);}};__decorate([(0x0,nestjs_agenda_1['Define'])(enums_1[a9_0x3d3c93(0x1ce)][a9_0x3d3c93(0x1e8)]),__metadata('design:type',Function),__metadata(a9_0x3d3c93(0x1fc),[agenda_1[a9_0x3d3c93(0x1ca)]]),__metadata(a9_0x3d3c93(0x1d4),Promise)],JobProccessor[a9_0x3d3c93(0x1bb)],a9_0x3d3c93(0x1bf),null),__decorate([(0x0,nestjs_agenda_1[a9_0x3d3c93(0x1d8)])(enums_1['BackgroundJobType'][a9_0x3d3c93(0x202)]),__metadata(a9_0x3d3c93(0x1ba),Function),__metadata(a9_0x3d3c93(0x1fc),[agenda_1[a9_0x3d3c93(0x1ca)]]),__metadata(a9_0x3d3c93(0x1d4),Promise)],JobProccessor[a9_0x3d3c93(0x1bb)],a9_0x3d3c93(0x1c8),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1['Processor'])(),__metadata(a9_0x3d3c93(0x1fc),[nestjs_agenda_1['AgendaService'],schedule_service_1['ScheduleService'],setting_service_1[a9_0x3d3c93(0x1b7)]])],JobProccessor),exports[a9_0x3d3c93(0x1be)]=JobProccessor;function a9_0x394c(){const _0x4a6549=['983748lTICAx','settingService','Logger','2047927MVABWg','1929880xpGLAQ','../common/file','logger','single','CheckEvent','PlayTextToAudio','length','setMinutes','Eligible\x20schedule:\x20','@nestjs/common','object','function','isExpired','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','38iZfPub','data','schedule','51870mnoema','../common/constants','Fetching\x20today\x20schedule...','../setting/setting.service','findEligibleSchedule','getMinutes','PlaySound','design:paramtypes','name','AuditActor','PlayVoiceRecorded','Canceling\x20all\x20old\x20background\x20checks...','@agent-ly/nestjs-agenda','PurgeTempUploadedFiles','metadata','NODE_ENV','jobType','getOwnPropertyDescriptor','env','SettingService','scheduleService','\x20-\x20','design:type','prototype','deleteFilesInFolder','events','JobProccessor','checkEvent','\x20-\x20Schedule:\x20','Scheduling\x20event:\x20','13670ptrDUF','error','JobType','3185snzUKQ','../schedule/schedule.service','getHours','purgeTempUploadedFiles','__metadata','Job','TMP_UPLOAD_DIR','724ltqQKk','log','BackgroundJobType','PlayMusic','Event:\x20','agendaService','forEach','agenda','design:returntype','__esModule','2494170DeGvye','decorate','Define','setHours','attrs','.\x20Job:\x20','setSeconds','Events\x20scheduled!','time','updateExpiryStatus'];a9_0x394c=function(){return _0x4a6549;};return a9_0x394c();}