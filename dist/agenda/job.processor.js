'use strict';const a9_0x2b0615=a9_0x73c0;(function(_0x214118,_0xe89818){const _0x45cdd9=a9_0x73c0,_0x2e526a=_0x214118();while(!![]){try{const _0x2744e4=parseInt(_0x45cdd9(0x113))/0x1*(parseInt(_0x45cdd9(0x114))/0x2)+parseInt(_0x45cdd9(0x15c))/0x3*(-parseInt(_0x45cdd9(0x158))/0x4)+parseInt(_0x45cdd9(0x137))/0x5+parseInt(_0x45cdd9(0x115))/0x6+parseInt(_0x45cdd9(0x152))/0x7*(-parseInt(_0x45cdd9(0x138))/0x8)+-parseInt(_0x45cdd9(0x150))/0x9+parseInt(_0x45cdd9(0x11f))/0xa*(parseInt(_0x45cdd9(0x12c))/0xb);if(_0x2744e4===_0xe89818)break;else _0x2e526a['push'](_0x2e526a['shift']());}catch(_0x1778b6){_0x2e526a['push'](_0x2e526a['shift']());}}}(a9_0x8f8a,0xcabda));var __decorate=this&&this[a9_0x2b0615(0x13b)]||function(_0x34791b,_0x2cc161,_0x568b91,_0x2d9eb3){const _0x24deb9=a9_0x2b0615;var _0x553036=arguments[_0x24deb9(0x149)],_0x192306=_0x553036<0x3?_0x2cc161:_0x2d9eb3===null?_0x2d9eb3=Object[_0x24deb9(0x131)](_0x2cc161,_0x568b91):_0x2d9eb3,_0x2056f3;if(typeof Reflect===_0x24deb9(0x147)&&typeof Reflect[_0x24deb9(0x121)]===_0x24deb9(0x156))_0x192306=Reflect['decorate'](_0x34791b,_0x2cc161,_0x568b91,_0x2d9eb3);else{for(var _0x3a90bb=_0x34791b['length']-0x1;_0x3a90bb>=0x0;_0x3a90bb--)if(_0x2056f3=_0x34791b[_0x3a90bb])_0x192306=(_0x553036<0x3?_0x2056f3(_0x192306):_0x553036>0x3?_0x2056f3(_0x2cc161,_0x568b91,_0x192306):_0x2056f3(_0x2cc161,_0x568b91))||_0x192306;}return _0x553036>0x3&&_0x192306&&Object[_0x24deb9(0x15d)](_0x2cc161,_0x568b91,_0x192306),_0x192306;},__metadata=this&&this[a9_0x2b0615(0x129)]||function(_0x3bc37c,_0x18d3a5){const _0xd2d60c=a9_0x2b0615;if(typeof Reflect===_0xd2d60c(0x147)&&typeof Reflect[_0xd2d60c(0x143)]===_0xd2d60c(0x156))return Reflect[_0xd2d60c(0x143)](_0x3bc37c,_0x18d3a5);},JobProccessor_1;function a9_0x73c0(_0x28ab8a,_0x47f30f){const _0x8f8a86=a9_0x8f8a();return a9_0x73c0=function(_0x73c097,_0x19248a){_0x73c097=_0x73c097-0x10f;let _0x340ba4=_0x8f8a86[_0x73c097];return _0x340ba4;},a9_0x73c0(_0x28ab8a,_0x47f30f);}function a9_0x8f8a(){const _0x1764ae=['322814sWfzCx','7327560OVMdrC','@nestjs/common','settingService','Define','events','attrs','AgendaService','JobType','@agent-ly/nestjs-agenda','log','8530LGbecq','../common/file','decorate','../common/constants','BackgroundJobType','AuditActor','../setting/setting.service','isExpired','development','time','__metadata','agendaService','data','8668friLyO','name','deleteFilesInFolder','CheckEvent','scheduleService','getOwnPropertyDescriptor','JobProccessor','../common/enums','Events\x20scheduled!','PlayMusic','getSeconds','6117400WaOPTv','95072nPWPOo','setSeconds','Canceling\x20all\x20old\x20background\x20checks...','__decorate','getHours','PlaySound','jobType','PlayVoiceRecorded','agenda','prototype','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','metadata','Job','ScheduleService','.\x20Job:\x20','object','Invalid\x20or\x20expired\x20license\x20key!','length','env','PlayTextToAudio','NODE_ENV','Purging\x20temp\x20uploaded\x20files...','design:paramtypes','design:returntype','9648198KDnzPk','schedule','238gULwjW','single','setHours','logger','function','design:type','431316ybEDHl','\x20-\x20','Eligible\x20schedule:\x20','findEligibleSchedule','45GEcNPF','defineProperty','../schedule/schedule.service','purgeTempUploadedFiles','split','\x20-\x20Schedule:\x20','checkEvent','Fetching\x20today\x20schedule...','Event:\x20','5eGjbZX'];a9_0x8f8a=function(){return _0x1764ae;};return a9_0x8f8a();}Object[a9_0x2b0615(0x15d)](exports,'__esModule',{'value':!![]}),exports[a9_0x2b0615(0x132)]=void 0x0;const common_1=require(a9_0x2b0615(0x116)),agenda_1=require(a9_0x2b0615(0x140)),nestjs_agenda_1=require(a9_0x2b0615(0x11d)),enums_1=require(a9_0x2b0615(0x133)),schedule_service_1=require(a9_0x2b0615(0x15e)),setting_service_1=require(a9_0x2b0615(0x125)),file_1=require(a9_0x2b0615(0x120)),constants_1=require(a9_0x2b0615(0x122));let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x19fbd1,_0x3916c8,_0x9cdcd){const _0x1713ee=a9_0x2b0615;this['agendaService']=_0x19fbd1,this[_0x1713ee(0x130)]=_0x3916c8,this[_0x1713ee(0x117)]=_0x9cdcd,this[_0x1713ee(0x155)]=new common_1['Logger'](JobProccessor_1[_0x1713ee(0x12d)]);}async[a9_0x2b0615(0x110)](_0x443daf){const _0x223c30=a9_0x2b0615;this['logger']['log']('Server\x20time:\x20'+new Date()+_0x223c30(0x146)+_0x443daf[_0x223c30(0x11a)][_0x223c30(0x12d)]);const _0x5a7247=await this['settingService']['updateExpiryStatus']();if(_0x5a7247[_0x223c30(0x126)]){this[_0x223c30(0x155)][_0x223c30(0x11e)](_0x223c30(0x148));if(process[_0x223c30(0x14a)][_0x223c30(0x14c)]!==_0x223c30(0x127))return;}this['logger']['log'](_0x223c30(0x13a)),await this[_0x223c30(0x12a)]['cancel']({'name':{'$nin':[enums_1['BackgroundJobType'][_0x223c30(0x12f)],enums_1['BackgroundJobType']['PurgeTempUploadedFiles']]},'type':_0x223c30(0x153)}),this[_0x223c30(0x155)][_0x223c30(0x11e)](_0x223c30(0x111));const _0x51f20f=await this['scheduleService'][_0x223c30(0x15b)](new Date());this[_0x223c30(0x155)][_0x223c30(0x11e)](_0x223c30(0x15a)+(_0x51f20f===null||_0x51f20f===void 0x0?void 0x0:_0x51f20f['name']));if(!_0x51f20f||!_0x51f20f[_0x223c30(0x119)]||_0x51f20f[_0x223c30(0x119)][_0x223c30(0x149)]===0x0)return;_0x51f20f['events']['forEach'](_0x41b80e=>{const _0x305e80=_0x223c30;this[_0x305e80(0x155)][_0x305e80(0x11e)]('Scheduling\x20event:\x20'+_0x41b80e['time']+_0x305e80(0x159)+_0x41b80e[_0x305e80(0x13e)]+_0x305e80(0x159)+_0x41b80e[_0x305e80(0x12d)]);const _0x54ab65=new Date(),_0x5af78a=_0x54ab65[_0x305e80(0x13c)](),_0xfe7d57=_0x54ab65['getMinutes'](),_0x522ca9=_0x54ab65[_0x305e80(0x136)](),[_0x5ba2e8,_0x58d1f1,_0x4f4240]=_0x41b80e[_0x305e80(0x128)][_0x305e80(0x160)](':');if(+_0x5ba2e8<_0x5af78a||+_0x5ba2e8===_0x5af78a&&+_0x58d1f1<_0xfe7d57||+_0x5ba2e8===_0x5af78a&&+_0x58d1f1===_0xfe7d57&&+_0x4f4240<_0x522ca9)return;_0x54ab65[_0x305e80(0x154)](+_0x5ba2e8),_0x54ab65['setMinutes'](+_0x58d1f1),_0x54ab65[_0x305e80(0x139)](+_0x4f4240);switch(_0x41b80e[_0x305e80(0x13e)]){case enums_1[_0x305e80(0x11c)][_0x305e80(0x13d)]:{const {soundId:_0x18662e,durationInSecond:_0x4c43f2}=_0x41b80e[_0x305e80(0x12b)];if(!_0x18662e)return;const _0x29dd2e={'soundId':_0x18662e,'durationInSecond':_0x4c43f2,'audit':{'actor':enums_1[_0x305e80(0x124)]['Job'],'name':enums_1[_0x305e80(0x11c)]['PlaySound'],'message':_0x305e80(0x112)+_0x41b80e[_0x305e80(0x12d)]+_0x305e80(0x10f)+_0x51f20f['name']}};this[_0x305e80(0x12a)][_0x305e80(0x151)](_0x54ab65,enums_1[_0x305e80(0x11c)][_0x305e80(0x13d)],_0x29dd2e);break;}case enums_1[_0x305e80(0x11c)]['PlayMusic']:{const {playlistId:_0x419686,durationInSecond:_0x520b05}=_0x41b80e[_0x305e80(0x12b)];if(!_0x419686)return;const _0x55db12={'playlistId':_0x419686,'durationInSecond':_0x520b05,'audit':{'actor':enums_1[_0x305e80(0x124)][_0x305e80(0x144)],'name':enums_1[_0x305e80(0x11c)][_0x305e80(0x135)],'message':_0x305e80(0x112)+_0x41b80e['name']+_0x305e80(0x10f)+_0x51f20f[_0x305e80(0x12d)]}};this[_0x305e80(0x12a)]['schedule'](_0x54ab65,enums_1[_0x305e80(0x11c)][_0x305e80(0x135)],_0x55db12);break;}case enums_1[_0x305e80(0x11c)][_0x305e80(0x13f)]:{const {voiceId:_0x1f5e0d,durationInSecond:_0x1dde39}=_0x41b80e['data'];if(!_0x1f5e0d)return;const _0x43bc24={'voiceId':_0x1f5e0d,'durationInSecond':_0x1dde39,'audit':{'actor':enums_1['AuditActor']['Job'],'name':enums_1[_0x305e80(0x11c)][_0x305e80(0x13f)],'message':_0x305e80(0x112)+_0x41b80e[_0x305e80(0x12d)]+_0x305e80(0x10f)+_0x51f20f[_0x305e80(0x12d)]}};this[_0x305e80(0x12a)][_0x305e80(0x151)](_0x54ab65,enums_1[_0x305e80(0x11c)]['PlayVoiceRecorded'],_0x43bc24);break;}case enums_1['JobType'][_0x305e80(0x14b)]:{const {textToAudioId:_0x1e5e47,durationInSecond:_0x223ba8}=_0x41b80e[_0x305e80(0x12b)];if(!_0x1e5e47)return;const _0x2de892={'textToAudioId':_0x1e5e47,'durationInSecond':_0x223ba8,'audit':{'actor':enums_1[_0x305e80(0x124)][_0x305e80(0x144)],'name':enums_1[_0x305e80(0x11c)]['PlayTextToAudio'],'message':_0x305e80(0x112)+_0x41b80e[_0x305e80(0x12d)]+'\x20-\x20Schedule:\x20'+_0x51f20f[_0x305e80(0x12d)]}};this[_0x305e80(0x12a)]['schedule'](_0x54ab65,enums_1[_0x305e80(0x11c)][_0x305e80(0x14b)],_0x2de892);break;}default:return;}}),this[_0x223c30(0x155)][_0x223c30(0x11e)](_0x223c30(0x134));}async[a9_0x2b0615(0x15f)](_0x16f862){const _0x51c669=a9_0x2b0615;this[_0x51c669(0x155)][_0x51c669(0x11e)](_0x51c669(0x14d));const {success:_0x34b0d7,message:_0x1e28ee}=await(0x0,file_1[_0x51c669(0x12e)])(constants_1['TMP_UPLOAD_DIR']);!_0x34b0d7&&this[_0x51c669(0x155)]['error'](_0x51c669(0x142)+_0x1e28ee);}};__decorate([(0x0,nestjs_agenda_1['Define'])(enums_1[a9_0x2b0615(0x123)][a9_0x2b0615(0x12f)]),__metadata(a9_0x2b0615(0x157),Function),__metadata(a9_0x2b0615(0x14e),[agenda_1[a9_0x2b0615(0x144)]]),__metadata(a9_0x2b0615(0x14f),Promise)],JobProccessor[a9_0x2b0615(0x141)],a9_0x2b0615(0x110),null),__decorate([(0x0,nestjs_agenda_1[a9_0x2b0615(0x118)])(enums_1['BackgroundJobType']['PurgeTempUploadedFiles']),__metadata('design:type',Function),__metadata(a9_0x2b0615(0x14e),[agenda_1['Job']]),__metadata(a9_0x2b0615(0x14f),Promise)],JobProccessor[a9_0x2b0615(0x141)],a9_0x2b0615(0x15f),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1['Processor'])(),__metadata('design:paramtypes',[nestjs_agenda_1[a9_0x2b0615(0x11b)],schedule_service_1[a9_0x2b0615(0x145)],setting_service_1['SettingService']])],JobProccessor),exports[a9_0x2b0615(0x132)]=JobProccessor;