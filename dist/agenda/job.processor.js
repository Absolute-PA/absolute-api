'use strict';const a9_0x3b82c1=a9_0x2661;(function(_0x1fdaf2,_0x3301f4){const _0x457282=a9_0x2661,_0xaafd8e=_0x1fdaf2();while(!![]){try{const _0x31e85f=-parseInt(_0x457282(0xcd))/0x1*(parseInt(_0x457282(0xac))/0x2)+-parseInt(_0x457282(0xd8))/0x3+parseInt(_0x457282(0xd0))/0x4*(parseInt(_0x457282(0xaf))/0x5)+-parseInt(_0x457282(0xd7))/0x6*(parseInt(_0x457282(0xe8))/0x7)+-parseInt(_0x457282(0xb9))/0x8+-parseInt(_0x457282(0xe5))/0x9*(-parseInt(_0x457282(0xb6))/0xa)+parseInt(_0x457282(0xbc))/0xb;if(_0x31e85f===_0x3301f4)break;else _0xaafd8e['push'](_0xaafd8e['shift']());}catch(_0x13f4db){_0xaafd8e['push'](_0xaafd8e['shift']());}}}(a9_0x5d89,0xeac92));var __decorate=this&&this[a9_0x3b82c1(0xd6)]||function(_0x38ae0d,_0x53efc1,_0x352557,_0x3103b1){const _0x2c83e0=a9_0x3b82c1;var _0x42f3dd=arguments['length'],_0x574999=_0x42f3dd<0x3?_0x53efc1:_0x3103b1===null?_0x3103b1=Object['getOwnPropertyDescriptor'](_0x53efc1,_0x352557):_0x3103b1,_0x5a5088;if(typeof Reflect==='object'&&typeof Reflect[_0x2c83e0(0xd4)]===_0x2c83e0(0xab))_0x574999=Reflect['decorate'](_0x38ae0d,_0x53efc1,_0x352557,_0x3103b1);else{for(var _0x4080e1=_0x38ae0d[_0x2c83e0(0xae)]-0x1;_0x4080e1>=0x0;_0x4080e1--)if(_0x5a5088=_0x38ae0d[_0x4080e1])_0x574999=(_0x42f3dd<0x3?_0x5a5088(_0x574999):_0x42f3dd>0x3?_0x5a5088(_0x53efc1,_0x352557,_0x574999):_0x5a5088(_0x53efc1,_0x352557))||_0x574999;}return _0x42f3dd>0x3&&_0x574999&&Object[_0x2c83e0(0xc8)](_0x53efc1,_0x352557,_0x574999),_0x574999;},__metadata=this&&this[a9_0x3b82c1(0xc7)]||function(_0x5a6e92,_0x6f7b73){const _0xdf78f3=a9_0x3b82c1;if(typeof Reflect===_0xdf78f3(0xb4)&&typeof Reflect[_0xdf78f3(0xe0)]==='function')return Reflect[_0xdf78f3(0xe0)](_0x5a6e92,_0x6f7b73);},JobProccessor_1;Object['defineProperty'](exports,a9_0x3b82c1(0xdc),{'value':!![]}),exports[a9_0x3b82c1(0xb0)]=void 0x0;const common_1=require('@nestjs/common'),agenda_1=require(a9_0x3b82c1(0xa4)),nestjs_agenda_1=require('@agent-ly/nestjs-agenda'),enums_1=require(a9_0x3b82c1(0xa6)),schedule_service_1=require(a9_0x3b82c1(0xe6)),setting_service_1=require(a9_0x3b82c1(0xd2)),file_1=require(a9_0x3b82c1(0xbe)),constants_1=require(a9_0x3b82c1(0xeb));function a9_0x5d89(){const _0x2f6eab=['purgeTempUploadedFiles','single','design:returntype','PlayMusic','prototype','agenda','getSeconds','../common/enums','time','checkEvent','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','Server\x20time:\x20','function','174SIDDCj','findEligibleSchedule','length','860bzfVmC','JobProccessor','schedule','\x20-\x20Schedule:\x20','scheduleService','object','forEach','210qNTtnr','Define','Eligible\x20schedule:\x20','7926464hqvrOv','Processor','PlaySound','34856844XlBzKd','TMP_UPLOAD_DIR','../common/file','PlayVoiceRecorded','PurgeTempUploadedFiles','\x20-\x20','isExpired','name','data','jobType','ScheduleService','__metadata','defineProperty','Event:\x20','deleteFilesInFolder','design:type','.\x20Job:\x20','9254eRsaCj','getMinutes','CheckEvent','12412oWpvnM','Canceling\x20all\x20old\x20background\x20checks...','../setting/setting.service','Job','decorate','log','__decorate','42obIhNd','4923036ZzfbjB','AuditActor','agendaService','PlayTextToAudio','__esModule','split','setMinutes','attrs','metadata','events','Logger','settingService','env','493083DfPgQr','../schedule/schedule.service','Fetching\x20today\x20schedule...','454447IdmMKM','BackgroundJobType','getHours','../common/constants','setSeconds','JobType','logger','SettingService','design:paramtypes','AgendaService'];a9_0x5d89=function(){return _0x2f6eab;};return a9_0x5d89();}let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x52e44c,_0x566664,_0x3ad617){const _0x5b302d=a9_0x3b82c1;this[_0x5b302d(0xda)]=_0x52e44c,this[_0x5b302d(0xb3)]=_0x566664,this[_0x5b302d(0xe3)]=_0x3ad617,this[_0x5b302d(0xee)]=new common_1[(_0x5b302d(0xe2))](JobProccessor_1[_0x5b302d(0xc3)]);}async[a9_0x3b82c1(0xa8)](_0x4be403){const _0x2b9f0f=a9_0x3b82c1;this[_0x2b9f0f(0xee)][_0x2b9f0f(0xd5)](_0x2b9f0f(0xaa)+new Date()+_0x2b9f0f(0xcc)+_0x4be403[_0x2b9f0f(0xdf)][_0x2b9f0f(0xc3)]);const _0x15d98a=await this[_0x2b9f0f(0xe3)]['updateExpiryStatus']();if(_0x15d98a[_0x2b9f0f(0xc2)]){this[_0x2b9f0f(0xee)][_0x2b9f0f(0xd5)]('Invalid\x20or\x20expired\x20license\x20key!');if(process[_0x2b9f0f(0xe4)]['NODE_ENV']!=='development')return;}this[_0x2b9f0f(0xee)][_0x2b9f0f(0xd5)](_0x2b9f0f(0xd1)),await this[_0x2b9f0f(0xda)]['cancel']({'name':{'$nin':[enums_1[_0x2b9f0f(0xe9)][_0x2b9f0f(0xcf)],enums_1[_0x2b9f0f(0xe9)][_0x2b9f0f(0xc0)]]},'type':_0x2b9f0f(0xf3)}),this['logger'][_0x2b9f0f(0xd5)](_0x2b9f0f(0xe7));const _0x555688=await this[_0x2b9f0f(0xb3)][_0x2b9f0f(0xad)](new Date());this[_0x2b9f0f(0xee)][_0x2b9f0f(0xd5)](_0x2b9f0f(0xb8)+(_0x555688===null||_0x555688===void 0x0?void 0x0:_0x555688[_0x2b9f0f(0xc3)]));if(!_0x555688||!_0x555688[_0x2b9f0f(0xe1)]||_0x555688['events'][_0x2b9f0f(0xae)]===0x0)return;_0x555688[_0x2b9f0f(0xe1)][_0x2b9f0f(0xb5)](_0x2b9964=>{const _0x1edef9=_0x2b9f0f;this[_0x1edef9(0xee)][_0x1edef9(0xd5)]('Scheduling\x20event:\x20'+_0x2b9964[_0x1edef9(0xa7)]+_0x1edef9(0xc1)+_0x2b9964[_0x1edef9(0xc5)]+_0x1edef9(0xc1)+_0x2b9964[_0x1edef9(0xc3)]);const _0x38f43a=new Date(),_0x23ed59=_0x38f43a[_0x1edef9(0xea)](),_0x296300=_0x38f43a[_0x1edef9(0xce)](),_0x138702=_0x38f43a[_0x1edef9(0xa5)](),[_0x104ac4,_0x162902,_0x42f156]=_0x2b9964['time'][_0x1edef9(0xdd)](':');if(+_0x104ac4<_0x23ed59||+_0x104ac4===_0x23ed59&&+_0x162902<_0x296300||+_0x104ac4===_0x23ed59&&+_0x162902===_0x296300&&+_0x42f156<_0x138702)return;_0x38f43a['setHours'](+_0x104ac4),_0x38f43a[_0x1edef9(0xde)](+_0x162902),_0x38f43a[_0x1edef9(0xec)](+_0x42f156);switch(_0x2b9964[_0x1edef9(0xc5)]){case enums_1[_0x1edef9(0xed)][_0x1edef9(0xbb)]:{const {soundId:_0x21a3f3,durationInSecond:_0x3b4be5}=_0x2b9964[_0x1edef9(0xc4)];if(!_0x21a3f3)return;const _0x478c20={'soundId':_0x21a3f3,'durationInSecond':_0x3b4be5,'audit':{'actor':enums_1[_0x1edef9(0xd9)][_0x1edef9(0xd3)],'name':enums_1['JobType']['PlaySound'],'message':'Event:\x20'+_0x2b9964[_0x1edef9(0xc3)]+_0x1edef9(0xb2)+_0x555688[_0x1edef9(0xc3)]}};this['agendaService'][_0x1edef9(0xb1)](_0x38f43a,enums_1[_0x1edef9(0xed)][_0x1edef9(0xbb)],_0x478c20);break;}case enums_1[_0x1edef9(0xed)][_0x1edef9(0xa2)]:{const {playlistId:_0x40528d,durationInSecond:_0x519b0f}=_0x2b9964[_0x1edef9(0xc4)];if(!_0x40528d)return;const _0x3342d1={'playlistId':_0x40528d,'durationInSecond':_0x519b0f,'audit':{'actor':enums_1[_0x1edef9(0xd9)]['Job'],'name':enums_1['JobType']['PlayMusic'],'message':'Event:\x20'+_0x2b9964[_0x1edef9(0xc3)]+'\x20-\x20Schedule:\x20'+_0x555688[_0x1edef9(0xc3)]}};this['agendaService']['schedule'](_0x38f43a,enums_1[_0x1edef9(0xed)][_0x1edef9(0xa2)],_0x3342d1);break;}case enums_1[_0x1edef9(0xed)][_0x1edef9(0xbf)]:{const {voiceId:_0x5e2684,durationInSecond:_0x7dfc9f}=_0x2b9964[_0x1edef9(0xc4)];if(!_0x5e2684)return;const _0x371b68={'voiceId':_0x5e2684,'durationInSecond':_0x7dfc9f,'audit':{'actor':enums_1[_0x1edef9(0xd9)][_0x1edef9(0xd3)],'name':enums_1[_0x1edef9(0xed)]['PlayVoiceRecorded'],'message':_0x1edef9(0xc9)+_0x2b9964[_0x1edef9(0xc3)]+_0x1edef9(0xb2)+_0x555688[_0x1edef9(0xc3)]}};this[_0x1edef9(0xda)][_0x1edef9(0xb1)](_0x38f43a,enums_1[_0x1edef9(0xed)][_0x1edef9(0xbf)],_0x371b68);break;}case enums_1[_0x1edef9(0xed)][_0x1edef9(0xdb)]:{const {textToAudioId:_0x1f893e,durationInSecond:_0x2c1324}=_0x2b9964[_0x1edef9(0xc4)];if(!_0x1f893e)return;const _0x10c941={'textToAudioId':_0x1f893e,'durationInSecond':_0x2c1324,'audit':{'actor':enums_1[_0x1edef9(0xd9)]['Job'],'name':enums_1[_0x1edef9(0xed)][_0x1edef9(0xdb)],'message':_0x1edef9(0xc9)+_0x2b9964[_0x1edef9(0xc3)]+_0x1edef9(0xb2)+_0x555688[_0x1edef9(0xc3)]}};this[_0x1edef9(0xda)][_0x1edef9(0xb1)](_0x38f43a,enums_1[_0x1edef9(0xed)][_0x1edef9(0xdb)],_0x10c941);break;}default:return;}}),this[_0x2b9f0f(0xee)][_0x2b9f0f(0xd5)]('Events\x20scheduled!');}async[a9_0x3b82c1(0xf2)](_0x24c9c5){const _0xed8dc8=a9_0x3b82c1;this[_0xed8dc8(0xee)][_0xed8dc8(0xd5)]('Purging\x20temp\x20uploaded\x20files...');const {success:_0x377652,message:_0x5605d8}=await(0x0,file_1[_0xed8dc8(0xca)])(constants_1[_0xed8dc8(0xbd)]);!_0x377652&&this[_0xed8dc8(0xee)]['error'](_0xed8dc8(0xa9)+_0x5605d8);}};function a9_0x2661(_0x330068,_0x4f56e6){const _0x5d89b1=a9_0x5d89();return a9_0x2661=function(_0x266142,_0x6e8c13){_0x266142=_0x266142-0xa1;let _0x2c6f35=_0x5d89b1[_0x266142];return _0x2c6f35;},a9_0x2661(_0x330068,_0x4f56e6);}__decorate([(0x0,nestjs_agenda_1[a9_0x3b82c1(0xb7)])(enums_1[a9_0x3b82c1(0xe9)]['CheckEvent']),__metadata(a9_0x3b82c1(0xcb),Function),__metadata(a9_0x3b82c1(0xf0),[agenda_1[a9_0x3b82c1(0xd3)]]),__metadata('design:returntype',Promise)],JobProccessor['prototype'],a9_0x3b82c1(0xa8),null),__decorate([(0x0,nestjs_agenda_1[a9_0x3b82c1(0xb7)])(enums_1[a9_0x3b82c1(0xe9)][a9_0x3b82c1(0xc0)]),__metadata(a9_0x3b82c1(0xcb),Function),__metadata(a9_0x3b82c1(0xf0),[agenda_1[a9_0x3b82c1(0xd3)]]),__metadata(a9_0x3b82c1(0xa1),Promise)],JobProccessor[a9_0x3b82c1(0xa3)],a9_0x3b82c1(0xf2),null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1[a9_0x3b82c1(0xba)])(),__metadata(a9_0x3b82c1(0xf0),[nestjs_agenda_1[a9_0x3b82c1(0xf1)],schedule_service_1[a9_0x3b82c1(0xc6)],setting_service_1[a9_0x3b82c1(0xef)]])],JobProccessor),exports[a9_0x3b82c1(0xb0)]=JobProccessor;