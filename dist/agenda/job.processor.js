'use strict';const a9_0x35ff59=a9_0x298b;(function(_0x57abf6,_0x3e69a1){const _0x2b86e8=a9_0x298b,_0x2f313d=_0x57abf6();while(!![]){try{const _0x574503=-parseInt(_0x2b86e8(0x1a7))/0x1+-parseInt(_0x2b86e8(0x1c2))/0x2+parseInt(_0x2b86e8(0x1a8))/0x3+parseInt(_0x2b86e8(0x1b3))/0x4*(parseInt(_0x2b86e8(0x1c5))/0x5)+parseInt(_0x2b86e8(0x1cc))/0x6*(-parseInt(_0x2b86e8(0x1c9))/0x7)+parseInt(_0x2b86e8(0x1d1))/0x8*(-parseInt(_0x2b86e8(0x1b9))/0x9)+parseInt(_0x2b86e8(0x1b1))/0xa;if(_0x574503===_0x3e69a1)break;else _0x2f313d['push'](_0x2f313d['shift']());}catch(_0x28f21d){_0x2f313d['push'](_0x2f313d['shift']());}}}(a9_0x3a34,0x7b707));var __decorate=this&&this[a9_0x35ff59(0x1ea)]||function(_0x2cfa78,_0x210431,_0xee132e,_0x8cd554){const _0x17aee1=a9_0x35ff59;var _0x4c289d=arguments[_0x17aee1(0x1e9)],_0xc4ab39=_0x4c289d<0x3?_0x210431:_0x8cd554===null?_0x8cd554=Object['getOwnPropertyDescriptor'](_0x210431,_0xee132e):_0x8cd554,_0x2a752e;if(typeof Reflect===_0x17aee1(0x1b5)&&typeof Reflect[_0x17aee1(0x1e3)]==='function')_0xc4ab39=Reflect[_0x17aee1(0x1e3)](_0x2cfa78,_0x210431,_0xee132e,_0x8cd554);else{for(var _0x16f6e5=_0x2cfa78['length']-0x1;_0x16f6e5>=0x0;_0x16f6e5--)if(_0x2a752e=_0x2cfa78[_0x16f6e5])_0xc4ab39=(_0x4c289d<0x3?_0x2a752e(_0xc4ab39):_0x4c289d>0x3?_0x2a752e(_0x210431,_0xee132e,_0xc4ab39):_0x2a752e(_0x210431,_0xee132e))||_0xc4ab39;}return _0x4c289d>0x3&&_0xc4ab39&&Object[_0x17aee1(0x1e8)](_0x210431,_0xee132e,_0xc4ab39),_0xc4ab39;},__metadata=this&&this[a9_0x35ff59(0x1b2)]||function(_0xef3682,_0x1062db){const _0x5e29fa=a9_0x35ff59;if(typeof Reflect===_0x5e29fa(0x1b5)&&typeof Reflect[_0x5e29fa(0x1a3)]==='function')return Reflect[_0x5e29fa(0x1a3)](_0xef3682,_0x1062db);},JobProccessor_1;Object[a9_0x35ff59(0x1e8)](exports,a9_0x35ff59(0x1da),{'value':!![]}),exports[a9_0x35ff59(0x1ed)]=void 0x0;const common_1=require(a9_0x35ff59(0x1dc)),agenda_1=require(a9_0x35ff59(0x1d6)),nestjs_agenda_1=require(a9_0x35ff59(0x1b6)),enums_1=require('../common/enums'),schedule_service_1=require('../schedule/schedule.service'),setting_service_1=require(a9_0x35ff59(0x1b7)),file_1=require(a9_0x35ff59(0x1e1)),constants_1=require(a9_0x35ff59(0x1bd));function a9_0x298b(_0x631847,_0x45f646){const _0x3a3471=a9_0x3a34();return a9_0x298b=function(_0x298b6b,_0x52a370){_0x298b6b=_0x298b6b-0x1a0;let _0x43939e=_0x3a3471[_0x298b6b];return _0x43939e;},a9_0x298b(_0x631847,_0x45f646);}let JobProccessor=JobProccessor_1=class JobProccessor{constructor(_0x128241,_0x4f4667,_0x5290e2){const _0x2bb905=a9_0x35ff59;this[_0x2bb905(0x1d0)]=_0x128241,this['scheduleService']=_0x4f4667,this[_0x2bb905(0x1c7)]=_0x5290e2,this['logger']=new common_1[(_0x2bb905(0x1c0))](JobProccessor_1[_0x2bb905(0x1af)]);}async[a9_0x35ff59(0x1ee)](_0x4c4744){const _0x497d55=a9_0x35ff59;this['logger'][_0x497d55(0x1d7)](_0x497d55(0x1d4)+new Date()+_0x497d55(0x1e5)+_0x4c4744[_0x497d55(0x1b0)][_0x497d55(0x1af)]);const _0x575c81=await this[_0x497d55(0x1c7)][_0x497d55(0x1e7)]();if(_0x575c81['isExpired']){this[_0x497d55(0x1ba)][_0x497d55(0x1d7)]('Invalid\x20or\x20expired\x20license\x20key!');if(process[_0x497d55(0x1a0)]['NODE_ENV']!==_0x497d55(0x1d3))return;}this[_0x497d55(0x1ba)][_0x497d55(0x1d7)](_0x497d55(0x1c4)),await this[_0x497d55(0x1d0)][_0x497d55(0x1bc)]({'name':{'$nin':[enums_1['BackgroundJobType']['CheckEvent'],enums_1['BackgroundJobType'][_0x497d55(0x1a5)]]},'type':_0x497d55(0x1e0)}),this[_0x497d55(0x1ba)][_0x497d55(0x1d7)](_0x497d55(0x1cd));const _0x1c2996=await this[_0x497d55(0x1ae)][_0x497d55(0x1a2)](new Date());this['logger']['log'](_0x497d55(0x1f0)+(_0x1c2996===null||_0x1c2996===void 0x0?void 0x0:_0x1c2996['name']));if(!_0x1c2996||!_0x1c2996[_0x497d55(0x1ef)]||_0x1c2996[_0x497d55(0x1ef)][_0x497d55(0x1e9)]===0x0)return;_0x1c2996[_0x497d55(0x1ef)]['forEach'](_0x1a3e34=>{const _0x724310=_0x497d55;this['logger']['log'](_0x724310(0x1d9)+_0x1a3e34[_0x724310(0x1c1)]+'\x20-\x20'+_0x1a3e34[_0x724310(0x1a1)]+'\x20-\x20'+_0x1a3e34[_0x724310(0x1af)]);const _0x27162b=new Date(),_0x12ca84=_0x27162b[_0x724310(0x1a4)](),_0x316494=_0x27162b[_0x724310(0x1bf)](),_0x2339b6=_0x27162b[_0x724310(0x1ca)](),[_0x5c6ce7,_0xfe4705,_0x2a17eb]=_0x1a3e34['time'][_0x724310(0x1c8)](':');if(+_0x5c6ce7<_0x12ca84||+_0x5c6ce7===_0x12ca84&&+_0xfe4705<_0x316494||+_0x5c6ce7===_0x12ca84&&+_0xfe4705===_0x316494&&+_0x2a17eb<_0x2339b6)return;_0x27162b[_0x724310(0x1aa)](+_0x5c6ce7),_0x27162b[_0x724310(0x1b8)](+_0xfe4705),_0x27162b[_0x724310(0x1ac)](+_0x2a17eb);switch(_0x1a3e34['jobType']){case enums_1[_0x724310(0x1d8)]['PlaySound']:{const {soundId:_0x1f9ef9,durationInSecond:_0xfdcc2d}=_0x1a3e34[_0x724310(0x1dd)];if(!_0x1f9ef9)return;const _0x3264d4={'soundId':_0x1f9ef9,'durationInSecond':_0xfdcc2d,'audit':{'actor':enums_1[_0x724310(0x1f1)][_0x724310(0x1ad)],'name':enums_1['JobType'][_0x724310(0x1be)],'message':_0x724310(0x1de)+_0x1a3e34[_0x724310(0x1af)]+'\x20-\x20Schedule:\x20'+_0x1c2996[_0x724310(0x1af)]}};this[_0x724310(0x1d0)][_0x724310(0x1cb)](_0x27162b,enums_1[_0x724310(0x1d8)][_0x724310(0x1be)],_0x3264d4);break;}case enums_1[_0x724310(0x1d8)][_0x724310(0x1eb)]:{const {playlistId:_0x20bf6e,durationInSecond:_0x43fd9b}=_0x1a3e34[_0x724310(0x1dd)];if(!_0x20bf6e)return;const _0x54bee3={'playlistId':_0x20bf6e,'durationInSecond':_0x43fd9b,'audit':{'actor':enums_1[_0x724310(0x1f1)]['Job'],'name':enums_1[_0x724310(0x1d8)][_0x724310(0x1eb)],'message':_0x724310(0x1de)+_0x1a3e34[_0x724310(0x1af)]+_0x724310(0x1e2)+_0x1c2996[_0x724310(0x1af)]}};this['agendaService'][_0x724310(0x1cb)](_0x27162b,enums_1[_0x724310(0x1d8)][_0x724310(0x1eb)],_0x54bee3);break;}case enums_1[_0x724310(0x1d8)][_0x724310(0x1cf)]:{const {voiceId:_0x384451,durationInSecond:_0xfff3cd}=_0x1a3e34[_0x724310(0x1dd)];if(!_0x384451)return;const _0x4b300a={'voiceId':_0x384451,'durationInSecond':_0xfff3cd,'audit':{'actor':enums_1[_0x724310(0x1f1)]['Job'],'name':enums_1['JobType'][_0x724310(0x1cf)],'message':_0x724310(0x1de)+_0x1a3e34[_0x724310(0x1af)]+_0x724310(0x1e2)+_0x1c2996['name']}};this['agendaService']['schedule'](_0x27162b,enums_1[_0x724310(0x1d8)][_0x724310(0x1cf)],_0x4b300a);break;}case enums_1[_0x724310(0x1d8)][_0x724310(0x1c6)]:{const {textToAudioId:_0x271e1d,durationInSecond:_0x4cffe5}=_0x1a3e34[_0x724310(0x1dd)];if(!_0x271e1d)return;const _0x5e54d2={'textToAudioId':_0x271e1d,'durationInSecond':_0x4cffe5,'audit':{'actor':enums_1[_0x724310(0x1f1)]['Job'],'name':enums_1[_0x724310(0x1d8)][_0x724310(0x1c6)],'message':_0x724310(0x1de)+_0x1a3e34[_0x724310(0x1af)]+_0x724310(0x1e2)+_0x1c2996['name']}};this['agendaService']['schedule'](_0x27162b,enums_1['JobType'][_0x724310(0x1c6)],_0x5e54d2);break;}default:return;}}),this['logger'][_0x497d55(0x1d7)]('Events\x20scheduled!');}async['purgeTempUploadedFiles'](_0x84ed3a){const _0x599d44=a9_0x35ff59;this[_0x599d44(0x1ba)][_0x599d44(0x1d7)](_0x599d44(0x1c3));const {success:_0x57baed,message:_0x140c79}=await(0x0,file_1[_0x599d44(0x1a6)])(constants_1[_0x599d44(0x1b4)]);!_0x57baed&&this['logger'][_0x599d44(0x1ec)](_0x599d44(0x1db)+_0x140c79);}};__decorate([(0x0,nestjs_agenda_1[a9_0x35ff59(0x1df)])(enums_1[a9_0x35ff59(0x1e6)][a9_0x35ff59(0x1d5)]),__metadata(a9_0x35ff59(0x1d2),Function),__metadata(a9_0x35ff59(0x1ce),[agenda_1['Job']]),__metadata(a9_0x35ff59(0x1e4),Promise)],JobProccessor['prototype'],'checkEvent',null),__decorate([(0x0,nestjs_agenda_1[a9_0x35ff59(0x1df)])(enums_1[a9_0x35ff59(0x1e6)]['PurgeTempUploadedFiles']),__metadata(a9_0x35ff59(0x1d2),Function),__metadata(a9_0x35ff59(0x1ce),[agenda_1[a9_0x35ff59(0x1ad)]]),__metadata(a9_0x35ff59(0x1e4),Promise)],JobProccessor['prototype'],'purgeTempUploadedFiles',null),JobProccessor=JobProccessor_1=__decorate([(0x0,nestjs_agenda_1[a9_0x35ff59(0x1bb)])(),__metadata(a9_0x35ff59(0x1ce),[nestjs_agenda_1[a9_0x35ff59(0x1a9)],schedule_service_1[a9_0x35ff59(0x1ab)],setting_service_1['SettingService']])],JobProccessor),exports[a9_0x35ff59(0x1ed)]=JobProccessor;function a9_0x3a34(){const _0x4162fd=['deleteFilesInFolder','104448ZszsUY','1195278WoHrFf','AgendaService','setHours','ScheduleService','setSeconds','Job','scheduleService','name','attrs','15220340SOwWnn','__metadata','2686988bAuXbH','TMP_UPLOAD_DIR','object','@agent-ly/nestjs-agenda','../setting/setting.service','setMinutes','5339223mfUqAl','logger','Processor','cancel','../common/constants','PlaySound','getMinutes','Logger','time','1114474RHNCaE','Purging\x20temp\x20uploaded\x20files...','Canceling\x20all\x20old\x20background\x20checks...','5LbFKlM','PlayTextToAudio','settingService','split','16492lHMZnM','getSeconds','schedule','2118iXeglz','Fetching\x20today\x20schedule...','design:paramtypes','PlayVoiceRecorded','agendaService','8SkZOkl','design:type','development','Server\x20time:\x20','CheckEvent','agenda','log','JobType','Scheduling\x20event:\x20','__esModule','Failed\x20to\x20purge\x20temp\x20uploaded\x20files:\x20','@nestjs/common','data','Event:\x20','Define','single','../common/file','\x20-\x20Schedule:\x20','decorate','design:returntype','.\x20Job:\x20','BackgroundJobType','updateExpiryStatus','defineProperty','length','__decorate','PlayMusic','error','JobProccessor','checkEvent','events','Eligible\x20schedule:\x20','AuditActor','env','jobType','findEligibleSchedule','metadata','getHours','PurgeTempUploadedFiles'];a9_0x3a34=function(){return _0x4162fd;};return a9_0x3a34();}