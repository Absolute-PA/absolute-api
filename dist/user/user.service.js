'use strict';const a160_0x135ca8=a160_0x4d9c;(function(_0x1a205a,_0x38038f){const _0x2f0cc1=a160_0x4d9c,_0x2d4726=_0x1a205a();while(!![]){try{const _0x371b88=-parseInt(_0x2f0cc1(0xf1))/0x1*(-parseInt(_0x2f0cc1(0x109))/0x2)+parseInt(_0x2f0cc1(0xe6))/0x3+parseInt(_0x2f0cc1(0x104))/0x4+parseInt(_0x2f0cc1(0xf6))/0x5*(-parseInt(_0x2f0cc1(0x106))/0x6)+-parseInt(_0x2f0cc1(0x12b))/0x7+parseInt(_0x2f0cc1(0x111))/0x8*(parseInt(_0x2f0cc1(0xe3))/0x9)+parseInt(_0x2f0cc1(0xf9))/0xa*(-parseInt(_0x2f0cc1(0x12f))/0xb);if(_0x371b88===_0x38038f)break;else _0x2d4726['push'](_0x2d4726['shift']());}catch(_0x1f2ea4){_0x2d4726['push'](_0x2d4726['shift']());}}}(a160_0x5474,0x1f495));function a160_0x5474(){const _0x35c3d1=['Logger','absolutePA123','-password','error','toObject','create','roles','map','303261sXzYxm','Admin','Injectable','save','1665411bdosyF','deleteOne','updateUser','MASTER_PASSWORD','mongoose','jwtService','482661tPlUtC','find','UserService','282303wbmTbT','userModel','__metadata','Model','password','../setting/setting.service','userSetting','design:paramtypes','MasterUserUsername','findOne','findByIdAndUpdate','10312gUIsPK','DefaultAdminUsername','JwtService','__param','logger','5970iQxPFm','__esModule','User','10MYrpfy','../auth/verify','hash','settingService','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','__decorate','forgotpassword','findById','@nestjs/jwt','addUser','username','906372bFFudt','decorate','414ddkHlN','onModuleInit','env','6WBjRBu','../setting/constants','findFirst','delete','name','length','defineProperty','email','8dESWDx','sign','absolutePA123@gmail.com','Role','maxUser','@nestjs/common','object','select','DEFAULT_PASSWORD','admin@absolutepa','SettingService','getOwnPropertyDescriptor','Email\x20is\x20exist\x20','function','DefaultAdminPassword','@nestjs/mongoose','DEFAULT_MAX_USER','getAllUser'];a160_0x5474=function(){return _0x35c3d1;};return a160_0x5474();}function a160_0x4d9c(_0x2aa9f6,_0x5aad01){const _0x547467=a160_0x5474();return a160_0x4d9c=function(_0x4d9c2b,_0x3f98ac){_0x4d9c2b=_0x4d9c2b-0xe1;let _0x5b7b6f=_0x547467[_0x4d9c2b];return _0x5b7b6f;},a160_0x4d9c(_0x2aa9f6,_0x5aad01);}var __decorate=this&&this[a160_0x135ca8(0xfe)]||function(_0x4bcc98,_0x371eca,_0x55a4b1,_0x649e18){const _0xecd211=a160_0x135ca8;var _0x1c1f1f=arguments[_0xecd211(0x10e)],_0x3be8fb=_0x1c1f1f<0x3?_0x371eca:_0x649e18===null?_0x649e18=Object[_0xecd211(0x11c)](_0x371eca,_0x55a4b1):_0x649e18,_0x56495b;if(typeof Reflect===_0xecd211(0x117)&&typeof Reflect[_0xecd211(0x105)]===_0xecd211(0x11e))_0x3be8fb=Reflect['decorate'](_0x4bcc98,_0x371eca,_0x55a4b1,_0x649e18);else{for(var _0x455a4a=_0x4bcc98[_0xecd211(0x10e)]-0x1;_0x455a4a>=0x0;_0x455a4a--)if(_0x56495b=_0x4bcc98[_0x455a4a])_0x3be8fb=(_0x1c1f1f<0x3?_0x56495b(_0x3be8fb):_0x1c1f1f>0x3?_0x56495b(_0x371eca,_0x55a4b1,_0x3be8fb):_0x56495b(_0x371eca,_0x55a4b1))||_0x3be8fb;}return _0x1c1f1f>0x3&&_0x3be8fb&&Object[_0xecd211(0x10f)](_0x371eca,_0x55a4b1,_0x3be8fb),_0x3be8fb;},__metadata=this&&this[a160_0x135ca8(0xe8)]||function(_0x5b9d4e,_0x3d93aa){const _0x3d057c=a160_0x135ca8;if(typeof Reflect===_0x3d057c(0x117)&&typeof Reflect['metadata']===_0x3d057c(0x11e))return Reflect['metadata'](_0x5b9d4e,_0x3d93aa);},__param=this&&this[a160_0x135ca8(0xf4)]||function(_0xacb21a,_0x5160f3){return function(_0x2f98e6,_0x69d611){_0x5160f3(_0x2f98e6,_0x69d611,_0xacb21a);};},UserService_1;Object[a160_0x135ca8(0x10f)](exports,a160_0x135ca8(0xf7),{'value':!![]}),exports[a160_0x135ca8(0xe5)]=exports[a160_0x135ca8(0x11f)]=exports['DefaultAdminUsername']=exports[a160_0x135ca8(0xee)]=void 0x0;const common_1=require(a160_0x135ca8(0x116)),mongoose_1=require(a160_0x135ca8(0xe1)),mongoose_2=require(a160_0x135ca8(0x120)),role_enum_1=require('../auth/enums/role.enum'),jwt_1=require(a160_0x135ca8(0x101)),verify_1=require(a160_0x135ca8(0xfa)),setting_service_1=require(a160_0x135ca8(0xeb)),constants_1=require(a160_0x135ca8(0x10a));exports[a160_0x135ca8(0xee)]=a160_0x135ca8(0x124),exports[a160_0x135ca8(0xf2)]=a160_0x135ca8(0x11a),exports['DefaultAdminPassword']=a160_0x135ca8(0xff);let UserService=UserService_1=class UserService{constructor(_0x4176e6,_0x4c1da7,_0x1f4986){const _0x4546d3=a160_0x135ca8;this['userModel']=_0x4176e6,this['jwtService']=_0x4c1da7,this[_0x4546d3(0xfc)]=_0x1f4986,this[_0x4546d3(0xf5)]=new common_1[(_0x4546d3(0x123))](UserService_1[_0x4546d3(0x10d)]);}async[a160_0x135ca8(0x102)](_0x4f53e9){const _0x11b579=a160_0x135ca8;var _0x41fd53;const _0x4c14b3=await this[_0x11b579(0xe7)][_0x11b579(0xef)]({'email':_0x4f53e9[_0x11b579(0x110)]});if(_0x4c14b3)throw new Error(_0x11b579(0x11d)+_0x4f53e9['email']);const _0x59e406=(await this[_0x11b579(0xe7)][_0x11b579(0xe4)]({}))[_0x11b579(0x10e)],_0x298362=((_0x41fd53=(await this[_0x11b579(0xfc)][_0x11b579(0x10b)]())[_0x11b579(0xec)])===null||_0x41fd53===void 0x0?void 0x0:_0x41fd53[_0x11b579(0x115)])||constants_1[_0x11b579(0x121)];if(_0x59e406>_0x298362)throw new Error(_0x11b579(0xfd)+_0x298362);const _0x27b714=await this[_0x11b579(0xe7)][_0x11b579(0x128)](_0x4f53e9);return _0x27b714[_0x11b579(0xea)]=await(0x0,verify_1[_0x11b579(0xfb)])(_0x27b714[_0x11b579(0xea)]),_0x27b714[_0x11b579(0x12e)]();}async['findUser'](_0x4d7cd1){const _0x1d0222=a160_0x135ca8,_0x9ab082=await this[_0x1d0222(0xe7)]['findOne']({'username':_0x4d7cd1});return _0x9ab082;}async[a160_0x135ca8(0x122)](){const _0xf5d058=a160_0x135ca8,_0x52fbda=await this[_0xf5d058(0xe7)]['find']({'roles':{'$ne':role_enum_1[_0xf5d058(0x114)]['Master']}})[_0xf5d058(0x118)](_0xf5d058(0x125));return _0x52fbda[_0xf5d058(0x12a)](_0x1c1752=>({'email':_0x1c1752[_0xf5d058(0x110)],'roles':_0x1c1752[_0xf5d058(0x129)],'username':_0x1c1752[_0xf5d058(0x103)],'id':_0x1c1752['id']}));}async[a160_0x135ca8(0x131)](_0x2d06cf,_0x1fbbfa){const _0x951dd3=a160_0x135ca8;try{return await this['userModel'][_0x951dd3(0xf0)](_0x2d06cf,_0x1fbbfa)[_0x951dd3(0x118)](_0x951dd3(0x125));}catch(_0x56f22c){this[_0x951dd3(0xf5)][_0x951dd3(0x126)](_0x56f22c);return;}}async['deleteUser'](_0x134a61){const _0x38cdef=a160_0x135ca8,_0x281533=await this['userModel']['findById'](_0x134a61)[_0x38cdef(0x118)]('-password');if(!_0x281533)return;return await _0x281533[_0x38cdef(0x130)]();}async['resetPassword'](_0x48b0bb){const _0x393818=a160_0x135ca8;try{const _0x4d90fd=await this[_0x393818(0xe7)][_0x393818(0x100)](_0x48b0bb)[_0x393818(0x118)](_0x393818(0x125));if(!_0x4d90fd)return;return _0x4d90fd[_0x393818(0xea)]=await(0x0,verify_1[_0x393818(0xfb)])(process[_0x393818(0x108)][_0x393818(0x119)]),_0x4d90fd[_0x393818(0x12e)]();}catch(_0x4a0c21){this[_0x393818(0xf5)][_0x393818(0x126)](_0x4a0c21);}}async[a160_0x135ca8(0x107)](){const _0x23ce2a=a160_0x135ca8;try{const _0x400b3d=await this[_0x23ce2a(0xe7)]['findOne']({'username':exports['MasterUserUsername']});_0x400b3d&&await _0x400b3d['delete']();await this[_0x23ce2a(0x102)]({'username':exports[_0x23ce2a(0xee)],'email':_0x23ce2a(0x113),'roles':[role_enum_1[_0x23ce2a(0x114)]['Master']],'password':process[_0x23ce2a(0x108)][_0x23ce2a(0x132)]});const _0x16e476=await this[_0x23ce2a(0xe7)]['findOne']({'username':exports[_0x23ce2a(0xf2)]});_0x16e476&&await _0x16e476[_0x23ce2a(0x10c)](),await this[_0x23ce2a(0x102)]({'username':exports['DefaultAdminUsername'],'email':_0x23ce2a(0x11a),'roles':[role_enum_1[_0x23ce2a(0x114)][_0x23ce2a(0x12c)]],'password':exports['DefaultAdminPassword']});}catch(_0x24fc35){this[_0x23ce2a(0xf5)]['error'](_0x24fc35);}}async['getMasterUserAccessToken'](){const _0x4451fd=a160_0x135ca8,_0x1f5383=await this['userModel'][_0x4451fd(0xef)]({'username':exports[_0x4451fd(0xee)]}),_0x2293f9=await this[_0x4451fd(0xe2)][_0x4451fd(0x112)](_0x1f5383[_0x4451fd(0x127)](),{'secret':process[_0x4451fd(0x108)]['JWT_SECRET']});return _0x2293f9;}};UserService=UserService_1=__decorate([(0x0,common_1[a160_0x135ca8(0x12d)])(),__param(0x0,(0x0,mongoose_2['InjectModel'])(a160_0x135ca8(0xf8))),__metadata(a160_0x135ca8(0xed),[mongoose_1[a160_0x135ca8(0xe9)],jwt_1[a160_0x135ca8(0xf3)],setting_service_1[a160_0x135ca8(0x11b)]])],UserService),exports[a160_0x135ca8(0xe5)]=UserService;