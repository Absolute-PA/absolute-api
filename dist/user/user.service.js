'use strict';const a157_0x4877a4=a157_0x5b26;(function(_0x1281e6,_0x508d39){const _0x1bd014=a157_0x5b26,_0x3da151=_0x1281e6();while(!![]){try{const _0x289c8d=-parseInt(_0x1bd014(0xd3))/0x1*(parseInt(_0x1bd014(0xf5))/0x2)+parseInt(_0x1bd014(0x103))/0x3*(-parseInt(_0x1bd014(0xd7))/0x4)+parseInt(_0x1bd014(0xdc))/0x5+parseInt(_0x1bd014(0x10c))/0x6+-parseInt(_0x1bd014(0xd0))/0x7+-parseInt(_0x1bd014(0xc6))/0x8+parseInt(_0x1bd014(0xda))/0x9;if(_0x289c8d===_0x508d39)break;else _0x3da151['push'](_0x3da151['shift']());}catch(_0x3dbf3b){_0x3da151['push'](_0x3da151['shift']());}}}(a157_0x2ecd,0xc1f0e));var __decorate=this&&this[a157_0x4877a4(0xd5)]||function(_0x2b9b5d,_0x4a27d0,_0x145e51,_0x56d40b){const _0xb2af9b=a157_0x4877a4;var _0x43b1d6=arguments[_0xb2af9b(0xc2)],_0x1f493f=_0x43b1d6<0x3?_0x4a27d0:_0x56d40b===null?_0x56d40b=Object[_0xb2af9b(0xdb)](_0x4a27d0,_0x145e51):_0x56d40b,_0x3ff6ce;if(typeof Reflect==='object'&&typeof Reflect[_0xb2af9b(0xeb)]==='function')_0x1f493f=Reflect[_0xb2af9b(0xeb)](_0x2b9b5d,_0x4a27d0,_0x145e51,_0x56d40b);else{for(var _0x3fb869=_0x2b9b5d[_0xb2af9b(0xc2)]-0x1;_0x3fb869>=0x0;_0x3fb869--)if(_0x3ff6ce=_0x2b9b5d[_0x3fb869])_0x1f493f=(_0x43b1d6<0x3?_0x3ff6ce(_0x1f493f):_0x43b1d6>0x3?_0x3ff6ce(_0x4a27d0,_0x145e51,_0x1f493f):_0x3ff6ce(_0x4a27d0,_0x145e51))||_0x1f493f;}return _0x43b1d6>0x3&&_0x1f493f&&Object[_0xb2af9b(0xc9)](_0x4a27d0,_0x145e51,_0x1f493f),_0x1f493f;},__metadata=this&&this[a157_0x4877a4(0xf7)]||function(_0x31cd76,_0x4f6ade){const _0x117f49=a157_0x4877a4;if(typeof Reflect===_0x117f49(0xe8)&&typeof Reflect[_0x117f49(0xe7)]===_0x117f49(0xec))return Reflect['metadata'](_0x31cd76,_0x4f6ade);},__param=this&&this[a157_0x4877a4(0xff)]||function(_0x19c0f3,_0x437a14){return function(_0x56348a,_0x35e509){_0x437a14(_0x56348a,_0x35e509,_0x19c0f3);};},UserService_1;function a157_0x5b26(_0x34cb20,_0x5a6376){const _0x2ecd97=a157_0x2ecd();return a157_0x5b26=function(_0x5b26ea,_0x314d13){_0x5b26ea=_0x5b26ea-0xbf;let _0x3acc6d=_0x2ecd97[_0x5b26ea];return _0x3acc6d;},a157_0x5b26(_0x34cb20,_0x5a6376);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a157_0x4877a4(0xd1)]=exports[a157_0x4877a4(0xea)]=exports[a157_0x4877a4(0x104)]=exports['MasterUserUsername']=void 0x0;const common_1=require(a157_0x4877a4(0xf3)),mongoose_1=require(a157_0x4877a4(0x10d)),mongoose_2=require(a157_0x4877a4(0xd4)),role_enum_1=require(a157_0x4877a4(0xf6)),jwt_1=require(a157_0x4877a4(0x102)),verify_1=require(a157_0x4877a4(0xd8)),setting_service_1=require(a157_0x4877a4(0xfc)),constants_1=require(a157_0x4877a4(0xd6));exports[a157_0x4877a4(0xcb)]=a157_0x4877a4(0xca),exports[a157_0x4877a4(0x104)]=a157_0x4877a4(0xfb),exports[a157_0x4877a4(0xea)]=a157_0x4877a4(0xde);let UserService=UserService_1=class UserService{constructor(_0x545e0e,_0x2784ab,_0x4d8517){const _0x337f5d=a157_0x4877a4;this['userModel']=_0x545e0e,this[_0x337f5d(0xf2)]=_0x2784ab,this['settingService']=_0x4d8517,this[_0x337f5d(0xc0)]=new common_1[(_0x337f5d(0xfa))](UserService_1['name']);}async['addUser'](_0x25f630){const _0x4a85cd=a157_0x4877a4;var _0x4c197e;const _0x3be619=await this[_0x4a85cd(0x100)][_0x4a85cd(0xfd)]({'email':_0x25f630[_0x4a85cd(0xd9)]});if(_0x3be619)throw new Error(_0x4a85cd(0xee)+_0x25f630['email']);const _0x34ee49=(await this[_0x4a85cd(0x100)]['find']({}))[_0x4a85cd(0xc2)],_0x2b3d22=((_0x4c197e=(await this[_0x4a85cd(0xe0)][_0x4a85cd(0xc4)]())['userSetting'])===null||_0x4c197e===void 0x0?void 0x0:_0x4c197e[_0x4a85cd(0x108)])||constants_1[_0x4a85cd(0x107)];if(_0x34ee49>_0x2b3d22)throw new Error('Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20'+_0x2b3d22);const _0x45c751=await this[_0x4a85cd(0x100)][_0x4a85cd(0xe1)](_0x25f630);return _0x45c751[_0x4a85cd(0xe2)]=await(0x0,verify_1[_0x4a85cd(0xef)])(_0x45c751['password']),_0x45c751[_0x4a85cd(0xf8)]();}async['findUser'](_0x4aa2c9){const _0x206412=a157_0x4877a4,_0x1c7832=await this[_0x206412(0x100)]['findOne']({'username':_0x4aa2c9});return _0x1c7832;}async[a157_0x4877a4(0x105)](){const _0x63f536=a157_0x4877a4,_0x28d7fc=await this['userModel'][_0x63f536(0xdf)]({'roles':{'$ne':role_enum_1[_0x63f536(0xc3)][_0x63f536(0xc7)]}})[_0x63f536(0xf4)](_0x63f536(0xf9));return _0x28d7fc[_0x63f536(0x101)](_0x4acea0=>({'email':_0x4acea0[_0x63f536(0xd9)],'roles':_0x4acea0['roles'],'username':_0x4acea0[_0x63f536(0xcf)],'id':_0x4acea0['id']}));}async[a157_0x4877a4(0xed)](_0x2a76ab,_0x5d45e3){const _0x47e3ac=a157_0x4877a4;try{return await this[_0x47e3ac(0x100)][_0x47e3ac(0xcd)](_0x2a76ab,_0x5d45e3)[_0x47e3ac(0xf4)](_0x47e3ac(0xf9));}catch(_0x28123e){this[_0x47e3ac(0xc0)][_0x47e3ac(0xbf)](_0x28123e);return;}}async[a157_0x4877a4(0xe4)](_0x2565c2){const _0x32a222=a157_0x4877a4,_0x4adb4b=await this[_0x32a222(0x100)][_0x32a222(0xdd)](_0x2565c2)['select'](_0x32a222(0xf9));if(!_0x4adb4b)return;return await _0x4adb4b[_0x32a222(0xe6)]();}async[a157_0x4877a4(0xd2)](_0x3a56a2){const _0x5b538a=a157_0x4877a4;try{const _0x4bb35d=await this[_0x5b538a(0x100)][_0x5b538a(0xdd)](_0x3a56a2)['select'](_0x5b538a(0xf9));if(!_0x4bb35d)return;return _0x4bb35d[_0x5b538a(0xe2)]=await(0x0,verify_1[_0x5b538a(0xef)])(process[_0x5b538a(0xe9)][_0x5b538a(0x109)]),_0x4bb35d[_0x5b538a(0xf8)]();}catch(_0x5e240c){this[_0x5b538a(0xc0)][_0x5b538a(0xbf)](_0x5e240c);}}async[a157_0x4877a4(0xc5)](){const _0x3afa28=a157_0x4877a4;try{const _0x1a20f7=await this[_0x3afa28(0x100)][_0x3afa28(0xfd)]({'username':exports[_0x3afa28(0xcb)]});_0x1a20f7&&await _0x1a20f7['delete']();await this[_0x3afa28(0x10b)]({'username':exports[_0x3afa28(0xcb)],'email':_0x3afa28(0xc1),'roles':[role_enum_1[_0x3afa28(0xc3)][_0x3afa28(0xc7)]],'password':process[_0x3afa28(0xe9)][_0x3afa28(0x106)]});const _0x3a30d0=await this['userModel']['findOne']({'username':exports[_0x3afa28(0x104)]});_0x3a30d0&&await _0x3a30d0[_0x3afa28(0xce)](),await this[_0x3afa28(0x10b)]({'username':exports[_0x3afa28(0x104)],'email':_0x3afa28(0xfb),'roles':[role_enum_1[_0x3afa28(0xc3)][_0x3afa28(0xc8)]],'password':exports[_0x3afa28(0xea)]});}catch(_0x3b9465){this[_0x3afa28(0xc0)]['error'](_0x3b9465);}}async['getMasterUserAccessToken'](){const _0x52915c=a157_0x4877a4,_0x459ec2=await this[_0x52915c(0x100)][_0x52915c(0xfd)]({'username':exports[_0x52915c(0xcb)]}),_0x14c00e=await this[_0x52915c(0xf2)][_0x52915c(0x10a)](_0x459ec2[_0x52915c(0xe5)](),{'secret':process['env']['JWT_SECRET']});return _0x14c00e;}};UserService=UserService_1=__decorate([(0x0,common_1[a157_0x4877a4(0xf1)])(),__param(0x0,(0x0,mongoose_2['InjectModel'])(a157_0x4877a4(0xf0))),__metadata(a157_0x4877a4(0xcc),[mongoose_1['Model'],jwt_1[a157_0x4877a4(0xe3)],setting_service_1[a157_0x4877a4(0xfe)]])],UserService),exports[a157_0x4877a4(0xd1)]=UserService;function a157_0x2ecd(){const _0x410752=['SettingService','__param','userModel','map','@nestjs/jwt','419121KMkSlH','DefaultAdminUsername','getAllUser','MASTER_PASSWORD','DEFAULT_MAX_USER','maxUser','DEFAULT_PASSWORD','sign','addUser','2887674vRdMYp','mongoose','error','logger','absolutePA123@gmail.com','length','Role','findFirst','onModuleInit','9485920YZiUlc','Master','Admin','defineProperty','absolutePA123','MasterUserUsername','design:paramtypes','findByIdAndUpdate','delete','username','3967901EZKntm','UserService','resetPassword','14NfjANN','@nestjs/mongoose','__decorate','../setting/constants','36wmWwtN','../auth/verify','email','30984462mSEiBb','getOwnPropertyDescriptor','204765odlsGb','findById','forgotpassword','find','settingService','create','password','JwtService','deleteUser','toObject','deleteOne','metadata','object','env','DefaultAdminPassword','decorate','function','updateUser','Email\x20is\x20exist\x20','hash','User','Injectable','jwtService','@nestjs/common','select','22946IcCNBp','../auth/enums/role.enum','__metadata','save','-password','Logger','admin@absolutepa','../setting/setting.service','findOne'];a157_0x2ecd=function(){return _0x410752;};return a157_0x2ecd();}