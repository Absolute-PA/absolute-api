'use strict';function a160_0x5f44(){const _0x273af2=['__esModule','select','userSetting','admin@absolutepa','updateUser','env','-password','DefaultAdminPassword','absolutePA123','../setting/constants','MasterUserUsername','resetPassword','../setting/setting.service','error','10iVVabv','save','5582907jfdmGE','getOwnPropertyDescriptor','getMasterUserAccessToken','metadata','find','311886ceaWRU','deleteOne','addUser','SettingService','function','defineProperty','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','email','Master','DefaultAdminUsername','3825597SSjGjW','settingService','Email\x20is\x20exist\x20','logger','__decorate','name','delete','Injectable','findOne','roles','findById','335ROSBOU','hash','toObject','39462gQxlIu','findByIdAndUpdate','5183591sXPxAh','__metadata','maxUser','MASTER_PASSWORD','@nestjs/mongoose','JwtService','deleteUser','DEFAULT_PASSWORD','UserService','16MAsXME','4zakKVu','@nestjs/jwt','../auth/enums/role.enum','JWT_SECRET','Role','../auth/verify','decorate','username','forgotpassword','onModuleInit','map','userModel','27253523JfwmYh','Admin','Model','@nestjs/common','length','mongoose','findUser','create','InjectModel','password','object','1415422jddiBw','jwtService'];a160_0x5f44=function(){return _0x273af2;};return a160_0x5f44();}const a160_0x534042=a160_0x4329;function a160_0x4329(_0x2b24e8,_0x1319f1){const _0x5f44af=a160_0x5f44();return a160_0x4329=function(_0x432949,_0x386cd7){_0x432949=_0x432949-0xcc;let _0x16d2a9=_0x5f44af[_0x432949];return _0x16d2a9;},a160_0x4329(_0x2b24e8,_0x1319f1);}(function(_0x5397fd,_0x10a7cd){const _0x334793=a160_0x4329,_0x1c65ec=_0x5397fd();while(!![]){try{const _0x33b1d9=parseInt(_0x334793(0xd7))/0x1+parseInt(_0x334793(0xee))/0x2+parseInt(_0x334793(0xf8))/0x3*(parseInt(_0x334793(0x112))/0x4)+parseInt(_0x334793(0x103))/0x5*(-parseInt(_0x334793(0x106))/0x6)+-parseInt(_0x334793(0x108))/0x7*(-parseInt(_0x334793(0x111))/0x8)+-parseInt(_0x334793(0xe9))/0x9+parseInt(_0x334793(0xe7))/0xa*(-parseInt(_0x334793(0xcc))/0xb);if(_0x33b1d9===_0x10a7cd)break;else _0x1c65ec['push'](_0x1c65ec['shift']());}catch(_0x46fb2e){_0x1c65ec['push'](_0x1c65ec['shift']());}}}(a160_0x5f44,0xc0a17));var __decorate=this&&this[a160_0x534042(0xfc)]||function(_0x5a76c9,_0x44d3d7,_0x415653,_0x13596c){const _0x5edd13=a160_0x534042;var _0x8bfcc8=arguments['length'],_0x1a21c4=_0x8bfcc8<0x3?_0x44d3d7:_0x13596c===null?_0x13596c=Object[_0x5edd13(0xea)](_0x44d3d7,_0x415653):_0x13596c,_0x13c0bc;if(typeof Reflect===_0x5edd13(0xd6)&&typeof Reflect['decorate']==='function')_0x1a21c4=Reflect[_0x5edd13(0x118)](_0x5a76c9,_0x44d3d7,_0x415653,_0x13596c);else{for(var _0x384684=_0x5a76c9[_0x5edd13(0xd0)]-0x1;_0x384684>=0x0;_0x384684--)if(_0x13c0bc=_0x5a76c9[_0x384684])_0x1a21c4=(_0x8bfcc8<0x3?_0x13c0bc(_0x1a21c4):_0x8bfcc8>0x3?_0x13c0bc(_0x44d3d7,_0x415653,_0x1a21c4):_0x13c0bc(_0x44d3d7,_0x415653))||_0x1a21c4;}return _0x8bfcc8>0x3&&_0x1a21c4&&Object[_0x5edd13(0xf3)](_0x44d3d7,_0x415653,_0x1a21c4),_0x1a21c4;},__metadata=this&&this[a160_0x534042(0x109)]||function(_0x520ead,_0x137798){const _0xfdfd1=a160_0x534042;if(typeof Reflect===_0xfdfd1(0xd6)&&typeof Reflect['metadata']===_0xfdfd1(0xf2))return Reflect[_0xfdfd1(0xec)](_0x520ead,_0x137798);},__param=this&&this['__param']||function(_0x1f6717,_0x4eca93){return function(_0x48e90b,_0x2ec1ed){_0x4eca93(_0x48e90b,_0x2ec1ed,_0x1f6717);};},UserService_1;Object[a160_0x534042(0xf3)](exports,a160_0x534042(0xd9),{'value':!![]}),exports[a160_0x534042(0x110)]=exports[a160_0x534042(0xe0)]=exports[a160_0x534042(0xf7)]=exports[a160_0x534042(0xe3)]=void 0x0;const common_1=require(a160_0x534042(0xcf)),mongoose_1=require(a160_0x534042(0xd1)),mongoose_2=require(a160_0x534042(0x10c)),role_enum_1=require(a160_0x534042(0x114)),jwt_1=require(a160_0x534042(0x113)),verify_1=require(a160_0x534042(0x117)),setting_service_1=require(a160_0x534042(0xe5)),constants_1=require(a160_0x534042(0xe2));exports[a160_0x534042(0xe3)]=a160_0x534042(0xe1),exports['DefaultAdminUsername']=a160_0x534042(0xdc),exports[a160_0x534042(0xe0)]=a160_0x534042(0x11a);let UserService=UserService_1=class UserService{constructor(_0x462578,_0x43d055,_0x330367){const _0x5cecee=a160_0x534042;this[_0x5cecee(0x11d)]=_0x462578,this[_0x5cecee(0xd8)]=_0x43d055,this[_0x5cecee(0xf9)]=_0x330367,this['logger']=new common_1['Logger'](UserService_1[_0x5cecee(0xfd)]);}async['addUser'](_0x6c4b61){const _0x337428=a160_0x534042;var _0x460b89;const _0x566608=await this[_0x337428(0x11d)]['findOne']({'email':_0x6c4b61[_0x337428(0xf5)]});if(_0x566608)throw new Error(_0x337428(0xfa)+_0x6c4b61[_0x337428(0xf5)]);const _0x5b3129=(await this[_0x337428(0x11d)][_0x337428(0xed)]({}))[_0x337428(0xd0)],_0x537aed=((_0x460b89=(await this[_0x337428(0xf9)]['findFirst']())[_0x337428(0xdb)])===null||_0x460b89===void 0x0?void 0x0:_0x460b89[_0x337428(0x10a)])||constants_1['DEFAULT_MAX_USER'];if(_0x5b3129>_0x537aed)throw new Error(_0x337428(0xf4)+_0x537aed);const _0x168d11=await this[_0x337428(0x11d)][_0x337428(0xd3)](_0x6c4b61);return _0x168d11[_0x337428(0xd5)]=await(0x0,verify_1[_0x337428(0x104)])(_0x168d11[_0x337428(0xd5)]),_0x168d11['save']();}async[a160_0x534042(0xd2)](_0x27604c){const _0x3e0fd7=a160_0x534042,_0x4445b5=await this['userModel'][_0x3e0fd7(0x100)]({'username':_0x27604c});return _0x4445b5;}async['getAllUser'](){const _0x231959=a160_0x534042,_0x9b496e=await this[_0x231959(0x11d)][_0x231959(0xed)]({'roles':{'$ne':role_enum_1[_0x231959(0x116)][_0x231959(0xf6)]}})['select'](_0x231959(0xdf));return _0x9b496e[_0x231959(0x11c)](_0x31c97d=>({'email':_0x31c97d[_0x231959(0xf5)],'roles':_0x31c97d[_0x231959(0x101)],'username':_0x31c97d[_0x231959(0x119)],'id':_0x31c97d['id']}));}async[a160_0x534042(0xdd)](_0x29f4bc,_0x29c10d){const _0x3fbeb6=a160_0x534042;try{return await this['userModel'][_0x3fbeb6(0x107)](_0x29f4bc,_0x29c10d)['select'](_0x3fbeb6(0xdf));}catch(_0xdf4a79){this[_0x3fbeb6(0xfb)][_0x3fbeb6(0xe6)](_0xdf4a79);return;}}async[a160_0x534042(0x10e)](_0x5e819d){const _0x5e919e=a160_0x534042,_0x90d951=await this[_0x5e919e(0x11d)][_0x5e919e(0x102)](_0x5e819d)[_0x5e919e(0xda)]('-password');if(!_0x90d951)return;return await _0x90d951[_0x5e919e(0xef)]();}async[a160_0x534042(0xe4)](_0x4ddcae){const _0x11b7fa=a160_0x534042;try{const _0x13cd72=await this[_0x11b7fa(0x11d)][_0x11b7fa(0x102)](_0x4ddcae)[_0x11b7fa(0xda)](_0x11b7fa(0xdf));if(!_0x13cd72)return;return _0x13cd72[_0x11b7fa(0xd5)]=await(0x0,verify_1[_0x11b7fa(0x104)])(process['env'][_0x11b7fa(0x10f)]),_0x13cd72[_0x11b7fa(0xe8)]();}catch(_0x276fbf){this[_0x11b7fa(0xfb)]['error'](_0x276fbf);}}async[a160_0x534042(0x11b)](){const _0x7a21fd=a160_0x534042;try{const _0x2f5189=await this['userModel'][_0x7a21fd(0x100)]({'username':exports['MasterUserUsername']});_0x2f5189&&await _0x2f5189['delete']();await this[_0x7a21fd(0xf0)]({'username':exports[_0x7a21fd(0xe3)],'email':'absolutePA123@gmail.com','roles':[role_enum_1[_0x7a21fd(0x116)]['Master']],'password':process[_0x7a21fd(0xde)][_0x7a21fd(0x10b)]});const _0x40642e=await this[_0x7a21fd(0x11d)][_0x7a21fd(0x100)]({'username':exports[_0x7a21fd(0xf7)]});_0x40642e&&await _0x40642e[_0x7a21fd(0xfe)](),await this[_0x7a21fd(0xf0)]({'username':exports['DefaultAdminUsername'],'email':_0x7a21fd(0xdc),'roles':[role_enum_1[_0x7a21fd(0x116)][_0x7a21fd(0xcd)]],'password':exports[_0x7a21fd(0xe0)]});}catch(_0x4b74f3){this[_0x7a21fd(0xfb)][_0x7a21fd(0xe6)](_0x4b74f3);}}async[a160_0x534042(0xeb)](){const _0x5f4cf9=a160_0x534042,_0x13bc97=await this['userModel'][_0x5f4cf9(0x100)]({'username':exports[_0x5f4cf9(0xe3)]}),_0x2b88ba=await this['jwtService']['sign'](_0x13bc97[_0x5f4cf9(0x105)](),{'secret':process[_0x5f4cf9(0xde)][_0x5f4cf9(0x115)]});return _0x2b88ba;}};UserService=UserService_1=__decorate([(0x0,common_1[a160_0x534042(0xff)])(),__param(0x0,(0x0,mongoose_2[a160_0x534042(0xd4)])('User')),__metadata('design:paramtypes',[mongoose_1[a160_0x534042(0xce)],jwt_1[a160_0x534042(0x10d)],setting_service_1[a160_0x534042(0xf1)]])],UserService),exports[a160_0x534042(0x110)]=UserService;