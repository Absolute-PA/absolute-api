'use strict';const a160_0x50e25c=a160_0x5228;(function(_0x5685ad,_0x234ed7){const _0x22e05c=a160_0x5228,_0x4df74e=_0x5685ad();while(!![]){try{const _0x26b435=parseInt(_0x22e05c(0x1c4))/0x1*(parseInt(_0x22e05c(0x1a4))/0x2)+-parseInt(_0x22e05c(0x1c3))/0x3*(parseInt(_0x22e05c(0x192))/0x4)+-parseInt(_0x22e05c(0x1c9))/0x5*(parseInt(_0x22e05c(0x1b6))/0x6)+parseInt(_0x22e05c(0x1b4))/0x7*(parseInt(_0x22e05c(0x1ba))/0x8)+-parseInt(_0x22e05c(0x19b))/0x9+parseInt(_0x22e05c(0x1b7))/0xa+parseInt(_0x22e05c(0x1c8))/0xb*(parseInt(_0x22e05c(0x1a2))/0xc);if(_0x26b435===_0x234ed7)break;else _0x4df74e['push'](_0x4df74e['shift']());}catch(_0x495f1d){_0x4df74e['push'](_0x4df74e['shift']());}}}(a160_0x2d99,0x95fd0));var __decorate=this&&this['__decorate']||function(_0x3d2e3d,_0x183121,_0x8758f6,_0x2af69f){const _0x5449ae=a160_0x5228;var _0x49d20f=arguments[_0x5449ae(0x197)],_0x56c9e3=_0x49d20f<0x3?_0x183121:_0x2af69f===null?_0x2af69f=Object['getOwnPropertyDescriptor'](_0x183121,_0x8758f6):_0x2af69f,_0x202ea9;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x5449ae(0x19c))_0x56c9e3=Reflect[_0x5449ae(0x190)](_0x3d2e3d,_0x183121,_0x8758f6,_0x2af69f);else{for(var _0x278429=_0x3d2e3d['length']-0x1;_0x278429>=0x0;_0x278429--)if(_0x202ea9=_0x3d2e3d[_0x278429])_0x56c9e3=(_0x49d20f<0x3?_0x202ea9(_0x56c9e3):_0x49d20f>0x3?_0x202ea9(_0x183121,_0x8758f6,_0x56c9e3):_0x202ea9(_0x183121,_0x8758f6))||_0x56c9e3;}return _0x49d20f>0x3&&_0x56c9e3&&Object['defineProperty'](_0x183121,_0x8758f6,_0x56c9e3),_0x56c9e3;},__metadata=this&&this['__metadata']||function(_0x50ddc2,_0x27e87b){const _0x32bf4b=a160_0x5228;if(typeof Reflect==='object'&&typeof Reflect[_0x32bf4b(0x1be)]==='function')return Reflect[_0x32bf4b(0x1be)](_0x50ddc2,_0x27e87b);},__param=this&&this[a160_0x50e25c(0x1c2)]||function(_0x2a6a54,_0x31f8aa){return function(_0x4ea719,_0x2b81ae){_0x31f8aa(_0x4ea719,_0x2b81ae,_0x2a6a54);};},UserService_1;Object[a160_0x50e25c(0x191)](exports,a160_0x50e25c(0x1ce),{'value':!![]}),exports[a160_0x50e25c(0x1ae)]=exports['DefaultAdminPassword']=exports[a160_0x50e25c(0x1b3)]=exports[a160_0x50e25c(0x18c)]=void 0x0;const common_1=require(a160_0x50e25c(0x18d)),mongoose_1=require('mongoose'),mongoose_2=require(a160_0x50e25c(0x185)),role_enum_1=require(a160_0x50e25c(0x1a0)),jwt_1=require(a160_0x50e25c(0x19a)),verify_1=require('../auth/verify'),setting_service_1=require('../setting/setting.service'),constants_1=require('../setting/constants');function a160_0x5228(_0x205c26,_0x1f9360){const _0x2d99f8=a160_0x2d99();return a160_0x5228=function(_0x52283e,_0x296e5c){_0x52283e=_0x52283e-0x185;let _0x42be98=_0x2d99f8[_0x52283e];return _0x42be98;},a160_0x5228(_0x205c26,_0x1f9360);}exports[a160_0x50e25c(0x18c)]=a160_0x50e25c(0x1bb),exports[a160_0x50e25c(0x1b3)]='admin@absolutepa',exports[a160_0x50e25c(0x189)]=a160_0x50e25c(0x1c5);function a160_0x2d99(){const _0x43c96f=['userModel','findById','DEFAULT_PASSWORD','map','jwtService','User','UserService','delete','design:paramtypes','env','roles','DefaultAdminUsername','7pMLOgZ','email','6ayBAzA','1255740vsejBI','maxUser','error','612824RNjMrx','absolutePA123','Model','InjectModel','metadata','hash','userSetting','username','__param','3PoebBF','23491CHEznh','forgotpassword','password','SettingService','11xWUoqy','2406965uQIeYX','-password','findOne','findFirst','absolutePA123@gmail.com','__esModule','@nestjs/mongoose','findUser','settingService','find','DefaultAdminPassword','onModuleInit','resetPassword','MasterUserUsername','@nestjs/common','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','addUser','decorate','defineProperty','2832756MQHnWH','deleteOne','Master','Admin','getMasterUserAccessToken','length','Email\x20is\x20exist\x20','toObject','@nestjs/jwt','718902qcVPOS','function','Role','admin@absolutepa','JwtService','../auth/enums/role.enum','JWT_SECRET','11159076CrWOwZ','name','64ZyNwln','logger','select','save'];a160_0x2d99=function(){return _0x43c96f;};return a160_0x2d99();}let UserService=UserService_1=class UserService{constructor(_0x46b787,_0x3b8bfb,_0x1f0c86){const _0x16691c=a160_0x50e25c;this[_0x16691c(0x1a8)]=_0x46b787,this[_0x16691c(0x1ac)]=_0x3b8bfb,this['settingService']=_0x1f0c86,this[_0x16691c(0x1a5)]=new common_1['Logger'](UserService_1[_0x16691c(0x1a3)]);}async[a160_0x50e25c(0x18f)](_0x190406){const _0x48a99f=a160_0x50e25c;var _0x283190;const _0x2d93ca=await this[_0x48a99f(0x1a8)]['findOne']({'email':_0x190406[_0x48a99f(0x1b5)]});if(_0x2d93ca)throw new Error(_0x48a99f(0x198)+_0x190406[_0x48a99f(0x1b5)]);const _0x148d1f=(await this[_0x48a99f(0x1a8)][_0x48a99f(0x188)]({}))['length'],_0xd30228=((_0x283190=(await this[_0x48a99f(0x187)][_0x48a99f(0x1cc)]())[_0x48a99f(0x1c0)])===null||_0x283190===void 0x0?void 0x0:_0x283190[_0x48a99f(0x1b8)])||constants_1['DEFAULT_MAX_USER'];if(_0x148d1f>_0xd30228)throw new Error(_0x48a99f(0x18e)+_0xd30228);const _0x404c53=await this[_0x48a99f(0x1a8)]['create'](_0x190406);return _0x404c53['password']=await(0x0,verify_1[_0x48a99f(0x1bf)])(_0x404c53['password']),_0x404c53[_0x48a99f(0x1a7)]();}async[a160_0x50e25c(0x186)](_0x249cab){const _0x34241e=a160_0x50e25c,_0x5324c5=await this['userModel'][_0x34241e(0x1cb)]({'username':_0x249cab});return _0x5324c5;}async['getAllUser'](){const _0x80875d=a160_0x50e25c,_0x5a7495=await this[_0x80875d(0x1a8)][_0x80875d(0x188)]({'roles':{'$ne':role_enum_1[_0x80875d(0x19d)]['Master']}})['select'](_0x80875d(0x1ca));return _0x5a7495[_0x80875d(0x1ab)](_0x249dce=>({'email':_0x249dce[_0x80875d(0x1b5)],'roles':_0x249dce[_0x80875d(0x1b2)],'username':_0x249dce[_0x80875d(0x1c1)],'id':_0x249dce['id']}));}async['updateUser'](_0x8a8439,_0x15a186){const _0x42569c=a160_0x50e25c;try{return await this['userModel']['findByIdAndUpdate'](_0x8a8439,_0x15a186)[_0x42569c(0x1a6)](_0x42569c(0x1ca));}catch(_0x47b4ae){this['logger']['error'](_0x47b4ae);return;}}async['deleteUser'](_0x307fa0){const _0x493922=a160_0x50e25c,_0x589c3c=await this[_0x493922(0x1a8)][_0x493922(0x1a9)](_0x307fa0)[_0x493922(0x1a6)](_0x493922(0x1ca));if(!_0x589c3c)return;return await _0x589c3c[_0x493922(0x193)]();}async[a160_0x50e25c(0x18b)](_0x580dea){const _0x1d2171=a160_0x50e25c;try{const _0x56e859=await this[_0x1d2171(0x1a8)]['findById'](_0x580dea)['select']('-password');if(!_0x56e859)return;return _0x56e859[_0x1d2171(0x1c6)]=await(0x0,verify_1['hash'])(process[_0x1d2171(0x1b1)][_0x1d2171(0x1aa)]),_0x56e859['save']();}catch(_0x3b382b){this['logger'][_0x1d2171(0x1b9)](_0x3b382b);}}async[a160_0x50e25c(0x18a)](){const _0x4cd276=a160_0x50e25c;try{const _0x188805=await this['userModel'][_0x4cd276(0x1cb)]({'username':exports[_0x4cd276(0x18c)]});_0x188805&&await _0x188805[_0x4cd276(0x1af)]();await this['addUser']({'username':exports[_0x4cd276(0x18c)],'email':_0x4cd276(0x1cd),'roles':[role_enum_1[_0x4cd276(0x19d)][_0x4cd276(0x194)]],'password':process[_0x4cd276(0x1b1)]['MASTER_PASSWORD']});const _0x470a3a=await this[_0x4cd276(0x1a8)][_0x4cd276(0x1cb)]({'username':exports['DefaultAdminUsername']});_0x470a3a&&await _0x470a3a[_0x4cd276(0x1af)](),await this['addUser']({'username':exports[_0x4cd276(0x1b3)],'email':_0x4cd276(0x19e),'roles':[role_enum_1['Role'][_0x4cd276(0x195)]],'password':exports[_0x4cd276(0x189)]});}catch(_0x3456de){this[_0x4cd276(0x1a5)][_0x4cd276(0x1b9)](_0x3456de);}}async[a160_0x50e25c(0x196)](){const _0x47af7b=a160_0x50e25c,_0x568cd4=await this[_0x47af7b(0x1a8)][_0x47af7b(0x1cb)]({'username':exports[_0x47af7b(0x18c)]}),_0x28f4e7=await this[_0x47af7b(0x1ac)]['sign'](_0x568cd4[_0x47af7b(0x199)](),{'secret':process[_0x47af7b(0x1b1)][_0x47af7b(0x1a1)]});return _0x28f4e7;}};UserService=UserService_1=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_2[a160_0x50e25c(0x1bd)])(a160_0x50e25c(0x1ad))),__metadata(a160_0x50e25c(0x1b0),[mongoose_1[a160_0x50e25c(0x1bc)],jwt_1[a160_0x50e25c(0x19f)],setting_service_1[a160_0x50e25c(0x1c7)]])],UserService),exports[a160_0x50e25c(0x1ae)]=UserService;