'use strict';const a157_0x2dfacd=a157_0x67f5;(function(_0x5d5768,_0x33f021){const _0x5962bb=a157_0x67f5,_0x5c6483=_0x5d5768();while(!![]){try{const _0x43ae4c=parseInt(_0x5962bb(0x1d5))/0x1*(-parseInt(_0x5962bb(0x1a3))/0x2)+parseInt(_0x5962bb(0x1df))/0x3+parseInt(_0x5962bb(0x1b1))/0x4*(-parseInt(_0x5962bb(0x1cf))/0x5)+-parseInt(_0x5962bb(0x1da))/0x6*(-parseInt(_0x5962bb(0x1ae))/0x7)+-parseInt(_0x5962bb(0x1d1))/0x8+parseInt(_0x5962bb(0x1be))/0x9+parseInt(_0x5962bb(0x1de))/0xa;if(_0x43ae4c===_0x33f021)break;else _0x5c6483['push'](_0x5c6483['shift']());}catch(_0x23aba6){_0x5c6483['push'](_0x5c6483['shift']());}}}(a157_0x5e7f,0xf2454));function a157_0x5e7f(){const _0x1c72a2=['Email\x20is\x20exist','username','UserService','env','-password','DEFAULT_MAX_USER','595259eaSDte','sign','../setting/constants','8qQQeEG','JwtService','create','metadata','settingService','roles','defineProperty','userSetting','findByIdAndUpdate','__esModule','@nestjs/common','findFirst','JWT_SECRET','13231170grIPBA','Role','getOwnPropertyDescriptor','mongoose','jwtService','SettingService','Logger','addUser','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','logger','__param','absolutePA123@gmail.com','getAllUser','InjectModel','decorate','deleteUser','MasterUserUsername','2379865AvINJg','userModel','5896944wVBzmm','design:paramtypes','MASTER_PASSWORD','map','7471oDTCTT','__decorate','error','absolutePA123','DEFAULT_PASSWORD','72saKPra','findOne','toObject','findUser','2254580iHIyyK','4804563xfpuQX','object','save','resetPassword','getMasterUserAccessToken','email','findById','@nestjs/jwt','Master','onModuleInit','updateUser','password','hash','438IyQFNE','delete','function','length','select'];a157_0x5e7f=function(){return _0x1c72a2;};return a157_0x5e7f();}var __decorate=this&&this[a157_0x2dfacd(0x1d6)]||function(_0x4b15b4,_0x238e0d,_0x388c1d,_0x54a71a){const _0x1e9d73=a157_0x2dfacd;var _0x1bae1e=arguments[_0x1e9d73(0x1a6)],_0x4649b7=_0x1bae1e<0x3?_0x238e0d:_0x54a71a===null?_0x54a71a=Object[_0x1e9d73(0x1c0)](_0x238e0d,_0x388c1d):_0x54a71a,_0x2c51cf;if(typeof Reflect===_0x1e9d73(0x1e0)&&typeof Reflect[_0x1e9d73(0x1cc)]===_0x1e9d73(0x1a5))_0x4649b7=Reflect[_0x1e9d73(0x1cc)](_0x4b15b4,_0x238e0d,_0x388c1d,_0x54a71a);else{for(var _0x417cf3=_0x4b15b4['length']-0x1;_0x417cf3>=0x0;_0x417cf3--)if(_0x2c51cf=_0x4b15b4[_0x417cf3])_0x4649b7=(_0x1bae1e<0x3?_0x2c51cf(_0x4649b7):_0x1bae1e>0x3?_0x2c51cf(_0x238e0d,_0x388c1d,_0x4649b7):_0x2c51cf(_0x238e0d,_0x388c1d))||_0x4649b7;}return _0x1bae1e>0x3&&_0x4649b7&&Object['defineProperty'](_0x238e0d,_0x388c1d,_0x4649b7),_0x4649b7;},__metadata=this&&this['__metadata']||function(_0x158305,_0x1372d4){const _0x4be167=a157_0x2dfacd;if(typeof Reflect==='object'&&typeof Reflect[_0x4be167(0x1b4)]===_0x4be167(0x1a5))return Reflect['metadata'](_0x158305,_0x1372d4);},__param=this&&this[a157_0x2dfacd(0x1c8)]||function(_0x2c02fb,_0x3dfee9){return function(_0x1d73fc,_0x480362){_0x3dfee9(_0x1d73fc,_0x480362,_0x2c02fb);};},UserService_1;Object[a157_0x2dfacd(0x1b7)](exports,a157_0x2dfacd(0x1ba),{'value':!![]}),exports[a157_0x2dfacd(0x1aa)]=exports[a157_0x2dfacd(0x1ce)]=void 0x0;const common_1=require(a157_0x2dfacd(0x1bb)),mongoose_1=require(a157_0x2dfacd(0x1c1)),mongoose_2=require('@nestjs/mongoose'),role_enum_1=require('../auth/enums/role.enum'),jwt_1=require(a157_0x2dfacd(0x19d)),verify_1=require('../auth/verify'),setting_service_1=require('../setting/setting.service'),constants_1=require(a157_0x2dfacd(0x1b0));function a157_0x67f5(_0x8041be,_0x35b76a){const _0x5e7f04=a157_0x5e7f();return a157_0x67f5=function(_0x67f510,_0x426a4d){_0x67f510=_0x67f510-0x19c;let _0x2cea2a=_0x5e7f04[_0x67f510];return _0x2cea2a;},a157_0x67f5(_0x8041be,_0x35b76a);}exports['MasterUserUsername']=a157_0x2dfacd(0x1d8);let UserService=UserService_1=class UserService{constructor(_0x3bcdad,_0x923454,_0x56e7e9){const _0x41c9e6=a157_0x2dfacd;this[_0x41c9e6(0x1d0)]=_0x3bcdad,this[_0x41c9e6(0x1c2)]=_0x923454,this[_0x41c9e6(0x1b5)]=_0x56e7e9,this[_0x41c9e6(0x1c7)]=new common_1[(_0x41c9e6(0x1c4))](UserService_1['name']);}async[a157_0x2dfacd(0x1c5)](_0x1fcb63){const _0x143687=a157_0x2dfacd;var _0x2e6942;const _0x1df4fe=await this[_0x143687(0x1d0)][_0x143687(0x1db)]({'email':_0x1fcb63['email']});if(_0x1df4fe)throw new Error(_0x143687(0x1a8));const _0x390820=(await this['userModel']['find']({}))[_0x143687(0x1a6)],_0x1296f1=((_0x2e6942=(await this[_0x143687(0x1b5)][_0x143687(0x1bc)]())[_0x143687(0x1b8)])===null||_0x2e6942===void 0x0?void 0x0:_0x2e6942['maxUser'])||constants_1[_0x143687(0x1ad)];if(_0x390820>_0x1296f1)throw new Error(_0x143687(0x1c6)+_0x1296f1);const _0x4b4423=await this[_0x143687(0x1d0)][_0x143687(0x1b3)](_0x1fcb63);return _0x4b4423[_0x143687(0x1a1)]=await(0x0,verify_1[_0x143687(0x1a2)])(_0x4b4423[_0x143687(0x1a1)]),_0x4b4423[_0x143687(0x1e1)]();}async[a157_0x2dfacd(0x1dd)](_0x363962){const _0x5511c8=a157_0x2dfacd,_0x28c7e5=await this[_0x5511c8(0x1d0)][_0x5511c8(0x1db)]({'username':_0x363962});return _0x28c7e5;}async[a157_0x2dfacd(0x1ca)](){const _0x3a871c=a157_0x2dfacd,_0x581bf1=await this[_0x3a871c(0x1d0)]['find']({'roles':{'$ne':role_enum_1[_0x3a871c(0x1bf)][_0x3a871c(0x19e)]}})['select'](_0x3a871c(0x1ac));return _0x581bf1[_0x3a871c(0x1d4)](_0x43864e=>({'email':_0x43864e[_0x3a871c(0x1e4)],'roles':_0x43864e[_0x3a871c(0x1b6)],'username':_0x43864e[_0x3a871c(0x1a9)],'id':_0x43864e['id']}));}async[a157_0x2dfacd(0x1a0)](_0xa92449,_0xa02415){const _0x176422=a157_0x2dfacd;try{return await this[_0x176422(0x1d0)][_0x176422(0x1b9)](_0xa92449,_0xa02415)[_0x176422(0x1a7)](_0x176422(0x1ac));}catch(_0x4d3efc){this[_0x176422(0x1c7)][_0x176422(0x1d7)](_0x4d3efc);return;}}async[a157_0x2dfacd(0x1cd)](_0x453150){const _0x1566b6=a157_0x2dfacd,_0x3c8d55=await this[_0x1566b6(0x1d0)][_0x1566b6(0x19c)](_0x453150)[_0x1566b6(0x1a7)](_0x1566b6(0x1ac));if(!_0x3c8d55)return;return await _0x3c8d55['deleteOne']();}async[a157_0x2dfacd(0x1e2)](_0x5239cf){const _0x148c1d=a157_0x2dfacd;try{const _0x30a76f=await this['userModel'][_0x148c1d(0x19c)](_0x5239cf)['select'](_0x148c1d(0x1ac));if(!_0x30a76f)return;return _0x30a76f[_0x148c1d(0x1a1)]=await(0x0,verify_1[_0x148c1d(0x1a2)])(process[_0x148c1d(0x1ab)][_0x148c1d(0x1d9)]),_0x30a76f[_0x148c1d(0x1e1)]();}catch(_0x529129){this[_0x148c1d(0x1c7)]['error'](_0x529129);}}async[a157_0x2dfacd(0x19f)](){const _0x2d6913=a157_0x2dfacd;try{const _0x3d2c75=await this[_0x2d6913(0x1d0)]['findOne']({'username':exports[_0x2d6913(0x1ce)]});_0x3d2c75&&await _0x3d2c75[_0x2d6913(0x1a4)](),await this[_0x2d6913(0x1c5)]({'username':exports[_0x2d6913(0x1ce)],'email':_0x2d6913(0x1c9),'roles':[role_enum_1['Role'][_0x2d6913(0x19e)]],'password':process[_0x2d6913(0x1ab)][_0x2d6913(0x1d3)]});}catch(_0x435a23){this[_0x2d6913(0x1c7)][_0x2d6913(0x1d7)](_0x435a23);throw _0x435a23;}}async[a157_0x2dfacd(0x1e3)](){const _0x40c64c=a157_0x2dfacd,_0x5d068a=await this[_0x40c64c(0x1d0)][_0x40c64c(0x1db)]({'username':exports['MasterUserUsername']}),_0x242f3f=await this[_0x40c64c(0x1c2)][_0x40c64c(0x1af)](_0x5d068a[_0x40c64c(0x1dc)](),{'secret':process[_0x40c64c(0x1ab)][_0x40c64c(0x1bd)]});return _0x242f3f;}};UserService=UserService_1=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_2[a157_0x2dfacd(0x1cb)])('User')),__metadata(a157_0x2dfacd(0x1d2),[mongoose_1['Model'],jwt_1[a157_0x2dfacd(0x1b2)],setting_service_1[a157_0x2dfacd(0x1c3)]])],UserService),exports[a157_0x2dfacd(0x1aa)]=UserService;