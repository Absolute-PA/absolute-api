'use strict';const a157_0x17c287=a157_0x24a5;(function(_0x4f2f86,_0x4fb432){const _0x365ee3=a157_0x24a5,_0x2f71c1=_0x4f2f86();while(!![]){try{const _0x23d36c=parseInt(_0x365ee3(0x115))/0x1+-parseInt(_0x365ee3(0x129))/0x2+parseInt(_0x365ee3(0x10d))/0x3*(-parseInt(_0x365ee3(0x133))/0x4)+parseInt(_0x365ee3(0x132))/0x5+parseInt(_0x365ee3(0x138))/0x6*(parseInt(_0x365ee3(0x10f))/0x7)+-parseInt(_0x365ee3(0x11b))/0x8+parseInt(_0x365ee3(0x12b))/0x9;if(_0x23d36c===_0x4fb432)break;else _0x2f71c1['push'](_0x2f71c1['shift']());}catch(_0x4bb501){_0x2f71c1['push'](_0x2f71c1['shift']());}}}(a157_0x2e61,0xd10e2));var __decorate=this&&this[a157_0x17c287(0x11a)]||function(_0x3268c3,_0x52116c,_0x16fed2,_0x18da2d){const _0x75f92d=a157_0x17c287;var _0x4eb65a=arguments['length'],_0x148512=_0x4eb65a<0x3?_0x52116c:_0x18da2d===null?_0x18da2d=Object[_0x75f92d(0x10c)](_0x52116c,_0x16fed2):_0x18da2d,_0x37ca98;if(typeof Reflect===_0x75f92d(0x11e)&&typeof Reflect[_0x75f92d(0x13f)]===_0x75f92d(0x107))_0x148512=Reflect[_0x75f92d(0x13f)](_0x3268c3,_0x52116c,_0x16fed2,_0x18da2d);else{for(var _0x2d2dff=_0x3268c3[_0x75f92d(0x106)]-0x1;_0x2d2dff>=0x0;_0x2d2dff--)if(_0x37ca98=_0x3268c3[_0x2d2dff])_0x148512=(_0x4eb65a<0x3?_0x37ca98(_0x148512):_0x4eb65a>0x3?_0x37ca98(_0x52116c,_0x16fed2,_0x148512):_0x37ca98(_0x52116c,_0x16fed2))||_0x148512;}return _0x4eb65a>0x3&&_0x148512&&Object[_0x75f92d(0x134)](_0x52116c,_0x16fed2,_0x148512),_0x148512;},__metadata=this&&this['__metadata']||function(_0x403e47,_0x4cc407){const _0x332676=a157_0x17c287;if(typeof Reflect===_0x332676(0x11e)&&typeof Reflect['metadata']===_0x332676(0x107))return Reflect['metadata'](_0x403e47,_0x4cc407);},__param=this&&this[a157_0x17c287(0x119)]||function(_0x54eff3,_0xeb5d13){return function(_0x2ff673,_0x31476d){_0xeb5d13(_0x2ff673,_0x31476d,_0x54eff3);};},UserService_1;Object[a157_0x17c287(0x134)](exports,a157_0x17c287(0x100),{'value':!![]}),exports[a157_0x17c287(0x12c)]=exports[a157_0x17c287(0x12f)]=void 0x0;const common_1=require(a157_0x17c287(0x10b)),mongoose_1=require('mongoose'),mongoose_2=require('@nestjs/mongoose'),role_enum_1=require('../auth/enums/role.enum'),jwt_1=require(a157_0x17c287(0x116)),verify_1=require(a157_0x17c287(0x125)),setting_service_1=require(a157_0x17c287(0x13e)),constants_1=require('../setting/constants');exports[a157_0x17c287(0x12f)]=a157_0x17c287(0x131);function a157_0x2e61(){const _0x10fba8=['UserService','Email\x20is\x20exist','onModuleInit','MasterUserUsername','findByIdAndUpdate','absolutePA123','1927235RGXUeH','3331104VfHjdy','defineProperty','resetPassword','jwtService','addUser','2202YTDVPm','findOne','hash','findUser','userModel','Role','../setting/setting.service','decorate','Master','email','__esModule','error','toObject','deleteUser','maxUser','JWT_SECRET','length','function','findFirst','sign','select','@nestjs/common','getOwnPropertyDescriptor','6gyOLSR','create','11032JxddOR','roles','env','delete','User','Model','967417gVYWKf','@nestjs/jwt','save','DEFAULT_PASSWORD','__param','__decorate','11353120Tsmbmz','findById','-password','object','design:paramtypes','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','deleteOne','logger','InjectModel','SettingService','../auth/verify','settingService','find','password','1985854FNnmez','map','27023877IuIuTh'];a157_0x2e61=function(){return _0x10fba8;};return a157_0x2e61();}let UserService=UserService_1=class UserService{constructor(_0x32fdce,_0x24baf4,_0x4a27c3){const _0x410a24=a157_0x17c287;this[_0x410a24(0x13c)]=_0x32fdce,this[_0x410a24(0x136)]=_0x24baf4,this['settingService']=_0x4a27c3,this['logger']=new common_1['Logger'](UserService_1['name']);}async[a157_0x17c287(0x137)](_0x3b65c0){const _0x2c5a5c=a157_0x17c287;var _0x417043;const _0x119570=await this[_0x2c5a5c(0x13c)][_0x2c5a5c(0x139)]({'email':_0x3b65c0[_0x2c5a5c(0xff)]});if(_0x119570)throw new Error(_0x2c5a5c(0x12d));const _0x44b214=(await this[_0x2c5a5c(0x13c)][_0x2c5a5c(0x127)]({}))[_0x2c5a5c(0x106)],_0x33f791=((_0x417043=(await this[_0x2c5a5c(0x126)][_0x2c5a5c(0x108)]())['userSetting'])===null||_0x417043===void 0x0?void 0x0:_0x417043[_0x2c5a5c(0x104)])||constants_1['DEFAULT_MAX_USER'];if(_0x44b214>_0x33f791)throw new Error(_0x2c5a5c(0x120)+_0x33f791);const _0x9158fe=await this[_0x2c5a5c(0x13c)][_0x2c5a5c(0x10e)](_0x3b65c0);return _0x9158fe[_0x2c5a5c(0x128)]=await(0x0,verify_1['hash'])(_0x9158fe[_0x2c5a5c(0x128)]),_0x9158fe[_0x2c5a5c(0x117)]();}async[a157_0x17c287(0x13b)](_0x1a3090){const _0xfe9cdb=await this['userModel']['findOne']({'username':_0x1a3090});return _0xfe9cdb;}async['getAllUser'](){const _0x191998=a157_0x17c287,_0x224ef7=await this[_0x191998(0x13c)][_0x191998(0x127)]({'roles':{'$ne':role_enum_1[_0x191998(0x13d)][_0x191998(0xfe)]}})[_0x191998(0x10a)](_0x191998(0x11d));return _0x224ef7[_0x191998(0x12a)](_0x5e61e2=>({'email':_0x5e61e2[_0x191998(0xff)],'roles':_0x5e61e2[_0x191998(0x110)],'username':_0x5e61e2['username'],'id':_0x5e61e2['id']}));}async['updateUser'](_0x2fce33,_0xb02222){const _0x3ff9f8=a157_0x17c287;try{return await this[_0x3ff9f8(0x13c)][_0x3ff9f8(0x130)](_0x2fce33,_0xb02222)[_0x3ff9f8(0x10a)](_0x3ff9f8(0x11d));}catch(_0x5a9970){this[_0x3ff9f8(0x122)]['error'](_0x5a9970);return;}}async[a157_0x17c287(0x103)](_0x4a35d1){const _0x3f3710=a157_0x17c287,_0xe86042=await this['userModel'][_0x3f3710(0x11c)](_0x4a35d1)[_0x3f3710(0x10a)]('-password');if(!_0xe86042)return;return await _0xe86042[_0x3f3710(0x121)]();}async[a157_0x17c287(0x135)](_0x1b283b){const _0x51d891=a157_0x17c287;try{const _0x22d640=await this[_0x51d891(0x13c)][_0x51d891(0x11c)](_0x1b283b)[_0x51d891(0x10a)](_0x51d891(0x11d));if(!_0x22d640)return;return _0x22d640[_0x51d891(0x128)]=await(0x0,verify_1[_0x51d891(0x13a)])(process['env'][_0x51d891(0x118)]),_0x22d640[_0x51d891(0x117)]();}catch(_0x170651){this[_0x51d891(0x122)]['error'](_0x170651);}}async[a157_0x17c287(0x12e)](){const _0x3383f8=a157_0x17c287;try{const _0x8be1d9=await this['userModel'][_0x3383f8(0x139)]({'username':exports[_0x3383f8(0x12f)]});_0x8be1d9&&await _0x8be1d9[_0x3383f8(0x112)](),await this[_0x3383f8(0x137)]({'username':exports['MasterUserUsername'],'email':'absolutePA123@gmail.com','roles':[role_enum_1['Role'][_0x3383f8(0xfe)]],'password':process[_0x3383f8(0x111)]['MASTER_PASSWORD']});}catch(_0x4abc0d){this['logger'][_0x3383f8(0x101)](_0x4abc0d);}}async['getMasterUserAccessToken'](){const _0x229fc5=a157_0x17c287,_0x3629ef=await this[_0x229fc5(0x13c)][_0x229fc5(0x139)]({'username':exports[_0x229fc5(0x12f)]}),_0x1716c4=await this['jwtService'][_0x229fc5(0x109)](_0x3629ef[_0x229fc5(0x102)](),{'secret':process['env'][_0x229fc5(0x105)]});return _0x1716c4;}};function a157_0x24a5(_0x3909df,_0x2ad399){const _0x2e61f7=a157_0x2e61();return a157_0x24a5=function(_0x24a567,_0x146300){_0x24a567=_0x24a567-0xfe;let _0x5aff3c=_0x2e61f7[_0x24a567];return _0x5aff3c;},a157_0x24a5(_0x3909df,_0x2ad399);}UserService=UserService_1=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_2[a157_0x17c287(0x123)])(a157_0x17c287(0x113))),__metadata(a157_0x17c287(0x11f),[mongoose_1[a157_0x17c287(0x114)],jwt_1['JwtService'],setting_service_1[a157_0x17c287(0x124)]])],UserService),exports[a157_0x17c287(0x12c)]=UserService;