'use strict';const a157_0x3d55a8=a157_0x1848;(function(_0x5ca61f,_0x5b6074){const _0xb4926e=a157_0x1848,_0xd6404=_0x5ca61f();while(!![]){try{const _0x591c4e=parseInt(_0xb4926e(0xff))/0x1*(-parseInt(_0xb4926e(0xf0))/0x2)+-parseInt(_0xb4926e(0x101))/0x3*(-parseInt(_0xb4926e(0xcc))/0x4)+parseInt(_0xb4926e(0x10f))/0x5*(-parseInt(_0xb4926e(0xf7))/0x6)+parseInt(_0xb4926e(0xd3))/0x7*(parseInt(_0xb4926e(0xf6))/0x8)+parseInt(_0xb4926e(0x110))/0x9+-parseInt(_0xb4926e(0xf1))/0xa*(parseInt(_0xb4926e(0xd5))/0xb)+parseInt(_0xb4926e(0x113))/0xc*(parseInt(_0xb4926e(0x112))/0xd);if(_0x591c4e===_0x5b6074)break;else _0xd6404['push'](_0xd6404['shift']());}catch(_0x13867e){_0xd6404['push'](_0xd6404['shift']());}}}(a157_0x250e,0x545b6));function a157_0x1848(_0x53b69c,_0x47202a){const _0x250e7a=a157_0x250e();return a157_0x1848=function(_0x1848d5,_0x1005a7){_0x1848d5=_0x1848d5-0xca;let _0xeba020=_0x250e7a[_0x1848d5];return _0xeba020;},a157_0x1848(_0x53b69c,_0x47202a);}var __decorate=this&&this[a157_0x3d55a8(0xf4)]||function(_0x599cce,_0x3f9ad0,_0x59a8ca,_0x187ccb){const _0x4d8a45=a157_0x3d55a8;var _0x179ad5=arguments[_0x4d8a45(0xd2)],_0x3c9355=_0x179ad5<0x3?_0x3f9ad0:_0x187ccb===null?_0x187ccb=Object[_0x4d8a45(0x117)](_0x3f9ad0,_0x59a8ca):_0x187ccb,_0x41e62b;if(typeof Reflect===_0x4d8a45(0xed)&&typeof Reflect['decorate']===_0x4d8a45(0xf5))_0x3c9355=Reflect[_0x4d8a45(0x116)](_0x599cce,_0x3f9ad0,_0x59a8ca,_0x187ccb);else{for(var _0x204624=_0x599cce['length']-0x1;_0x204624>=0x0;_0x204624--)if(_0x41e62b=_0x599cce[_0x204624])_0x3c9355=(_0x179ad5<0x3?_0x41e62b(_0x3c9355):_0x179ad5>0x3?_0x41e62b(_0x3f9ad0,_0x59a8ca,_0x3c9355):_0x41e62b(_0x3f9ad0,_0x59a8ca))||_0x3c9355;}return _0x179ad5>0x3&&_0x3c9355&&Object['defineProperty'](_0x3f9ad0,_0x59a8ca,_0x3c9355),_0x3c9355;},__metadata=this&&this[a157_0x3d55a8(0x109)]||function(_0x5b0fab,_0x174528){const _0x1e17b0=a157_0x3d55a8;if(typeof Reflect===_0x1e17b0(0xed)&&typeof Reflect[_0x1e17b0(0xe0)]==='function')return Reflect[_0x1e17b0(0xe0)](_0x5b0fab,_0x174528);},__param=this&&this[a157_0x3d55a8(0xe8)]||function(_0x42469c,_0x2adbee){return function(_0x4ae940,_0x3de517){_0x2adbee(_0x4ae940,_0x3de517,_0x42469c);};},UserService_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a157_0x3d55a8(0xea)]=exports[a157_0x3d55a8(0xd9)]=void 0x0;const common_1=require(a157_0x3d55a8(0xd7)),mongoose_1=require(a157_0x3d55a8(0xd4)),mongoose_2=require(a157_0x3d55a8(0xe3)),role_enum_1=require(a157_0x3d55a8(0xd0)),jwt_1=require(a157_0x3d55a8(0xf3)),verify_1=require(a157_0x3d55a8(0xdb)),setting_service_1=require('../setting/setting.service'),constants_1=require(a157_0x3d55a8(0xce));function a157_0x250e(){const _0x58f20a=['object','Model','roles','6zABZXH','1547740QxEsFg','updateUser','@nestjs/jwt','__decorate','function','312OAfOBm','1831134pVkqLT','absolutePA123','find','env','error','username','userModel','-password','217823AmQfsr','map','1350669SwPoPE','User','create','password','MASTER_PASSWORD','deleteUser','deleteOne','hash','__metadata','email','InjectModel','settingService','Master','name','10MEReHb','3754926ZTKAwz','toObject','429BZrHxW','226068PSbXts','onModuleInit','findById','decorate','getOwnPropertyDescriptor','DEFAULT_PASSWORD','sign','4ooqnuD','DEFAULT_MAX_USER','../setting/constants','findByIdAndUpdate','../auth/enums/role.enum','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','length','104923mmYZGA','mongoose','33IhfpiF','logger','@nestjs/common','findOne','MasterUserUsername','design:paramtypes','../auth/verify','select','findFirst','JWT_SECRET','Email\x20is\x20exist','metadata','JwtService','resetPassword','@nestjs/mongoose','addUser','findUser','userSetting','Logger','__param','save','UserService','jwtService','delete'];a157_0x250e=function(){return _0x58f20a;};return a157_0x250e();}exports[a157_0x3d55a8(0xd9)]=a157_0x3d55a8(0xf8);let UserService=UserService_1=class UserService{constructor(_0x41f270,_0x312a75,_0x43ae20){const _0x312567=a157_0x3d55a8;this[_0x312567(0xfd)]=_0x41f270,this['jwtService']=_0x312a75,this[_0x312567(0x10c)]=_0x43ae20,this[_0x312567(0xd6)]=new common_1[(_0x312567(0xe7))](UserService_1[_0x312567(0x10e)]);}async[a157_0x3d55a8(0xe4)](_0x28d209){const _0x4b2f5d=a157_0x3d55a8;var _0x461193;const _0x1fd4d4=await this['userModel'][_0x4b2f5d(0xd8)]({'email':_0x28d209['email']});if(_0x1fd4d4)throw new Error(_0x4b2f5d(0xdf));const _0x2a5f8d=(await this[_0x4b2f5d(0xfd)][_0x4b2f5d(0xf9)]({}))['length'],_0x34d686=((_0x461193=(await this[_0x4b2f5d(0x10c)][_0x4b2f5d(0xdd)]())[_0x4b2f5d(0xe6)])===null||_0x461193===void 0x0?void 0x0:_0x461193['maxUser'])||constants_1[_0x4b2f5d(0xcd)];if(_0x2a5f8d>_0x34d686)throw new Error(_0x4b2f5d(0xd1)+_0x34d686);const _0x597a5d=await this[_0x4b2f5d(0xfd)][_0x4b2f5d(0x103)](_0x28d209);return _0x597a5d['password']=await(0x0,verify_1[_0x4b2f5d(0x108)])(_0x597a5d[_0x4b2f5d(0x104)]),_0x597a5d['save']();}async[a157_0x3d55a8(0xe5)](_0x36362c){const _0x49cf2e=a157_0x3d55a8,_0x5bfa6d=await this[_0x49cf2e(0xfd)][_0x49cf2e(0xd8)]({'username':_0x36362c});return _0x5bfa6d;}async['getAllUser'](){const _0x51f742=a157_0x3d55a8,_0x496555=await this[_0x51f742(0xfd)][_0x51f742(0xf9)]({'roles':{'$ne':role_enum_1['Role'][_0x51f742(0x10d)]}})[_0x51f742(0xdc)]('-password');return _0x496555[_0x51f742(0x100)](_0x1a1430=>({'email':_0x1a1430[_0x51f742(0x10a)],'roles':_0x1a1430[_0x51f742(0xef)],'username':_0x1a1430[_0x51f742(0xfc)],'id':_0x1a1430['id']}));}async[a157_0x3d55a8(0xf2)](_0x4cfd64,_0x56dd12){const _0x352d6a=a157_0x3d55a8;try{return await this[_0x352d6a(0xfd)][_0x352d6a(0xcf)](_0x4cfd64,_0x56dd12)[_0x352d6a(0xdc)]('-password');}catch(_0x527109){this[_0x352d6a(0xd6)]['error'](_0x527109);return;}}async[a157_0x3d55a8(0x106)](_0x8c4950){const _0x1db05d=a157_0x3d55a8,_0x355875=await this['userModel'][_0x1db05d(0x115)](_0x8c4950)[_0x1db05d(0xdc)]('-password');if(!_0x355875)return;return await _0x355875[_0x1db05d(0x107)]();}async[a157_0x3d55a8(0xe2)](_0x41eba9){const _0x4cfbbd=a157_0x3d55a8;try{const _0x1f9271=await this[_0x4cfbbd(0xfd)][_0x4cfbbd(0x115)](_0x41eba9)['select'](_0x4cfbbd(0xfe));if(!_0x1f9271)return;return _0x1f9271['password']=await(0x0,verify_1[_0x4cfbbd(0x108)])(process[_0x4cfbbd(0xfa)][_0x4cfbbd(0xca)]),_0x1f9271[_0x4cfbbd(0xe9)]();}catch(_0x264f46){this[_0x4cfbbd(0xd6)][_0x4cfbbd(0xfb)](_0x264f46);}}async[a157_0x3d55a8(0x114)](){const _0x34740e=a157_0x3d55a8;try{const _0x98d44c=await this[_0x34740e(0xfd)][_0x34740e(0xd8)]({'username':exports[_0x34740e(0xd9)]});_0x98d44c&&await _0x98d44c[_0x34740e(0xec)](),await this['addUser']({'username':exports['MasterUserUsername'],'email':'absolutePA123@gmail.com','roles':[role_enum_1['Role']['Master']],'password':process[_0x34740e(0xfa)][_0x34740e(0x105)]});}catch(_0x24bce4){this[_0x34740e(0xd6)][_0x34740e(0xfb)](_0x24bce4);throw _0x24bce4;}}async['getMasterUserAccessToken'](){const _0x43f68c=a157_0x3d55a8,_0x1f08e6=await this[_0x43f68c(0xfd)][_0x43f68c(0xd8)]({'username':exports[_0x43f68c(0xd9)]}),_0x453c01=await this[_0x43f68c(0xeb)][_0x43f68c(0xcb)](_0x1f08e6[_0x43f68c(0x111)](),{'secret':process[_0x43f68c(0xfa)][_0x43f68c(0xde)]});return _0x453c01;}};UserService=UserService_1=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_2[a157_0x3d55a8(0x10b)])(a157_0x3d55a8(0x102))),__metadata(a157_0x3d55a8(0xda),[mongoose_1[a157_0x3d55a8(0xee)],jwt_1[a157_0x3d55a8(0xe1)],setting_service_1['SettingService']])],UserService),exports[a157_0x3d55a8(0xea)]=UserService;