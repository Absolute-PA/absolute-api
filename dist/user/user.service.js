'use strict';const a160_0x5cc80c=a160_0x566c;(function(_0x5a7a25,_0x1344d4){const _0x38d7d7=a160_0x566c,_0x431cb2=_0x5a7a25();while(!![]){try{const _0x427dee=-parseInt(_0x38d7d7(0x15f))/0x1*(parseInt(_0x38d7d7(0x13e))/0x2)+-parseInt(_0x38d7d7(0x162))/0x3+-parseInt(_0x38d7d7(0x186))/0x4+-parseInt(_0x38d7d7(0x164))/0x5*(parseInt(_0x38d7d7(0x15c))/0x6)+parseInt(_0x38d7d7(0x15e))/0x7+parseInt(_0x38d7d7(0x15d))/0x8+-parseInt(_0x38d7d7(0x145))/0x9*(-parseInt(_0x38d7d7(0x14e))/0xa);if(_0x427dee===_0x1344d4)break;else _0x431cb2['push'](_0x431cb2['shift']());}catch(_0x31bd93){_0x431cb2['push'](_0x431cb2['shift']());}}}(a160_0x425c,0x4f811));var __decorate=this&&this[a160_0x5cc80c(0x14d)]||function(_0xd87810,_0xc0e28c,_0xcb8711,_0x39d812){const _0x3fd274=a160_0x5cc80c;var _0x44a8a6=arguments[_0x3fd274(0x175)],_0x368cc9=_0x44a8a6<0x3?_0xc0e28c:_0x39d812===null?_0x39d812=Object[_0x3fd274(0x13f)](_0xc0e28c,_0xcb8711):_0x39d812,_0x4202bc;if(typeof Reflect===_0x3fd274(0x146)&&typeof Reflect[_0x3fd274(0x147)]==='function')_0x368cc9=Reflect[_0x3fd274(0x147)](_0xd87810,_0xc0e28c,_0xcb8711,_0x39d812);else{for(var _0x586c19=_0xd87810[_0x3fd274(0x175)]-0x1;_0x586c19>=0x0;_0x586c19--)if(_0x4202bc=_0xd87810[_0x586c19])_0x368cc9=(_0x44a8a6<0x3?_0x4202bc(_0x368cc9):_0x44a8a6>0x3?_0x4202bc(_0xc0e28c,_0xcb8711,_0x368cc9):_0x4202bc(_0xc0e28c,_0xcb8711))||_0x368cc9;}return _0x44a8a6>0x3&&_0x368cc9&&Object[_0x3fd274(0x170)](_0xc0e28c,_0xcb8711,_0x368cc9),_0x368cc9;},__metadata=this&&this[a160_0x5cc80c(0x142)]||function(_0x187524,_0x476eff){const _0x2083ee=a160_0x5cc80c;if(typeof Reflect===_0x2083ee(0x146)&&typeof Reflect[_0x2083ee(0x163)]===_0x2083ee(0x14a))return Reflect[_0x2083ee(0x163)](_0x187524,_0x476eff);},__param=this&&this[a160_0x5cc80c(0x167)]||function(_0x1ad91c,_0x3fc091){return function(_0x1e25b6,_0x366601){_0x3fc091(_0x1e25b6,_0x366601,_0x1ad91c);};},UserService_1;function a160_0x566c(_0x232808,_0x33d799){const _0x425c41=a160_0x425c();return a160_0x566c=function(_0x566c32,_0x21624d){_0x566c32=_0x566c32-0x13c;let _0x5f5467=_0x425c41[_0x566c32];return _0x5f5467;},a160_0x566c(_0x232808,_0x33d799);}Object[a160_0x5cc80c(0x170)](exports,a160_0x5cc80c(0x172),{'value':!![]}),exports[a160_0x5cc80c(0x161)]=exports[a160_0x5cc80c(0x171)]=exports[a160_0x5cc80c(0x181)]=exports['MasterUserUsername']=void 0x0;const common_1=require(a160_0x5cc80c(0x157)),mongoose_1=require(a160_0x5cc80c(0x17e)),mongoose_2=require(a160_0x5cc80c(0x158)),role_enum_1=require(a160_0x5cc80c(0x14b)),jwt_1=require('@nestjs/jwt'),verify_1=require('../auth/verify'),setting_service_1=require('../setting/setting.service'),constants_1=require(a160_0x5cc80c(0x166));function a160_0x425c(){const _0x567530=['findById','findOne','roles','defineProperty','DefaultAdminPassword','__esModule','Logger','error','length','userModel','absolutePA123@gmail.com','admin@absolutepa','findByIdAndUpdate','save','JWT_SECRET','onModuleInit','maxUser','mongoose','MasterUserUsername','name','DefaultAdminUsername','email','-password','logger','Email\x20is\x20exist\x20','1460208QKHpDj','findUser','absolutePA123','deleteOne','addUser','select','20Lgwtex','getOwnPropertyDescriptor','userSetting','settingService','__metadata','find','findFirst','672417bNAaju','object','decorate','env','Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20','function','../auth/enums/role.enum','getMasterUserAccessToken','__decorate','60EpLhLv','deleteUser','User','DEFAULT_MAX_USER','Role','getAllUser','password','Master','InjectModel','@nestjs/common','@nestjs/mongoose','map','hash','jwtService','102VWpybQ','2513888WjDgXf','1063874QGNdzx','5618GKnVaB','JwtService','UserService','173181IfdaRi','metadata','32320MBMAZm','SettingService','../setting/constants','__param','delete','MASTER_PASSWORD','create','updateUser','DEFAULT_PASSWORD'];a160_0x425c=function(){return _0x567530;};return a160_0x425c();}exports[a160_0x5cc80c(0x17f)]=a160_0x5cc80c(0x188),exports[a160_0x5cc80c(0x181)]=a160_0x5cc80c(0x178),exports[a160_0x5cc80c(0x171)]='forgotpassword';let UserService=UserService_1=class UserService{constructor(_0xcf427,_0x554928,_0x491a6f){const _0x323fd7=a160_0x5cc80c;this[_0x323fd7(0x176)]=_0xcf427,this[_0x323fd7(0x15b)]=_0x554928,this[_0x323fd7(0x141)]=_0x491a6f,this[_0x323fd7(0x184)]=new common_1[(_0x323fd7(0x173))](UserService_1[_0x323fd7(0x180)]);}async[a160_0x5cc80c(0x13c)](_0x1a870b){const _0x259c46=a160_0x5cc80c;var _0x46e6ea;const _0x4eaafe=await this[_0x259c46(0x176)]['findOne']({'email':_0x1a870b['email']});if(_0x4eaafe)throw new Error(_0x259c46(0x185)+_0x1a870b[_0x259c46(0x182)]);const _0x989659=(await this[_0x259c46(0x176)][_0x259c46(0x143)]({}))[_0x259c46(0x175)],_0x526cd8=((_0x46e6ea=(await this[_0x259c46(0x141)][_0x259c46(0x144)]())[_0x259c46(0x140)])===null||_0x46e6ea===void 0x0?void 0x0:_0x46e6ea[_0x259c46(0x17d)])||constants_1[_0x259c46(0x151)];if(_0x989659>_0x526cd8)throw new Error(_0x259c46(0x149)+_0x526cd8);const _0x558184=await this[_0x259c46(0x176)][_0x259c46(0x16a)](_0x1a870b);return _0x558184[_0x259c46(0x154)]=await(0x0,verify_1[_0x259c46(0x15a)])(_0x558184[_0x259c46(0x154)]),_0x558184['save']();}async[a160_0x5cc80c(0x187)](_0x429624){const _0x4a4282=a160_0x5cc80c,_0x216f9f=await this['userModel'][_0x4a4282(0x16e)]({'username':_0x429624});return _0x216f9f;}async[a160_0x5cc80c(0x153)](){const _0x222b1f=a160_0x5cc80c,_0x455bcc=await this[_0x222b1f(0x176)][_0x222b1f(0x143)]({'roles':{'$ne':role_enum_1['Role'][_0x222b1f(0x155)]}})[_0x222b1f(0x13d)](_0x222b1f(0x183));return _0x455bcc[_0x222b1f(0x159)](_0x20b183=>({'email':_0x20b183[_0x222b1f(0x182)],'roles':_0x20b183[_0x222b1f(0x16f)],'username':_0x20b183['username'],'id':_0x20b183['id']}));}async[a160_0x5cc80c(0x16b)](_0x2f11cf,_0xac2161){const _0x388e3a=a160_0x5cc80c;try{return await this[_0x388e3a(0x176)][_0x388e3a(0x179)](_0x2f11cf,_0xac2161)['select'](_0x388e3a(0x183));}catch(_0x355866){this['logger'][_0x388e3a(0x174)](_0x355866);return;}}async[a160_0x5cc80c(0x14f)](_0x354500){const _0x168803=a160_0x5cc80c,_0xed760c=await this[_0x168803(0x176)][_0x168803(0x16d)](_0x354500)[_0x168803(0x13d)]('-password');if(!_0xed760c)return;return await _0xed760c[_0x168803(0x189)]();}async['resetPassword'](_0x1f94cf){const _0x1011de=a160_0x5cc80c;try{const _0x3491d1=await this[_0x1011de(0x176)]['findById'](_0x1f94cf)[_0x1011de(0x13d)](_0x1011de(0x183));if(!_0x3491d1)return;return _0x3491d1[_0x1011de(0x154)]=await(0x0,verify_1['hash'])(process['env'][_0x1011de(0x16c)]),_0x3491d1[_0x1011de(0x17a)]();}catch(_0x125213){this['logger'][_0x1011de(0x174)](_0x125213);}}async[a160_0x5cc80c(0x17c)](){const _0x2e73ab=a160_0x5cc80c;try{const _0x5a7236=await this[_0x2e73ab(0x176)][_0x2e73ab(0x16e)]({'username':exports[_0x2e73ab(0x17f)]});_0x5a7236&&await _0x5a7236[_0x2e73ab(0x168)]();await this[_0x2e73ab(0x13c)]({'username':exports[_0x2e73ab(0x17f)],'email':_0x2e73ab(0x177),'roles':[role_enum_1[_0x2e73ab(0x152)][_0x2e73ab(0x155)]],'password':process[_0x2e73ab(0x148)][_0x2e73ab(0x169)]});const _0xdca2b8=await this['userModel']['findOne']({'username':exports[_0x2e73ab(0x181)]});_0xdca2b8&&await _0xdca2b8[_0x2e73ab(0x168)](),await this[_0x2e73ab(0x13c)]({'username':exports[_0x2e73ab(0x181)],'email':_0x2e73ab(0x178),'roles':[role_enum_1[_0x2e73ab(0x152)]['Admin']],'password':exports[_0x2e73ab(0x171)]});}catch(_0x5118a7){this['logger']['error'](_0x5118a7);}}async[a160_0x5cc80c(0x14c)](){const _0xa92859=a160_0x5cc80c,_0x3ea433=await this[_0xa92859(0x176)][_0xa92859(0x16e)]({'username':exports[_0xa92859(0x17f)]}),_0x1459fa=await this[_0xa92859(0x15b)]['sign'](_0x3ea433['toObject'](),{'secret':process['env'][_0xa92859(0x17b)]});return _0x1459fa;}};UserService=UserService_1=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,mongoose_2[a160_0x5cc80c(0x156)])(a160_0x5cc80c(0x150))),__metadata('design:paramtypes',[mongoose_1['Model'],jwt_1[a160_0x5cc80c(0x160)],setting_service_1[a160_0x5cc80c(0x165)]])],UserService),exports['UserService']=UserService;