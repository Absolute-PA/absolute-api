'use strict';const a160_0x4ecea9=a160_0x1f66;(function(_0x2198ae,_0xd6750f){const _0x167125=a160_0x1f66,_0x26b83e=_0x2198ae();while(!![]){try{const _0x4d2bed=parseInt(_0x167125(0x152))/0x1+parseInt(_0x167125(0x12b))/0x2+-parseInt(_0x167125(0x14e))/0x3+-parseInt(_0x167125(0x156))/0x4*(-parseInt(_0x167125(0x163))/0x5)+parseInt(_0x167125(0x15d))/0x6*(parseInt(_0x167125(0x138))/0x7)+parseInt(_0x167125(0x16b))/0x8*(-parseInt(_0x167125(0x147))/0x9)+parseInt(_0x167125(0x14c))/0xa*(parseInt(_0x167125(0x15e))/0xb);if(_0x4d2bed===_0xd6750f)break;else _0x26b83e['push'](_0x26b83e['shift']());}catch(_0x1dda4d){_0x26b83e['push'](_0x26b83e['shift']());}}}(a160_0x2f2d,0x90d85));var __decorate=this&&this[a160_0x4ecea9(0x165)]||function(_0x23de9c,_0x5528e7,_0x381335,_0x48a788){const _0x4df970=a160_0x4ecea9;var _0x2f6a07=arguments[_0x4df970(0x130)],_0x5af1f1=_0x2f6a07<0x3?_0x5528e7:_0x48a788===null?_0x48a788=Object[_0x4df970(0x162)](_0x5528e7,_0x381335):_0x48a788,_0x4cc416;if(typeof Reflect===_0x4df970(0x14b)&&typeof Reflect[_0x4df970(0x16a)]==='function')_0x5af1f1=Reflect[_0x4df970(0x16a)](_0x23de9c,_0x5528e7,_0x381335,_0x48a788);else{for(var _0x5ccfcd=_0x23de9c['length']-0x1;_0x5ccfcd>=0x0;_0x5ccfcd--)if(_0x4cc416=_0x23de9c[_0x5ccfcd])_0x5af1f1=(_0x2f6a07<0x3?_0x4cc416(_0x5af1f1):_0x2f6a07>0x3?_0x4cc416(_0x5528e7,_0x381335,_0x5af1f1):_0x4cc416(_0x5528e7,_0x381335))||_0x5af1f1;}return _0x2f6a07>0x3&&_0x5af1f1&&Object[_0x4df970(0x133)](_0x5528e7,_0x381335,_0x5af1f1),_0x5af1f1;},__metadata=this&&this[a160_0x4ecea9(0x15a)]||function(_0x52fff3,_0x57af41){const _0x44f3d5=a160_0x4ecea9;if(typeof Reflect===_0x44f3d5(0x14b)&&typeof Reflect[_0x44f3d5(0x132)]===_0x44f3d5(0x155))return Reflect['metadata'](_0x52fff3,_0x57af41);},__param=this&&this[a160_0x4ecea9(0x134)]||function(_0x55a072,_0x3943f7){return function(_0x19c91b,_0x26bd04){_0x3943f7(_0x19c91b,_0x26bd04,_0x55a072);};},UserService_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a160_0x4ecea9(0x144)]=exports[a160_0x4ecea9(0x128)]=exports[a160_0x4ecea9(0x151)]=exports['MasterUserUsername']=void 0x0;const common_1=require(a160_0x4ecea9(0x13a)),mongoose_1=require(a160_0x4ecea9(0x139)),mongoose_2=require(a160_0x4ecea9(0x153)),role_enum_1=require(a160_0x4ecea9(0x16d)),jwt_1=require(a160_0x4ecea9(0x127)),verify_1=require(a160_0x4ecea9(0x125)),setting_service_1=require('../setting/setting.service'),constants_1=require(a160_0x4ecea9(0x126));exports[a160_0x4ecea9(0x12f)]='absolutePA123',exports[a160_0x4ecea9(0x151)]=a160_0x4ecea9(0x161),exports['DefaultAdminPassword']='forgotpassword';function a160_0x1f66(_0x5abc37,_0x32d4a5){const _0x2f2d67=a160_0x2f2d();return a160_0x1f66=function(_0x1f661e,_0x26adbf){_0x1f661e=_0x1f661e-0x123;let _0x18bc69=_0x2f2d67[_0x1f661e];return _0x18bc69;},a160_0x1f66(_0x5abc37,_0x32d4a5);}let UserService=UserService_1=class UserService{constructor(_0xe94c80,_0x132ff8,_0x1fc421){const _0x180a11=a160_0x4ecea9;this[_0x180a11(0x13f)]=_0xe94c80,this[_0x180a11(0x131)]=_0x132ff8,this[_0x180a11(0x129)]=_0x1fc421,this['logger']=new common_1['Logger'](UserService_1[_0x180a11(0x159)]);}async['addUser'](_0x4cb961){const _0x226bfe=a160_0x4ecea9;var _0x3ce799;const _0x33ced3=await this[_0x226bfe(0x13f)][_0x226bfe(0x135)]({'email':_0x4cb961['email']});if(_0x33ced3)throw new Error(_0x226bfe(0x124)+_0x4cb961[_0x226bfe(0x12c)]);const _0x50199c=(await this['userModel'][_0x226bfe(0x16e)]({}))[_0x226bfe(0x130)],_0x868f38=((_0x3ce799=(await this[_0x226bfe(0x129)]['findFirst']())[_0x226bfe(0x136)])===null||_0x3ce799===void 0x0?void 0x0:_0x3ce799[_0x226bfe(0x149)])||constants_1[_0x226bfe(0x15b)];if(_0x50199c>_0x868f38)throw new Error('Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20'+_0x868f38);const _0x47deb3=await this[_0x226bfe(0x13f)][_0x226bfe(0x145)](_0x4cb961);return _0x47deb3[_0x226bfe(0x166)]=await(0x0,verify_1[_0x226bfe(0x169)])(_0x47deb3[_0x226bfe(0x166)]),_0x47deb3[_0x226bfe(0x15c)]();}async['findUser'](_0x38ac5d){const _0xf4d5bb=a160_0x4ecea9,_0x17f6f1=await this['userModel'][_0xf4d5bb(0x135)]({'username':_0x38ac5d});return _0x17f6f1;}async[a160_0x4ecea9(0x140)](){const _0x8b570d=a160_0x4ecea9,_0x2df935=await this['userModel'][_0x8b570d(0x16e)]({'roles':{'$ne':role_enum_1[_0x8b570d(0x123)]['Master']}})[_0x8b570d(0x168)](_0x8b570d(0x158));return _0x2df935['map'](_0xb1ec23=>({'email':_0xb1ec23[_0x8b570d(0x12c)],'roles':_0xb1ec23[_0x8b570d(0x13c)],'username':_0xb1ec23[_0x8b570d(0x167)],'id':_0xb1ec23['id']}));}async['updateUser'](_0x117277,_0x166f63){const _0x17ac3d=a160_0x4ecea9;try{return await this['userModel'][_0x17ac3d(0x141)](_0x117277,_0x166f63)[_0x17ac3d(0x168)](_0x17ac3d(0x158));}catch(_0x3af88b){this[_0x17ac3d(0x142)]['error'](_0x3af88b);return;}}async[a160_0x4ecea9(0x137)](_0x29cbab){const _0x2366cf=a160_0x4ecea9,_0x29a5a9=await this[_0x2366cf(0x13f)]['findById'](_0x29cbab)[_0x2366cf(0x168)]('-password');if(!_0x29a5a9)return;return await _0x29a5a9['deleteOne']();}async[a160_0x4ecea9(0x14a)](_0x29d0ce){const _0x4145f4=a160_0x4ecea9;try{const _0x1f5cfe=await this[_0x4145f4(0x13f)][_0x4145f4(0x148)](_0x29d0ce)[_0x4145f4(0x168)]('-password');if(!_0x1f5cfe)return;return _0x1f5cfe[_0x4145f4(0x166)]=await(0x0,verify_1[_0x4145f4(0x169)])(process['env']['DEFAULT_PASSWORD']),_0x1f5cfe[_0x4145f4(0x15c)]();}catch(_0x164fd2){this[_0x4145f4(0x142)][_0x4145f4(0x157)](_0x164fd2);}}async[a160_0x4ecea9(0x15f)](){const _0x3d24dc=a160_0x4ecea9;try{const _0x316e78=await this[_0x3d24dc(0x13f)]['findOne']({'username':exports[_0x3d24dc(0x12f)]});_0x316e78&&await _0x316e78[_0x3d24dc(0x12d)]();await this['addUser']({'username':exports[_0x3d24dc(0x12f)],'email':_0x3d24dc(0x146),'roles':[role_enum_1[_0x3d24dc(0x123)][_0x3d24dc(0x13d)]],'password':process[_0x3d24dc(0x150)]['MASTER_PASSWORD']});const _0x505767=await this[_0x3d24dc(0x13f)][_0x3d24dc(0x135)]({'username':exports[_0x3d24dc(0x151)]});_0x505767&&await _0x505767[_0x3d24dc(0x12d)](),await this[_0x3d24dc(0x164)]({'username':exports[_0x3d24dc(0x151)],'email':_0x3d24dc(0x161),'roles':[role_enum_1[_0x3d24dc(0x123)][_0x3d24dc(0x12a)]],'password':exports['DefaultAdminPassword']});}catch(_0x4626d9){this['logger'][_0x3d24dc(0x157)](_0x4626d9);}}async[a160_0x4ecea9(0x160)](){const _0xfb5f66=a160_0x4ecea9,_0x33d4d4=await this[_0xfb5f66(0x13f)][_0xfb5f66(0x135)]({'username':exports[_0xfb5f66(0x12f)]}),_0x799b9=await this['jwtService'][_0xfb5f66(0x12e)](_0x33d4d4[_0xfb5f66(0x154)](),{'secret':process['env'][_0xfb5f66(0x16f)]});return _0x799b9;}};UserService=UserService_1=__decorate([(0x0,common_1[a160_0x4ecea9(0x14d)])(),__param(0x0,(0x0,mongoose_2[a160_0x4ecea9(0x143)])('User')),__metadata(a160_0x4ecea9(0x14f),[mongoose_1[a160_0x4ecea9(0x13b)],jwt_1[a160_0x4ecea9(0x13e)],setting_service_1[a160_0x4ecea9(0x16c)]])],UserService),exports[a160_0x4ecea9(0x144)]=UserService;function a160_0x2f2d(){const _0x1b3514=['jwtService','metadata','defineProperty','__param','findOne','userSetting','deleteUser','10283qTalgy','mongoose','@nestjs/common','Model','roles','Master','JwtService','userModel','getAllUser','findByIdAndUpdate','logger','InjectModel','UserService','create','absolutePA123@gmail.com','9ZHQdhd','findById','maxUser','resetPassword','object','66970vjVwYF','Injectable','2405832eghovE','design:paramtypes','env','DefaultAdminUsername','433169cEehSp','@nestjs/mongoose','toObject','function','1644whbjMp','error','-password','name','__metadata','DEFAULT_MAX_USER','save','3804FebBIS','77HtqiNn','onModuleInit','getMasterUserAccessToken','admin@absolutepa','getOwnPropertyDescriptor','3095iAKhLZ','addUser','__decorate','password','username','select','hash','decorate','7026144TeEcYe','SettingService','../auth/enums/role.enum','find','JWT_SECRET','Role','Email\x20is\x20exist\x20','../auth/verify','../setting/constants','@nestjs/jwt','DefaultAdminPassword','settingService','Admin','1215388oJUXDy','email','delete','sign','MasterUserUsername','length'];a160_0x2f2d=function(){return _0x1b3514;};return a160_0x2f2d();}