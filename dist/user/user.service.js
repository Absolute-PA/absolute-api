'use strict';function a160_0x22dd(_0x3dc307,_0x3ad749){const _0x915469=a160_0x9154();return a160_0x22dd=function(_0x22dde5,_0x4bafca){_0x22dde5=_0x22dde5-0x15c;let _0x4685a5=_0x915469[_0x22dde5];return _0x4685a5;},a160_0x22dd(_0x3dc307,_0x3ad749);}const a160_0x242245=a160_0x22dd;(function(_0x48401d,_0x1d3885){const _0x18a467=a160_0x22dd,_0x2c09b0=_0x48401d();while(!![]){try{const _0x165d0a=-parseInt(_0x18a467(0x1b1))/0x1*(-parseInt(_0x18a467(0x15d))/0x2)+-parseInt(_0x18a467(0x17f))/0x3+parseInt(_0x18a467(0x19f))/0x4*(-parseInt(_0x18a467(0x181))/0x5)+-parseInt(_0x18a467(0x17a))/0x6*(-parseInt(_0x18a467(0x1a9))/0x7)+-parseInt(_0x18a467(0x160))/0x8*(parseInt(_0x18a467(0x1ab))/0x9)+parseInt(_0x18a467(0x1b0))/0xa*(parseInt(_0x18a467(0x175))/0xb)+-parseInt(_0x18a467(0x1a5))/0xc*(-parseInt(_0x18a467(0x1ad))/0xd);if(_0x165d0a===_0x1d3885)break;else _0x2c09b0['push'](_0x2c09b0['shift']());}catch(_0x380e30){_0x2c09b0['push'](_0x2c09b0['shift']());}}}(a160_0x9154,0x991bd));var __decorate=this&&this['__decorate']||function(_0x30f30c,_0x23b81a,_0x47211a,_0x53260d){const _0x3293c3=a160_0x22dd;var _0x51e76f=arguments['length'],_0x56254e=_0x51e76f<0x3?_0x23b81a:_0x53260d===null?_0x53260d=Object[_0x3293c3(0x15f)](_0x23b81a,_0x47211a):_0x53260d,_0x4db118;if(typeof Reflect==='object'&&typeof Reflect[_0x3293c3(0x162)]==='function')_0x56254e=Reflect[_0x3293c3(0x162)](_0x30f30c,_0x23b81a,_0x47211a,_0x53260d);else{for(var _0x2acdd5=_0x30f30c[_0x3293c3(0x1a0)]-0x1;_0x2acdd5>=0x0;_0x2acdd5--)if(_0x4db118=_0x30f30c[_0x2acdd5])_0x56254e=(_0x51e76f<0x3?_0x4db118(_0x56254e):_0x51e76f>0x3?_0x4db118(_0x23b81a,_0x47211a,_0x56254e):_0x4db118(_0x23b81a,_0x47211a))||_0x56254e;}return _0x51e76f>0x3&&_0x56254e&&Object[_0x3293c3(0x16a)](_0x23b81a,_0x47211a,_0x56254e),_0x56254e;},__metadata=this&&this[a160_0x242245(0x1a8)]||function(_0x51f3ec,_0xb4d9c0){const _0x1bab53=a160_0x242245;if(typeof Reflect===_0x1bab53(0x16b)&&typeof Reflect[_0x1bab53(0x194)]===_0x1bab53(0x184))return Reflect[_0x1bab53(0x194)](_0x51f3ec,_0xb4d9c0);},__param=this&&this[a160_0x242245(0x185)]||function(_0x444bb3,_0x35725e){return function(_0x1083e2,_0x1bef15){_0x35725e(_0x1083e2,_0x1bef15,_0x444bb3);};},UserService_1;Object[a160_0x242245(0x16a)](exports,a160_0x242245(0x183),{'value':!![]}),exports[a160_0x242245(0x1a1)]=exports['DefaultAdminPassword']=exports[a160_0x242245(0x19b)]=exports[a160_0x242245(0x193)]=void 0x0;const common_1=require(a160_0x242245(0x17b)),mongoose_1=require(a160_0x242245(0x19c)),mongoose_2=require(a160_0x242245(0x170)),role_enum_1=require(a160_0x242245(0x17d)),jwt_1=require('@nestjs/jwt'),verify_1=require('../auth/verify'),setting_service_1=require(a160_0x242245(0x178)),constants_1=require(a160_0x242245(0x171));exports['MasterUserUsername']=a160_0x242245(0x18b),exports[a160_0x242245(0x19b)]=a160_0x242245(0x1a4),exports['DefaultAdminPassword']=a160_0x242245(0x1ae);let UserService=UserService_1=class UserService{constructor(_0x2228ca,_0x26aed1,_0x53e1d4){const _0x4f4a41=a160_0x242245;this['userModel']=_0x2228ca,this[_0x4f4a41(0x1a7)]=_0x26aed1,this[_0x4f4a41(0x177)]=_0x53e1d4,this[_0x4f4a41(0x169)]=new common_1[(_0x4f4a41(0x18a))](UserService_1['name']);}async['addUser'](_0x38b822){const _0x48882a=a160_0x242245;var _0x3d04ba;const _0x93dbf2=await this['userModel'][_0x48882a(0x18e)]({'email':_0x38b822['email']});if(_0x93dbf2)throw new Error(_0x48882a(0x174)+_0x38b822['email']);const _0xf6ac2b=(await this[_0x48882a(0x197)][_0x48882a(0x15e)]({}))[_0x48882a(0x1a0)],_0x27f213=((_0x3d04ba=(await this[_0x48882a(0x177)][_0x48882a(0x1ac)]())[_0x48882a(0x17c)])===null||_0x3d04ba===void 0x0?void 0x0:_0x3d04ba[_0x48882a(0x173)])||constants_1[_0x48882a(0x165)];if(_0xf6ac2b>_0x27f213)throw new Error('Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20'+_0x27f213);const _0x52819f=await this[_0x48882a(0x197)][_0x48882a(0x19d)](_0x38b822);return _0x52819f[_0x48882a(0x180)]=await(0x0,verify_1[_0x48882a(0x16e)])(_0x52819f[_0x48882a(0x180)]),_0x52819f['save']();}async[a160_0x242245(0x18f)](_0x52ed7){const _0x234521=a160_0x242245,_0x5c8642=await this[_0x234521(0x197)][_0x234521(0x18e)]({'username':_0x52ed7});return _0x5c8642;}async[a160_0x242245(0x18d)](){const _0x3e602b=a160_0x242245,_0x18f513=await this[_0x3e602b(0x197)][_0x3e602b(0x15e)]({'roles':{'$ne':role_enum_1[_0x3e602b(0x16d)][_0x3e602b(0x168)]}})[_0x3e602b(0x191)](_0x3e602b(0x163));return _0x18f513[_0x3e602b(0x1aa)](_0x152745=>({'email':_0x152745[_0x3e602b(0x182)],'roles':_0x152745[_0x3e602b(0x187)],'username':_0x152745[_0x3e602b(0x16f)],'id':_0x152745['id']}));}async[a160_0x242245(0x167)](_0x15224d,_0x49091b){const _0x517f19=a160_0x242245;try{return await this[_0x517f19(0x197)][_0x517f19(0x1a6)](_0x15224d,_0x49091b)['select'](_0x517f19(0x163));}catch(_0x5e9c18){this['logger'][_0x517f19(0x164)](_0x5e9c18);return;}}async[a160_0x242245(0x176)](_0x3e9bda){const _0x12b16f=a160_0x242245,_0x1961bd=await this[_0x12b16f(0x197)]['findById'](_0x3e9bda)[_0x12b16f(0x191)]('-password');if(!_0x1961bd)return;return await _0x1961bd[_0x12b16f(0x186)]();}async[a160_0x242245(0x192)](_0x2952ca){const _0x183259=a160_0x242245;try{const _0x39a131=await this[_0x183259(0x197)][_0x183259(0x198)](_0x2952ca)[_0x183259(0x191)]('-password');if(!_0x39a131)return;return _0x39a131[_0x183259(0x180)]=await(0x0,verify_1[_0x183259(0x16e)])(process['env'][_0x183259(0x161)]),_0x39a131['save']();}catch(_0x175f19){this[_0x183259(0x169)][_0x183259(0x164)](_0x175f19);}}async[a160_0x242245(0x195)](){const _0x476758=a160_0x242245;try{const _0x339aaf=await this[_0x476758(0x197)][_0x476758(0x18e)]({'username':exports[_0x476758(0x193)]});_0x339aaf&&await _0x339aaf[_0x476758(0x19a)]();await this[_0x476758(0x16c)]({'username':exports[_0x476758(0x193)],'email':_0x476758(0x189),'roles':[role_enum_1[_0x476758(0x16d)][_0x476758(0x168)]],'password':process[_0x476758(0x199)][_0x476758(0x19e)]});const _0x5a741a=await this[_0x476758(0x197)]['findOne']({'username':exports['DefaultAdminUsername']});_0x5a741a&&await _0x5a741a[_0x476758(0x19a)](),await this['addUser']({'username':exports['DefaultAdminUsername'],'email':_0x476758(0x1a4),'roles':[role_enum_1[_0x476758(0x16d)][_0x476758(0x196)]],'password':exports['DefaultAdminPassword']});}catch(_0x9a6c93){this[_0x476758(0x169)][_0x476758(0x164)](_0x9a6c93);}}async[a160_0x242245(0x1a2)](){const _0x3c10d4=a160_0x242245,_0x3c2827=await this[_0x3c10d4(0x197)][_0x3c10d4(0x18e)]({'username':exports[_0x3c10d4(0x193)]}),_0xe68deb=await this[_0x3c10d4(0x1a7)][_0x3c10d4(0x188)](_0x3c2827[_0x3c10d4(0x166)](),{'secret':process[_0x3c10d4(0x199)][_0x3c10d4(0x1af)]});return _0xe68deb;}};function a160_0x9154(){const _0x269997=['Logger','absolutePA123','InjectModel','getAllUser','findOne','findUser','design:paramtypes','select','resetPassword','MasterUserUsername','metadata','onModuleInit','Admin','userModel','findById','env','delete','DefaultAdminUsername','mongoose','create','MASTER_PASSWORD','74516Ioztfj','length','UserService','getMasterUserAccessToken','Model','admin@absolutepa','11293056slpQzZ','findByIdAndUpdate','jwtService','__metadata','105iNNWtH','map','265446fZEbKl','findFirst','13VDKMOQ','forgotpassword','JWT_SECRET','3915970IBUMyF','858463MjnAMZ','SettingService','2QTCHPv','find','getOwnPropertyDescriptor','152kkofyp','DEFAULT_PASSWORD','decorate','-password','error','DEFAULT_MAX_USER','toObject','updateUser','Master','logger','defineProperty','object','addUser','Role','hash','username','@nestjs/mongoose','../setting/constants','Injectable','maxUser','Email\x20is\x20exist\x20','11ljFxHB','deleteUser','settingService','../setting/setting.service','JwtService','94422eNDqDd','@nestjs/common','userSetting','../auth/enums/role.enum','User','2768973WzhVuO','password','85fcJAPi','email','__esModule','function','__param','deleteOne','roles','sign','absolutePA123@gmail.com'];a160_0x9154=function(){return _0x269997;};return a160_0x9154();}UserService=UserService_1=__decorate([(0x0,common_1[a160_0x242245(0x172)])(),__param(0x0,(0x0,mongoose_2[a160_0x242245(0x18c)])(a160_0x242245(0x17e))),__metadata(a160_0x242245(0x190),[mongoose_1[a160_0x242245(0x1a3)],jwt_1[a160_0x242245(0x179)],setting_service_1[a160_0x242245(0x15c)]])],UserService),exports['UserService']=UserService;