'use strict';const a160_0x46c57e=a160_0x4969;(function(_0x3a30a8,_0x3fda12){const _0x152c7b=a160_0x4969,_0x219f26=_0x3a30a8();while(!![]){try{const _0x4e0d8b=-parseInt(_0x152c7b(0x229))/0x1+parseInt(_0x152c7b(0x223))/0x2+parseInt(_0x152c7b(0x1f8))/0x3*(parseInt(_0x152c7b(0x1fa))/0x4)+parseInt(_0x152c7b(0x221))/0x5+parseInt(_0x152c7b(0x1fc))/0x6+parseInt(_0x152c7b(0x1e7))/0x7+-parseInt(_0x152c7b(0x21b))/0x8;if(_0x4e0d8b===_0x3fda12)break;else _0x219f26['push'](_0x219f26['shift']());}catch(_0x37b882){_0x219f26['push'](_0x219f26['shift']());}}}(a160_0x7971,0x4ac06));var __decorate=this&&this[a160_0x46c57e(0x200)]||function(_0x316ad8,_0x5ec668,_0x15d200,_0x29a206){const _0x5a356f=a160_0x46c57e;var _0x566185=arguments['length'],_0x1e2250=_0x566185<0x3?_0x5ec668:_0x29a206===null?_0x29a206=Object[_0x5a356f(0x1ea)](_0x5ec668,_0x15d200):_0x29a206,_0x3245eb;if(typeof Reflect===_0x5a356f(0x21a)&&typeof Reflect['decorate']===_0x5a356f(0x232))_0x1e2250=Reflect[_0x5a356f(0x1f1)](_0x316ad8,_0x5ec668,_0x15d200,_0x29a206);else{for(var _0x3fe7f4=_0x316ad8['length']-0x1;_0x3fe7f4>=0x0;_0x3fe7f4--)if(_0x3245eb=_0x316ad8[_0x3fe7f4])_0x1e2250=(_0x566185<0x3?_0x3245eb(_0x1e2250):_0x566185>0x3?_0x3245eb(_0x5ec668,_0x15d200,_0x1e2250):_0x3245eb(_0x5ec668,_0x15d200))||_0x1e2250;}return _0x566185>0x3&&_0x1e2250&&Object['defineProperty'](_0x5ec668,_0x15d200,_0x1e2250),_0x1e2250;},__metadata=this&&this[a160_0x46c57e(0x20f)]||function(_0x22602b,_0x5d7356){const _0x205ad6=a160_0x46c57e;if(typeof Reflect===_0x205ad6(0x21a)&&typeof Reflect[_0x205ad6(0x228)]===_0x205ad6(0x232))return Reflect[_0x205ad6(0x228)](_0x22602b,_0x5d7356);},__param=this&&this[a160_0x46c57e(0x1ee)]||function(_0x180909,_0x577755){return function(_0x13a99b,_0x2ff094){_0x577755(_0x13a99b,_0x2ff094,_0x180909);};},UserService_1;Object['defineProperty'](exports,a160_0x46c57e(0x1f3),{'value':!![]}),exports[a160_0x46c57e(0x22c)]=exports[a160_0x46c57e(0x21f)]=exports['DefaultAdminUsername']=exports[a160_0x46c57e(0x209)]=void 0x0;function a160_0x7971(){const _0x10493d=['object','10817080CgPmlX','find','jwtService','getMasterUserAccessToken','DefaultAdminPassword','save','2937650KoFyOh','select','1101958uPLUwk','map','toObject','email','mongoose','metadata','495262TMRmca','userModel','name','UserService','Logger','findByIdAndUpdate','userSetting','JWT_SECRET','findUser','function','roles','design:paramtypes','Email\x20is\x20exist\x20','2006179akPcoW','DefaultAdminUsername','addUser','getOwnPropertyDescriptor','@nestjs/jwt','create','hash','__param','findOne','SettingService','decorate','username','__esModule','resetPassword','Admin','forgotpassword','admin@absolutepa','2766UALwXX','Master','508mQRPso','InjectModel','3668274tqdGpe','absolutePA123@gmail.com','logger','DEFAULT_PASSWORD','__decorate','@nestjs/mongoose','deleteOne','../setting/constants','onModuleInit','../setting/setting.service','-password','findById','JwtService','MasterUserUsername','Injectable','settingService','env','../auth/verify','Model','__metadata','length','updateUser','Role','password','getAllUser','maxUser','../auth/enums/role.enum','delete','MASTER_PASSWORD','error'];a160_0x7971=function(){return _0x10493d;};return a160_0x7971();}function a160_0x4969(_0x3dc4ff,_0x4c7f22){const _0x79710e=a160_0x7971();return a160_0x4969=function(_0x496913,_0x441da3){_0x496913=_0x496913-0x1e4;let _0x1f0dcb=_0x79710e[_0x496913];return _0x1f0dcb;},a160_0x4969(_0x3dc4ff,_0x4c7f22);}const common_1=require('@nestjs/common'),mongoose_1=require(a160_0x46c57e(0x227)),mongoose_2=require(a160_0x46c57e(0x201)),role_enum_1=require(a160_0x46c57e(0x216)),jwt_1=require(a160_0x46c57e(0x1eb)),verify_1=require(a160_0x46c57e(0x20d)),setting_service_1=require(a160_0x46c57e(0x205)),constants_1=require(a160_0x46c57e(0x203));exports[a160_0x46c57e(0x209)]='absolutePA123',exports[a160_0x46c57e(0x1e8)]='admin@absolutepa',exports[a160_0x46c57e(0x21f)]=a160_0x46c57e(0x1f6);let UserService=UserService_1=class UserService{constructor(_0x5443dc,_0x313ddc,_0x16feb3){const _0x13182d=a160_0x46c57e;this[_0x13182d(0x22a)]=_0x5443dc,this[_0x13182d(0x21d)]=_0x313ddc,this[_0x13182d(0x20b)]=_0x16feb3,this['logger']=new common_1[(_0x13182d(0x22d))](UserService_1[_0x13182d(0x22b)]);}async[a160_0x46c57e(0x1e9)](_0x3feb67){const _0x49753e=a160_0x46c57e;var _0x403670;const _0xa5e2de=await this[_0x49753e(0x22a)]['findOne']({'email':_0x3feb67[_0x49753e(0x226)]});if(_0xa5e2de)throw new Error(_0x49753e(0x1e6)+_0x3feb67[_0x49753e(0x226)]);const _0x391cb4=(await this[_0x49753e(0x22a)][_0x49753e(0x21c)]({}))[_0x49753e(0x210)],_0x2350a3=((_0x403670=(await this[_0x49753e(0x20b)]['findFirst']())[_0x49753e(0x22f)])===null||_0x403670===void 0x0?void 0x0:_0x403670[_0x49753e(0x215)])||constants_1['DEFAULT_MAX_USER'];if(_0x391cb4>_0x2350a3)throw new Error('Your\x20account\x20reach\x20maximum\x20number\x20of\x20account:\x20'+_0x2350a3);const _0x30b94a=await this[_0x49753e(0x22a)][_0x49753e(0x1ec)](_0x3feb67);return _0x30b94a[_0x49753e(0x213)]=await(0x0,verify_1[_0x49753e(0x1ed)])(_0x30b94a[_0x49753e(0x213)]),_0x30b94a[_0x49753e(0x220)]();}async[a160_0x46c57e(0x231)](_0x1b6723){const _0x1d8bf3=a160_0x46c57e,_0x45fcd9=await this[_0x1d8bf3(0x22a)][_0x1d8bf3(0x1ef)]({'username':_0x1b6723});return _0x45fcd9;}async[a160_0x46c57e(0x214)](){const _0x5a2b72=a160_0x46c57e,_0x59df7c=await this[_0x5a2b72(0x22a)][_0x5a2b72(0x21c)]({'roles':{'$ne':role_enum_1[_0x5a2b72(0x212)][_0x5a2b72(0x1f9)]}})[_0x5a2b72(0x222)](_0x5a2b72(0x206));return _0x59df7c[_0x5a2b72(0x224)](_0x11ba0f=>({'email':_0x11ba0f[_0x5a2b72(0x226)],'roles':_0x11ba0f[_0x5a2b72(0x1e4)],'username':_0x11ba0f[_0x5a2b72(0x1f2)],'id':_0x11ba0f['id']}));}async[a160_0x46c57e(0x211)](_0x2ba5dd,_0x1c9b3e){const _0x1e6c44=a160_0x46c57e;try{return await this['userModel'][_0x1e6c44(0x22e)](_0x2ba5dd,_0x1c9b3e)[_0x1e6c44(0x222)]('-password');}catch(_0x49fad2){this[_0x1e6c44(0x1fe)]['error'](_0x49fad2);return;}}async['deleteUser'](_0x5c93ba){const _0x576fed=a160_0x46c57e,_0x180bf3=await this[_0x576fed(0x22a)][_0x576fed(0x207)](_0x5c93ba)[_0x576fed(0x222)](_0x576fed(0x206));if(!_0x180bf3)return;return await _0x180bf3[_0x576fed(0x202)]();}async[a160_0x46c57e(0x1f4)](_0x437ad7){const _0x31525a=a160_0x46c57e;try{const _0x193124=await this['userModel'][_0x31525a(0x207)](_0x437ad7)[_0x31525a(0x222)]('-password');if(!_0x193124)return;return _0x193124[_0x31525a(0x213)]=await(0x0,verify_1[_0x31525a(0x1ed)])(process[_0x31525a(0x20c)][_0x31525a(0x1ff)]),_0x193124[_0x31525a(0x220)]();}catch(_0x530993){this[_0x31525a(0x1fe)][_0x31525a(0x219)](_0x530993);}}async[a160_0x46c57e(0x204)](){const _0x364291=a160_0x46c57e;try{const _0x2da357=await this['userModel'][_0x364291(0x1ef)]({'username':exports[_0x364291(0x209)]});_0x2da357&&await _0x2da357[_0x364291(0x217)]();await this[_0x364291(0x1e9)]({'username':exports[_0x364291(0x209)],'email':_0x364291(0x1fd),'roles':[role_enum_1['Role'][_0x364291(0x1f9)]],'password':process['env'][_0x364291(0x218)]});const _0x17b042=await this[_0x364291(0x22a)]['findOne']({'username':exports[_0x364291(0x1e8)]});_0x17b042&&await _0x17b042[_0x364291(0x217)](),await this[_0x364291(0x1e9)]({'username':exports[_0x364291(0x1e8)],'email':_0x364291(0x1f7),'roles':[role_enum_1[_0x364291(0x212)][_0x364291(0x1f5)]],'password':exports[_0x364291(0x21f)]});}catch(_0x68077f){this[_0x364291(0x1fe)][_0x364291(0x219)](_0x68077f);}}async[a160_0x46c57e(0x21e)](){const _0x23f565=a160_0x46c57e,_0x2df6c9=await this[_0x23f565(0x22a)]['findOne']({'username':exports['MasterUserUsername']}),_0x4fe82a=await this[_0x23f565(0x21d)]['sign'](_0x2df6c9[_0x23f565(0x225)](),{'secret':process['env'][_0x23f565(0x230)]});return _0x4fe82a;}};UserService=UserService_1=__decorate([(0x0,common_1[a160_0x46c57e(0x20a)])(),__param(0x0,(0x0,mongoose_2[a160_0x46c57e(0x1fb)])('User')),__metadata(a160_0x46c57e(0x1e5),[mongoose_1[a160_0x46c57e(0x20e)],jwt_1[a160_0x46c57e(0x208)],setting_service_1[a160_0x46c57e(0x1f0)]])],UserService),exports['UserService']=UserService;