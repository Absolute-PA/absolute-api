'use strict';function a145_0x23b4(){const _0x2d2775=['There\x20is\x20no\x20message\x20to\x20play','volume','decorate','228258vyaGIB','deleteTextMessage','User','error','@nestjs/common','2343tgkKJL','design:paramtypes','Put','1610250CzDMLU','processRootPath','/message','AudioPlayer','error\x20','3PCjLWh','function','Roles','StreamingService','length','playAudioFile','../streaming/streaming.service','TextToAudioService','30444tATErQ','object','283830coKyZj','__decorate','logger','__esModule','getMessages','../auth/decorators/roles.decorator','Role','updateTextMessage','textToAudio','/:id','getAllMessage','Post','../common/file','__metadata','assign','isFileExist','design:returntype','11354qySPew','Success\x20save\x20text:\x20','./saveStreamToFile','__param','createFolder','228450uzHhge','Param','TextDTO','log','JwtAuthGuard','join','saveMessage','Body','9aDHrpf','design:type','../auth/guards/roles.guard','textToAudioService','UseGuards','saveStreamToFile','defineProperty','TextToAudioController','../common/constants','prototype','Res','text','AUDIO_TO_MESSAGE_DIR','42VGWTpa','RolesGuard','metadata','play','../auth/enums/role.enum','624xClkLy','2254668ftAChn','.wav','Admin','send'];a145_0x23b4=function(){return _0x2d2775;};return a145_0x23b4();}const a145_0x31a248=a145_0x1c0e;(function(_0x18dbf4,_0x2b20bc){const _0x1f94a5=a145_0x1c0e,_0x87903=_0x18dbf4();while(!![]){try{const _0x5e0a11=-parseInt(_0x1f94a5(0xfa))/0x1+-parseInt(_0x1f94a5(0x11c))/0x2+-parseInt(_0x1f94a5(0xda))/0x3*(parseInt(_0x1f94a5(0x115))/0x4)+-parseInt(_0x1f94a5(0xe4))/0x5*(-parseInt(_0x1f94a5(0x10f))/0x6)+parseInt(_0x1f94a5(0xf5))/0x7*(parseInt(_0x1f94a5(0x114))/0x8)+-parseInt(_0x1f94a5(0x102))/0x9*(-parseInt(_0x1f94a5(0xd5))/0xa)+-parseInt(_0x1f94a5(0x121))/0xb*(-parseInt(_0x1f94a5(0xe2))/0xc);if(_0x5e0a11===_0x2b20bc)break;else _0x87903['push'](_0x87903['shift']());}catch(_0x411201){_0x87903['push'](_0x87903['shift']());}}}(a145_0x23b4,0x4de3e));var __decorate=this&&this[a145_0x31a248(0xe5)]||function(_0x4f81dd,_0x2b7263,_0x4e646d,_0x10bb11){const _0x513707=a145_0x31a248;var _0x59d9b2=arguments[_0x513707(0xde)],_0x3ed80f=_0x59d9b2<0x3?_0x2b7263:_0x10bb11===null?_0x10bb11=Object['getOwnPropertyDescriptor'](_0x2b7263,_0x4e646d):_0x10bb11,_0x4f606a;if(typeof Reflect==='object'&&typeof Reflect[_0x513707(0x11b)]===_0x513707(0xdb))_0x3ed80f=Reflect[_0x513707(0x11b)](_0x4f81dd,_0x2b7263,_0x4e646d,_0x10bb11);else{for(var _0x174b48=_0x4f81dd['length']-0x1;_0x174b48>=0x0;_0x174b48--)if(_0x4f606a=_0x4f81dd[_0x174b48])_0x3ed80f=(_0x59d9b2<0x3?_0x4f606a(_0x3ed80f):_0x59d9b2>0x3?_0x4f606a(_0x2b7263,_0x4e646d,_0x3ed80f):_0x4f606a(_0x2b7263,_0x4e646d))||_0x3ed80f;}return _0x59d9b2>0x3&&_0x3ed80f&&Object[_0x513707(0x108)](_0x2b7263,_0x4e646d,_0x3ed80f),_0x3ed80f;},__metadata=this&&this[a145_0x31a248(0xf1)]||function(_0x3ac73e,_0x39162c){const _0x31ad27=a145_0x31a248;if(typeof Reflect===_0x31ad27(0xe3)&&typeof Reflect['metadata']===_0x31ad27(0xdb))return Reflect[_0x31ad27(0x111)](_0x3ac73e,_0x39162c);},__param=this&&this[a145_0x31a248(0xf8)]||function(_0x5e486b,_0x4bf2d3){return function(_0x5dbce9,_0x3e5fbf){_0x4bf2d3(_0x5dbce9,_0x3e5fbf,_0x5e486b);};},TextToAudioController_1;Object[a145_0x31a248(0x108)](exports,a145_0x31a248(0xe7),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require(a145_0x31a248(0x120)),text_to_audio_service_1=require('./text-to-audio.service'),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a145_0x31a248(0xe0)),roles_decorator_1=require(a145_0x31a248(0xe9)),role_enum_1=require(a145_0x31a248(0x113)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a145_0x31a248(0x104)),saveStreamToFile_1=require(a145_0x31a248(0xf7)),path=require('path'),path_1=require('../common/path'),constants_1=require(a145_0x31a248(0x10a)),file_1=require(a145_0x31a248(0xf0)),audio_player_1=require('../common/audio/audio-player');let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x1c0be9,_0x2fdadb){const _0x47d1f5=a145_0x31a248;this[_0x47d1f5(0x105)]=_0x1c0be9,this['streamingService']=_0x2fdadb,this[_0x47d1f5(0xe6)]=new common_1['Logger'](TextToAudioController_1['name']);}async['playAudioFile'](_0x421935,_0x20b406){const _0x1538e4=a145_0x31a248;try{const _0x242faa=_0x20b406['text'];if(!_0x242faa){_0x421935[_0x1538e4(0x118)](_0x1538e4(0x119));return;}const {id:_0x339706,volume:_0x426e93}=await this[_0x1538e4(0x105)]['saveMessage'](_0x242faa);!(0x0,file_1[_0x1538e4(0xf3)])(constants_1[_0x1538e4(0x10e)])&&(0x0,file_1[_0x1538e4(0xf9)])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x5718a4=path[_0x1538e4(0xff)](path_1[_0x1538e4(0xd6)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x4eccbf=_0x5718a4+'/'+_0x339706+_0x1538e4(0x116);!(0x0,file_1[_0x1538e4(0xf3)])(_0x4eccbf)?await this[_0x1538e4(0x105)][_0x1538e4(0xec)](_0x20b406[_0x1538e4(0x10d)],async _0x17ddbc=>{const _0x44c7c6=_0x1538e4;await(0x0,saveStreamToFile_1[_0x44c7c6(0x107)])(_0x17ddbc,_0x5718a4+'/'+_0x339706+'.wav'),audio_player_1[_0x44c7c6(0xd8)][_0x44c7c6(0x112)](_0x4eccbf,_0x426e93!==null&&_0x426e93!==void 0x0?_0x426e93:0x32);}):audio_player_1[_0x1538e4(0xd8)]['play'](_0x4eccbf,_0x426e93!==null&&_0x426e93!==void 0x0?_0x426e93:0x32),_0x421935[_0x1538e4(0x118)]('Success\x20play\x20text\x20to\x20audio:\x20'+_0x20b406[_0x1538e4(0x10d)]);}catch(_0x302df5){return this['logger'][_0x1538e4(0xfd)](_0x302df5,_0x1538e4(0x11f)),'';}}async[a145_0x31a248(0x100)](_0x1aa2f0,_0x30860c){const _0x2136ff=a145_0x31a248;try{const _0x324a1b=_0x30860c[_0x2136ff(0x10d)];if(!_0x324a1b){_0x1aa2f0[_0x2136ff(0x118)]('There\x20is\x20no\x20message\x20to\x20play');return;}await this[_0x2136ff(0x105)][_0x2136ff(0x100)](_0x324a1b),_0x1aa2f0[_0x2136ff(0x118)](_0x2136ff(0xf6)+_0x30860c['text']);}catch(_0xdf0e1e){return this[_0x2136ff(0xe6)][_0x2136ff(0xfd)](_0xdf0e1e,_0x2136ff(0xd9)),'';}}async['getAllMessage'](){const _0x38715d=a145_0x31a248;try{const _0x22d6d8=await this[_0x38715d(0x105)][_0x38715d(0xe8)]();return _0x22d6d8!==null&&_0x22d6d8!==void 0x0?_0x22d6d8:[];}catch(_0x3ba655){return this[_0x38715d(0xe6)]['log'](_0x3ba655,_0x38715d(0x11f)),'';}}['deleteTextMessage'](_0x3c6a5f){const _0x4c55ff=a145_0x31a248;return this['textToAudioService'][_0x4c55ff(0x11d)](_0x3c6a5f);}[a145_0x31a248(0xeb)](_0x328006,_0x1f60b1){const _0x547932=a145_0x31a248;var _0x2c9cc4;return this[_0x547932(0x105)]['updateTextMessage'](_0x328006,Object[_0x547932(0xf2)](Object[_0x547932(0xf2)]({},_0x1f60b1),{'volume':(_0x2c9cc4=_0x1f60b1[_0x547932(0x11a)])!==null&&_0x2c9cc4!==void 0x0?_0x2c9cc4:0x32}));}};function a145_0x1c0e(_0x24272c,_0x519fb8){const _0x23b410=a145_0x23b4();return a145_0x1c0e=function(_0x1c0eaf,_0xb672b6){_0x1c0eaf=_0x1c0eaf-0xd4;let _0x551335=_0x23b410[_0x1c0eaf];return _0x551335;},a145_0x1c0e(_0x24272c,_0x519fb8);}__decorate([(0x0,common_1[a145_0x31a248(0xef)])('/'),(0x0,common_1[a145_0x31a248(0x106)])(jwt_guard_1[a145_0x31a248(0xfe)],roles_guard_1[a145_0x31a248(0x110)]),(0x0,roles_decorator_1[a145_0x31a248(0xdc)])(role_enum_1[a145_0x31a248(0xea)]['Admin'],role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x11e)]),__param(0x0,(0x0,common_1[a145_0x31a248(0x10c)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x31a248(0x101)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,text_dto_1[a145_0x31a248(0xfc)]]),__metadata(a145_0x31a248(0xf4),Promise)],TextToAudioController['prototype'],a145_0x31a248(0xdf),null),__decorate([(0x0,common_1[a145_0x31a248(0xef)])(a145_0x31a248(0x100)),(0x0,common_1[a145_0x31a248(0x106)])(jwt_guard_1[a145_0x31a248(0xfe)],roles_guard_1[a145_0x31a248(0x110)]),(0x0,roles_decorator_1[a145_0x31a248(0xdc)])(role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x117)],role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x11e)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x31a248(0x103),Function),__metadata(a145_0x31a248(0x122),[Object,text_dto_1['TextDTO']]),__metadata(a145_0x31a248(0xf4),Promise)],TextToAudioController['prototype'],a145_0x31a248(0x100),null),__decorate([(0x0,common_1['Get'])(a145_0x31a248(0xd7)),(0x0,common_1[a145_0x31a248(0x106)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x31a248(0x110)]),(0x0,roles_decorator_1[a145_0x31a248(0xdc)])(role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x117)],role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x11e)]),__metadata(a145_0x31a248(0x103),Function),__metadata(a145_0x31a248(0x122),[]),__metadata(a145_0x31a248(0xf4),Promise)],TextToAudioController[a145_0x31a248(0x10b)],a145_0x31a248(0xee),null),__decorate([(0x0,common_1['Delete'])(a145_0x31a248(0xed)),(0x0,common_1[a145_0x31a248(0x106)])(jwt_guard_1[a145_0x31a248(0xfe)],roles_guard_1[a145_0x31a248(0x110)]),(0x0,roles_decorator_1[a145_0x31a248(0xdc)])(role_enum_1[a145_0x31a248(0xea)]['Admin'],role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x11e)]),__param(0x0,(0x0,common_1[a145_0x31a248(0xfb)])('id')),__metadata(a145_0x31a248(0x103),Function),__metadata('design:paramtypes',[String]),__metadata(a145_0x31a248(0xf4),void 0x0)],TextToAudioController['prototype'],a145_0x31a248(0x11d),null),__decorate([(0x0,common_1[a145_0x31a248(0xd4)])(a145_0x31a248(0xed)),(0x0,common_1[a145_0x31a248(0x106)])(jwt_guard_1[a145_0x31a248(0xfe)],roles_guard_1[a145_0x31a248(0x110)]),(0x0,roles_decorator_1[a145_0x31a248(0xdc)])(role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x117)],role_enum_1[a145_0x31a248(0xea)][a145_0x31a248(0x11e)]),__param(0x0,(0x0,common_1[a145_0x31a248(0xfb)])('id')),__param(0x1,(0x0,common_1[a145_0x31a248(0x101)])()),__metadata(a145_0x31a248(0x103),Function),__metadata(a145_0x31a248(0x122),[String,text_dto_1['TextDTO']]),__metadata(a145_0x31a248(0xf4),void 0x0)],TextToAudioController[a145_0x31a248(0x10b)],'updateTextMessage',null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a145_0x31a248(0xec)),__metadata(a145_0x31a248(0x122),[text_to_audio_service_1[a145_0x31a248(0xe1)],streaming_service_1[a145_0x31a248(0xdd)]])],TextToAudioController),exports[a145_0x31a248(0x109)]=TextToAudioController;