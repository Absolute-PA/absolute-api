'use strict';const a142_0x28ba7d=a142_0x4693;(function(_0x482138,_0x29a3ba){const _0x110146=a142_0x4693,_0x12628b=_0x482138();while(!![]){try{const _0x17373c=-parseInt(_0x110146(0xcf))/0x1+parseInt(_0x110146(0xac))/0x2+-parseInt(_0x110146(0xa0))/0x3+-parseInt(_0x110146(0x95))/0x4+-parseInt(_0x110146(0x9b))/0x5*(-parseInt(_0x110146(0x8c))/0x6)+-parseInt(_0x110146(0xa2))/0x7+parseInt(_0x110146(0xb5))/0x8;if(_0x17373c===_0x29a3ba)break;else _0x12628b['push'](_0x12628b['shift']());}catch(_0x40963e){_0x12628b['push'](_0x12628b['shift']());}}}(a142_0x22f8,0xaa028));function a142_0x4693(_0x4f596b,_0x3b0204){const _0x22f854=a142_0x22f8();return a142_0x4693=function(_0x4693e5,_0x55fed1){_0x4693e5=_0x4693e5-0x8b;let _0x4b9bd2=_0x22f854[_0x4693e5];return _0x4b9bd2;},a142_0x4693(_0x4f596b,_0x3b0204);}var __decorate=this&&this[a142_0x28ba7d(0xc9)]||function(_0x4bd0eb,_0x42e9cc,_0x7f286e,_0x1b3a8b){const _0x23af97=a142_0x28ba7d;var _0x2fad2a=arguments[_0x23af97(0xa3)],_0xa5449a=_0x2fad2a<0x3?_0x42e9cc:_0x1b3a8b===null?_0x1b3a8b=Object[_0x23af97(0xd5)](_0x42e9cc,_0x7f286e):_0x1b3a8b,_0x491906;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0xa5449a=Reflect[_0x23af97(0x8e)](_0x4bd0eb,_0x42e9cc,_0x7f286e,_0x1b3a8b);else{for(var _0x5e9541=_0x4bd0eb[_0x23af97(0xa3)]-0x1;_0x5e9541>=0x0;_0x5e9541--)if(_0x491906=_0x4bd0eb[_0x5e9541])_0xa5449a=(_0x2fad2a<0x3?_0x491906(_0xa5449a):_0x2fad2a>0x3?_0x491906(_0x42e9cc,_0x7f286e,_0xa5449a):_0x491906(_0x42e9cc,_0x7f286e))||_0xa5449a;}return _0x2fad2a>0x3&&_0xa5449a&&Object[_0x23af97(0xcd)](_0x42e9cc,_0x7f286e,_0xa5449a),_0xa5449a;},__metadata=this&&this[a142_0x28ba7d(0xa9)]||function(_0x2751e1,_0x16cc15){const _0x47db07=a142_0x28ba7d;if(typeof Reflect===_0x47db07(0xc8)&&typeof Reflect['metadata']===_0x47db07(0xba))return Reflect[_0x47db07(0xb7)](_0x2751e1,_0x16cc15);},__param=this&&this[a142_0x28ba7d(0xc2)]||function(_0x40492c,_0x4b52cc){return function(_0x365e29,_0x205817){_0x4b52cc(_0x365e29,_0x205817,_0x40492c);};},TextToAudioController_1;Object[a142_0x28ba7d(0xcd)](exports,'__esModule',{'value':!![]}),exports[a142_0x28ba7d(0xa6)]=void 0x0;const common_1=require(a142_0x28ba7d(0x8d)),text_to_audio_service_1=require(a142_0x28ba7d(0xa4)),text_dto_1=require(a142_0x28ba7d(0xcc)),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require(a142_0x28ba7d(0xd1)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a142_0x28ba7d(0x99)),roles_guard_1=require(a142_0x28ba7d(0xaf)),saveStreamToFile_1=require(a142_0x28ba7d(0xd4)),path=require(a142_0x28ba7d(0xaa)),path_1=require('../common/path'),constants_1=require('../common/constants'),file_1=require('../common/file'),audio_player_1=require(a142_0x28ba7d(0xbe));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x468384,_0x5dd60b){const _0x1e433c=a142_0x28ba7d;this['textToAudioService']=_0x468384,this[_0x1e433c(0x9f)]=_0x5dd60b,this['logger']=new common_1[(_0x1e433c(0xc1))](TextToAudioController_1['name']);}async[a142_0x28ba7d(0xb3)](_0x33c89d,_0x2d9c69){const _0x5d41c0=a142_0x28ba7d;try{const _0x42481a=_0x2d9c69[_0x5d41c0(0x9c)];if(!_0x42481a){_0x33c89d[_0x5d41c0(0x8b)](_0x5d41c0(0x97));return;}const {id:_0x73921f,volume:_0x1e8590}=await this[_0x5d41c0(0xb0)][_0x5d41c0(0xd2)](_0x42481a);!(0x0,file_1[_0x5d41c0(0xcb)])(constants_1[_0x5d41c0(0xd8)])&&(0x0,file_1[_0x5d41c0(0xc5)])(constants_1[_0x5d41c0(0xd8)]);const _0x994d1d=path['join'](path_1[_0x5d41c0(0xd7)],constants_1[_0x5d41c0(0xd8)]),_0x4efda9=_0x994d1d+'/'+_0x73921f+'.wav';!(0x0,file_1['isFileExist'])(_0x4efda9)?await this[_0x5d41c0(0xb0)][_0x5d41c0(0xc6)](_0x2d9c69[_0x5d41c0(0x9c)],async _0x523802=>{const _0x3f90ee=_0x5d41c0;await(0x0,saveStreamToFile_1[_0x3f90ee(0x96)])(_0x523802,_0x994d1d+'/'+_0x73921f+'.wav'),audio_player_1[_0x3f90ee(0xbb)][_0x3f90ee(0xab)](_0x4efda9,_0x1e8590!==null&&_0x1e8590!==void 0x0?_0x1e8590:0x32);}):audio_player_1[_0x5d41c0(0xbb)][_0x5d41c0(0xab)](_0x4efda9,_0x1e8590!==null&&_0x1e8590!==void 0x0?_0x1e8590:0x32),_0x33c89d[_0x5d41c0(0x8b)](_0x5d41c0(0xc7)+_0x2d9c69[_0x5d41c0(0x9c)]);}catch(_0x2b7a4a){return this[_0x5d41c0(0x90)][_0x5d41c0(0xae)](_0x2b7a4a,'error'),'';}}async[a142_0x28ba7d(0xd2)](_0x5f34c9,_0x3e3227){const _0x1f0e6a=a142_0x28ba7d;try{const _0x5c1e61=_0x3e3227[_0x1f0e6a(0x9c)];if(!_0x5c1e61){_0x5f34c9['send'](_0x1f0e6a(0x97));return;}await this[_0x1f0e6a(0xb0)]['saveMessage'](_0x5c1e61),_0x5f34c9[_0x1f0e6a(0x8b)](_0x1f0e6a(0xd0)+_0x3e3227[_0x1f0e6a(0x9c)]);}catch(_0x590cf5){return this[_0x1f0e6a(0x90)][_0x1f0e6a(0xae)](_0x590cf5,_0x1f0e6a(0xbf)),'';}}async[a142_0x28ba7d(0x92)](){const _0x19c165=a142_0x28ba7d;try{const _0x4f9ecc=await this['textToAudioService'][_0x19c165(0xa8)]();return _0x4f9ecc!==null&&_0x4f9ecc!==void 0x0?_0x4f9ecc:[];}catch(_0x5668c8){return this['logger'][_0x19c165(0xae)](_0x5668c8,_0x19c165(0xca)),'';}}[a142_0x28ba7d(0xb1)](_0xdda34b){return this['textToAudioService']['deleteTextMessage'](_0xdda34b);}['updateTextMessage'](_0x5b34fc,_0x4424ec){const _0xa96fb3=a142_0x28ba7d;var _0x51818e;return this[_0xa96fb3(0xb0)][_0xa96fb3(0xd6)](_0x5b34fc,Object[_0xa96fb3(0xb6)](Object[_0xa96fb3(0xb6)]({},_0x4424ec),{'volume':(_0x51818e=_0x4424ec[_0xa96fb3(0xa1)])!==null&&_0x51818e!==void 0x0?_0x51818e:0x32}));}};__decorate([(0x0,common_1[a142_0x28ba7d(0xd3)])('/'),(0x0,common_1[a142_0x28ba7d(0xbd)])(jwt_guard_1[a142_0x28ba7d(0xa7)],roles_guard_1[a142_0x28ba7d(0x9d)]),(0x0,roles_decorator_1[a142_0x28ba7d(0x9a)])(role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x8f)],role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x94)]),__param(0x0,(0x0,common_1[a142_0x28ba7d(0x98)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x28ba7d(0xa5)])()),__metadata(a142_0x28ba7d(0xb4),Function),__metadata(a142_0x28ba7d(0xb9),[Object,text_dto_1[a142_0x28ba7d(0x9e)]]),__metadata(a142_0x28ba7d(0xbc),Promise)],TextToAudioController['prototype'],'playAudioFile',null),__decorate([(0x0,common_1['Post'])(a142_0x28ba7d(0xd2)),(0x0,common_1[a142_0x28ba7d(0xbd)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x28ba7d(0x9d)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x8f)],role_enum_1['Role'][a142_0x28ba7d(0x94)]),__param(0x0,(0x0,common_1[a142_0x28ba7d(0x98)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x28ba7d(0xb4),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x28ba7d(0x9e)]]),__metadata(a142_0x28ba7d(0xbc),Promise)],TextToAudioController['prototype'],a142_0x28ba7d(0xd2),null),__decorate([(0x0,common_1[a142_0x28ba7d(0xad)])('/message'),(0x0,common_1[a142_0x28ba7d(0xbd)])(jwt_guard_1[a142_0x28ba7d(0xa7)],roles_guard_1[a142_0x28ba7d(0x9d)]),(0x0,roles_decorator_1[a142_0x28ba7d(0x9a)])(role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x8f)],role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x94)]),__metadata(a142_0x28ba7d(0xb4),Function),__metadata(a142_0x28ba7d(0xb9),[]),__metadata(a142_0x28ba7d(0xbc),Promise)],TextToAudioController['prototype'],'getAllMessage',null),__decorate([(0x0,common_1[a142_0x28ba7d(0xb8)])(a142_0x28ba7d(0xc3)),(0x0,common_1[a142_0x28ba7d(0xbd)])(jwt_guard_1[a142_0x28ba7d(0xa7)],roles_guard_1[a142_0x28ba7d(0x9d)]),(0x0,roles_decorator_1[a142_0x28ba7d(0x9a)])(role_enum_1[a142_0x28ba7d(0xc4)]['Admin'],role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x94)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x28ba7d(0xb4),Function),__metadata(a142_0x28ba7d(0xb9),[String]),__metadata(a142_0x28ba7d(0xbc),void 0x0)],TextToAudioController[a142_0x28ba7d(0x93)],a142_0x28ba7d(0xb1),null),__decorate([(0x0,common_1[a142_0x28ba7d(0xb2)])(a142_0x28ba7d(0xc3)),(0x0,common_1[a142_0x28ba7d(0xbd)])(jwt_guard_1[a142_0x28ba7d(0xa7)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x28ba7d(0x9a)])(role_enum_1[a142_0x28ba7d(0xc4)][a142_0x28ba7d(0x8f)],role_enum_1[a142_0x28ba7d(0xc4)]['User']),__param(0x0,(0x0,common_1[a142_0x28ba7d(0x91)])('id')),__param(0x1,(0x0,common_1[a142_0x28ba7d(0xa5)])()),__metadata(a142_0x28ba7d(0xb4),Function),__metadata('design:paramtypes',[String,text_dto_1[a142_0x28ba7d(0x9e)]]),__metadata(a142_0x28ba7d(0xbc),void 0x0)],TextToAudioController['prototype'],a142_0x28ba7d(0xd6),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x28ba7d(0xce)])(a142_0x28ba7d(0xc6)),__metadata('design:paramtypes',[text_to_audio_service_1[a142_0x28ba7d(0xc0)],streaming_service_1['StreamingService']])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;function a142_0x22f8(){const _0x483a75=['textToAudioService','deleteTextMessage','Put','playAudioFile','design:type','14209624nymkIx','assign','metadata','Delete','design:paramtypes','function','AudioPlayer','design:returntype','UseGuards','../common/audio/audio-player','error\x20','TextToAudioService','Logger','__param','/:id','Role','createFolder','textToAudio','Success\x20play\x20text\x20to\x20audio:\x20','object','__decorate','error','isFileExist','./dtos/text.dto','defineProperty','Controller','1370918hGZacO','Success\x20save\x20text:\x20','../auth/decorators/roles.decorator','saveMessage','Post','./saveStreamToFile','getOwnPropertyDescriptor','updateTextMessage','processRootPath','AUDIO_TO_MESSAGE_DIR','send','454392hGVXRR','@nestjs/common','decorate','Admin','logger','Param','getAllMessage','prototype','User','1732040EYlMfS','saveStreamToFile','There\x20is\x20no\x20message\x20to\x20play','Res','../auth/guards/jwt.guard','Roles','60qweNJU','text','RolesGuard','TextDTO','streamingService','1479390FZcDJr','volume','440265qJVRWy','length','./text-to-audio.service','Body','TextToAudioController','JwtAuthGuard','getMessages','__metadata','path','play','742652Dppwee','Get','log','../auth/guards/roles.guard'];a142_0x22f8=function(){return _0x483a75;};return a142_0x22f8();}