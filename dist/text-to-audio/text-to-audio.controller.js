'use strict';const a142_0x4293ac=a142_0xf652;(function(_0x2ffc40,_0x4ed4f7){const _0x618236=a142_0xf652,_0x42b828=_0x2ffc40();while(!![]){try{const _0x663416=-parseInt(_0x618236(0x115))/0x1+-parseInt(_0x618236(0x13a))/0x2*(-parseInt(_0x618236(0x139))/0x3)+-parseInt(_0x618236(0x130))/0x4*(-parseInt(_0x618236(0x107))/0x5)+-parseInt(_0x618236(0x11d))/0x6+parseInt(_0x618236(0xf7))/0x7+parseInt(_0x618236(0x12f))/0x8*(parseInt(_0x618236(0x10c))/0x9)+-parseInt(_0x618236(0x103))/0xa;if(_0x663416===_0x4ed4f7)break;else _0x42b828['push'](_0x42b828['shift']());}catch(_0x2fb724){_0x42b828['push'](_0x42b828['shift']());}}}(a142_0x3686,0xba3f6));var __decorate=this&&this[a142_0x4293ac(0x11c)]||function(_0x18d886,_0x29b0e9,_0x4764eb,_0x43125a){const _0x3e9752=a142_0x4293ac;var _0x5d4074=arguments['length'],_0x18b724=_0x5d4074<0x3?_0x29b0e9:_0x43125a===null?_0x43125a=Object[_0x3e9752(0x121)](_0x29b0e9,_0x4764eb):_0x43125a,_0x57bb81;if(typeof Reflect===_0x3e9752(0x12c)&&typeof Reflect['decorate']==='function')_0x18b724=Reflect['decorate'](_0x18d886,_0x29b0e9,_0x4764eb,_0x43125a);else{for(var _0x29be6e=_0x18d886[_0x3e9752(0x110)]-0x1;_0x29be6e>=0x0;_0x29be6e--)if(_0x57bb81=_0x18d886[_0x29be6e])_0x18b724=(_0x5d4074<0x3?_0x57bb81(_0x18b724):_0x5d4074>0x3?_0x57bb81(_0x29b0e9,_0x4764eb,_0x18b724):_0x57bb81(_0x29b0e9,_0x4764eb))||_0x18b724;}return _0x5d4074>0x3&&_0x18b724&&Object[_0x3e9752(0x11a)](_0x29b0e9,_0x4764eb,_0x18b724),_0x18b724;},__metadata=this&&this['__metadata']||function(_0x4afcef,_0x1c5eb5){const _0x24f505=a142_0x4293ac;if(typeof Reflect===_0x24f505(0x12c)&&typeof Reflect['metadata']===_0x24f505(0x10b))return Reflect['metadata'](_0x4afcef,_0x1c5eb5);},__param=this&&this['__param']||function(_0x141a12,_0x5b50fd){return function(_0x1328d5,_0x4e1b81){_0x5b50fd(_0x1328d5,_0x4e1b81,_0x141a12);};},TextToAudioController_1;function a142_0x3686(){const _0x3020e1=['object','/:id','log','8KlsEIe','2131988mzXMku','play','deleteTextMessage','Body','design:returntype','AUDIO_TO_MESSAGE_DIR','There\x20is\x20no\x20message\x20to\x20play','getAllMessage','Success\x20save\x20text:\x20','3bsLSbe','2427586bIktSh','textToAudioService','error','User','./text-to-audio.service','design:paramtypes','../streaming/streaming.service','saveStreamToFile','saveMessage','8240043fBpABq','playAudioFile','./dtos/text.dto','JwtAuthGuard','../common/audio/audio-player','Param','name','.wav','send','../common/constants','volume','../common/file','26591100PpZnwQ','AudioPlayer','./saveStreamToFile','Roles','5XMVFOu','Res','processRootPath','streamingService','function','10838979qTiwDX','logger','design:type','StreamingService','length','Admin','error\x20','text','RolesGuard','458169kGIaBX','prototype','updateTextMessage','@nestjs/common','UseGuards','defineProperty','../auth/enums/role.enum','__decorate','1488726EmHZaE','Controller','isFileExist','TextToAudioService','getOwnPropertyDescriptor','Role','TextToAudioController','__esModule','path','../auth/guards/roles.guard','Logger','../auth/guards/jwt.guard','TextDTO','Post','createFolder'];a142_0x3686=function(){return _0x3020e1;};return a142_0x3686();}Object['defineProperty'](exports,a142_0x4293ac(0x124),{'value':!![]}),exports[a142_0x4293ac(0x123)]=void 0x0;function a142_0xf652(_0xf43ed5,_0x559102){const _0x368676=a142_0x3686();return a142_0xf652=function(_0xf652ab,_0x25dbf3){_0xf652ab=_0xf652ab-0xf1;let _0x4ad063=_0x368676[_0xf652ab];return _0x4ad063;},a142_0xf652(_0xf43ed5,_0x559102);}const common_1=require(a142_0x4293ac(0x118)),text_to_audio_service_1=require(a142_0x4293ac(0xf2)),text_dto_1=require(a142_0x4293ac(0xf9)),streaming_service_1=require(a142_0x4293ac(0xf4)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a142_0x4293ac(0x11b)),jwt_guard_1=require(a142_0x4293ac(0x128)),roles_guard_1=require(a142_0x4293ac(0x126)),saveStreamToFile_1=require(a142_0x4293ac(0x105)),path=require(a142_0x4293ac(0x125)),path_1=require('../common/path'),constants_1=require(a142_0x4293ac(0x100)),file_1=require(a142_0x4293ac(0x102)),audio_player_1=require(a142_0x4293ac(0xfb));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x4cd148,_0x52218c){const _0x1ec22d=a142_0x4293ac;this[_0x1ec22d(0x13b)]=_0x4cd148,this[_0x1ec22d(0x10a)]=_0x52218c,this[_0x1ec22d(0x10d)]=new common_1[(_0x1ec22d(0x127))](TextToAudioController_1[_0x1ec22d(0xfd)]);}async[a142_0x4293ac(0xf8)](_0x988d43,_0x29118b){const _0x221b1b=a142_0x4293ac;try{const _0x672edd=_0x29118b['text'];if(!_0x672edd){_0x988d43[_0x221b1b(0xff)](_0x221b1b(0x136));return;}const {id:_0x109af2,volume:_0x50372c}=await this['textToAudioService'][_0x221b1b(0xf6)](_0x672edd);!(0x0,file_1[_0x221b1b(0x11f)])(constants_1[_0x221b1b(0x135)])&&(0x0,file_1[_0x221b1b(0x12b)])(constants_1[_0x221b1b(0x135)]);const _0x5cb2ea=path['join'](path_1[_0x221b1b(0x109)],constants_1[_0x221b1b(0x135)]),_0x1e2e3c=_0x5cb2ea+'/'+_0x109af2+'.wav';!(0x0,file_1[_0x221b1b(0x11f)])(_0x1e2e3c)?await this[_0x221b1b(0x13b)]['textToAudio'](_0x29118b[_0x221b1b(0x113)],async _0x7f317b=>{const _0x8b1761=_0x221b1b;await(0x0,saveStreamToFile_1[_0x8b1761(0xf5)])(_0x7f317b,_0x5cb2ea+'/'+_0x109af2+_0x8b1761(0xfe)),audio_player_1[_0x8b1761(0x104)]['play'](_0x1e2e3c,_0x50372c!==null&&_0x50372c!==void 0x0?_0x50372c:0x32);}):audio_player_1['AudioPlayer'][_0x221b1b(0x131)](_0x1e2e3c,_0x50372c!==null&&_0x50372c!==void 0x0?_0x50372c:0x32),_0x988d43[_0x221b1b(0xff)]('Success\x20play\x20text\x20to\x20audio:\x20'+_0x29118b['text']);}catch(_0x4fd45e){return this[_0x221b1b(0x10d)][_0x221b1b(0x12e)](_0x4fd45e,_0x221b1b(0x13c)),'';}}async[a142_0x4293ac(0xf6)](_0x4f0f55,_0xa1770c){const _0x265570=a142_0x4293ac;try{const _0xb248cf=_0xa1770c['text'];if(!_0xb248cf){_0x4f0f55[_0x265570(0xff)](_0x265570(0x136));return;}await this[_0x265570(0x13b)][_0x265570(0xf6)](_0xb248cf),_0x4f0f55['send'](_0x265570(0x138)+_0xa1770c['text']);}catch(_0x459597){return this[_0x265570(0x10d)][_0x265570(0x12e)](_0x459597,_0x265570(0x112)),'';}}async[a142_0x4293ac(0x137)](){const _0x1569ea=a142_0x4293ac;try{const _0x34d7d8=await this[_0x1569ea(0x13b)]['getMessages']();return _0x34d7d8!==null&&_0x34d7d8!==void 0x0?_0x34d7d8:[];}catch(_0x3e1393){return this['logger'][_0x1569ea(0x12e)](_0x3e1393,_0x1569ea(0x13c)),'';}}[a142_0x4293ac(0x132)](_0x114ae7){const _0x50c614=a142_0x4293ac;return this[_0x50c614(0x13b)][_0x50c614(0x132)](_0x114ae7);}['updateTextMessage'](_0x42af95,_0x358412){const _0x4ad8c6=a142_0x4293ac;var _0x1e90fd;return this[_0x4ad8c6(0x13b)][_0x4ad8c6(0x117)](_0x42af95,Object['assign'](Object['assign']({},_0x358412),{'volume':(_0x1e90fd=_0x358412[_0x4ad8c6(0x101)])!==null&&_0x1e90fd!==void 0x0?_0x1e90fd:0x32}));}};__decorate([(0x0,common_1[a142_0x4293ac(0x12a)])('/'),(0x0,common_1[a142_0x4293ac(0x119)])(jwt_guard_1[a142_0x4293ac(0xfa)],roles_guard_1[a142_0x4293ac(0x114)]),(0x0,roles_decorator_1[a142_0x4293ac(0x106)])(role_enum_1[a142_0x4293ac(0x122)]['Admin'],role_enum_1[a142_0x4293ac(0x122)]['User']),__param(0x0,(0x0,common_1[a142_0x4293ac(0x108)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x4293ac(0x133)])()),__metadata(a142_0x4293ac(0x10e),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x4293ac(0x129)]]),__metadata(a142_0x4293ac(0x134),Promise)],TextToAudioController[a142_0x4293ac(0x116)],'playAudioFile',null),__decorate([(0x0,common_1['Post'])(a142_0x4293ac(0xf6)),(0x0,common_1[a142_0x4293ac(0x119)])(jwt_guard_1[a142_0x4293ac(0xfa)],roles_guard_1[a142_0x4293ac(0x114)]),(0x0,roles_decorator_1[a142_0x4293ac(0x106)])(role_enum_1['Role'][a142_0x4293ac(0x111)],role_enum_1[a142_0x4293ac(0x122)][a142_0x4293ac(0xf1)]),__param(0x0,(0x0,common_1[a142_0x4293ac(0x108)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x4293ac(0x133)])()),__metadata(a142_0x4293ac(0x10e),Function),__metadata(a142_0x4293ac(0xf3),[Object,text_dto_1[a142_0x4293ac(0x129)]]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x4293ac(0x116)],a142_0x4293ac(0xf6),null),__decorate([(0x0,common_1['Get'])('/message'),(0x0,common_1[a142_0x4293ac(0x119)])(jwt_guard_1[a142_0x4293ac(0xfa)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x4293ac(0x106)])(role_enum_1[a142_0x4293ac(0x122)][a142_0x4293ac(0x111)],role_enum_1[a142_0x4293ac(0x122)][a142_0x4293ac(0xf1)]),__metadata('design:type',Function),__metadata(a142_0x4293ac(0xf3),[]),__metadata(a142_0x4293ac(0x134),Promise)],TextToAudioController[a142_0x4293ac(0x116)],'getAllMessage',null),__decorate([(0x0,common_1['Delete'])(a142_0x4293ac(0x12d)),(0x0,common_1[a142_0x4293ac(0x119)])(jwt_guard_1[a142_0x4293ac(0xfa)],roles_guard_1[a142_0x4293ac(0x114)]),(0x0,roles_decorator_1[a142_0x4293ac(0x106)])(role_enum_1['Role']['Admin'],role_enum_1[a142_0x4293ac(0x122)][a142_0x4293ac(0xf1)]),__param(0x0,(0x0,common_1[a142_0x4293ac(0xfc)])('id')),__metadata(a142_0x4293ac(0x10e),Function),__metadata('design:paramtypes',[String]),__metadata(a142_0x4293ac(0x134),void 0x0)],TextToAudioController[a142_0x4293ac(0x116)],a142_0x4293ac(0x132),null),__decorate([(0x0,common_1['Put'])(a142_0x4293ac(0x12d)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x4293ac(0xfa)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x4293ac(0x122)]['Admin'],role_enum_1[a142_0x4293ac(0x122)][a142_0x4293ac(0xf1)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a142_0x4293ac(0x133)])()),__metadata(a142_0x4293ac(0x10e),Function),__metadata(a142_0x4293ac(0xf3),[String,text_dto_1[a142_0x4293ac(0x129)]]),__metadata(a142_0x4293ac(0x134),void 0x0)],TextToAudioController[a142_0x4293ac(0x116)],a142_0x4293ac(0x117),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x4293ac(0x11e)])('textToAudio'),__metadata(a142_0x4293ac(0xf3),[text_to_audio_service_1[a142_0x4293ac(0x120)],streaming_service_1[a142_0x4293ac(0x10f)]])],TextToAudioController),exports[a142_0x4293ac(0x123)]=TextToAudioController;