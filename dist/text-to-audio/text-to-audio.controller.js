'use strict';function a142_0x2295(){const _0x190619=['Admin','../auth/decorators/roles.decorator','processRootPath','10497870nwwJHU','17519777ZXbSsK','7929882mVIaWq','textToAudioService','textToAudio','Logger','error\x20','.wav','text','deleteTextMessage','createFolder','Controller','design:paramtypes','Roles','send','play','error','log','saveMessage','JwtAuthGuard','prototype','assign','function','Role','Body','There\x20is\x20no\x20message\x20to\x20play','path','AUDIO_TO_MESSAGE_DIR','isFileExist','29102eABjRg','metadata','playAudioFile','logger','Post','../streaming/streaming.service','Param','design:type','./text-to-audio.service','updateTextMessage','AudioPlayer','object','RolesGuard','design:returntype','decorate','7899360aoPpdb','defineProperty','/message','TextToAudioService','Success\x20play\x20text\x20to\x20audio:\x20','TextDTO','Res','saveStreamToFile','getMessages','./dtos/text.dto','50sKyhmH','174432QSGmPe','@nestjs/common','497dtpPNE','__param','476ynOPBk','UseGuards','name','getOwnPropertyDescriptor','streamingService','Get','join','TextToAudioController','10389seyHgn','../common/audio/audio-player','User','5eyPQXb'];a142_0x2295=function(){return _0x190619;};return a142_0x2295();}const a142_0x27699f=a142_0x3317;function a142_0x3317(_0x37d76d,_0x35d8bc){const _0x229532=a142_0x2295();return a142_0x3317=function(_0x3317c8,_0x285d86){_0x3317c8=_0x3317c8-0x17b;let _0x234274=_0x229532[_0x3317c8];return _0x234274;},a142_0x3317(_0x37d76d,_0x35d8bc);}(function(_0x5b9f63,_0x498698){const _0xc5fbb8=a142_0x3317,_0x3a3e1a=_0x5b9f63();while(!![]){try{const _0x10f9c4=parseInt(_0xc5fbb8(0x17d))/0x1*(-parseInt(_0xc5fbb8(0x1ae))/0x2)+parseInt(_0xc5fbb8(0x18a))/0x3*(parseInt(_0xc5fbb8(0x182))/0x4)+parseInt(_0xc5fbb8(0x18d))/0x5*(parseInt(_0xc5fbb8(0x1bd))/0x6)+-parseInt(_0xc5fbb8(0x180))/0x7*(parseInt(_0xc5fbb8(0x17e))/0x8)+parseInt(_0xc5fbb8(0x193))/0x9+-parseInt(_0xc5fbb8(0x191))/0xa+parseInt(_0xc5fbb8(0x192))/0xb;if(_0x10f9c4===_0x498698)break;else _0x3a3e1a['push'](_0x3a3e1a['shift']());}catch(_0x137f9f){_0x3a3e1a['push'](_0x3a3e1a['shift']());}}}(a142_0x2295,0xd61f1));var __decorate=this&&this['__decorate']||function(_0x4400c0,_0x24dbcd,_0x5b50ba,_0x3f5141){const _0x1b1acb=a142_0x3317;var _0x38fbcf=arguments['length'],_0x946cab=_0x38fbcf<0x3?_0x24dbcd:_0x3f5141===null?_0x3f5141=Object[_0x1b1acb(0x185)](_0x24dbcd,_0x5b50ba):_0x3f5141,_0x2c41e8;if(typeof Reflect===_0x1b1acb(0x1b9)&&typeof Reflect[_0x1b1acb(0x1bc)]===_0x1b1acb(0x1a7))_0x946cab=Reflect[_0x1b1acb(0x1bc)](_0x4400c0,_0x24dbcd,_0x5b50ba,_0x3f5141);else{for(var _0x32b88f=_0x4400c0['length']-0x1;_0x32b88f>=0x0;_0x32b88f--)if(_0x2c41e8=_0x4400c0[_0x32b88f])_0x946cab=(_0x38fbcf<0x3?_0x2c41e8(_0x946cab):_0x38fbcf>0x3?_0x2c41e8(_0x24dbcd,_0x5b50ba,_0x946cab):_0x2c41e8(_0x24dbcd,_0x5b50ba))||_0x946cab;}return _0x38fbcf>0x3&&_0x946cab&&Object[_0x1b1acb(0x1be)](_0x24dbcd,_0x5b50ba,_0x946cab),_0x946cab;},__metadata=this&&this['__metadata']||function(_0x1a9ee9,_0x2d9ed8){const _0x4a75a7=a142_0x3317;if(typeof Reflect===_0x4a75a7(0x1b9)&&typeof Reflect[_0x4a75a7(0x1af)]===_0x4a75a7(0x1a7))return Reflect[_0x4a75a7(0x1af)](_0x1a9ee9,_0x2d9ed8);},__param=this&&this[a142_0x27699f(0x181)]||function(_0x3e2fcf,_0x2faddb){return function(_0x32c12d,_0xdff2d5){_0x2faddb(_0x32c12d,_0xdff2d5,_0x3e2fcf);};},TextToAudioController_1;Object[a142_0x27699f(0x1be)](exports,'__esModule',{'value':!![]}),exports[a142_0x27699f(0x189)]=void 0x0;const common_1=require(a142_0x27699f(0x17f)),text_to_audio_service_1=require(a142_0x27699f(0x1b6)),text_dto_1=require(a142_0x27699f(0x17c)),streaming_service_1=require(a142_0x27699f(0x1b3)),roles_decorator_1=require(a142_0x27699f(0x18f)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a142_0x27699f(0x1ab)),path_1=require('../common/path'),constants_1=require('../common/constants'),file_1=require('../common/file'),audio_player_1=require(a142_0x27699f(0x18b));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x281c8a,_0x2bf688){const _0x1b78a5=a142_0x27699f;this[_0x1b78a5(0x194)]=_0x281c8a,this[_0x1b78a5(0x186)]=_0x2bf688,this['logger']=new common_1[(_0x1b78a5(0x196))](TextToAudioController_1[_0x1b78a5(0x184)]);}async[a142_0x27699f(0x1b0)](_0x4baca2,_0x14f9d5){const _0x20de75=a142_0x27699f;try{const _0x285373=_0x14f9d5[_0x20de75(0x199)];if(!_0x285373){_0x4baca2[_0x20de75(0x19f)](_0x20de75(0x1aa));return;}const {id:_0x3a1643,volume:_0x1b8526}=await this[_0x20de75(0x194)][_0x20de75(0x1a3)](_0x285373);!(0x0,file_1[_0x20de75(0x1ad)])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1[_0x20de75(0x19b)])(constants_1[_0x20de75(0x1ac)]);const _0x5c793c=path[_0x20de75(0x188)](path_1[_0x20de75(0x190)],constants_1[_0x20de75(0x1ac)]),_0x2602bf=_0x5c793c+'/'+_0x3a1643+_0x20de75(0x198);!(0x0,file_1[_0x20de75(0x1ad)])(_0x2602bf)?await this[_0x20de75(0x194)][_0x20de75(0x195)](_0x14f9d5[_0x20de75(0x199)],async _0x1a6dc4=>{const _0xe2e3d2=_0x20de75;await(0x0,saveStreamToFile_1[_0xe2e3d2(0x1c4)])(_0x1a6dc4,_0x5c793c+'/'+_0x3a1643+_0xe2e3d2(0x198)),audio_player_1[_0xe2e3d2(0x1b8)][_0xe2e3d2(0x1a0)](_0x2602bf,_0x1b8526!==null&&_0x1b8526!==void 0x0?_0x1b8526:0x32);}):audio_player_1[_0x20de75(0x1b8)]['play'](_0x2602bf,_0x1b8526!==null&&_0x1b8526!==void 0x0?_0x1b8526:0x32),_0x4baca2[_0x20de75(0x19f)](_0x20de75(0x1c1)+_0x14f9d5[_0x20de75(0x199)]);}catch(_0x2ff7e6){return this['logger'][_0x20de75(0x1a2)](_0x2ff7e6,_0x20de75(0x1a1)),'';}}async['saveMessage'](_0x53676b,_0x1d90e3){const _0x4b145e=a142_0x27699f;try{const _0xac4ba3=_0x1d90e3[_0x4b145e(0x199)];if(!_0xac4ba3){_0x53676b[_0x4b145e(0x19f)](_0x4b145e(0x1aa));return;}await this['textToAudioService'][_0x4b145e(0x1a3)](_0xac4ba3),_0x53676b[_0x4b145e(0x19f)]('Success\x20save\x20text:\x20'+_0x1d90e3[_0x4b145e(0x199)]);}catch(_0x185b12){return this[_0x4b145e(0x1b1)][_0x4b145e(0x1a2)](_0x185b12,_0x4b145e(0x197)),'';}}async['getAllMessage'](){const _0xb1512e=a142_0x27699f;try{const _0x7879c=await this[_0xb1512e(0x194)][_0xb1512e(0x17b)]();return _0x7879c!==null&&_0x7879c!==void 0x0?_0x7879c:[];}catch(_0x3949a2){return this[_0xb1512e(0x1b1)][_0xb1512e(0x1a2)](_0x3949a2,'error'),'';}}[a142_0x27699f(0x19a)](_0x3b52de){const _0x2be0ed=a142_0x27699f;return this[_0x2be0ed(0x194)][_0x2be0ed(0x19a)](_0x3b52de);}[a142_0x27699f(0x1b7)](_0xce9f4b,_0x20bd9b){const _0x2fc119=a142_0x27699f;var _0x643b66;return this[_0x2fc119(0x194)][_0x2fc119(0x1b7)](_0xce9f4b,Object[_0x2fc119(0x1a6)](Object[_0x2fc119(0x1a6)]({},_0x20bd9b),{'volume':(_0x643b66=_0x20bd9b['volume'])!==null&&_0x643b66!==void 0x0?_0x643b66:0x32}));}};__decorate([(0x0,common_1[a142_0x27699f(0x1b2)])('/'),(0x0,common_1[a142_0x27699f(0x183)])(jwt_guard_1[a142_0x27699f(0x1a4)],roles_guard_1[a142_0x27699f(0x1ba)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18e)],role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18c)]),__param(0x0,(0x0,common_1[a142_0x27699f(0x1c3)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x27699f(0x1a9)])()),__metadata(a142_0x27699f(0x1b5),Function),__metadata(a142_0x27699f(0x19d),[Object,text_dto_1[a142_0x27699f(0x1c2)]]),__metadata(a142_0x27699f(0x1bb),Promise)],TextToAudioController[a142_0x27699f(0x1a5)],'playAudioFile',null),__decorate([(0x0,common_1[a142_0x27699f(0x1b2)])(a142_0x27699f(0x1a3)),(0x0,common_1[a142_0x27699f(0x183)])(jwt_guard_1[a142_0x27699f(0x1a4)],roles_guard_1[a142_0x27699f(0x1ba)]),(0x0,roles_decorator_1[a142_0x27699f(0x19e)])(role_enum_1['Role'][a142_0x27699f(0x18e)],role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18c)]),__param(0x0,(0x0,common_1[a142_0x27699f(0x1c3)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x27699f(0x1b5),Function),__metadata(a142_0x27699f(0x19d),[Object,text_dto_1[a142_0x27699f(0x1c2)]]),__metadata(a142_0x27699f(0x1bb),Promise)],TextToAudioController[a142_0x27699f(0x1a5)],a142_0x27699f(0x1a3),null),__decorate([(0x0,common_1[a142_0x27699f(0x187)])(a142_0x27699f(0x1bf)),(0x0,common_1[a142_0x27699f(0x183)])(jwt_guard_1[a142_0x27699f(0x1a4)],roles_guard_1[a142_0x27699f(0x1ba)]),(0x0,roles_decorator_1[a142_0x27699f(0x19e)])(role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18e)],role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18c)]),__metadata(a142_0x27699f(0x1b5),Function),__metadata(a142_0x27699f(0x19d),[]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x27699f(0x1a5)],'getAllMessage',null),__decorate([(0x0,common_1['Delete'])('/:id'),(0x0,common_1[a142_0x27699f(0x183)])(jwt_guard_1[a142_0x27699f(0x1a4)],roles_guard_1[a142_0x27699f(0x1ba)]),(0x0,roles_decorator_1[a142_0x27699f(0x19e)])(role_enum_1[a142_0x27699f(0x1a8)]['Admin'],role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18c)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x27699f(0x1b5),Function),__metadata(a142_0x27699f(0x19d),[String]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x27699f(0x1a5)],a142_0x27699f(0x19a),null),__decorate([(0x0,common_1['Put'])('/:id'),(0x0,common_1[a142_0x27699f(0x183)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x27699f(0x1ba)]),(0x0,roles_decorator_1[a142_0x27699f(0x19e)])(role_enum_1['Role'][a142_0x27699f(0x18e)],role_enum_1[a142_0x27699f(0x1a8)][a142_0x27699f(0x18c)]),__param(0x0,(0x0,common_1[a142_0x27699f(0x1b4)])('id')),__param(0x1,(0x0,common_1[a142_0x27699f(0x1a9)])()),__metadata('design:type',Function),__metadata(a142_0x27699f(0x19d),[String,text_dto_1[a142_0x27699f(0x1c2)]]),__metadata(a142_0x27699f(0x1bb),void 0x0)],TextToAudioController['prototype'],'updateTextMessage',null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x27699f(0x19c)])(a142_0x27699f(0x195)),__metadata(a142_0x27699f(0x19d),[text_to_audio_service_1[a142_0x27699f(0x1c0)],streaming_service_1['StreamingService']])],TextToAudioController),exports[a142_0x27699f(0x189)]=TextToAudioController;