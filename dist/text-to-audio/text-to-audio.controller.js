'use strict';function a142_0x4856(){const _0x44d109=['textToAudioService','AudioPlayer','object','streamingService','join','getOwnPropertyDescriptor','Logger','JwtAuthGuard','1644440fCBThr','1421005diQTrR','saveMessage','Body','/message','./dtos/text.dto','prototype','deleteTextMessage','decorate','playAudioFile','./saveStreamToFile','design:paramtypes','getAllMessage','assign','User','RolesGuard','Delete','design:returntype','../auth/guards/jwt.guard','109184eDtZfa','Admin','There\x20is\x20no\x20message\x20to\x20play','design:type','path','createFolder','Param','@nestjs/common','TextToAudioService','function','./text-to-audio.service','Get','../common/audio/audio-player','__esModule','Role','TextDTO','processRootPath','Success\x20save\x20text:\x20','__decorate','9857400TlGXQe','3514mMXgfc','../auth/guards/roles.guard','play','getMessages','1374246VVIHJe','Roles','__param','1813000MywMrg','defineProperty','TextToAudioController','Put','send','1236HEXklw','isFileExist','9BhlYIV','UseGuards','error','../common/path','length','10gDZqsJ','text','Post','AUDIO_TO_MESSAGE_DIR','/:id','logger','log','Res','updateTextMessage','name','StreamingService'];a142_0x4856=function(){return _0x44d109;};return a142_0x4856();}const a142_0x2c7e24=a142_0x865c;(function(_0x57eacc,_0x4d96b2){const _0x26ff7e=a142_0x865c,_0x3fa871=_0x57eacc();while(!![]){try{const _0x837a30=-parseInt(_0x26ff7e(0x96))/0x1*(-parseInt(_0x26ff7e(0xbc))/0x2)+parseInt(_0x26ff7e(0x87))/0x3+parseInt(_0x26ff7e(0x8a))/0x4+-parseInt(_0x26ff7e(0xaa))/0x5+parseInt(_0x26ff7e(0x8f))/0x6*(-parseInt(_0x26ff7e(0xd0))/0x7)+-parseInt(_0x26ff7e(0xa9))/0x8*(-parseInt(_0x26ff7e(0x91))/0x9)+-parseInt(_0x26ff7e(0xcf))/0xa;if(_0x837a30===_0x4d96b2)break;else _0x3fa871['push'](_0x3fa871['shift']());}catch(_0x7ffe60){_0x3fa871['push'](_0x3fa871['shift']());}}}(a142_0x4856,0x46aae));var __decorate=this&&this[a142_0x2c7e24(0xce)]||function(_0x56ab0f,_0x304cbc,_0x32a43d,_0x2f8ab4){const _0x3d68ea=a142_0x2c7e24;var _0x4c4247=arguments[_0x3d68ea(0x95)],_0xecd04d=_0x4c4247<0x3?_0x304cbc:_0x2f8ab4===null?_0x2f8ab4=Object[_0x3d68ea(0xa6)](_0x304cbc,_0x32a43d):_0x2f8ab4,_0x1f9406;if(typeof Reflect===_0x3d68ea(0xa3)&&typeof Reflect['decorate']==='function')_0xecd04d=Reflect[_0x3d68ea(0xb1)](_0x56ab0f,_0x304cbc,_0x32a43d,_0x2f8ab4);else{for(var _0x373243=_0x56ab0f[_0x3d68ea(0x95)]-0x1;_0x373243>=0x0;_0x373243--)if(_0x1f9406=_0x56ab0f[_0x373243])_0xecd04d=(_0x4c4247<0x3?_0x1f9406(_0xecd04d):_0x4c4247>0x3?_0x1f9406(_0x304cbc,_0x32a43d,_0xecd04d):_0x1f9406(_0x304cbc,_0x32a43d))||_0xecd04d;}return _0x4c4247>0x3&&_0xecd04d&&Object[_0x3d68ea(0x8b)](_0x304cbc,_0x32a43d,_0xecd04d),_0xecd04d;},__metadata=this&&this['__metadata']||function(_0x5c36ac,_0xd1ced6){const _0x4dd497=a142_0x2c7e24;if(typeof Reflect===_0x4dd497(0xa3)&&typeof Reflect['metadata']===_0x4dd497(0xc5))return Reflect['metadata'](_0x5c36ac,_0xd1ced6);},__param=this&&this[a142_0x2c7e24(0x89)]||function(_0x38f67b,_0x384b51){return function(_0x319cfd,_0x483b5a){_0x384b51(_0x319cfd,_0x483b5a,_0x38f67b);};},TextToAudioController_1;Object['defineProperty'](exports,a142_0x2c7e24(0xc9),{'value':!![]}),exports[a142_0x2c7e24(0x8c)]=void 0x0;const common_1=require(a142_0x2c7e24(0xc3)),text_to_audio_service_1=require(a142_0x2c7e24(0xc6)),text_dto_1=require(a142_0x2c7e24(0xae)),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a142_0x2c7e24(0xbb)),roles_guard_1=require(a142_0x2c7e24(0xd1)),saveStreamToFile_1=require(a142_0x2c7e24(0xb3)),path=require(a142_0x2c7e24(0xc0)),path_1=require(a142_0x2c7e24(0x94)),constants_1=require('../common/constants'),file_1=require('../common/file'),audio_player_1=require(a142_0x2c7e24(0xc8));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x523c45,_0x2b762c){const _0x272d0a=a142_0x2c7e24;this['textToAudioService']=_0x523c45,this[_0x272d0a(0xa4)]=_0x2b762c,this[_0x272d0a(0x9b)]=new common_1[(_0x272d0a(0xa7))](TextToAudioController_1[_0x272d0a(0x9f)]);}async['playAudioFile'](_0x56d8c8,_0x4a9fa5){const _0x36888b=a142_0x2c7e24;try{const _0x5d8585=_0x4a9fa5[_0x36888b(0x97)];if(!_0x5d8585){_0x56d8c8[_0x36888b(0x8e)](_0x36888b(0xbe));return;}const {id:_0x27713d,volume:_0xb516d1}=await this['textToAudioService']['saveMessage'](_0x5d8585);!(0x0,file_1['isFileExist'])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1[_0x36888b(0xc1)])(constants_1[_0x36888b(0x99)]);const _0x5bba16=path[_0x36888b(0xa5)](path_1[_0x36888b(0xcc)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x59934b=_0x5bba16+'/'+_0x27713d+'.wav';!(0x0,file_1[_0x36888b(0x90)])(_0x59934b)?await this[_0x36888b(0xa1)]['textToAudio'](_0x4a9fa5[_0x36888b(0x97)],async _0x5b466f=>{const _0x16a310=_0x36888b;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x5b466f,_0x5bba16+'/'+_0x27713d+'.wav'),audio_player_1[_0x16a310(0xa2)][_0x16a310(0xd2)](_0x59934b,_0xb516d1!==null&&_0xb516d1!==void 0x0?_0xb516d1:0x32);}):audio_player_1[_0x36888b(0xa2)][_0x36888b(0xd2)](_0x59934b,_0xb516d1!==null&&_0xb516d1!==void 0x0?_0xb516d1:0x32),_0x56d8c8[_0x36888b(0x8e)]('Success\x20play\x20text\x20to\x20audio:\x20'+_0x4a9fa5[_0x36888b(0x97)]);}catch(_0x787819){return this['logger'][_0x36888b(0x9c)](_0x787819,'error'),'';}}async[a142_0x2c7e24(0xab)](_0x4d0470,_0x26646f){const _0xe25ff1=a142_0x2c7e24;try{const _0x39f4b0=_0x26646f[_0xe25ff1(0x97)];if(!_0x39f4b0){_0x4d0470[_0xe25ff1(0x8e)](_0xe25ff1(0xbe));return;}await this[_0xe25ff1(0xa1)][_0xe25ff1(0xab)](_0x39f4b0),_0x4d0470[_0xe25ff1(0x8e)](_0xe25ff1(0xcd)+_0x26646f[_0xe25ff1(0x97)]);}catch(_0x5bb9b3){return this[_0xe25ff1(0x9b)][_0xe25ff1(0x9c)](_0x5bb9b3,'error\x20'),'';}}async[a142_0x2c7e24(0xb5)](){const _0x1cee3f=a142_0x2c7e24;try{const _0x34d19d=await this[_0x1cee3f(0xa1)][_0x1cee3f(0xd3)]();return _0x34d19d!==null&&_0x34d19d!==void 0x0?_0x34d19d:[];}catch(_0x5b3c68){return this[_0x1cee3f(0x9b)][_0x1cee3f(0x9c)](_0x5b3c68,_0x1cee3f(0x93)),'';}}[a142_0x2c7e24(0xb0)](_0x13a2f0){const _0x3f0297=a142_0x2c7e24;return this[_0x3f0297(0xa1)][_0x3f0297(0xb0)](_0x13a2f0);}[a142_0x2c7e24(0x9e)](_0x5b506f,_0x442f66){const _0x69fbaa=a142_0x2c7e24;var _0x4735d8;return this[_0x69fbaa(0xa1)][_0x69fbaa(0x9e)](_0x5b506f,Object[_0x69fbaa(0xb6)](Object[_0x69fbaa(0xb6)]({},_0x442f66),{'volume':(_0x4735d8=_0x442f66['volume'])!==null&&_0x4735d8!==void 0x0?_0x4735d8:0x32}));}};function a142_0x865c(_0x55f8f0,_0x4a036b){const _0x4856c1=a142_0x4856();return a142_0x865c=function(_0x865c18,_0x508f76){_0x865c18=_0x865c18-0x87;let _0x523e2d=_0x4856c1[_0x865c18];return _0x523e2d;},a142_0x865c(_0x55f8f0,_0x4a036b);}__decorate([(0x0,common_1[a142_0x2c7e24(0x98)])('/'),(0x0,common_1[a142_0x2c7e24(0x92)])(jwt_guard_1[a142_0x2c7e24(0xa8)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x2c7e24(0x88)])(role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xbd)],role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xb7)]),__param(0x0,(0x0,common_1[a142_0x2c7e24(0x9d)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x2c7e24(0xbf),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x2c7e24(0xcb)]]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x2c7e24(0xaf)],a142_0x2c7e24(0xb2),null),__decorate([(0x0,common_1['Post'])(a142_0x2c7e24(0xab)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x2c7e24(0xa8)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x2c7e24(0x88)])(role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xbd)],role_enum_1[a142_0x2c7e24(0xca)]['User']),__param(0x0,(0x0,common_1[a142_0x2c7e24(0x9d)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x2c7e24(0xac)])()),__metadata(a142_0x2c7e24(0xbf),Function),__metadata(a142_0x2c7e24(0xb4),[Object,text_dto_1[a142_0x2c7e24(0xcb)]]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x2c7e24(0xaf)],a142_0x2c7e24(0xab),null),__decorate([(0x0,common_1[a142_0x2c7e24(0xc7)])(a142_0x2c7e24(0xad)),(0x0,common_1[a142_0x2c7e24(0x92)])(jwt_guard_1[a142_0x2c7e24(0xa8)],roles_guard_1[a142_0x2c7e24(0xb8)]),(0x0,roles_decorator_1[a142_0x2c7e24(0x88)])(role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xbd)],role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xb7)]),__metadata('design:type',Function),__metadata(a142_0x2c7e24(0xb4),[]),__metadata(a142_0x2c7e24(0xba),Promise)],TextToAudioController['prototype'],a142_0x2c7e24(0xb5),null),__decorate([(0x0,common_1[a142_0x2c7e24(0xb9)])(a142_0x2c7e24(0x9a)),(0x0,common_1[a142_0x2c7e24(0x92)])(jwt_guard_1[a142_0x2c7e24(0xa8)],roles_guard_1[a142_0x2c7e24(0xb8)]),(0x0,roles_decorator_1[a142_0x2c7e24(0x88)])(role_enum_1[a142_0x2c7e24(0xca)]['Admin'],role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xb7)]),__param(0x0,(0x0,common_1[a142_0x2c7e24(0xc2)])('id')),__metadata(a142_0x2c7e24(0xbf),Function),__metadata(a142_0x2c7e24(0xb4),[String]),__metadata(a142_0x2c7e24(0xba),void 0x0)],TextToAudioController['prototype'],a142_0x2c7e24(0xb0),null),__decorate([(0x0,common_1[a142_0x2c7e24(0x8d)])(a142_0x2c7e24(0x9a)),(0x0,common_1[a142_0x2c7e24(0x92)])(jwt_guard_1[a142_0x2c7e24(0xa8)],roles_guard_1[a142_0x2c7e24(0xb8)]),(0x0,roles_decorator_1[a142_0x2c7e24(0x88)])(role_enum_1[a142_0x2c7e24(0xca)][a142_0x2c7e24(0xbd)],role_enum_1[a142_0x2c7e24(0xca)]['User']),__param(0x0,(0x0,common_1[a142_0x2c7e24(0xc2)])('id')),__param(0x1,(0x0,common_1[a142_0x2c7e24(0xac)])()),__metadata(a142_0x2c7e24(0xbf),Function),__metadata(a142_0x2c7e24(0xb4),[String,text_dto_1[a142_0x2c7e24(0xcb)]]),__metadata(a142_0x2c7e24(0xba),void 0x0)],TextToAudioController[a142_0x2c7e24(0xaf)],a142_0x2c7e24(0x9e),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])('textToAudio'),__metadata('design:paramtypes',[text_to_audio_service_1[a142_0x2c7e24(0xc4)],streaming_service_1[a142_0x2c7e24(0xa0)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;