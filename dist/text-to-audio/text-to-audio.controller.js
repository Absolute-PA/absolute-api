'use strict';const a145_0x38a417=a145_0x2651;(function(_0x163204,_0x3a24f0){const _0x2aabbd=a145_0x2651,_0x45ddef=_0x163204();while(!![]){try{const _0x2da2ca=-parseInt(_0x2aabbd(0xd0))/0x1*(parseInt(_0x2aabbd(0xc4))/0x2)+parseInt(_0x2aabbd(0xd5))/0x3+-parseInt(_0x2aabbd(0xa4))/0x4+-parseInt(_0x2aabbd(0x94))/0x5+parseInt(_0x2aabbd(0xc3))/0x6*(-parseInt(_0x2aabbd(0xd3))/0x7)+-parseInt(_0x2aabbd(0xcd))/0x8+parseInt(_0x2aabbd(0xd6))/0x9;if(_0x2da2ca===_0x3a24f0)break;else _0x45ddef['push'](_0x45ddef['shift']());}catch(_0x462026){_0x45ddef['push'](_0x45ddef['shift']());}}}(a145_0x5035,0x758f1));function a145_0x2651(_0x4d0516,_0x2b9c42){const _0x50359c=a145_0x5035();return a145_0x2651=function(_0x2651ad,_0x2a4d64){_0x2651ad=_0x2651ad-0x88;let _0x40c6e0=_0x50359c[_0x2651ad];return _0x40c6e0;},a145_0x2651(_0x4d0516,_0x2b9c42);}var __decorate=this&&this[a145_0x38a417(0x9a)]||function(_0x411f57,_0x3935e2,_0x3eb938,_0x227d7e){const _0x85b5ed=a145_0x38a417;var _0x45097b=arguments[_0x85b5ed(0xd1)],_0x46436e=_0x45097b<0x3?_0x3935e2:_0x227d7e===null?_0x227d7e=Object[_0x85b5ed(0xcb)](_0x3935e2,_0x3eb938):_0x227d7e,_0x37a50b;if(typeof Reflect===_0x85b5ed(0x8a)&&typeof Reflect[_0x85b5ed(0xb6)]===_0x85b5ed(0x89))_0x46436e=Reflect[_0x85b5ed(0xb6)](_0x411f57,_0x3935e2,_0x3eb938,_0x227d7e);else{for(var _0x4f18f0=_0x411f57[_0x85b5ed(0xd1)]-0x1;_0x4f18f0>=0x0;_0x4f18f0--)if(_0x37a50b=_0x411f57[_0x4f18f0])_0x46436e=(_0x45097b<0x3?_0x37a50b(_0x46436e):_0x45097b>0x3?_0x37a50b(_0x3935e2,_0x3eb938,_0x46436e):_0x37a50b(_0x3935e2,_0x3eb938))||_0x46436e;}return _0x45097b>0x3&&_0x46436e&&Object[_0x85b5ed(0x9c)](_0x3935e2,_0x3eb938,_0x46436e),_0x46436e;},__metadata=this&&this['__metadata']||function(_0x2bf9eb,_0x1c6459){const _0xf73792=a145_0x38a417;if(typeof Reflect===_0xf73792(0x8a)&&typeof Reflect[_0xf73792(0x8d)]===_0xf73792(0x89))return Reflect[_0xf73792(0x8d)](_0x2bf9eb,_0x1c6459);},__param=this&&this[a145_0x38a417(0x8e)]||function(_0x11ed29,_0x2502d5){return function(_0x50bd24,_0x37d944){_0x2502d5(_0x50bd24,_0x37d944,_0x11ed29);};},TextToAudioController_1;Object['defineProperty'](exports,a145_0x38a417(0xaa),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require(a145_0x38a417(0xc2)),text_to_audio_service_1=require(a145_0x38a417(0x88)),text_dto_1=require(a145_0x38a417(0xb8)),streaming_service_1=require(a145_0x38a417(0x8f)),roles_decorator_1=require(a145_0x38a417(0x92)),role_enum_1=require(a145_0x38a417(0xd2)),jwt_guard_1=require(a145_0x38a417(0xc0)),roles_guard_1=require(a145_0x38a417(0xa6)),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a145_0x38a417(0xa8)),path_1=require(a145_0x38a417(0xb5)),constants_1=require(a145_0x38a417(0xbf)),file_1=require(a145_0x38a417(0x95)),audio_player_1=require('../common/audio/audio-player');let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x45baf5,_0x57d3a2){const _0x41b605=a145_0x38a417;this['textToAudioService']=_0x45baf5,this[_0x41b605(0x8c)]=_0x57d3a2,this[_0x41b605(0xa1)]=new common_1[(_0x41b605(0xcc))](TextToAudioController_1[_0x41b605(0xab)]);}async[a145_0x38a417(0x96)](_0x3df5a8,_0x137ed2){const _0x434cb1=a145_0x38a417;try{const _0x2a2c7f=_0x137ed2[_0x434cb1(0xd8)];if(!_0x2a2c7f){_0x3df5a8[_0x434cb1(0xc9)](_0x434cb1(0xc6));return;}const {id:_0x6307dc,volume:_0x43117e}=await this[_0x434cb1(0xc1)][_0x434cb1(0x90)](_0x2a2c7f);!(0x0,file_1[_0x434cb1(0x9e)])(constants_1[_0x434cb1(0xc7)])&&(0x0,file_1[_0x434cb1(0xce)])(constants_1[_0x434cb1(0xc7)]);const _0xfbd6ba=path[_0x434cb1(0x9f)](path_1[_0x434cb1(0xb7)],constants_1[_0x434cb1(0xc7)]),_0x3ae791=_0xfbd6ba+'/'+_0x6307dc+_0x434cb1(0xb0);!(0x0,file_1[_0x434cb1(0x9e)])(_0x3ae791)?await this[_0x434cb1(0xc1)]['textToAudio'](_0x137ed2[_0x434cb1(0xd8)],async _0x1f7ffd=>{const _0x26b5a0=_0x434cb1;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x1f7ffd,_0xfbd6ba+'/'+_0x6307dc+_0x26b5a0(0xb0)),audio_player_1[_0x26b5a0(0xcf)]['play'](_0x3ae791,_0x43117e!==null&&_0x43117e!==void 0x0?_0x43117e:0x32);}):audio_player_1['AudioPlayer'][_0x434cb1(0xbb)](_0x3ae791,_0x43117e!==null&&_0x43117e!==void 0x0?_0x43117e:0x32),_0x3df5a8[_0x434cb1(0xc9)](_0x434cb1(0xb1)+_0x137ed2[_0x434cb1(0xd8)]);}catch(_0x5bb0d2){return this['logger'][_0x434cb1(0xd4)](_0x5bb0d2,_0x434cb1(0xa0)),'';}}async[a145_0x38a417(0x90)](_0x20d43e,_0x504e78){const _0x8aaabc=a145_0x38a417;try{const _0x2fae45=_0x504e78[_0x8aaabc(0xd8)];if(!_0x2fae45){_0x20d43e['send'](_0x8aaabc(0xc6));return;}await this['textToAudioService']['saveMessage'](_0x2fae45),_0x20d43e['send']('Success\x20save\x20text:\x20'+_0x504e78[_0x8aaabc(0xd8)]);}catch(_0x511aec){return this['logger'][_0x8aaabc(0xd4)](_0x511aec,'error\x20'),'';}}async[a145_0x38a417(0x9b)](){const _0x249abb=a145_0x38a417;try{const _0x14bf30=await this[_0x249abb(0xc1)]['getMessages']();return _0x14bf30!==null&&_0x14bf30!==void 0x0?_0x14bf30:[];}catch(_0x4775bb){return this[_0x249abb(0xa1)]['log'](_0x4775bb,_0x249abb(0xa0)),'';}}[a145_0x38a417(0xba)](_0x541267){const _0x432b0f=a145_0x38a417;return this[_0x432b0f(0xc1)][_0x432b0f(0xba)](_0x541267);}[a145_0x38a417(0x98)](_0x2850d2,_0x36ee37){const _0x1171a3=a145_0x38a417;var _0x4eb341;return this[_0x1171a3(0xc1)][_0x1171a3(0x98)](_0x2850d2,Object[_0x1171a3(0xa5)](Object[_0x1171a3(0xa5)]({},_0x36ee37),{'volume':(_0x4eb341=_0x36ee37[_0x1171a3(0xa2)])!==null&&_0x4eb341!==void 0x0?_0x4eb341:0x32}));}};function a145_0x5035(){const _0x12be11=['../auth/enums/role.enum','2916508IgCTwF','log','563718fnLnLk','14304312RhwCiL','Delete','text','./text-to-audio.service','function','object','prototype','streamingService','metadata','__param','../streaming/streaming.service','saveMessage','Param','../auth/decorators/roles.decorator','Roles','308425ukmOFV','../common/file','playAudioFile','TextDTO','updateTextMessage','design:paramtypes','__decorate','getAllMessage','defineProperty','TextToAudioService','isFileExist','join','error','logger','volume','UseGuards','590944BQHePd','assign','../auth/guards/roles.guard','Res','path','JwtAuthGuard','__esModule','name','StreamingService','Admin','Put','Body','.wav','Success\x20play\x20text\x20to\x20audio:\x20','/:id','design:type','Role','../common/path','decorate','processRootPath','./dtos/text.dto','User','deleteTextMessage','play','design:returntype','Controller','RolesGuard','../common/constants','../auth/guards/jwt.guard','textToAudioService','@nestjs/common','6NrUpei','7166eJvjtC','TextToAudioController','There\x20is\x20no\x20message\x20to\x20play','AUDIO_TO_MESSAGE_DIR','/message','send','Post','getOwnPropertyDescriptor','Logger','4354264BPrfvu','createFolder','AudioPlayer','35ZGVSHD','length'];a145_0x5035=function(){return _0x12be11;};return a145_0x5035();}__decorate([(0x0,common_1[a145_0x38a417(0xca)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a145_0x38a417(0xa9)],roles_guard_1[a145_0x38a417(0xbe)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a145_0x38a417(0xad)],role_enum_1[a145_0x38a417(0xb4)]['User']),__param(0x0,(0x0,common_1[a145_0x38a417(0xa7)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x38a417(0xaf)])()),__metadata(a145_0x38a417(0xb3),Function),__metadata(a145_0x38a417(0x99),[Object,text_dto_1[a145_0x38a417(0x97)]]),__metadata(a145_0x38a417(0xbc),Promise)],TextToAudioController['prototype'],a145_0x38a417(0x96),null),__decorate([(0x0,common_1['Post'])(a145_0x38a417(0x90)),(0x0,common_1[a145_0x38a417(0xa3)])(jwt_guard_1[a145_0x38a417(0xa9)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x38a417(0x93)])(role_enum_1[a145_0x38a417(0xb4)][a145_0x38a417(0xad)],role_enum_1[a145_0x38a417(0xb4)]['User']),__param(0x0,(0x0,common_1[a145_0x38a417(0xa7)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x38a417(0xb3),Function),__metadata('design:paramtypes',[Object,text_dto_1[a145_0x38a417(0x97)]]),__metadata(a145_0x38a417(0xbc),Promise)],TextToAudioController['prototype'],a145_0x38a417(0x90),null),__decorate([(0x0,common_1['Get'])(a145_0x38a417(0xc8)),(0x0,common_1[a145_0x38a417(0xa3)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x38a417(0xbe)]),(0x0,roles_decorator_1[a145_0x38a417(0x93)])(role_enum_1['Role'][a145_0x38a417(0xad)],role_enum_1['Role'][a145_0x38a417(0xb9)]),__metadata(a145_0x38a417(0xb3),Function),__metadata(a145_0x38a417(0x99),[]),__metadata(a145_0x38a417(0xbc),Promise)],TextToAudioController['prototype'],a145_0x38a417(0x9b),null),__decorate([(0x0,common_1[a145_0x38a417(0xd7)])('/:id'),(0x0,common_1[a145_0x38a417(0xa3)])(jwt_guard_1[a145_0x38a417(0xa9)],roles_guard_1[a145_0x38a417(0xbe)]),(0x0,roles_decorator_1[a145_0x38a417(0x93)])(role_enum_1[a145_0x38a417(0xb4)][a145_0x38a417(0xad)],role_enum_1[a145_0x38a417(0xb4)][a145_0x38a417(0xb9)]),__param(0x0,(0x0,common_1[a145_0x38a417(0x91)])('id')),__metadata(a145_0x38a417(0xb3),Function),__metadata(a145_0x38a417(0x99),[String]),__metadata(a145_0x38a417(0xbc),void 0x0)],TextToAudioController['prototype'],a145_0x38a417(0xba),null),__decorate([(0x0,common_1[a145_0x38a417(0xae)])(a145_0x38a417(0xb2)),(0x0,common_1[a145_0x38a417(0xa3)])(jwt_guard_1[a145_0x38a417(0xa9)],roles_guard_1[a145_0x38a417(0xbe)]),(0x0,roles_decorator_1[a145_0x38a417(0x93)])(role_enum_1[a145_0x38a417(0xb4)][a145_0x38a417(0xad)],role_enum_1[a145_0x38a417(0xb4)][a145_0x38a417(0xb9)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a145_0x38a417(0xaf)])()),__metadata(a145_0x38a417(0xb3),Function),__metadata(a145_0x38a417(0x99),[String,text_dto_1[a145_0x38a417(0x97)]]),__metadata(a145_0x38a417(0xbc),void 0x0)],TextToAudioController[a145_0x38a417(0x8b)],a145_0x38a417(0x98),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x38a417(0xbd)])('textToAudio'),__metadata(a145_0x38a417(0x99),[text_to_audio_service_1[a145_0x38a417(0x9d)],streaming_service_1[a145_0x38a417(0xac)]])],TextToAudioController),exports[a145_0x38a417(0xc5)]=TextToAudioController;