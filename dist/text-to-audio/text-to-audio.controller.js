'use strict';const a145_0x31a9cd=a145_0x2db8;(function(_0x5c688d,_0xa68344){const _0x5c9c4a=a145_0x2db8,_0x21c074=_0x5c688d();while(!![]){try{const _0xbfb1cf=-parseInt(_0x5c9c4a(0xbc))/0x1+-parseInt(_0x5c9c4a(0xb9))/0x2+parseInt(_0x5c9c4a(0xa9))/0x3+-parseInt(_0x5c9c4a(0xc8))/0x4+-parseInt(_0x5c9c4a(0xab))/0x5*(parseInt(_0x5c9c4a(0xc0))/0x6)+-parseInt(_0x5c9c4a(0xc7))/0x7+parseInt(_0x5c9c4a(0xb4))/0x8;if(_0xbfb1cf===_0xa68344)break;else _0x21c074['push'](_0x21c074['shift']());}catch(_0x212702){_0x21c074['push'](_0x21c074['shift']());}}}(a145_0x462d,0x78f11));function a145_0x2db8(_0x2fbaa4,_0x32229b){const _0x462d54=a145_0x462d();return a145_0x2db8=function(_0x2db847,_0x4344ad){_0x2db847=_0x2db847-0xa5;let _0x3ea2c6=_0x462d54[_0x2db847];return _0x3ea2c6;},a145_0x2db8(_0x2fbaa4,_0x32229b);}function a145_0x462d(){const _0x497520=['../common/constants','textToAudioService','UseGuards','getMessages','RolesGuard','/:id','../common/audio/audio-player','decorate','join','../common/path','textToAudio','prototype','error\x20','design:returntype','Controller','AudioPlayer','send','Admin','Body','volume','saveStreamToFile','TextToAudioService','playAudioFile','JwtAuthGuard','./text-to-audio.service','../auth/enums/role.enum','AUDIO_TO_MESSAGE_DIR','play','../auth/guards/roles.guard','deleteTextMessage','TextToAudioController','../streaming/streaming.service','.wav','metadata','name','Roles','logger','__param','object','Success\x20play\x20text\x20to\x20audio:\x20','error','isFileExist','assign','Logger','../common/file','saveMessage','2888382IxwkHs','getOwnPropertyDescriptor','2185BFOyGq','design:type','length','log','design:paramtypes','Role','../auth/guards/jwt.guard','Res','StreamingService','17444008ohGEks','Delete','text','updateTextMessage','function','674846KyEJQi','./saveStreamToFile','__decorate','874967YJPfUM','__metadata','getAllMessage','TextDTO','5514bagpOy','defineProperty','User','__esModule','Post','processRootPath','Put','4608142IydNPh','1502476UYasOH'];a145_0x462d=function(){return _0x497520;};return a145_0x462d();}var __decorate=this&&this[a145_0x31a9cd(0xbb)]||function(_0xc126f9,_0x17c289,_0x51dbc6,_0x262464){const _0x210e2d=a145_0x31a9cd;var _0x4ee40e=arguments['length'],_0x113307=_0x4ee40e<0x3?_0x17c289:_0x262464===null?_0x262464=Object[_0x210e2d(0xaa)](_0x17c289,_0x51dbc6):_0x262464,_0x390bbb;if(typeof Reflect===_0x210e2d(0xef)&&typeof Reflect[_0x210e2d(0xd0)]===_0x210e2d(0xb8))_0x113307=Reflect[_0x210e2d(0xd0)](_0xc126f9,_0x17c289,_0x51dbc6,_0x262464);else{for(var _0x346003=_0xc126f9[_0x210e2d(0xad)]-0x1;_0x346003>=0x0;_0x346003--)if(_0x390bbb=_0xc126f9[_0x346003])_0x113307=(_0x4ee40e<0x3?_0x390bbb(_0x113307):_0x4ee40e>0x3?_0x390bbb(_0x17c289,_0x51dbc6,_0x113307):_0x390bbb(_0x17c289,_0x51dbc6))||_0x113307;}return _0x4ee40e>0x3&&_0x113307&&Object[_0x210e2d(0xc1)](_0x17c289,_0x51dbc6,_0x113307),_0x113307;},__metadata=this&&this[a145_0x31a9cd(0xbd)]||function(_0x14eef2,_0x3ab220){const _0x5a5647=a145_0x31a9cd;if(typeof Reflect===_0x5a5647(0xef)&&typeof Reflect[_0x5a5647(0xea)]===_0x5a5647(0xb8))return Reflect[_0x5a5647(0xea)](_0x14eef2,_0x3ab220);},__param=this&&this[a145_0x31a9cd(0xee)]||function(_0x1c5fbd,_0x5cb0d8){return function(_0x177a19,_0x5e4df1){_0x5cb0d8(_0x177a19,_0x5e4df1,_0x1c5fbd);};},TextToAudioController_1;Object[a145_0x31a9cd(0xc1)](exports,a145_0x31a9cd(0xc3),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a145_0x31a9cd(0xe1)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a145_0x31a9cd(0xe8)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a145_0x31a9cd(0xe2)),jwt_guard_1=require(a145_0x31a9cd(0xb1)),roles_guard_1=require(a145_0x31a9cd(0xe5)),saveStreamToFile_1=require(a145_0x31a9cd(0xba)),path=require('path'),path_1=require(a145_0x31a9cd(0xd2)),constants_1=require(a145_0x31a9cd(0xc9)),file_1=require(a145_0x31a9cd(0xa7)),audio_player_1=require(a145_0x31a9cd(0xcf));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x4ea80a,_0x519157){const _0x5658e4=a145_0x31a9cd;this['textToAudioService']=_0x4ea80a,this['streamingService']=_0x519157,this[_0x5658e4(0xed)]=new common_1[(_0x5658e4(0xa6))](TextToAudioController_1[_0x5658e4(0xeb)]);}async[a145_0x31a9cd(0xdf)](_0x2d3d2d,_0x26eb6f){const _0x37ea3c=a145_0x31a9cd;try{const _0x319bf6=_0x26eb6f[_0x37ea3c(0xb6)];if(!_0x319bf6){_0x2d3d2d[_0x37ea3c(0xd9)]('There\x20is\x20no\x20message\x20to\x20play');return;}const {id:_0x566434,volume:_0x4a4057}=await this['textToAudioService'][_0x37ea3c(0xa8)](_0x319bf6);!(0x0,file_1['isFileExist'])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1['createFolder'])(constants_1[_0x37ea3c(0xe3)]);const _0x15eed5=path[_0x37ea3c(0xd1)](path_1[_0x37ea3c(0xc5)],constants_1[_0x37ea3c(0xe3)]),_0x3e3968=_0x15eed5+'/'+_0x566434+_0x37ea3c(0xe9);!(0x0,file_1[_0x37ea3c(0xf2)])(_0x3e3968)?await this[_0x37ea3c(0xca)]['textToAudio'](_0x26eb6f[_0x37ea3c(0xb6)],async _0x3fbd08=>{const _0x1005a8=_0x37ea3c;await(0x0,saveStreamToFile_1[_0x1005a8(0xdd)])(_0x3fbd08,_0x15eed5+'/'+_0x566434+_0x1005a8(0xe9)),audio_player_1[_0x1005a8(0xd8)]['play'](_0x3e3968,_0x4a4057!==null&&_0x4a4057!==void 0x0?_0x4a4057:0x32);}):audio_player_1[_0x37ea3c(0xd8)][_0x37ea3c(0xe4)](_0x3e3968,_0x4a4057!==null&&_0x4a4057!==void 0x0?_0x4a4057:0x32),_0x2d3d2d[_0x37ea3c(0xd9)](_0x37ea3c(0xf0)+_0x26eb6f['text']);}catch(_0x3c2920){return this[_0x37ea3c(0xed)][_0x37ea3c(0xae)](_0x3c2920,'error'),'';}}async['saveMessage'](_0x55be2c,_0x379d89){const _0x4f26bb=a145_0x31a9cd;try{const _0x39cbb8=_0x379d89[_0x4f26bb(0xb6)];if(!_0x39cbb8){_0x55be2c[_0x4f26bb(0xd9)]('There\x20is\x20no\x20message\x20to\x20play');return;}await this[_0x4f26bb(0xca)][_0x4f26bb(0xa8)](_0x39cbb8),_0x55be2c[_0x4f26bb(0xd9)]('Success\x20save\x20text:\x20'+_0x379d89[_0x4f26bb(0xb6)]);}catch(_0x3238bf){return this[_0x4f26bb(0xed)][_0x4f26bb(0xae)](_0x3238bf,_0x4f26bb(0xd5)),'';}}async[a145_0x31a9cd(0xbe)](){const _0x48b61b=a145_0x31a9cd;try{const _0x43a7ea=await this[_0x48b61b(0xca)][_0x48b61b(0xcc)]();return _0x43a7ea!==null&&_0x43a7ea!==void 0x0?_0x43a7ea:[];}catch(_0x4081cf){return this[_0x48b61b(0xed)]['log'](_0x4081cf,_0x48b61b(0xf1)),'';}}[a145_0x31a9cd(0xe6)](_0x180f21){const _0x209db3=a145_0x31a9cd;return this[_0x209db3(0xca)][_0x209db3(0xe6)](_0x180f21);}[a145_0x31a9cd(0xb7)](_0x238348,_0x49587a){const _0x4214de=a145_0x31a9cd;var _0xcd423b;return this[_0x4214de(0xca)][_0x4214de(0xb7)](_0x238348,Object['assign'](Object[_0x4214de(0xa5)]({},_0x49587a),{'volume':(_0xcd423b=_0x49587a[_0x4214de(0xdc)])!==null&&_0xcd423b!==void 0x0?_0xcd423b:0x32}));}};__decorate([(0x0,common_1[a145_0x31a9cd(0xc4)])('/'),(0x0,common_1[a145_0x31a9cd(0xcb)])(jwt_guard_1[a145_0x31a9cd(0xe0)],roles_guard_1[a145_0x31a9cd(0xcd)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xda)],role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xc2)]),__param(0x0,(0x0,common_1[a145_0x31a9cd(0xb2)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x31a9cd(0xdb)])()),__metadata(a145_0x31a9cd(0xac),Function),__metadata(a145_0x31a9cd(0xaf),[Object,text_dto_1['TextDTO']]),__metadata(a145_0x31a9cd(0xd6),Promise)],TextToAudioController['prototype'],a145_0x31a9cd(0xdf),null),__decorate([(0x0,common_1['Post'])('saveMessage'),(0x0,common_1[a145_0x31a9cd(0xcb)])(jwt_guard_1[a145_0x31a9cd(0xe0)],roles_guard_1[a145_0x31a9cd(0xcd)]),(0x0,roles_decorator_1[a145_0x31a9cd(0xec)])(role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xda)],role_enum_1['Role']['User']),__param(0x0,(0x0,common_1[a145_0x31a9cd(0xb2)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x31a9cd(0xac),Function),__metadata(a145_0x31a9cd(0xaf),[Object,text_dto_1[a145_0x31a9cd(0xbf)]]),__metadata(a145_0x31a9cd(0xd6),Promise)],TextToAudioController[a145_0x31a9cd(0xd4)],'saveMessage',null),__decorate([(0x0,common_1['Get'])('/message'),(0x0,common_1[a145_0x31a9cd(0xcb)])(jwt_guard_1[a145_0x31a9cd(0xe0)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x31a9cd(0xec)])(role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xda)],role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xc2)]),__metadata('design:type',Function),__metadata(a145_0x31a9cd(0xaf),[]),__metadata(a145_0x31a9cd(0xd6),Promise)],TextToAudioController['prototype'],a145_0x31a9cd(0xbe),null),__decorate([(0x0,common_1[a145_0x31a9cd(0xb5)])(a145_0x31a9cd(0xce)),(0x0,common_1[a145_0x31a9cd(0xcb)])(jwt_guard_1[a145_0x31a9cd(0xe0)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x31a9cd(0xec)])(role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xda)],role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xc2)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata('design:type',Function),__metadata(a145_0x31a9cd(0xaf),[String]),__metadata(a145_0x31a9cd(0xd6),void 0x0)],TextToAudioController[a145_0x31a9cd(0xd4)],a145_0x31a9cd(0xe6),null),__decorate([(0x0,common_1[a145_0x31a9cd(0xc6)])('/:id'),(0x0,common_1[a145_0x31a9cd(0xcb)])(jwt_guard_1[a145_0x31a9cd(0xe0)],roles_guard_1[a145_0x31a9cd(0xcd)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xda)],role_enum_1[a145_0x31a9cd(0xb0)][a145_0x31a9cd(0xc2)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a145_0x31a9cd(0xdb)])()),__metadata(a145_0x31a9cd(0xac),Function),__metadata(a145_0x31a9cd(0xaf),[String,text_dto_1[a145_0x31a9cd(0xbf)]]),__metadata('design:returntype',void 0x0)],TextToAudioController[a145_0x31a9cd(0xd4)],'updateTextMessage',null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x31a9cd(0xd7)])(a145_0x31a9cd(0xd3)),__metadata('design:paramtypes',[text_to_audio_service_1[a145_0x31a9cd(0xde)],streaming_service_1[a145_0x31a9cd(0xb3)]])],TextToAudioController),exports[a145_0x31a9cd(0xe7)]=TextToAudioController;