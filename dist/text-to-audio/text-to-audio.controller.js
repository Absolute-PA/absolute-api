'use strict';const a142_0x5554a2=a142_0x1320;(function(_0x72df95,_0x1b68a4){const _0x1707cd=a142_0x1320,_0x117a0=_0x72df95();while(!![]){try{const _0x171223=parseInt(_0x1707cd(0x77))/0x1+parseInt(_0x1707cd(0xac))/0x2+parseInt(_0x1707cd(0x93))/0x3*(-parseInt(_0x1707cd(0xa6))/0x4)+-parseInt(_0x1707cd(0x7c))/0x5+parseInt(_0x1707cd(0x70))/0x6+-parseInt(_0x1707cd(0x9b))/0x7+parseInt(_0x1707cd(0xbc))/0x8;if(_0x171223===_0x1b68a4)break;else _0x117a0['push'](_0x117a0['shift']());}catch(_0x25caa7){_0x117a0['push'](_0x117a0['shift']());}}}(a142_0x5bd0,0x1d0ca));function a142_0x1320(_0x4c8b4b,_0xfb7c1b){const _0x5bd0e7=a142_0x5bd0();return a142_0x1320=function(_0x132058,_0x563a54){_0x132058=_0x132058-0x6f;let _0x44be14=_0x5bd0e7[_0x132058];return _0x44be14;},a142_0x1320(_0x4c8b4b,_0xfb7c1b);}function a142_0x5bd0(){const _0x53a7cb=['422800TpzayO','@nestjs/common','error\x20','Param','streamingService','Success\x20play\x20text\x20to\x20audio:\x20','error','__metadata','play','../common/file','decorate','/:id','UseGuards','/message','TextToAudioController','length','1918816PkgxHU','TextDTO','__param','735960kHWKOR','__decorate','volume','log','getAllMessage','textToAudioService','getOwnPropertyDescriptor','59028omqCWy','__esModule','./text-to-audio.service','assign','Admin','920640hLFqcE','../auth/guards/roles.guard','Logger','../auth/decorators/roles.decorator','./dtos/text.dto','saveMessage','Get','Post','StreamingService','Roles','../common/path','send','processRootPath','User','AUDIO_TO_MESSAGE_DIR','../streaming/streaming.service','.wav','RolesGuard','design:returntype','Success\x20save\x20text:\x20','object','Body','JwtAuthGuard','522549gFnTAa','../auth/guards/jwt.guard','../common/constants','Res','deleteTextMessage','text','There\x20is\x20no\x20message\x20to\x20play','logger','1089501eYDKfG','AudioPlayer','Role','metadata','design:type','prototype','design:paramtypes','TextToAudioService','./saveStreamToFile','getMessages','updateTextMessage','4dydXxm','isFileExist','function','name','textToAudio','playAudioFile'];a142_0x5bd0=function(){return _0x53a7cb;};return a142_0x5bd0();}var __decorate=this&&this[a142_0x5554a2(0x71)]||function(_0x19e4c8,_0x43ab78,_0x308214,_0x4d4ae7){const _0x2c3451=a142_0x5554a2;var _0x17c11f=arguments[_0x2c3451(0xbb)],_0x39798b=_0x17c11f<0x3?_0x43ab78:_0x4d4ae7===null?_0x4d4ae7=Object[_0x2c3451(0x76)](_0x43ab78,_0x308214):_0x4d4ae7,_0x523e15;if(typeof Reflect===_0x2c3451(0x90)&&typeof Reflect[_0x2c3451(0xb6)]===_0x2c3451(0xa8))_0x39798b=Reflect[_0x2c3451(0xb6)](_0x19e4c8,_0x43ab78,_0x308214,_0x4d4ae7);else{for(var _0x5530ff=_0x19e4c8[_0x2c3451(0xbb)]-0x1;_0x5530ff>=0x0;_0x5530ff--)if(_0x523e15=_0x19e4c8[_0x5530ff])_0x39798b=(_0x17c11f<0x3?_0x523e15(_0x39798b):_0x17c11f>0x3?_0x523e15(_0x43ab78,_0x308214,_0x39798b):_0x523e15(_0x43ab78,_0x308214))||_0x39798b;}return _0x17c11f>0x3&&_0x39798b&&Object['defineProperty'](_0x43ab78,_0x308214,_0x39798b),_0x39798b;},__metadata=this&&this[a142_0x5554a2(0xb3)]||function(_0x52046b,_0x4bc86a){const _0x14d754=a142_0x5554a2;if(typeof Reflect===_0x14d754(0x90)&&typeof Reflect[_0x14d754(0x9e)]===_0x14d754(0xa8))return Reflect[_0x14d754(0x9e)](_0x52046b,_0x4bc86a);},__param=this&&this[a142_0x5554a2(0x6f)]||function(_0x4a84fb,_0x3fdbd8){return function(_0x6a3ddc,_0x38b82d){_0x3fdbd8(_0x6a3ddc,_0x38b82d,_0x4a84fb);};},TextToAudioController_1;Object['defineProperty'](exports,a142_0x5554a2(0x78),{'value':!![]}),exports[a142_0x5554a2(0xba)]=void 0x0;const common_1=require(a142_0x5554a2(0xad)),text_to_audio_service_1=require(a142_0x5554a2(0x79)),text_dto_1=require(a142_0x5554a2(0x80)),streaming_service_1=require(a142_0x5554a2(0x8b)),roles_decorator_1=require(a142_0x5554a2(0x7f)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a142_0x5554a2(0x94)),roles_guard_1=require(a142_0x5554a2(0x7d)),saveStreamToFile_1=require(a142_0x5554a2(0xa3)),path=require('path'),path_1=require(a142_0x5554a2(0x86)),constants_1=require(a142_0x5554a2(0x95)),file_1=require(a142_0x5554a2(0xb5)),audio_player_1=require('../common/audio/audio-player');let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x4ee669,_0x5b7a87){const _0x4ae1d9=a142_0x5554a2;this[_0x4ae1d9(0x75)]=_0x4ee669,this[_0x4ae1d9(0xb0)]=_0x5b7a87,this[_0x4ae1d9(0x9a)]=new common_1[(_0x4ae1d9(0x7e))](TextToAudioController_1[_0x4ae1d9(0xa9)]);}async[a142_0x5554a2(0xab)](_0x280e14,_0x279e36){const _0x4983af=a142_0x5554a2;try{const _0x3a5e36=_0x279e36[_0x4983af(0x98)];if(!_0x3a5e36){_0x280e14[_0x4983af(0x87)](_0x4983af(0x99));return;}const {id:_0x582f01,volume:_0x40f7b1}=await this[_0x4983af(0x75)]['saveMessage'](_0x3a5e36);!(0x0,file_1[_0x4983af(0xa7)])(constants_1[_0x4983af(0x8a)])&&(0x0,file_1['createFolder'])(constants_1[_0x4983af(0x8a)]);const _0x635fd6=path['join'](path_1[_0x4983af(0x88)],constants_1[_0x4983af(0x8a)]),_0x35c602=_0x635fd6+'/'+_0x582f01+'.wav';!(0x0,file_1[_0x4983af(0xa7)])(_0x35c602)?await this[_0x4983af(0x75)][_0x4983af(0xaa)](_0x279e36['text'],async _0x4e0fcf=>{const _0x3330c0=_0x4983af;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x4e0fcf,_0x635fd6+'/'+_0x582f01+_0x3330c0(0x8c)),audio_player_1[_0x3330c0(0x9c)][_0x3330c0(0xb4)](_0x35c602,_0x40f7b1!==null&&_0x40f7b1!==void 0x0?_0x40f7b1:0x32);}):audio_player_1[_0x4983af(0x9c)]['play'](_0x35c602,_0x40f7b1!==null&&_0x40f7b1!==void 0x0?_0x40f7b1:0x32),_0x280e14['send'](_0x4983af(0xb1)+_0x279e36[_0x4983af(0x98)]);}catch(_0x2516f0){return this[_0x4983af(0x9a)][_0x4983af(0x73)](_0x2516f0,_0x4983af(0xb2)),'';}}async[a142_0x5554a2(0x81)](_0x2a6b58,_0x4c3f56){const _0x1c57fa=a142_0x5554a2;try{const _0x281769=_0x4c3f56['text'];if(!_0x281769){_0x2a6b58[_0x1c57fa(0x87)](_0x1c57fa(0x99));return;}await this[_0x1c57fa(0x75)]['saveMessage'](_0x281769),_0x2a6b58[_0x1c57fa(0x87)](_0x1c57fa(0x8f)+_0x4c3f56[_0x1c57fa(0x98)]);}catch(_0x2f6f4f){return this['logger'][_0x1c57fa(0x73)](_0x2f6f4f,_0x1c57fa(0xae)),'';}}async[a142_0x5554a2(0x74)](){const _0x4825f3=a142_0x5554a2;try{const _0x1feadd=await this[_0x4825f3(0x75)][_0x4825f3(0xa4)]();return _0x1feadd!==null&&_0x1feadd!==void 0x0?_0x1feadd:[];}catch(_0x464c6e){return this[_0x4825f3(0x9a)]['log'](_0x464c6e,_0x4825f3(0xb2)),'';}}[a142_0x5554a2(0x97)](_0x27f1a3){return this['textToAudioService']['deleteTextMessage'](_0x27f1a3);}[a142_0x5554a2(0xa5)](_0x324191,_0x37fce3){const _0x471b19=a142_0x5554a2;var _0x189fab;return this[_0x471b19(0x75)][_0x471b19(0xa5)](_0x324191,Object[_0x471b19(0x7a)](Object['assign']({},_0x37fce3),{'volume':(_0x189fab=_0x37fce3[_0x471b19(0x72)])!==null&&_0x189fab!==void 0x0?_0x189fab:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a142_0x5554a2(0xb8)])(jwt_guard_1[a142_0x5554a2(0x92)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x5554a2(0x85)])(role_enum_1['Role']['Admin'],role_enum_1['Role']['User']),__param(0x0,(0x0,common_1[a142_0x5554a2(0x96)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x5554a2(0x91)])()),__metadata('design:type',Function),__metadata(a142_0x5554a2(0xa1),[Object,text_dto_1[a142_0x5554a2(0xbd)]]),__metadata(a142_0x5554a2(0x8e),Promise)],TextToAudioController['prototype'],a142_0x5554a2(0xab),null),__decorate([(0x0,common_1[a142_0x5554a2(0x83)])(a142_0x5554a2(0x81)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x5554a2(0x92)],roles_guard_1[a142_0x5554a2(0x8d)]),(0x0,roles_decorator_1[a142_0x5554a2(0x85)])(role_enum_1[a142_0x5554a2(0x9d)]['Admin'],role_enum_1[a142_0x5554a2(0x9d)][a142_0x5554a2(0x89)]),__param(0x0,(0x0,common_1[a142_0x5554a2(0x96)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x5554a2(0x9f),Function),__metadata(a142_0x5554a2(0xa1),[Object,text_dto_1[a142_0x5554a2(0xbd)]]),__metadata(a142_0x5554a2(0x8e),Promise)],TextToAudioController['prototype'],'saveMessage',null),__decorate([(0x0,common_1[a142_0x5554a2(0x82)])(a142_0x5554a2(0xb9)),(0x0,common_1[a142_0x5554a2(0xb8)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x5554a2(0x9d)][a142_0x5554a2(0x7b)],role_enum_1['Role'][a142_0x5554a2(0x89)]),__metadata('design:type',Function),__metadata(a142_0x5554a2(0xa1),[]),__metadata(a142_0x5554a2(0x8e),Promise)],TextToAudioController[a142_0x5554a2(0xa0)],'getAllMessage',null),__decorate([(0x0,common_1['Delete'])('/:id'),(0x0,common_1[a142_0x5554a2(0xb8)])(jwt_guard_1[a142_0x5554a2(0x92)],roles_guard_1[a142_0x5554a2(0x8d)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x5554a2(0x9d)][a142_0x5554a2(0x7b)],role_enum_1['Role'][a142_0x5554a2(0x89)]),__param(0x0,(0x0,common_1[a142_0x5554a2(0xaf)])('id')),__metadata(a142_0x5554a2(0x9f),Function),__metadata(a142_0x5554a2(0xa1),[String]),__metadata('design:returntype',void 0x0)],TextToAudioController['prototype'],'deleteTextMessage',null),__decorate([(0x0,common_1['Put'])(a142_0x5554a2(0xb7)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x5554a2(0x92)],roles_guard_1[a142_0x5554a2(0x8d)]),(0x0,roles_decorator_1[a142_0x5554a2(0x85)])(role_enum_1['Role'][a142_0x5554a2(0x7b)],role_enum_1[a142_0x5554a2(0x9d)][a142_0x5554a2(0x89)]),__param(0x0,(0x0,common_1[a142_0x5554a2(0xaf)])('id')),__param(0x1,(0x0,common_1[a142_0x5554a2(0x91)])()),__metadata('design:type',Function),__metadata(a142_0x5554a2(0xa1),[String,text_dto_1[a142_0x5554a2(0xbd)]]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x5554a2(0xa0)],a142_0x5554a2(0xa5),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a142_0x5554a2(0xaa)),__metadata(a142_0x5554a2(0xa1),[text_to_audio_service_1[a142_0x5554a2(0xa2)],streaming_service_1[a142_0x5554a2(0x84)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;