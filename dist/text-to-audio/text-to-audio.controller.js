'use strict';const a145_0x3adf26=a145_0x1a4a;(function(_0x5394a0,_0x5bb069){const _0x1cb8c4=a145_0x1a4a,_0x26f2f3=_0x5394a0();while(!![]){try{const _0x5d562f=parseInt(_0x1cb8c4(0x9a))/0x1+-parseInt(_0x1cb8c4(0xaf))/0x2*(parseInt(_0x1cb8c4(0x8f))/0x3)+parseInt(_0x1cb8c4(0x92))/0x4*(-parseInt(_0x1cb8c4(0xa9))/0x5)+parseInt(_0x1cb8c4(0xb2))/0x6*(-parseInt(_0x1cb8c4(0xbb))/0x7)+parseInt(_0x1cb8c4(0x94))/0x8+-parseInt(_0x1cb8c4(0x8b))/0x9*(-parseInt(_0x1cb8c4(0xa2))/0xa)+parseInt(_0x1cb8c4(0xa4))/0xb;if(_0x5d562f===_0x5bb069)break;else _0x26f2f3['push'](_0x26f2f3['shift']());}catch(_0x4447e3){_0x26f2f3['push'](_0x26f2f3['shift']());}}}(a145_0x26ff,0xc57fa));var __decorate=this&&this[a145_0x3adf26(0x8d)]||function(_0x7cd6c6,_0x5271ae,_0x526ab1,_0x25949f){const _0x582d9c=a145_0x3adf26;var _0x10a911=arguments['length'],_0xde5b91=_0x10a911<0x3?_0x5271ae:_0x25949f===null?_0x25949f=Object[_0x582d9c(0x97)](_0x5271ae,_0x526ab1):_0x25949f,_0x8bc266;if(typeof Reflect===_0x582d9c(0xbf)&&typeof Reflect['decorate']===_0x582d9c(0x91))_0xde5b91=Reflect[_0x582d9c(0x98)](_0x7cd6c6,_0x5271ae,_0x526ab1,_0x25949f);else{for(var _0x364b9a=_0x7cd6c6[_0x582d9c(0xbe)]-0x1;_0x364b9a>=0x0;_0x364b9a--)if(_0x8bc266=_0x7cd6c6[_0x364b9a])_0xde5b91=(_0x10a911<0x3?_0x8bc266(_0xde5b91):_0x10a911>0x3?_0x8bc266(_0x5271ae,_0x526ab1,_0xde5b91):_0x8bc266(_0x5271ae,_0x526ab1))||_0xde5b91;}return _0x10a911>0x3&&_0xde5b91&&Object[_0x582d9c(0x90)](_0x5271ae,_0x526ab1,_0xde5b91),_0xde5b91;},__metadata=this&&this['__metadata']||function(_0x102462,_0x5522b4){const _0x11c854=a145_0x3adf26;if(typeof Reflect===_0x11c854(0xbf)&&typeof Reflect['metadata']==='function')return Reflect[_0x11c854(0x96)](_0x102462,_0x5522b4);},__param=this&&this[a145_0x3adf26(0xb7)]||function(_0x4b4a7e,_0x2e8b9d){return function(_0x517ef3,_0x4a3b08){_0x2e8b9d(_0x517ef3,_0x4a3b08,_0x4b4a7e);};},TextToAudioController_1;function a145_0x26ff(){const _0x4cdcc6=['path','AUDIO_TO_MESSAGE_DIR','4479830MPPGfb','../common/constants','14906166ZfoyiN','@nestjs/common','design:paramtypes','.wav','play','5JuooVv','__esModule','send','text','isFileExist','saveStreamToFile','1016810UJIDck','getMessages','StreamingService','48CCTzBM','/message','playAudioFile','join','name','__param','There\x20is\x20no\x20message\x20to\x20play','volume','assign','1346674BZDlbC','JwtAuthGuard','../auth/guards/jwt.guard','length','object','RolesGuard','Success\x20save\x20text:\x20','createFolder','updateTextMessage','../auth/guards/roles.guard','Controller','logger','./text-to-audio.service','Post','Get','log','/:id','design:type','Delete','getAllMessage','Admin','Success\x20play\x20text\x20to\x20audio:\x20','UseGuards','Roles','Role','error','textToAudioService','AudioPlayer','../auth/enums/role.enum','prototype','TextDTO','./dtos/text.dto','design:returntype','9tQVmEd','saveMessage','__decorate','Res','3TPGIvW','defineProperty','function','5965640tRgKHl','Logger','8231544efZStz','../streaming/streaming.service','metadata','getOwnPropertyDescriptor','decorate','../common/file','1515793Kuqpgt','Param','Body','User','Put','../common/path'];a145_0x26ff=function(){return _0x4cdcc6;};return a145_0x26ff();}Object[a145_0x3adf26(0x90)](exports,a145_0x3adf26(0xaa),{'value':!![]}),exports['TextToAudioController']=void 0x0;function a145_0x1a4a(_0x2e6fca,_0x177032){const _0x26ffe5=a145_0x26ff();return a145_0x1a4a=function(_0x1a4a40,_0x2fecf1){_0x1a4a40=_0x1a4a40-0x80;let _0x3cc913=_0x26ffe5[_0x1a4a40];return _0x3cc913;},a145_0x1a4a(_0x2e6fca,_0x177032);}const common_1=require(a145_0x3adf26(0xa5)),text_to_audio_service_1=require(a145_0x3adf26(0xc7)),text_dto_1=require(a145_0x3adf26(0x89)),streaming_service_1=require(a145_0x3adf26(0x95)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a145_0x3adf26(0x86)),jwt_guard_1=require(a145_0x3adf26(0xbd)),roles_guard_1=require(a145_0x3adf26(0xc4)),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a145_0x3adf26(0xa0)),path_1=require(a145_0x3adf26(0x9f)),constants_1=require(a145_0x3adf26(0xa3)),file_1=require(a145_0x3adf26(0x99)),audio_player_1=require('../common/audio/audio-player');let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x54c2ff,_0x11f035){const _0x40ce17=a145_0x3adf26;this[_0x40ce17(0x84)]=_0x54c2ff,this['streamingService']=_0x11f035,this[_0x40ce17(0xc6)]=new common_1[(_0x40ce17(0x93))](TextToAudioController_1[_0x40ce17(0xb6)]);}async[a145_0x3adf26(0xb4)](_0x402ff6,_0x1be88e){const _0x4bbc2d=a145_0x3adf26;try{const _0x4d0313=_0x1be88e[_0x4bbc2d(0xac)];if(!_0x4d0313){_0x402ff6[_0x4bbc2d(0xab)](_0x4bbc2d(0xb8));return;}const {id:_0x4e3b5c,volume:_0x1377fd}=await this[_0x4bbc2d(0x84)][_0x4bbc2d(0x8c)](_0x4d0313);!(0x0,file_1[_0x4bbc2d(0xad)])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1[_0x4bbc2d(0xc2)])(constants_1[_0x4bbc2d(0xa1)]);const _0x16ecb0=path[_0x4bbc2d(0xb5)](path_1['processRootPath'],constants_1[_0x4bbc2d(0xa1)]),_0x1c0674=_0x16ecb0+'/'+_0x4e3b5c+_0x4bbc2d(0xa7);!(0x0,file_1[_0x4bbc2d(0xad)])(_0x1c0674)?await this['textToAudioService']['textToAudio'](_0x1be88e[_0x4bbc2d(0xac)],async _0x99ba47=>{const _0x46e2bc=_0x4bbc2d;await(0x0,saveStreamToFile_1[_0x46e2bc(0xae)])(_0x99ba47,_0x16ecb0+'/'+_0x4e3b5c+'.wav'),audio_player_1[_0x46e2bc(0x85)]['play'](_0x1c0674,_0x1377fd!==null&&_0x1377fd!==void 0x0?_0x1377fd:0x32);}):audio_player_1[_0x4bbc2d(0x85)][_0x4bbc2d(0xa8)](_0x1c0674,_0x1377fd!==null&&_0x1377fd!==void 0x0?_0x1377fd:0x32),_0x402ff6[_0x4bbc2d(0xab)](_0x4bbc2d(0xd0)+_0x1be88e[_0x4bbc2d(0xac)]);}catch(_0x369aff){return this[_0x4bbc2d(0xc6)]['log'](_0x369aff,_0x4bbc2d(0x83)),'';}}async['saveMessage'](_0x62a21,_0x27a7b4){const _0x7a0859=a145_0x3adf26;try{const _0x9327e9=_0x27a7b4[_0x7a0859(0xac)];if(!_0x9327e9){_0x62a21[_0x7a0859(0xab)](_0x7a0859(0xb8));return;}await this['textToAudioService'][_0x7a0859(0x8c)](_0x9327e9),_0x62a21[_0x7a0859(0xab)](_0x7a0859(0xc1)+_0x27a7b4['text']);}catch(_0x24928c){return this['logger'][_0x7a0859(0xca)](_0x24928c,'error\x20'),'';}}async['getAllMessage'](){const _0x1ac90f=a145_0x3adf26;try{const _0x420988=await this[_0x1ac90f(0x84)][_0x1ac90f(0xb0)]();return _0x420988!==null&&_0x420988!==void 0x0?_0x420988:[];}catch(_0x535954){return this[_0x1ac90f(0xc6)][_0x1ac90f(0xca)](_0x535954,_0x1ac90f(0x83)),'';}}['deleteTextMessage'](_0x469064){const _0x1f41d8=a145_0x3adf26;return this[_0x1f41d8(0x84)]['deleteTextMessage'](_0x469064);}[a145_0x3adf26(0xc3)](_0x490c44,_0x131044){const _0x49e5af=a145_0x3adf26;var _0x55fadf;return this['textToAudioService'][_0x49e5af(0xc3)](_0x490c44,Object[_0x49e5af(0xba)](Object['assign']({},_0x131044),{'volume':(_0x55fadf=_0x131044[_0x49e5af(0xb9)])!==null&&_0x55fadf!==void 0x0?_0x55fadf:0x32}));}};__decorate([(0x0,common_1[a145_0x3adf26(0xc8)])('/'),(0x0,common_1[a145_0x3adf26(0x80)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x3adf26(0xc0)]),(0x0,roles_decorator_1[a145_0x3adf26(0x81)])(role_enum_1[a145_0x3adf26(0x82)][a145_0x3adf26(0xcf)],role_enum_1[a145_0x3adf26(0x82)]['User']),__param(0x0,(0x0,common_1[a145_0x3adf26(0x8e)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x3adf26(0x9c)])()),__metadata(a145_0x3adf26(0xcc),Function),__metadata(a145_0x3adf26(0xa6),[Object,text_dto_1[a145_0x3adf26(0x88)]]),__metadata(a145_0x3adf26(0x8a),Promise)],TextToAudioController['prototype'],'playAudioFile',null),__decorate([(0x0,common_1[a145_0x3adf26(0xc8)])(a145_0x3adf26(0x8c)),(0x0,common_1[a145_0x3adf26(0x80)])(jwt_guard_1[a145_0x3adf26(0xbc)],roles_guard_1[a145_0x3adf26(0xc0)]),(0x0,roles_decorator_1[a145_0x3adf26(0x81)])(role_enum_1[a145_0x3adf26(0x82)][a145_0x3adf26(0xcf)],role_enum_1[a145_0x3adf26(0x82)][a145_0x3adf26(0x9d)]),__param(0x0,(0x0,common_1[a145_0x3adf26(0x8e)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x3adf26(0x9c)])()),__metadata(a145_0x3adf26(0xcc),Function),__metadata(a145_0x3adf26(0xa6),[Object,text_dto_1[a145_0x3adf26(0x88)]]),__metadata(a145_0x3adf26(0x8a),Promise)],TextToAudioController[a145_0x3adf26(0x87)],a145_0x3adf26(0x8c),null),__decorate([(0x0,common_1[a145_0x3adf26(0xc9)])(a145_0x3adf26(0xb3)),(0x0,common_1[a145_0x3adf26(0x80)])(jwt_guard_1[a145_0x3adf26(0xbc)],roles_guard_1[a145_0x3adf26(0xc0)]),(0x0,roles_decorator_1[a145_0x3adf26(0x81)])(role_enum_1['Role'][a145_0x3adf26(0xcf)],role_enum_1[a145_0x3adf26(0x82)]['User']),__metadata(a145_0x3adf26(0xcc),Function),__metadata(a145_0x3adf26(0xa6),[]),__metadata(a145_0x3adf26(0x8a),Promise)],TextToAudioController[a145_0x3adf26(0x87)],a145_0x3adf26(0xce),null),__decorate([(0x0,common_1[a145_0x3adf26(0xcd)])(a145_0x3adf26(0xcb)),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a145_0x3adf26(0xcf)],role_enum_1['Role'][a145_0x3adf26(0x9d)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a145_0x3adf26(0xcc),Function),__metadata(a145_0x3adf26(0xa6),[String]),__metadata(a145_0x3adf26(0x8a),void 0x0)],TextToAudioController[a145_0x3adf26(0x87)],'deleteTextMessage',null),__decorate([(0x0,common_1[a145_0x3adf26(0x9e)])(a145_0x3adf26(0xcb)),(0x0,common_1['UseGuards'])(jwt_guard_1[a145_0x3adf26(0xbc)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x3adf26(0x81)])(role_enum_1[a145_0x3adf26(0x82)][a145_0x3adf26(0xcf)],role_enum_1[a145_0x3adf26(0x82)][a145_0x3adf26(0x9d)]),__param(0x0,(0x0,common_1[a145_0x3adf26(0x9b)])('id')),__param(0x1,(0x0,common_1[a145_0x3adf26(0x9c)])()),__metadata(a145_0x3adf26(0xcc),Function),__metadata(a145_0x3adf26(0xa6),[String,text_dto_1['TextDTO']]),__metadata(a145_0x3adf26(0x8a),void 0x0)],TextToAudioController['prototype'],a145_0x3adf26(0xc3),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x3adf26(0xc5)])('textToAudio'),__metadata('design:paramtypes',[text_to_audio_service_1['TextToAudioService'],streaming_service_1[a145_0x3adf26(0xb1)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;