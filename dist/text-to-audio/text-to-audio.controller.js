'use strict';const a145_0x7700e6=a145_0x4698;function a145_0x2dbd(){const _0x2016fe=['3868984reBKBe','14216643AMJgAa','text','send','Put','1992Tfdrhl','decorate','Post','AudioPlayer','/:id','updateTextMessage','__metadata','Param','UseGuards','../auth/guards/roles.guard','RolesGuard','../auth/decorators/roles.decorator','TextToAudioController','There\x20is\x20no\x20message\x20to\x20play','../common/constants','processRootPath','../common/file','Body','Delete','Controller','Success\x20save\x20text:\x20','textToAudioService','Roles','2569167spHzQH','join','Res','design:paramtypes','saveMessage','getAllMessage','1523088xrnyTC','length','./saveStreamToFile','isFileExist','deleteTextMessage','.wav','AUDIO_TO_MESSAGE_DIR','../common/path','256142jcXskV','TextDTO','design:returntype','StreamingService','@nestjs/common','prototype','path','../auth/guards/jwt.guard','error\x20','Admin','log','name','__decorate','play','logger','User','assign','__esModule','../auth/enums/role.enum','13349bYfRXu','10KJjUCW','object','/message','217103ehwBHY','JwtAuthGuard','Role','design:type','error','function','../streaming/streaming.service','streamingService','../common/audio/audio-player','TextToAudioService','getOwnPropertyDescriptor','getMessages','createFolder','defineProperty'];a145_0x2dbd=function(){return _0x2016fe;};return a145_0x2dbd();}(function(_0x4e944d,_0x295cf7){const _0x4e62ea=a145_0x4698,_0x1e49d9=_0x4e944d();while(!![]){try{const _0x4153bd=-parseInt(_0x4e62ea(0x137))/0x1+parseInt(_0x4e62ea(0x120))/0x2+parseInt(_0x4e62ea(0x161))/0x3+parseInt(_0x4e62ea(0x118))/0x4*(-parseInt(_0x4e62ea(0x134))/0x5)+parseInt(_0x4e62ea(0x14a))/0x6*(-parseInt(_0x4e62ea(0x133))/0x7)+-parseInt(_0x4e62ea(0x145))/0x8+parseInt(_0x4e62ea(0x146))/0x9;if(_0x4153bd===_0x295cf7)break;else _0x1e49d9['push'](_0x1e49d9['shift']());}catch(_0xd94741){_0x1e49d9['push'](_0x1e49d9['shift']());}}}(a145_0x2dbd,0x726d5));function a145_0x4698(_0x15608c,_0x4a077d){const _0x2dbdca=a145_0x2dbd();return a145_0x4698=function(_0x4698af,_0x43ee73){_0x4698af=_0x4698af-0x115;let _0x576cc2=_0x2dbdca[_0x4698af];return _0x576cc2;},a145_0x4698(_0x15608c,_0x4a077d);}var __decorate=this&&this[a145_0x7700e6(0x12c)]||function(_0x4e9c39,_0x18518d,_0x20490f,_0xb886c0){const _0x1a46f0=a145_0x7700e6;var _0x26c3bb=arguments['length'],_0x1f06dc=_0x26c3bb<0x3?_0x18518d:_0xb886c0===null?_0xb886c0=Object[_0x1a46f0(0x141)](_0x18518d,_0x20490f):_0xb886c0,_0x47bd5d;if(typeof Reflect===_0x1a46f0(0x135)&&typeof Reflect[_0x1a46f0(0x14b)]===_0x1a46f0(0x13c))_0x1f06dc=Reflect[_0x1a46f0(0x14b)](_0x4e9c39,_0x18518d,_0x20490f,_0xb886c0);else{for(var _0x351dd2=_0x4e9c39[_0x1a46f0(0x119)]-0x1;_0x351dd2>=0x0;_0x351dd2--)if(_0x47bd5d=_0x4e9c39[_0x351dd2])_0x1f06dc=(_0x26c3bb<0x3?_0x47bd5d(_0x1f06dc):_0x26c3bb>0x3?_0x47bd5d(_0x18518d,_0x20490f,_0x1f06dc):_0x47bd5d(_0x18518d,_0x20490f))||_0x1f06dc;}return _0x26c3bb>0x3&&_0x1f06dc&&Object[_0x1a46f0(0x144)](_0x18518d,_0x20490f,_0x1f06dc),_0x1f06dc;},__metadata=this&&this[a145_0x7700e6(0x150)]||function(_0x1b1c4e,_0x4ed4fc){const _0x51ec9d=a145_0x7700e6;if(typeof Reflect===_0x51ec9d(0x135)&&typeof Reflect['metadata']===_0x51ec9d(0x13c))return Reflect['metadata'](_0x1b1c4e,_0x4ed4fc);},__param=this&&this['__param']||function(_0x874382,_0x21396d){return function(_0x3ce9ee,_0x4dc337){_0x21396d(_0x3ce9ee,_0x4dc337,_0x874382);};},TextToAudioController_1;Object['defineProperty'](exports,a145_0x7700e6(0x131),{'value':!![]}),exports[a145_0x7700e6(0x156)]=void 0x0;const common_1=require(a145_0x7700e6(0x124)),text_to_audio_service_1=require('./text-to-audio.service'),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a145_0x7700e6(0x13d)),roles_decorator_1=require(a145_0x7700e6(0x155)),role_enum_1=require(a145_0x7700e6(0x132)),jwt_guard_1=require(a145_0x7700e6(0x127)),roles_guard_1=require(a145_0x7700e6(0x153)),saveStreamToFile_1=require(a145_0x7700e6(0x11a)),path=require(a145_0x7700e6(0x126)),path_1=require(a145_0x7700e6(0x11f)),constants_1=require(a145_0x7700e6(0x158)),file_1=require(a145_0x7700e6(0x15a)),audio_player_1=require(a145_0x7700e6(0x13f));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x402bc6,_0x1cb7f7){const _0x201206=a145_0x7700e6;this[_0x201206(0x15f)]=_0x402bc6,this[_0x201206(0x13e)]=_0x1cb7f7,this[_0x201206(0x12e)]=new common_1['Logger'](TextToAudioController_1[_0x201206(0x12b)]);}async['playAudioFile'](_0x253ab1,_0x29ce1d){const _0x1c2b70=a145_0x7700e6;try{const _0x3d84ad=_0x29ce1d[_0x1c2b70(0x147)];if(!_0x3d84ad){_0x253ab1[_0x1c2b70(0x148)](_0x1c2b70(0x157));return;}const {id:_0x359c7d,volume:_0x2c5f3f}=await this[_0x1c2b70(0x15f)][_0x1c2b70(0x116)](_0x3d84ad);!(0x0,file_1[_0x1c2b70(0x11b)])(constants_1[_0x1c2b70(0x11e)])&&(0x0,file_1[_0x1c2b70(0x143)])(constants_1[_0x1c2b70(0x11e)]);const _0x5c7071=path[_0x1c2b70(0x162)](path_1[_0x1c2b70(0x159)],constants_1[_0x1c2b70(0x11e)]),_0x58c7e4=_0x5c7071+'/'+_0x359c7d+'.wav';!(0x0,file_1[_0x1c2b70(0x11b)])(_0x58c7e4)?await this[_0x1c2b70(0x15f)]['textToAudio'](_0x29ce1d['text'],async _0xd5cbf2=>{const _0x4c1340=_0x1c2b70;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0xd5cbf2,_0x5c7071+'/'+_0x359c7d+_0x4c1340(0x11d)),audio_player_1['AudioPlayer'][_0x4c1340(0x12d)](_0x58c7e4,_0x2c5f3f!==null&&_0x2c5f3f!==void 0x0?_0x2c5f3f:0x32);}):audio_player_1[_0x1c2b70(0x14d)][_0x1c2b70(0x12d)](_0x58c7e4,_0x2c5f3f!==null&&_0x2c5f3f!==void 0x0?_0x2c5f3f:0x32),_0x253ab1[_0x1c2b70(0x148)]('Success\x20play\x20text\x20to\x20audio:\x20'+_0x29ce1d[_0x1c2b70(0x147)]);}catch(_0x6e62d5){return this[_0x1c2b70(0x12e)][_0x1c2b70(0x12a)](_0x6e62d5,_0x1c2b70(0x13b)),'';}}async[a145_0x7700e6(0x116)](_0x52996a,_0x5b3c25){const _0x53682f=a145_0x7700e6;try{const _0x76e4b5=_0x5b3c25[_0x53682f(0x147)];if(!_0x76e4b5){_0x52996a[_0x53682f(0x148)]('There\x20is\x20no\x20message\x20to\x20play');return;}await this['textToAudioService'][_0x53682f(0x116)](_0x76e4b5),_0x52996a[_0x53682f(0x148)](_0x53682f(0x15e)+_0x5b3c25[_0x53682f(0x147)]);}catch(_0x3c4e1c){return this[_0x53682f(0x12e)]['log'](_0x3c4e1c,_0x53682f(0x128)),'';}}async['getAllMessage'](){const _0x5d3c44=a145_0x7700e6;try{const _0x1e7939=await this[_0x5d3c44(0x15f)][_0x5d3c44(0x142)]();return _0x1e7939!==null&&_0x1e7939!==void 0x0?_0x1e7939:[];}catch(_0x2dc1c8){return this[_0x5d3c44(0x12e)][_0x5d3c44(0x12a)](_0x2dc1c8,'error'),'';}}['deleteTextMessage'](_0x18df2a){const _0x2b6b39=a145_0x7700e6;return this[_0x2b6b39(0x15f)][_0x2b6b39(0x11c)](_0x18df2a);}[a145_0x7700e6(0x14f)](_0x50462c,_0x58c964){const _0xb07d07=a145_0x7700e6;var _0x5c1aeb;return this[_0xb07d07(0x15f)][_0xb07d07(0x14f)](_0x50462c,Object[_0xb07d07(0x130)](Object[_0xb07d07(0x130)]({},_0x58c964),{'volume':(_0x5c1aeb=_0x58c964['volume'])!==null&&_0x5c1aeb!==void 0x0?_0x5c1aeb:0x32}));}};__decorate([(0x0,common_1[a145_0x7700e6(0x14c)])('/'),(0x0,common_1[a145_0x7700e6(0x152)])(jwt_guard_1[a145_0x7700e6(0x138)],roles_guard_1[a145_0x7700e6(0x154)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x129)],role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x12f)]),__param(0x0,(0x0,common_1[a145_0x7700e6(0x163)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(a145_0x7700e6(0x115),[Object,text_dto_1['TextDTO']]),__metadata(a145_0x7700e6(0x122),Promise)],TextToAudioController['prototype'],'playAudioFile',null),__decorate([(0x0,common_1['Post'])(a145_0x7700e6(0x116)),(0x0,common_1[a145_0x7700e6(0x152)])(jwt_guard_1[a145_0x7700e6(0x138)],roles_guard_1[a145_0x7700e6(0x154)]),(0x0,roles_decorator_1[a145_0x7700e6(0x160)])(role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x129)],role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x12f)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x7700e6(0x15b)])()),__metadata('design:type',Function),__metadata(a145_0x7700e6(0x115),[Object,text_dto_1[a145_0x7700e6(0x121)]]),__metadata(a145_0x7700e6(0x122),Promise)],TextToAudioController[a145_0x7700e6(0x125)],a145_0x7700e6(0x116),null),__decorate([(0x0,common_1['Get'])(a145_0x7700e6(0x136)),(0x0,common_1[a145_0x7700e6(0x152)])(jwt_guard_1[a145_0x7700e6(0x138)],roles_guard_1[a145_0x7700e6(0x154)]),(0x0,roles_decorator_1[a145_0x7700e6(0x160)])(role_enum_1[a145_0x7700e6(0x139)]['Admin'],role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x12f)]),__metadata(a145_0x7700e6(0x13a),Function),__metadata(a145_0x7700e6(0x115),[]),__metadata(a145_0x7700e6(0x122),Promise)],TextToAudioController[a145_0x7700e6(0x125)],a145_0x7700e6(0x117),null),__decorate([(0x0,common_1[a145_0x7700e6(0x15c)])(a145_0x7700e6(0x14e)),(0x0,common_1[a145_0x7700e6(0x152)])(jwt_guard_1[a145_0x7700e6(0x138)],roles_guard_1[a145_0x7700e6(0x154)]),(0x0,roles_decorator_1[a145_0x7700e6(0x160)])(role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x129)],role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x12f)]),__param(0x0,(0x0,common_1[a145_0x7700e6(0x151)])('id')),__metadata(a145_0x7700e6(0x13a),Function),__metadata(a145_0x7700e6(0x115),[String]),__metadata(a145_0x7700e6(0x122),void 0x0)],TextToAudioController['prototype'],a145_0x7700e6(0x11c),null),__decorate([(0x0,common_1[a145_0x7700e6(0x149)])('/:id'),(0x0,common_1[a145_0x7700e6(0x152)])(jwt_guard_1[a145_0x7700e6(0x138)],roles_guard_1[a145_0x7700e6(0x154)]),(0x0,roles_decorator_1[a145_0x7700e6(0x160)])(role_enum_1[a145_0x7700e6(0x139)]['Admin'],role_enum_1[a145_0x7700e6(0x139)][a145_0x7700e6(0x12f)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a145_0x7700e6(0x15b)])()),__metadata('design:type',Function),__metadata(a145_0x7700e6(0x115),[String,text_dto_1[a145_0x7700e6(0x121)]]),__metadata(a145_0x7700e6(0x122),void 0x0)],TextToAudioController[a145_0x7700e6(0x125)],a145_0x7700e6(0x14f),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x7700e6(0x15d)])('textToAudio'),__metadata('design:paramtypes',[text_to_audio_service_1[a145_0x7700e6(0x140)],streaming_service_1[a145_0x7700e6(0x123)]])],TextToAudioController),exports[a145_0x7700e6(0x156)]=TextToAudioController;