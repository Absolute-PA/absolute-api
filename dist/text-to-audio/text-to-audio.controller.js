'use strict';const a145_0x5de479=a145_0x5d8b;(function(_0x4bfa9f,_0x20705f){const _0x4a7b64=a145_0x5d8b,_0x3e60fd=_0x4bfa9f();while(!![]){try{const _0x469633=parseInt(_0x4a7b64(0x144))/0x1+-parseInt(_0x4a7b64(0x148))/0x2+-parseInt(_0x4a7b64(0x13f))/0x3+-parseInt(_0x4a7b64(0x155))/0x4+-parseInt(_0x4a7b64(0x13e))/0x5*(-parseInt(_0x4a7b64(0x12a))/0x6)+parseInt(_0x4a7b64(0x127))/0x7*(-parseInt(_0x4a7b64(0x14d))/0x8)+parseInt(_0x4a7b64(0x143))/0x9*(parseInt(_0x4a7b64(0x146))/0xa);if(_0x469633===_0x20705f)break;else _0x3e60fd['push'](_0x3e60fd['shift']());}catch(_0x35d8ca){_0x3e60fd['push'](_0x3e60fd['shift']());}}}(a145_0x49af,0x25792));function a145_0x49af(){const _0x385f25=['createFolder','getMessages','object','Post','@nestjs/common','../common/constants','__param','play','Controller','Param','/:id','JwtAuthGuard','Success\x20play\x20text\x20to\x20audio:\x20','log','Res','processRootPath','updateTextMessage','isFileExist','Role','getOwnPropertyDescriptor','textToAudio','User','join','TextDTO','length','error','RolesGuard','design:type','prototype','../auth/guards/jwt.guard','Delete','playAudioFile','AudioPlayer','./text-to-audio.service','7HVQcVA','AUDIO_TO_MESSAGE_DIR','.wav','2148JkRzpM','../auth/guards/roles.guard','../common/file','./dtos/text.dto','send','../streaming/streaming.service','textToAudioService','StreamingService','__metadata','saveMessage','deleteTextMessage','getAllMessage','metadata','Roles','Admin','streamingService','text','Body','assign','./saveStreamToFile','1055aXRAsf','167454SnKRfv','UseGuards','TextToAudioController','logger','1168488XyMNkK','145590oNIApD','design:returntype','20omKZaD','Logger','10808inXYvF','saveStreamToFile','volume','name','error\x20','1130176cKfVik','../auth/decorators/roles.decorator','path','__esModule','../common/audio/audio-player','decorate','design:paramtypes','../common/path','499232OFtqlj','defineProperty'];a145_0x49af=function(){return _0x385f25;};return a145_0x49af();}function a145_0x5d8b(_0x3b96e6,_0x3b9350){const _0x49afd8=a145_0x49af();return a145_0x5d8b=function(_0x5d8b9f,_0x1f0922){_0x5d8b9f=_0x5d8b9f-0x11b;let _0x40ec8a=_0x49afd8[_0x5d8b9f];return _0x40ec8a;},a145_0x5d8b(_0x3b96e6,_0x3b9350);}var __decorate=this&&this['__decorate']||function(_0x34de72,_0x56f6a5,_0x580570,_0x226470){const _0x431b3e=a145_0x5d8b;var _0x1c2484=arguments[_0x431b3e(0x11d)],_0x4d5391=_0x1c2484<0x3?_0x56f6a5:_0x226470===null?_0x226470=Object[_0x431b3e(0x16a)](_0x56f6a5,_0x580570):_0x226470,_0x5d4bec;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x4d5391=Reflect[_0x431b3e(0x152)](_0x34de72,_0x56f6a5,_0x580570,_0x226470);else{for(var _0xe693a7=_0x34de72['length']-0x1;_0xe693a7>=0x0;_0xe693a7--)if(_0x5d4bec=_0x34de72[_0xe693a7])_0x4d5391=(_0x1c2484<0x3?_0x5d4bec(_0x4d5391):_0x1c2484>0x3?_0x5d4bec(_0x56f6a5,_0x580570,_0x4d5391):_0x5d4bec(_0x56f6a5,_0x580570))||_0x4d5391;}return _0x1c2484>0x3&&_0x4d5391&&Object[_0x431b3e(0x156)](_0x56f6a5,_0x580570,_0x4d5391),_0x4d5391;},__metadata=this&&this[a145_0x5de479(0x132)]||function(_0x1d8884,_0x3db2be){const _0x2f6dcb=a145_0x5de479;if(typeof Reflect===_0x2f6dcb(0x159)&&typeof Reflect[_0x2f6dcb(0x136)]==='function')return Reflect['metadata'](_0x1d8884,_0x3db2be);},__param=this&&this[a145_0x5de479(0x15d)]||function(_0x79b380,_0x1bc4e6){return function(_0x3b8339,_0x1a69b4){_0x1bc4e6(_0x3b8339,_0x1a69b4,_0x79b380);};},TextToAudioController_1;Object[a145_0x5de479(0x156)](exports,a145_0x5de479(0x150),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require(a145_0x5de479(0x15b)),text_to_audio_service_1=require(a145_0x5de479(0x126)),text_dto_1=require(a145_0x5de479(0x12d)),streaming_service_1=require(a145_0x5de479(0x12f)),roles_decorator_1=require(a145_0x5de479(0x14e)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a145_0x5de479(0x122)),roles_guard_1=require(a145_0x5de479(0x12b)),saveStreamToFile_1=require(a145_0x5de479(0x13d)),path=require(a145_0x5de479(0x14f)),path_1=require(a145_0x5de479(0x154)),constants_1=require(a145_0x5de479(0x15c)),file_1=require(a145_0x5de479(0x12c)),audio_player_1=require(a145_0x5de479(0x151));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x171b1d,_0x27e95f){const _0x379f04=a145_0x5de479;this[_0x379f04(0x130)]=_0x171b1d,this[_0x379f04(0x139)]=_0x27e95f,this[_0x379f04(0x142)]=new common_1[(_0x379f04(0x147))](TextToAudioController_1[_0x379f04(0x14b)]);}async['playAudioFile'](_0xcf352f,_0x290583){const _0x5d08e7=a145_0x5de479;try{const _0x2011e3=_0x290583['text'];if(!_0x2011e3){_0xcf352f['send']('There\x20is\x20no\x20message\x20to\x20play');return;}const {id:_0x369160,volume:_0xd50f97}=await this['textToAudioService']['saveMessage'](_0x2011e3);!(0x0,file_1[_0x5d08e7(0x168)])(constants_1[_0x5d08e7(0x128)])&&(0x0,file_1[_0x5d08e7(0x157)])(constants_1[_0x5d08e7(0x128)]);const _0x4e783e=path[_0x5d08e7(0x11b)](path_1[_0x5d08e7(0x166)],constants_1[_0x5d08e7(0x128)]),_0x5e107c=_0x4e783e+'/'+_0x369160+_0x5d08e7(0x129);!(0x0,file_1[_0x5d08e7(0x168)])(_0x5e107c)?await this[_0x5d08e7(0x130)][_0x5d08e7(0x16b)](_0x290583[_0x5d08e7(0x13a)],async _0x5f69bd=>{const _0x282291=_0x5d08e7;await(0x0,saveStreamToFile_1[_0x282291(0x149)])(_0x5f69bd,_0x4e783e+'/'+_0x369160+_0x282291(0x129)),audio_player_1[_0x282291(0x125)][_0x282291(0x15e)](_0x5e107c,_0xd50f97!==null&&_0xd50f97!==void 0x0?_0xd50f97:0x32);}):audio_player_1[_0x5d08e7(0x125)][_0x5d08e7(0x15e)](_0x5e107c,_0xd50f97!==null&&_0xd50f97!==void 0x0?_0xd50f97:0x32),_0xcf352f[_0x5d08e7(0x12e)](_0x5d08e7(0x163)+_0x290583['text']);}catch(_0x5f186d){return this[_0x5d08e7(0x142)][_0x5d08e7(0x164)](_0x5f186d,'error'),'';}}async[a145_0x5de479(0x133)](_0x9cc143,_0x5871bf){const _0x4f7c7e=a145_0x5de479;try{const _0x3f0850=_0x5871bf[_0x4f7c7e(0x13a)];if(!_0x3f0850){_0x9cc143[_0x4f7c7e(0x12e)]('There\x20is\x20no\x20message\x20to\x20play');return;}await this[_0x4f7c7e(0x130)][_0x4f7c7e(0x133)](_0x3f0850),_0x9cc143[_0x4f7c7e(0x12e)]('Success\x20save\x20text:\x20'+_0x5871bf['text']);}catch(_0x362f55){return this[_0x4f7c7e(0x142)][_0x4f7c7e(0x164)](_0x362f55,_0x4f7c7e(0x14c)),'';}}async[a145_0x5de479(0x135)](){const _0x24f28c=a145_0x5de479;try{const _0x57d09b=await this['textToAudioService'][_0x24f28c(0x158)]();return _0x57d09b!==null&&_0x57d09b!==void 0x0?_0x57d09b:[];}catch(_0x27805e){return this['logger'][_0x24f28c(0x164)](_0x27805e,_0x24f28c(0x11e)),'';}}[a145_0x5de479(0x134)](_0x269ed4){const _0xc775ea=a145_0x5de479;return this[_0xc775ea(0x130)][_0xc775ea(0x134)](_0x269ed4);}[a145_0x5de479(0x167)](_0x46db9b,_0x30a65a){const _0x495425=a145_0x5de479;var _0x31110e;return this[_0x495425(0x130)][_0x495425(0x167)](_0x46db9b,Object[_0x495425(0x13c)](Object[_0x495425(0x13c)]({},_0x30a65a),{'volume':(_0x31110e=_0x30a65a[_0x495425(0x14a)])!==null&&_0x31110e!==void 0x0?_0x31110e:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a145_0x5de479(0x162)],roles_guard_1[a145_0x5de479(0x11f)]),(0x0,roles_decorator_1[a145_0x5de479(0x137)])(role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x138)],role_enum_1['Role'][a145_0x5de479(0x16c)]),__param(0x0,(0x0,common_1[a145_0x5de479(0x165)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x5de479(0x13b)])()),__metadata(a145_0x5de479(0x120),Function),__metadata(a145_0x5de479(0x153),[Object,text_dto_1[a145_0x5de479(0x11c)]]),__metadata('design:returntype',Promise)],TextToAudioController[a145_0x5de479(0x121)],a145_0x5de479(0x124),null),__decorate([(0x0,common_1[a145_0x5de479(0x15a)])('saveMessage'),(0x0,common_1[a145_0x5de479(0x140)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x5de479(0x11f)]),(0x0,roles_decorator_1[a145_0x5de479(0x137)])(role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x138)],role_enum_1['Role'][a145_0x5de479(0x16c)]),__param(0x0,(0x0,common_1[a145_0x5de479(0x165)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x5de479(0x13b)])()),__metadata(a145_0x5de479(0x120),Function),__metadata(a145_0x5de479(0x153),[Object,text_dto_1[a145_0x5de479(0x11c)]]),__metadata(a145_0x5de479(0x145),Promise)],TextToAudioController[a145_0x5de479(0x121)],a145_0x5de479(0x133),null),__decorate([(0x0,common_1['Get'])('/message'),(0x0,common_1[a145_0x5de479(0x140)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x138)],role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x16c)]),__metadata('design:type',Function),__metadata(a145_0x5de479(0x153),[]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],a145_0x5de479(0x135),null),__decorate([(0x0,common_1[a145_0x5de479(0x123)])('/:id'),(0x0,common_1[a145_0x5de479(0x140)])(jwt_guard_1[a145_0x5de479(0x162)],roles_guard_1[a145_0x5de479(0x11f)]),(0x0,roles_decorator_1[a145_0x5de479(0x137)])(role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x138)],role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x16c)]),__param(0x0,(0x0,common_1[a145_0x5de479(0x160)])('id')),__metadata(a145_0x5de479(0x120),Function),__metadata(a145_0x5de479(0x153),[String]),__metadata(a145_0x5de479(0x145),void 0x0)],TextToAudioController[a145_0x5de479(0x121)],a145_0x5de479(0x134),null),__decorate([(0x0,common_1['Put'])(a145_0x5de479(0x161)),(0x0,common_1[a145_0x5de479(0x140)])(jwt_guard_1[a145_0x5de479(0x162)],roles_guard_1[a145_0x5de479(0x11f)]),(0x0,roles_decorator_1[a145_0x5de479(0x137)])(role_enum_1['Role']['Admin'],role_enum_1[a145_0x5de479(0x169)][a145_0x5de479(0x16c)]),__param(0x0,(0x0,common_1[a145_0x5de479(0x160)])('id')),__param(0x1,(0x0,common_1[a145_0x5de479(0x13b)])()),__metadata('design:type',Function),__metadata(a145_0x5de479(0x153),[String,text_dto_1[a145_0x5de479(0x11c)]]),__metadata('design:returntype',void 0x0)],TextToAudioController['prototype'],a145_0x5de479(0x167),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x5de479(0x15f)])('textToAudio'),__metadata(a145_0x5de479(0x153),[text_to_audio_service_1['TextToAudioService'],streaming_service_1[a145_0x5de479(0x131)]])],TextToAudioController),exports[a145_0x5de479(0x141)]=TextToAudioController;