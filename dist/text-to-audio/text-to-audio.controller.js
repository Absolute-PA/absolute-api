'use strict';function a145_0x280e(_0x2a1094,_0x325885){const _0x37a69e=a145_0x37a6();return a145_0x280e=function(_0x280e53,_0x3d5d2e){_0x280e53=_0x280e53-0xe5;let _0x42a65d=_0x37a69e[_0x280e53];return _0x42a65d;},a145_0x280e(_0x2a1094,_0x325885);}const a145_0x149710=a145_0x280e;(function(_0x599704,_0x115738){const _0x1f9005=a145_0x280e,_0x1d02b9=_0x599704();while(!![]){try{const _0x2f59e5=-parseInt(_0x1f9005(0x101))/0x1*(-parseInt(_0x1f9005(0x114))/0x2)+parseInt(_0x1f9005(0x131))/0x3*(parseInt(_0x1f9005(0x104))/0x4)+parseInt(_0x1f9005(0x122))/0x5+-parseInt(_0x1f9005(0xf5))/0x6*(parseInt(_0x1f9005(0x12e))/0x7)+parseInt(_0x1f9005(0xfe))/0x8*(-parseInt(_0x1f9005(0x12f))/0x9)+-parseInt(_0x1f9005(0x10c))/0xa*(-parseInt(_0x1f9005(0x11b))/0xb)+parseInt(_0x1f9005(0x127))/0xc;if(_0x2f59e5===_0x115738)break;else _0x1d02b9['push'](_0x1d02b9['shift']());}catch(_0x354559){_0x1d02b9['push'](_0x1d02b9['shift']());}}}(a145_0x37a6,0x230ac));var __decorate=this&&this[a145_0x149710(0x120)]||function(_0x2090a5,_0x5a3f5e,_0x3e864d,_0x3496e8){const _0x321f86=a145_0x149710;var _0x417d22=arguments[_0x321f86(0x10d)],_0x25f06a=_0x417d22<0x3?_0x5a3f5e:_0x3496e8===null?_0x3496e8=Object[_0x321f86(0xf0)](_0x5a3f5e,_0x3e864d):_0x3496e8,_0x11ba16;if(typeof Reflect===_0x321f86(0x12a)&&typeof Reflect['decorate']===_0x321f86(0xfc))_0x25f06a=Reflect['decorate'](_0x2090a5,_0x5a3f5e,_0x3e864d,_0x3496e8);else{for(var _0x39322a=_0x2090a5['length']-0x1;_0x39322a>=0x0;_0x39322a--)if(_0x11ba16=_0x2090a5[_0x39322a])_0x25f06a=(_0x417d22<0x3?_0x11ba16(_0x25f06a):_0x417d22>0x3?_0x11ba16(_0x5a3f5e,_0x3e864d,_0x25f06a):_0x11ba16(_0x5a3f5e,_0x3e864d))||_0x25f06a;}return _0x417d22>0x3&&_0x25f06a&&Object[_0x321f86(0x123)](_0x5a3f5e,_0x3e864d,_0x25f06a),_0x25f06a;},__metadata=this&&this[a145_0x149710(0x134)]||function(_0x54853c,_0x3396c5){const _0x59e490=a145_0x149710;if(typeof Reflect==='object'&&typeof Reflect[_0x59e490(0xec)]===_0x59e490(0xfc))return Reflect[_0x59e490(0xec)](_0x54853c,_0x3396c5);},__param=this&&this[a145_0x149710(0xed)]||function(_0x16e099,_0x292902){return function(_0x48852f,_0x3d51e9){_0x292902(_0x48852f,_0x3d51e9,_0x16e099);};},TextToAudioController_1;Object['defineProperty'](exports,a145_0x149710(0x117),{'value':!![]}),exports[a145_0x149710(0xe6)]=void 0x0;function a145_0x37a6(){const _0x11ca82=['Logger','Success\x20play\x20text\x20to\x20audio:\x20','TextToAudioController','play','playAudioFile','getAllMessage','../streaming/streaming.service','Get','metadata','__param','getMessages','./text-to-audio.service','getOwnPropertyDescriptor','Roles','error\x20','AUDIO_TO_MESSAGE_DIR','send','755430sDdUed','path','StreamingService','Res','assign','TextToAudioService','design:returntype','function','../common/file','8btRxQp','log','saveStreamToFile','1qZRDsW','deleteTextMessage','name','1136332SuVKee','Post','Body','Param','Controller','AudioPlayer','error','../common/constants','316070QZhCpU','length','isFileExist','../auth/enums/role.enum','saveMessage','RolesGuard','logger','text','39944SQnRVm','Role','textToAudioService','__esModule','../common/audio/audio-player','./saveStreamToFile','volume','22GLzent','.wav','design:paramtypes','There\x20is\x20no\x20message\x20to\x20play','updateTextMessage','__decorate','/message','122500GUqCYy','defineProperty','Admin','../auth/guards/jwt.guard','design:type','1788120RXpGWx','createFolder','prototype','object','JwtAuthGuard','streamingService','User','14ixDzrW','1308933zfUvDj','TextDTO','3rViIWF','./dtos/text.dto','/:id','__metadata','UseGuards','../auth/guards/roles.guard'];a145_0x37a6=function(){return _0x11ca82;};return a145_0x37a6();}const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a145_0x149710(0xef)),text_dto_1=require(a145_0x149710(0x132)),streaming_service_1=require(a145_0x149710(0xea)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a145_0x149710(0x10f)),jwt_guard_1=require(a145_0x149710(0x125)),roles_guard_1=require(a145_0x149710(0x136)),saveStreamToFile_1=require(a145_0x149710(0x119)),path=require(a145_0x149710(0xf6)),path_1=require('../common/path'),constants_1=require(a145_0x149710(0x10b)),file_1=require(a145_0x149710(0xfd)),audio_player_1=require(a145_0x149710(0x118));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x498c2e,_0x310127){const _0x4eedc3=a145_0x149710;this[_0x4eedc3(0x116)]=_0x498c2e,this[_0x4eedc3(0x12c)]=_0x310127,this[_0x4eedc3(0x112)]=new common_1[(_0x4eedc3(0x137))](TextToAudioController_1[_0x4eedc3(0x103)]);}async[a145_0x149710(0xe8)](_0x3a7f1b,_0x5384b6){const _0x22b4c5=a145_0x149710;try{const _0x8cda0d=_0x5384b6[_0x22b4c5(0x113)];if(!_0x8cda0d){_0x3a7f1b[_0x22b4c5(0xf4)](_0x22b4c5(0x11e));return;}const {id:_0x29f8cb,volume:_0x18325b}=await this[_0x22b4c5(0x116)][_0x22b4c5(0x110)](_0x8cda0d);!(0x0,file_1[_0x22b4c5(0x10e)])(constants_1[_0x22b4c5(0xf3)])&&(0x0,file_1[_0x22b4c5(0x128)])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x38b65c=path['join'](path_1['processRootPath'],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x5c82bc=_0x38b65c+'/'+_0x29f8cb+'.wav';!(0x0,file_1['isFileExist'])(_0x5c82bc)?await this[_0x22b4c5(0x116)]['textToAudio'](_0x5384b6[_0x22b4c5(0x113)],async _0x27e005=>{const _0x529909=_0x22b4c5;await(0x0,saveStreamToFile_1[_0x529909(0x100)])(_0x27e005,_0x38b65c+'/'+_0x29f8cb+_0x529909(0x11c)),audio_player_1[_0x529909(0x109)][_0x529909(0xe7)](_0x5c82bc,_0x18325b!==null&&_0x18325b!==void 0x0?_0x18325b:0x32);}):audio_player_1[_0x22b4c5(0x109)]['play'](_0x5c82bc,_0x18325b!==null&&_0x18325b!==void 0x0?_0x18325b:0x32),_0x3a7f1b[_0x22b4c5(0xf4)](_0x22b4c5(0xe5)+_0x5384b6[_0x22b4c5(0x113)]);}catch(_0x1f7ffc){return this[_0x22b4c5(0x112)][_0x22b4c5(0xff)](_0x1f7ffc,_0x22b4c5(0x10a)),'';}}async['saveMessage'](_0x49bbe7,_0x5682ca){const _0x5da4a2=a145_0x149710;try{const _0x562ed4=_0x5682ca[_0x5da4a2(0x113)];if(!_0x562ed4){_0x49bbe7[_0x5da4a2(0xf4)](_0x5da4a2(0x11e));return;}await this[_0x5da4a2(0x116)][_0x5da4a2(0x110)](_0x562ed4),_0x49bbe7[_0x5da4a2(0xf4)]('Success\x20save\x20text:\x20'+_0x5682ca[_0x5da4a2(0x113)]);}catch(_0x5502fa){return this['logger'][_0x5da4a2(0xff)](_0x5502fa,_0x5da4a2(0xf2)),'';}}async[a145_0x149710(0xe9)](){const _0x83ebf4=a145_0x149710;try{const _0x3cea32=await this[_0x83ebf4(0x116)][_0x83ebf4(0xee)]();return _0x3cea32!==null&&_0x3cea32!==void 0x0?_0x3cea32:[];}catch(_0x78e86a){return this[_0x83ebf4(0x112)]['log'](_0x78e86a,_0x83ebf4(0x10a)),'';}}[a145_0x149710(0x102)](_0x48f2e3){const _0x3530f4=a145_0x149710;return this[_0x3530f4(0x116)][_0x3530f4(0x102)](_0x48f2e3);}['updateTextMessage'](_0x3ea809,_0x5ef70d){const _0x4d4bbb=a145_0x149710;var _0x45110b;return this[_0x4d4bbb(0x116)][_0x4d4bbb(0x11f)](_0x3ea809,Object['assign'](Object[_0x4d4bbb(0xf9)]({},_0x5ef70d),{'volume':(_0x45110b=_0x5ef70d[_0x4d4bbb(0x11a)])!==null&&_0x45110b!==void 0x0?_0x45110b:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a145_0x149710(0x135)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x149710(0x111)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x124)],role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x12d)]),__param(0x0,(0x0,common_1[a145_0x149710(0xf8)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x149710(0x106)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,text_dto_1['TextDTO']]),__metadata(a145_0x149710(0xfb),Promise)],TextToAudioController[a145_0x149710(0x129)],a145_0x149710(0xe8),null),__decorate([(0x0,common_1[a145_0x149710(0x105)])('saveMessage'),(0x0,common_1[a145_0x149710(0x135)])(jwt_guard_1[a145_0x149710(0x12b)],roles_guard_1[a145_0x149710(0x111)]),(0x0,roles_decorator_1[a145_0x149710(0xf1)])(role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x124)],role_enum_1['Role'][a145_0x149710(0x12d)]),__param(0x0,(0x0,common_1[a145_0x149710(0xf8)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x149710(0x106)])()),__metadata('design:type',Function),__metadata(a145_0x149710(0x11d),[Object,text_dto_1[a145_0x149710(0x130)]]),__metadata('design:returntype',Promise)],TextToAudioController[a145_0x149710(0x129)],a145_0x149710(0x110),null),__decorate([(0x0,common_1[a145_0x149710(0xeb)])(a145_0x149710(0x121)),(0x0,common_1[a145_0x149710(0x135)])(jwt_guard_1[a145_0x149710(0x12b)],roles_guard_1[a145_0x149710(0x111)]),(0x0,roles_decorator_1[a145_0x149710(0xf1)])(role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x124)],role_enum_1[a145_0x149710(0x115)]['User']),__metadata(a145_0x149710(0x126),Function),__metadata(a145_0x149710(0x11d),[]),__metadata(a145_0x149710(0xfb),Promise)],TextToAudioController[a145_0x149710(0x129)],a145_0x149710(0xe9),null),__decorate([(0x0,common_1['Delete'])(a145_0x149710(0x133)),(0x0,common_1[a145_0x149710(0x135)])(jwt_guard_1[a145_0x149710(0x12b)],roles_guard_1[a145_0x149710(0x111)]),(0x0,roles_decorator_1[a145_0x149710(0xf1)])(role_enum_1[a145_0x149710(0x115)]['Admin'],role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x12d)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a145_0x149710(0x126),Function),__metadata(a145_0x149710(0x11d),[String]),__metadata(a145_0x149710(0xfb),void 0x0)],TextToAudioController[a145_0x149710(0x129)],a145_0x149710(0x102),null),__decorate([(0x0,common_1['Put'])(a145_0x149710(0x133)),(0x0,common_1['UseGuards'])(jwt_guard_1[a145_0x149710(0x12b)],roles_guard_1[a145_0x149710(0x111)]),(0x0,roles_decorator_1[a145_0x149710(0xf1)])(role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x124)],role_enum_1[a145_0x149710(0x115)][a145_0x149710(0x12d)]),__param(0x0,(0x0,common_1[a145_0x149710(0x107)])('id')),__param(0x1,(0x0,common_1[a145_0x149710(0x106)])()),__metadata(a145_0x149710(0x126),Function),__metadata('design:paramtypes',[String,text_dto_1[a145_0x149710(0x130)]]),__metadata(a145_0x149710(0xfb),void 0x0)],TextToAudioController[a145_0x149710(0x129)],a145_0x149710(0x11f),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x149710(0x108)])('textToAudio'),__metadata('design:paramtypes',[text_to_audio_service_1[a145_0x149710(0xfa)],streaming_service_1[a145_0x149710(0xf7)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;