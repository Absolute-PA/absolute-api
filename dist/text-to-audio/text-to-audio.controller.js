'use strict';const a142_0xf4337f=a142_0x19d9;(function(_0x17cacc,_0x23a622){const _0x32c714=a142_0x19d9,_0x3160f5=_0x17cacc();while(!![]){try{const _0x4f2d1e=parseInt(_0x32c714(0x186))/0x1*(parseInt(_0x32c714(0x17e))/0x2)+-parseInt(_0x32c714(0x163))/0x3+-parseInt(_0x32c714(0x189))/0x4*(parseInt(_0x32c714(0x153))/0x5)+-parseInt(_0x32c714(0x17a))/0x6+parseInt(_0x32c714(0x187))/0x7+parseInt(_0x32c714(0x159))/0x8+parseInt(_0x32c714(0x188))/0x9;if(_0x4f2d1e===_0x23a622)break;else _0x3160f5['push'](_0x3160f5['shift']());}catch(_0x3dd8c0){_0x3160f5['push'](_0x3160f5['shift']());}}}(a142_0x2021,0xe24b3));function a142_0x19d9(_0x50167a,_0x3ba108){const _0x20212f=a142_0x2021();return a142_0x19d9=function(_0x19d90a,_0x27f103){_0x19d90a=_0x19d90a-0x143;let _0x565507=_0x20212f[_0x19d90a];return _0x565507;},a142_0x19d9(_0x50167a,_0x3ba108);}var __decorate=this&&this['__decorate']||function(_0x981fda,_0x26e735,_0x40485b,_0x14e238){const _0x4c31ce=a142_0x19d9;var _0x480755=arguments[_0x4c31ce(0x178)],_0x531345=_0x480755<0x3?_0x26e735:_0x14e238===null?_0x14e238=Object['getOwnPropertyDescriptor'](_0x26e735,_0x40485b):_0x14e238,_0x1228f0;if(typeof Reflect===_0x4c31ce(0x162)&&typeof Reflect['decorate']===_0x4c31ce(0x170))_0x531345=Reflect[_0x4c31ce(0x173)](_0x981fda,_0x26e735,_0x40485b,_0x14e238);else{for(var _0x1b38cd=_0x981fda[_0x4c31ce(0x178)]-0x1;_0x1b38cd>=0x0;_0x1b38cd--)if(_0x1228f0=_0x981fda[_0x1b38cd])_0x531345=(_0x480755<0x3?_0x1228f0(_0x531345):_0x480755>0x3?_0x1228f0(_0x26e735,_0x40485b,_0x531345):_0x1228f0(_0x26e735,_0x40485b))||_0x531345;}return _0x480755>0x3&&_0x531345&&Object[_0x4c31ce(0x154)](_0x26e735,_0x40485b,_0x531345),_0x531345;},__metadata=this&&this[a142_0xf4337f(0x160)]||function(_0x4d2a30,_0x29e10a){const _0x15f2fa=a142_0xf4337f;if(typeof Reflect===_0x15f2fa(0x162)&&typeof Reflect[_0x15f2fa(0x144)]===_0x15f2fa(0x170))return Reflect[_0x15f2fa(0x144)](_0x4d2a30,_0x29e10a);},__param=this&&this[a142_0xf4337f(0x145)]||function(_0x2dee92,_0x555be1){return function(_0x43647c,_0x4e43bb){_0x555be1(_0x43647c,_0x4e43bb,_0x2dee92);};},TextToAudioController_1;Object['defineProperty'](exports,a142_0xf4337f(0x166),{'value':!![]}),exports[a142_0xf4337f(0x17c)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a142_0xf4337f(0x16a)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a142_0xf4337f(0x146)),roles_decorator_1=require(a142_0xf4337f(0x14b)),role_enum_1=require(a142_0xf4337f(0x152)),jwt_guard_1=require(a142_0xf4337f(0x168)),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require(a142_0xf4337f(0x17d)),path=require(a142_0xf4337f(0x182)),path_1=require(a142_0xf4337f(0x14a)),constants_1=require(a142_0xf4337f(0x16f)),file_1=require('../common/file'),audio_player_1=require(a142_0xf4337f(0x18d));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x31f6df,_0x36347b){const _0x13b4b2=a142_0xf4337f;this['textToAudioService']=_0x31f6df,this[_0x13b4b2(0x16b)]=_0x36347b,this['logger']=new common_1[(_0x13b4b2(0x15f))](TextToAudioController_1[_0x13b4b2(0x174)]);}async[a142_0xf4337f(0x17b)](_0x2ee7c1,_0x22a26f){const _0x1a2f53=a142_0xf4337f;try{const _0x282411=_0x22a26f[_0x1a2f53(0x16e)];if(!_0x282411){_0x2ee7c1[_0x1a2f53(0x16c)](_0x1a2f53(0x17f));return;}const {id:_0x57c5e1,volume:_0x377be6}=await this[_0x1a2f53(0x16d)][_0x1a2f53(0x15e)](_0x282411);!(0x0,file_1[_0x1a2f53(0x165)])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1['createFolder'])(constants_1[_0x1a2f53(0x180)]);const _0x25fd9d=path[_0x1a2f53(0x171)](path_1['processRootPath'],constants_1[_0x1a2f53(0x180)]),_0x415f1d=_0x25fd9d+'/'+_0x57c5e1+'.wav';!(0x0,file_1[_0x1a2f53(0x165)])(_0x415f1d)?await this[_0x1a2f53(0x16d)][_0x1a2f53(0x156)](_0x22a26f['text'],async _0x5e4d40=>{const _0x33d600=_0x1a2f53;await(0x0,saveStreamToFile_1[_0x33d600(0x18a)])(_0x5e4d40,_0x25fd9d+'/'+_0x57c5e1+_0x33d600(0x14d)),audio_player_1[_0x33d600(0x143)]['play'](_0x415f1d,_0x377be6!==null&&_0x377be6!==void 0x0?_0x377be6:0x32);}):audio_player_1['AudioPlayer'][_0x1a2f53(0x181)](_0x415f1d,_0x377be6!==null&&_0x377be6!==void 0x0?_0x377be6:0x32),_0x2ee7c1[_0x1a2f53(0x16c)](_0x1a2f53(0x184)+_0x22a26f[_0x1a2f53(0x16e)]);}catch(_0x9aa0f8){return this['logger'][_0x1a2f53(0x14c)](_0x9aa0f8,'error'),'';}}async[a142_0xf4337f(0x15e)](_0xb12e73,_0x26a1a7){const _0x4f1d00=a142_0xf4337f;try{const _0x3666c8=_0x26a1a7['text'];if(!_0x3666c8){_0xb12e73['send'](_0x4f1d00(0x17f));return;}await this[_0x4f1d00(0x16d)][_0x4f1d00(0x15e)](_0x3666c8),_0xb12e73['send'](_0x4f1d00(0x164)+_0x26a1a7['text']);}catch(_0x1adbb0){return this[_0x4f1d00(0x172)]['log'](_0x1adbb0,_0x4f1d00(0x148)),'';}}async['getAllMessage'](){const _0x3f74d6=a142_0xf4337f;try{const _0x2d2206=await this['textToAudioService'][_0x3f74d6(0x15a)]();return _0x2d2206!==null&&_0x2d2206!==void 0x0?_0x2d2206:[];}catch(_0x12c2f4){return this[_0x3f74d6(0x172)][_0x3f74d6(0x14c)](_0x12c2f4,_0x3f74d6(0x15b)),'';}}['deleteTextMessage'](_0x270a05){const _0xabba23=a142_0xf4337f;return this[_0xabba23(0x16d)][_0xabba23(0x15c)](_0x270a05);}['updateTextMessage'](_0x1134c3,_0x309d77){const _0x5ecf4f=a142_0xf4337f;var _0x2706c2;return this['textToAudioService']['updateTextMessage'](_0x1134c3,Object['assign'](Object[_0x5ecf4f(0x15d)]({},_0x309d77),{'volume':(_0x2706c2=_0x309d77['volume'])!==null&&_0x2706c2!==void 0x0?_0x2706c2:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a142_0xf4337f(0x161)])(jwt_guard_1[a142_0xf4337f(0x18c)],roles_guard_1[a142_0xf4337f(0x158)]),(0x0,roles_decorator_1[a142_0xf4337f(0x150)])(role_enum_1[a142_0xf4337f(0x183)][a142_0xf4337f(0x157)],role_enum_1[a142_0xf4337f(0x183)]['User']),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0xf4337f(0x175),Function),__metadata(a142_0xf4337f(0x155),[Object,text_dto_1[a142_0xf4337f(0x179)]]),__metadata(a142_0xf4337f(0x177),Promise)],TextToAudioController['prototype'],a142_0xf4337f(0x17b),null),__decorate([(0x0,common_1[a142_0xf4337f(0x167)])(a142_0xf4337f(0x15e)),(0x0,common_1[a142_0xf4337f(0x161)])(jwt_guard_1[a142_0xf4337f(0x18c)],roles_guard_1[a142_0xf4337f(0x158)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a142_0xf4337f(0x157)],role_enum_1[a142_0xf4337f(0x183)][a142_0xf4337f(0x149)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0xf4337f(0x14f)])()),__metadata(a142_0xf4337f(0x175),Function),__metadata(a142_0xf4337f(0x155),[Object,text_dto_1['TextDTO']]),__metadata(a142_0xf4337f(0x177),Promise)],TextToAudioController['prototype'],'saveMessage',null),__decorate([(0x0,common_1[a142_0xf4337f(0x185)])('/message'),(0x0,common_1[a142_0xf4337f(0x161)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0xf4337f(0x158)]),(0x0,roles_decorator_1[a142_0xf4337f(0x150)])(role_enum_1[a142_0xf4337f(0x183)][a142_0xf4337f(0x157)],role_enum_1['Role'][a142_0xf4337f(0x149)]),__metadata(a142_0xf4337f(0x175),Function),__metadata(a142_0xf4337f(0x155),[]),__metadata(a142_0xf4337f(0x177),Promise)],TextToAudioController['prototype'],'getAllMessage',null),__decorate([(0x0,common_1[a142_0xf4337f(0x169)])(a142_0xf4337f(0x147)),(0x0,common_1[a142_0xf4337f(0x161)])(jwt_guard_1[a142_0xf4337f(0x18c)],roles_guard_1[a142_0xf4337f(0x158)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0xf4337f(0x183)][a142_0xf4337f(0x157)],role_enum_1[a142_0xf4337f(0x183)][a142_0xf4337f(0x149)]),__param(0x0,(0x0,common_1[a142_0xf4337f(0x14e)])('id')),__metadata('design:type',Function),__metadata(a142_0xf4337f(0x155),[String]),__metadata(a142_0xf4337f(0x177),void 0x0)],TextToAudioController['prototype'],'deleteTextMessage',null),__decorate([(0x0,common_1['Put'])(a142_0xf4337f(0x147)),(0x0,common_1[a142_0xf4337f(0x161)])(jwt_guard_1[a142_0xf4337f(0x18c)],roles_guard_1[a142_0xf4337f(0x158)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a142_0xf4337f(0x157)],role_enum_1[a142_0xf4337f(0x183)][a142_0xf4337f(0x149)]),__param(0x0,(0x0,common_1[a142_0xf4337f(0x14e)])('id')),__param(0x1,(0x0,common_1[a142_0xf4337f(0x14f)])()),__metadata(a142_0xf4337f(0x175),Function),__metadata('design:paramtypes',[String,text_dto_1['TextDTO']]),__metadata(a142_0xf4337f(0x177),void 0x0)],TextToAudioController[a142_0xf4337f(0x176)],a142_0xf4337f(0x18b),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0xf4337f(0x151)])(a142_0xf4337f(0x156)),__metadata(a142_0xf4337f(0x155),[text_to_audio_service_1['TextToAudioService'],streaming_service_1['StreamingService']])],TextToAudioController),exports[a142_0xf4337f(0x17c)]=TextToAudioController;function a142_0x2021(){const _0x391cc7=['Delete','./text-to-audio.service','streamingService','send','textToAudioService','text','../common/constants','function','join','logger','decorate','name','design:type','prototype','design:returntype','length','TextDTO','3628698rxERNz','playAudioFile','TextToAudioController','./saveStreamToFile','1011658URJvXL','There\x20is\x20no\x20message\x20to\x20play','AUDIO_TO_MESSAGE_DIR','play','path','Role','Success\x20play\x20text\x20to\x20audio:\x20','Get','3wdqQjF','7931749MdpAjA','15427206wGBWsv','4rLbOxI','saveStreamToFile','updateTextMessage','JwtAuthGuard','../common/audio/audio-player','AudioPlayer','metadata','__param','../streaming/streaming.service','/:id','error\x20','User','../common/path','../auth/decorators/roles.decorator','log','.wav','Param','Body','Roles','Controller','../auth/enums/role.enum','8979605eslfgD','defineProperty','design:paramtypes','textToAudio','Admin','RolesGuard','3729448WFRIFj','getMessages','error','deleteTextMessage','assign','saveMessage','Logger','__metadata','UseGuards','object','4509918nqKJOo','Success\x20save\x20text:\x20','isFileExist','__esModule','Post','../auth/guards/jwt.guard'];a142_0x2021=function(){return _0x391cc7;};return a142_0x2021();}