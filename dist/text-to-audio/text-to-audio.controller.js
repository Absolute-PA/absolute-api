'use strict';const a145_0x5c2673=a145_0x490e;function a145_0x490e(_0x21bab9,_0x504d0e){const _0x3c04f5=a145_0x3c04();return a145_0x490e=function(_0x490e38,_0x257cf3){_0x490e38=_0x490e38-0xdd;let _0x1110a2=_0x3c04f5[_0x490e38];return _0x1110a2;},a145_0x490e(_0x21bab9,_0x504d0e);}(function(_0x5293a6,_0x1d8ad6){const _0x19eba3=a145_0x490e,_0x27698e=_0x5293a6();while(!![]){try{const _0x188b5b=parseInt(_0x19eba3(0x121))/0x1*(-parseInt(_0x19eba3(0xdd))/0x2)+-parseInt(_0x19eba3(0xfb))/0x3*(-parseInt(_0x19eba3(0xed))/0x4)+-parseInt(_0x19eba3(0x10c))/0x5*(-parseInt(_0x19eba3(0x12e))/0x6)+-parseInt(_0x19eba3(0x122))/0x7*(parseInt(_0x19eba3(0x11f))/0x8)+parseInt(_0x19eba3(0x12c))/0x9+parseInt(_0x19eba3(0x11a))/0xa*(parseInt(_0x19eba3(0x130))/0xb)+parseInt(_0x19eba3(0x102))/0xc*(-parseInt(_0x19eba3(0xfa))/0xd);if(_0x188b5b===_0x1d8ad6)break;else _0x27698e['push'](_0x27698e['shift']());}catch(_0x52a787){_0x27698e['push'](_0x27698e['shift']());}}}(a145_0x3c04,0x4044d));function a145_0x3c04(){const _0xae97cb=['61070vEcxZy','textToAudioService','AudioPlayer','__decorate','path','16TpPlAl','getMessages','176126Gcmqfj','863863DmeujT','logger','Res','Param','defineProperty','../auth/decorators/roles.decorator','There\x20is\x20no\x20message\x20to\x20play','updateTextMessage','saveMessage','../auth/guards/jwt.guard','2650644gqeulx','../common/file','1958586XTxENC','User','352ngztsu','2BiGLWW','textToAudio','function','Post','design:paramtypes','design:type','TextDTO','../streaming/streaming.service','StreamingService','AUDIO_TO_MESSAGE_DIR','text','../common/constants','getAllMessage','TextToAudioService','send','join','1188RcRamA','assign','playAudioFile','createFolder','../auth/guards/roles.guard','isFileExist','.wav','Put','length','name','saveStreamToFile','log','metadata','61932UowrQU','3834IvHFGW','error','decorate','Body','prototype','./dtos/text.dto','Success\x20play\x20text\x20to\x20audio:\x20','1284etecLB','volume','Delete','Role','__metadata','deleteTextMessage','play','Admin','./saveStreamToFile','UseGuards','5slCWlR','object','/:id','JwtAuthGuard','design:returntype','Success\x20save\x20text:\x20','error\x20','TextToAudioController','__esModule','../common/audio/audio-player','getOwnPropertyDescriptor','Roles','RolesGuard','../auth/enums/role.enum'];a145_0x3c04=function(){return _0xae97cb;};return a145_0x3c04();}var __decorate=this&&this[a145_0x5c2673(0x11d)]||function(_0x45a4c7,_0x217be8,_0xdfc095,_0x1bb1dd){const _0xd6c297=a145_0x5c2673;var _0x1e37cc=arguments[_0xd6c297(0xf5)],_0x3004d6=_0x1e37cc<0x3?_0x217be8:_0x1bb1dd===null?_0x1bb1dd=Object[_0xd6c297(0x116)](_0x217be8,_0xdfc095):_0x1bb1dd,_0x25b93a;if(typeof Reflect===_0xd6c297(0x10d)&&typeof Reflect['decorate']===_0xd6c297(0xdf))_0x3004d6=Reflect[_0xd6c297(0xfd)](_0x45a4c7,_0x217be8,_0xdfc095,_0x1bb1dd);else{for(var _0x10e2e2=_0x45a4c7['length']-0x1;_0x10e2e2>=0x0;_0x10e2e2--)if(_0x25b93a=_0x45a4c7[_0x10e2e2])_0x3004d6=(_0x1e37cc<0x3?_0x25b93a(_0x3004d6):_0x1e37cc>0x3?_0x25b93a(_0x217be8,_0xdfc095,_0x3004d6):_0x25b93a(_0x217be8,_0xdfc095))||_0x3004d6;}return _0x1e37cc>0x3&&_0x3004d6&&Object[_0xd6c297(0x126)](_0x217be8,_0xdfc095,_0x3004d6),_0x3004d6;},__metadata=this&&this[a145_0x5c2673(0x106)]||function(_0x5d7391,_0x3f6189){const _0x11e0cb=a145_0x5c2673;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x11e0cb(0xdf))return Reflect[_0x11e0cb(0xf9)](_0x5d7391,_0x3f6189);},__param=this&&this['__param']||function(_0x2bf444,_0x5a2307){return function(_0x587f89,_0x1a5c69){_0x5a2307(_0x587f89,_0x1a5c69,_0x2bf444);};},TextToAudioController_1;Object[a145_0x5c2673(0x126)](exports,a145_0x5c2673(0x114),{'value':!![]}),exports[a145_0x5c2673(0x113)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require('./text-to-audio.service'),text_dto_1=require(a145_0x5c2673(0x100)),streaming_service_1=require(a145_0x5c2673(0xe4)),roles_decorator_1=require(a145_0x5c2673(0x127)),role_enum_1=require(a145_0x5c2673(0x119)),jwt_guard_1=require(a145_0x5c2673(0x12b)),roles_guard_1=require(a145_0x5c2673(0xf1)),saveStreamToFile_1=require(a145_0x5c2673(0x10a)),path=require(a145_0x5c2673(0x11e)),path_1=require('../common/path'),constants_1=require(a145_0x5c2673(0xe8)),file_1=require(a145_0x5c2673(0x12d)),audio_player_1=require(a145_0x5c2673(0x115));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x4dd42a,_0x460041){const _0x19c21f=a145_0x5c2673;this[_0x19c21f(0x11b)]=_0x4dd42a,this['streamingService']=_0x460041,this[_0x19c21f(0x123)]=new common_1['Logger'](TextToAudioController_1[_0x19c21f(0xf6)]);}async[a145_0x5c2673(0xef)](_0x55acbb,_0x230d35){const _0x565192=a145_0x5c2673;try{const _0x4667fb=_0x230d35['text'];if(!_0x4667fb){_0x55acbb['send'](_0x565192(0x128));return;}const {id:_0x462b6d,volume:_0x5d700e}=await this['textToAudioService']['saveMessage'](_0x4667fb);!(0x0,file_1[_0x565192(0xf2)])(constants_1[_0x565192(0xe6)])&&(0x0,file_1[_0x565192(0xf0)])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x59584a=path[_0x565192(0xec)](path_1['processRootPath'],constants_1[_0x565192(0xe6)]),_0x2078aa=_0x59584a+'/'+_0x462b6d+_0x565192(0xf3);!(0x0,file_1[_0x565192(0xf2)])(_0x2078aa)?await this[_0x565192(0x11b)][_0x565192(0xde)](_0x230d35[_0x565192(0xe7)],async _0xdae641=>{const _0x4caf75=_0x565192;await(0x0,saveStreamToFile_1[_0x4caf75(0xf7)])(_0xdae641,_0x59584a+'/'+_0x462b6d+'.wav'),audio_player_1['AudioPlayer'][_0x4caf75(0x108)](_0x2078aa,_0x5d700e!==null&&_0x5d700e!==void 0x0?_0x5d700e:0x32);}):audio_player_1[_0x565192(0x11c)][_0x565192(0x108)](_0x2078aa,_0x5d700e!==null&&_0x5d700e!==void 0x0?_0x5d700e:0x32),_0x55acbb[_0x565192(0xeb)](_0x565192(0x101)+_0x230d35[_0x565192(0xe7)]);}catch(_0x14e3b5){return this[_0x565192(0x123)][_0x565192(0xf8)](_0x14e3b5,_0x565192(0xfc)),'';}}async['saveMessage'](_0x35cd6f,_0x488c40){const _0x326c08=a145_0x5c2673;try{const _0x55ad78=_0x488c40['text'];if(!_0x55ad78){_0x35cd6f[_0x326c08(0xeb)](_0x326c08(0x128));return;}await this[_0x326c08(0x11b)]['saveMessage'](_0x55ad78),_0x35cd6f[_0x326c08(0xeb)](_0x326c08(0x111)+_0x488c40[_0x326c08(0xe7)]);}catch(_0x5656fa){return this['logger'][_0x326c08(0xf8)](_0x5656fa,_0x326c08(0x112)),'';}}async[a145_0x5c2673(0xe9)](){const _0x5d9470=a145_0x5c2673;try{const _0x5bbba0=await this[_0x5d9470(0x11b)][_0x5d9470(0x120)]();return _0x5bbba0!==null&&_0x5bbba0!==void 0x0?_0x5bbba0:[];}catch(_0x3d4ccf){return this[_0x5d9470(0x123)][_0x5d9470(0xf8)](_0x3d4ccf,_0x5d9470(0xfc)),'';}}[a145_0x5c2673(0x107)](_0xac093e){const _0x59915e=a145_0x5c2673;return this['textToAudioService'][_0x59915e(0x107)](_0xac093e);}['updateTextMessage'](_0x814940,_0x552193){const _0x5e791c=a145_0x5c2673;var _0x20c8c7;return this['textToAudioService'][_0x5e791c(0x129)](_0x814940,Object[_0x5e791c(0xee)](Object[_0x5e791c(0xee)]({},_0x552193),{'volume':(_0x20c8c7=_0x552193[_0x5e791c(0x103)])!==null&&_0x20c8c7!==void 0x0?_0x20c8c7:0x32}));}};__decorate([(0x0,common_1[a145_0x5c2673(0xe0)])('/'),(0x0,common_1[a145_0x5c2673(0x10b)])(jwt_guard_1[a145_0x5c2673(0x10f)],roles_guard_1[a145_0x5c2673(0x118)]),(0x0,roles_decorator_1[a145_0x5c2673(0x117)])(role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x109)],role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x12f)]),__param(0x0,(0x0,common_1[a145_0x5c2673(0x124)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x5c2673(0xfe)])()),__metadata(a145_0x5c2673(0xe2),Function),__metadata(a145_0x5c2673(0xe1),[Object,text_dto_1[a145_0x5c2673(0xe3)]]),__metadata('design:returntype',Promise)],TextToAudioController[a145_0x5c2673(0xff)],a145_0x5c2673(0xef),null),__decorate([(0x0,common_1[a145_0x5c2673(0xe0)])(a145_0x5c2673(0x12a)),(0x0,common_1[a145_0x5c2673(0x10b)])(jwt_guard_1[a145_0x5c2673(0x10f)],roles_guard_1[a145_0x5c2673(0x118)]),(0x0,roles_decorator_1[a145_0x5c2673(0x117)])(role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x109)],role_enum_1[a145_0x5c2673(0x105)]['User']),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x5c2673(0xfe)])()),__metadata('design:type',Function),__metadata(a145_0x5c2673(0xe1),[Object,text_dto_1[a145_0x5c2673(0xe3)]]),__metadata(a145_0x5c2673(0x110),Promise)],TextToAudioController['prototype'],a145_0x5c2673(0x12a),null),__decorate([(0x0,common_1['Get'])('/message'),(0x0,common_1[a145_0x5c2673(0x10b)])(jwt_guard_1[a145_0x5c2673(0x10f)],roles_guard_1[a145_0x5c2673(0x118)]),(0x0,roles_decorator_1[a145_0x5c2673(0x117)])(role_enum_1['Role'][a145_0x5c2673(0x109)],role_enum_1[a145_0x5c2673(0x105)]['User']),__metadata(a145_0x5c2673(0xe2),Function),__metadata(a145_0x5c2673(0xe1),[]),__metadata(a145_0x5c2673(0x110),Promise)],TextToAudioController[a145_0x5c2673(0xff)],a145_0x5c2673(0xe9),null),__decorate([(0x0,common_1[a145_0x5c2673(0x104)])(a145_0x5c2673(0x10e)),(0x0,common_1[a145_0x5c2673(0x10b)])(jwt_guard_1[a145_0x5c2673(0x10f)],roles_guard_1[a145_0x5c2673(0x118)]),(0x0,roles_decorator_1[a145_0x5c2673(0x117)])(role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x109)],role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x12f)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a145_0x5c2673(0xe2),Function),__metadata(a145_0x5c2673(0xe1),[String]),__metadata(a145_0x5c2673(0x110),void 0x0)],TextToAudioController[a145_0x5c2673(0xff)],a145_0x5c2673(0x107),null),__decorate([(0x0,common_1[a145_0x5c2673(0xf4)])(a145_0x5c2673(0x10e)),(0x0,common_1[a145_0x5c2673(0x10b)])(jwt_guard_1[a145_0x5c2673(0x10f)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x109)],role_enum_1[a145_0x5c2673(0x105)][a145_0x5c2673(0x12f)]),__param(0x0,(0x0,common_1[a145_0x5c2673(0x125)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x5c2673(0xe2),Function),__metadata('design:paramtypes',[String,text_dto_1['TextDTO']]),__metadata('design:returntype',void 0x0)],TextToAudioController[a145_0x5c2673(0xff)],a145_0x5c2673(0x129),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a145_0x5c2673(0xde)),__metadata(a145_0x5c2673(0xe1),[text_to_audio_service_1[a145_0x5c2673(0xea)],streaming_service_1[a145_0x5c2673(0xe5)]])],TextToAudioController),exports[a145_0x5c2673(0x113)]=TextToAudioController;