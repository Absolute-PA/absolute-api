'use strict';const a142_0x3f5305=a142_0x5920;(function(_0x1c7347,_0x43981e){const _0x330a56=a142_0x5920,_0x46dfaf=_0x1c7347();while(!![]){try{const _0x3d724a=-parseInt(_0x330a56(0xcb))/0x1+parseInt(_0x330a56(0xd1))/0x2+-parseInt(_0x330a56(0xf7))/0x3+-parseInt(_0x330a56(0xd6))/0x4+-parseInt(_0x330a56(0xc6))/0x5+-parseInt(_0x330a56(0xb5))/0x6*(-parseInt(_0x330a56(0xf1))/0x7)+parseInt(_0x330a56(0xc9))/0x8;if(_0x3d724a===_0x43981e)break;else _0x46dfaf['push'](_0x46dfaf['shift']());}catch(_0x11ebb0){_0x46dfaf['push'](_0x46dfaf['shift']());}}}(a142_0x285b,0x9241c));var __decorate=this&&this[a142_0x3f5305(0xcf)]||function(_0x338da9,_0x4ba7b7,_0x5f3ab1,_0x2dee53){const _0x32df6a=a142_0x3f5305;var _0x4d5df0=arguments[_0x32df6a(0xde)],_0x5ecf2a=_0x4d5df0<0x3?_0x4ba7b7:_0x2dee53===null?_0x2dee53=Object[_0x32df6a(0xc5)](_0x4ba7b7,_0x5f3ab1):_0x2dee53,_0x45b093;if(typeof Reflect===_0x32df6a(0xce)&&typeof Reflect[_0x32df6a(0xf8)]===_0x32df6a(0xf9))_0x5ecf2a=Reflect[_0x32df6a(0xf8)](_0x338da9,_0x4ba7b7,_0x5f3ab1,_0x2dee53);else{for(var _0x50913d=_0x338da9[_0x32df6a(0xde)]-0x1;_0x50913d>=0x0;_0x50913d--)if(_0x45b093=_0x338da9[_0x50913d])_0x5ecf2a=(_0x4d5df0<0x3?_0x45b093(_0x5ecf2a):_0x4d5df0>0x3?_0x45b093(_0x4ba7b7,_0x5f3ab1,_0x5ecf2a):_0x45b093(_0x4ba7b7,_0x5f3ab1))||_0x5ecf2a;}return _0x4d5df0>0x3&&_0x5ecf2a&&Object[_0x32df6a(0xbb)](_0x4ba7b7,_0x5f3ab1,_0x5ecf2a),_0x5ecf2a;},__metadata=this&&this[a142_0x3f5305(0xc4)]||function(_0x4b7cf0,_0x360c4b){const _0x104bdf=a142_0x3f5305;if(typeof Reflect==='object'&&typeof Reflect[_0x104bdf(0xc7)]===_0x104bdf(0xf9))return Reflect['metadata'](_0x4b7cf0,_0x360c4b);},__param=this&&this[a142_0x3f5305(0xb0)]||function(_0x4de8c4,_0x4b761f){return function(_0x417c7a,_0x16913b){_0x4b761f(_0x417c7a,_0x16913b,_0x4de8c4);};},TextToAudioController_1;function a142_0x285b(){const _0x5229f8=['Roles','TextToAudioService','../streaming/streaming.service','getMessages','logger','__esModule','217kcKONm','textToAudio','Role','./text-to-audio.service','../common/path','TextDTO','2126043TXHHoG','decorate','function','name','UseGuards','play','text','__param','playAudioFile','TextToAudioController','design:returntype','Success\x20play\x20text\x20to\x20audio:\x20','40974egDbMD','prototype','Logger','../common/audio/audio-player','../auth/decorators/roles.decorator','RolesGuard','defineProperty','design:type','./dtos/text.dto','.wav','StreamingService','textToAudioService','streamingService','AUDIO_TO_MESSAGE_DIR','Post','__metadata','getOwnPropertyDescriptor','5698600onorMp','metadata','updateTextMessage','30927552tkUCRt','AudioPlayer','690012lxtzdu','volume','User','object','__decorate','../auth/enums/role.enum','377010NwkSVk','../auth/guards/jwt.guard','saveStreamToFile','error','design:paramtypes','4514668yUTzyg','assign','Admin','send','Controller','getAllMessage','../common/constants','processRootPath','length','deleteTextMessage','JwtAuthGuard','log','/message','/:id','isFileExist','saveMessage','./saveStreamToFile','Body','../auth/guards/roles.guard','There\x20is\x20no\x20message\x20to\x20play','path'];a142_0x285b=function(){return _0x5229f8;};return a142_0x285b();}Object[a142_0x3f5305(0xbb)](exports,a142_0x3f5305(0xf0),{'value':!![]}),exports[a142_0x3f5305(0xb2)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a142_0x3f5305(0xf4)),text_dto_1=require(a142_0x3f5305(0xbd)),streaming_service_1=require(a142_0x3f5305(0xed)),roles_decorator_1=require(a142_0x3f5305(0xb9)),role_enum_1=require(a142_0x3f5305(0xd0)),jwt_guard_1=require(a142_0x3f5305(0xd2)),roles_guard_1=require(a142_0x3f5305(0xe8)),saveStreamToFile_1=require(a142_0x3f5305(0xe6)),path=require(a142_0x3f5305(0xea)),path_1=require(a142_0x3f5305(0xf5)),constants_1=require(a142_0x3f5305(0xdc)),file_1=require('../common/file'),audio_player_1=require(a142_0x3f5305(0xb8));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x326778,_0x2e81b4){const _0x42a6d1=a142_0x3f5305;this[_0x42a6d1(0xc0)]=_0x326778,this[_0x42a6d1(0xc1)]=_0x2e81b4,this[_0x42a6d1(0xef)]=new common_1[(_0x42a6d1(0xb7))](TextToAudioController_1[_0x42a6d1(0xfa)]);}async['playAudioFile'](_0xa36f4d,_0x3f0e9d){const _0x51b402=a142_0x3f5305;try{const _0x3bc569=_0x3f0e9d[_0x51b402(0xfd)];if(!_0x3bc569){_0xa36f4d[_0x51b402(0xd9)](_0x51b402(0xe9));return;}const {id:_0x4c1f90,volume:_0xe1d70a}=await this[_0x51b402(0xc0)][_0x51b402(0xe5)](_0x3bc569);!(0x0,file_1[_0x51b402(0xe4)])(constants_1[_0x51b402(0xc2)])&&(0x0,file_1['createFolder'])(constants_1[_0x51b402(0xc2)]);const _0xf44c2e=path['join'](path_1[_0x51b402(0xdd)],constants_1[_0x51b402(0xc2)]),_0x38194b=_0xf44c2e+'/'+_0x4c1f90+_0x51b402(0xbe);!(0x0,file_1[_0x51b402(0xe4)])(_0x38194b)?await this[_0x51b402(0xc0)][_0x51b402(0xf2)](_0x3f0e9d[_0x51b402(0xfd)],async _0x188e59=>{const _0x412d5a=_0x51b402;await(0x0,saveStreamToFile_1[_0x412d5a(0xd3)])(_0x188e59,_0xf44c2e+'/'+_0x4c1f90+'.wav'),audio_player_1[_0x412d5a(0xca)][_0x412d5a(0xfc)](_0x38194b,_0xe1d70a!==null&&_0xe1d70a!==void 0x0?_0xe1d70a:0x32);}):audio_player_1['AudioPlayer'][_0x51b402(0xfc)](_0x38194b,_0xe1d70a!==null&&_0xe1d70a!==void 0x0?_0xe1d70a:0x32),_0xa36f4d['send'](_0x51b402(0xb4)+_0x3f0e9d['text']);}catch(_0x2cb190){return this['logger'][_0x51b402(0xe1)](_0x2cb190,_0x51b402(0xd4)),'';}}async[a142_0x3f5305(0xe5)](_0x520bf6,_0x5499f1){const _0x54ec55=a142_0x3f5305;try{const _0x28a0fa=_0x5499f1[_0x54ec55(0xfd)];if(!_0x28a0fa){_0x520bf6[_0x54ec55(0xd9)](_0x54ec55(0xe9));return;}await this[_0x54ec55(0xc0)][_0x54ec55(0xe5)](_0x28a0fa),_0x520bf6[_0x54ec55(0xd9)]('Success\x20save\x20text:\x20'+_0x5499f1[_0x54ec55(0xfd)]);}catch(_0x4126fd){return this[_0x54ec55(0xef)][_0x54ec55(0xe1)](_0x4126fd,'error\x20'),'';}}async[a142_0x3f5305(0xdb)](){const _0x5a5a3e=a142_0x3f5305;try{const _0x59ee4e=await this[_0x5a5a3e(0xc0)][_0x5a5a3e(0xee)]();return _0x59ee4e!==null&&_0x59ee4e!==void 0x0?_0x59ee4e:[];}catch(_0x5ca547){return this[_0x5a5a3e(0xef)][_0x5a5a3e(0xe1)](_0x5ca547,_0x5a5a3e(0xd4)),'';}}['deleteTextMessage'](_0x5743cb){const _0x794357=a142_0x3f5305;return this[_0x794357(0xc0)]['deleteTextMessage'](_0x5743cb);}[a142_0x3f5305(0xc8)](_0x50a54b,_0x16a36a){const _0x265518=a142_0x3f5305;var _0x2cebbe;return this[_0x265518(0xc0)][_0x265518(0xc8)](_0x50a54b,Object['assign'](Object[_0x265518(0xd7)]({},_0x16a36a),{'volume':(_0x2cebbe=_0x16a36a[_0x265518(0xcc)])!==null&&_0x2cebbe!==void 0x0?_0x2cebbe:0x32}));}};function a142_0x5920(_0x305da2,_0x58b379){const _0x285b3e=a142_0x285b();return a142_0x5920=function(_0x59205d,_0x4c48cc){_0x59205d=_0x59205d-0xb0;let _0x2c61b6=_0x285b3e[_0x59205d];return _0x2c61b6;},a142_0x5920(_0x305da2,_0x58b379);}__decorate([(0x0,common_1[a142_0x3f5305(0xc3)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x3f5305(0xe0)],roles_guard_1[a142_0x3f5305(0xba)]),(0x0,roles_decorator_1[a142_0x3f5305(0xeb)])(role_enum_1['Role'][a142_0x3f5305(0xd8)],role_enum_1[a142_0x3f5305(0xf3)][a142_0x3f5305(0xcd)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x3f5305(0xe7)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x3f5305(0xf6)]]),__metadata(a142_0x3f5305(0xb3),Promise)],TextToAudioController[a142_0x3f5305(0xb6)],a142_0x3f5305(0xb1),null),__decorate([(0x0,common_1[a142_0x3f5305(0xc3)])(a142_0x3f5305(0xe5)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x3f5305(0xe0)],roles_guard_1[a142_0x3f5305(0xba)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a142_0x3f5305(0xd8)],role_enum_1[a142_0x3f5305(0xf3)][a142_0x3f5305(0xcd)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x3f5305(0xbc),Function),__metadata(a142_0x3f5305(0xd5),[Object,text_dto_1['TextDTO']]),__metadata(a142_0x3f5305(0xb3),Promise)],TextToAudioController[a142_0x3f5305(0xb6)],a142_0x3f5305(0xe5),null),__decorate([(0x0,common_1['Get'])(a142_0x3f5305(0xe2)),(0x0,common_1[a142_0x3f5305(0xfb)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x3f5305(0xba)]),(0x0,roles_decorator_1[a142_0x3f5305(0xeb)])(role_enum_1['Role'][a142_0x3f5305(0xd8)],role_enum_1['Role'][a142_0x3f5305(0xcd)]),__metadata(a142_0x3f5305(0xbc),Function),__metadata(a142_0x3f5305(0xd5),[]),__metadata(a142_0x3f5305(0xb3),Promise)],TextToAudioController[a142_0x3f5305(0xb6)],a142_0x3f5305(0xdb),null),__decorate([(0x0,common_1['Delete'])(a142_0x3f5305(0xe3)),(0x0,common_1[a142_0x3f5305(0xfb)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x3f5305(0xba)]),(0x0,roles_decorator_1[a142_0x3f5305(0xeb)])(role_enum_1['Role']['Admin'],role_enum_1[a142_0x3f5305(0xf3)][a142_0x3f5305(0xcd)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x3f5305(0xbc),Function),__metadata(a142_0x3f5305(0xd5),[String]),__metadata(a142_0x3f5305(0xb3),void 0x0)],TextToAudioController['prototype'],a142_0x3f5305(0xdf),null),__decorate([(0x0,common_1['Put'])(a142_0x3f5305(0xe3)),(0x0,common_1[a142_0x3f5305(0xfb)])(jwt_guard_1[a142_0x3f5305(0xe0)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x3f5305(0xf3)][a142_0x3f5305(0xd8)],role_enum_1[a142_0x3f5305(0xf3)][a142_0x3f5305(0xcd)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a142_0x3f5305(0xe7)])()),__metadata('design:type',Function),__metadata(a142_0x3f5305(0xd5),[String,text_dto_1['TextDTO']]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x3f5305(0xb6)],a142_0x3f5305(0xc8),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x3f5305(0xda)])(a142_0x3f5305(0xf2)),__metadata(a142_0x3f5305(0xd5),[text_to_audio_service_1[a142_0x3f5305(0xec)],streaming_service_1[a142_0x3f5305(0xbf)]])],TextToAudioController),exports[a142_0x3f5305(0xb2)]=TextToAudioController;