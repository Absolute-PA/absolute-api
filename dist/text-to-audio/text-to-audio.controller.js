'use strict';const a145_0x59a8a7=a145_0x541e;function a145_0x32d0(){const _0x326676=['log','Logger','deleteTextMessage','getAllMessage','name','TextToAudioService','error\x20','../auth/guards/jwt.guard','../common/file','Res','path','RolesGuard','Delete','116xFVxLM','play','__param','1341760YBUtzG','../common/constants','../auth/decorators/roles.decorator','defineProperty','createFolder','length','AUDIO_TO_MESSAGE_DIR','prototype','1339698CXJgtV','design:type','design:paramtypes','decorate','assign','Success\x20save\x20text:\x20','Post','User','updateTextMessage','TextToAudioController','./saveStreamToFile','textToAudioService','__metadata','/:id','Param','52313107Bxjaas','8040752SmCAxI','StreamingService','Success\x20play\x20text\x20to\x20audio:\x20','object','isFileExist','94yQDBKW','.wav','23169ikUQRj','saveStreamToFile','design:returntype','./text-to-audio.service','processRootPath','Roles','There\x20is\x20no\x20message\x20to\x20play','getMessages','AudioPlayer','__esModule','saveMessage','Role','../auth/guards/roles.guard','UseGuards','TextDTO','streamingService','108nLigeq','textToAudio','text','../auth/enums/role.enum','Admin','error','7CqcBgz','JwtAuthGuard','function','logger','join','82578QlmNoZ','metadata','send','../streaming/streaming.service','6924380ArvBjU','Controller','../common/audio/audio-player'];a145_0x32d0=function(){return _0x326676;};return a145_0x32d0();}(function(_0x169b70,_0x3820be){const _0x23de98=a145_0x541e,_0x326aed=_0x169b70();while(!![]){try{const _0x3b6e52=parseInt(_0x23de98(0x218))/0x1*(parseInt(_0x23de98(0x216))/0x2)+parseInt(_0x23de98(0x233))/0x3*(-parseInt(_0x23de98(0x1f6))/0x4)+-parseInt(_0x23de98(0x237))/0x5+parseInt(_0x23de98(0x201))/0x6*(-parseInt(_0x23de98(0x22e))/0x7)+-parseInt(_0x23de98(0x211))/0x8+-parseInt(_0x23de98(0x228))/0x9*(parseInt(_0x23de98(0x1f9))/0xa)+parseInt(_0x23de98(0x210))/0xb;if(_0x3b6e52===_0x3820be)break;else _0x326aed['push'](_0x326aed['shift']());}catch(_0x58dfc9){_0x326aed['push'](_0x326aed['shift']());}}}(a145_0x32d0,0xc8f15));function a145_0x541e(_0x5d7f57,_0x50690e){const _0x32d030=a145_0x32d0();return a145_0x541e=function(_0x541e61,_0x295b1f){_0x541e61=_0x541e61-0x1ea;let _0x16fd18=_0x32d030[_0x541e61];return _0x16fd18;},a145_0x541e(_0x5d7f57,_0x50690e);}var __decorate=this&&this['__decorate']||function(_0x4457d2,_0xf5795d,_0x4dcdb5,_0x5910ce){const _0x4b35a2=a145_0x541e;var _0x526fb2=arguments['length'],_0x38805d=_0x526fb2<0x3?_0xf5795d:_0x5910ce===null?_0x5910ce=Object['getOwnPropertyDescriptor'](_0xf5795d,_0x4dcdb5):_0x5910ce,_0x543a2a;if(typeof Reflect===_0x4b35a2(0x214)&&typeof Reflect[_0x4b35a2(0x204)]===_0x4b35a2(0x230))_0x38805d=Reflect[_0x4b35a2(0x204)](_0x4457d2,_0xf5795d,_0x4dcdb5,_0x5910ce);else{for(var _0x4db307=_0x4457d2[_0x4b35a2(0x1fe)]-0x1;_0x4db307>=0x0;_0x4db307--)if(_0x543a2a=_0x4457d2[_0x4db307])_0x38805d=(_0x526fb2<0x3?_0x543a2a(_0x38805d):_0x526fb2>0x3?_0x543a2a(_0xf5795d,_0x4dcdb5,_0x38805d):_0x543a2a(_0xf5795d,_0x4dcdb5))||_0x38805d;}return _0x526fb2>0x3&&_0x38805d&&Object['defineProperty'](_0xf5795d,_0x4dcdb5,_0x38805d),_0x38805d;},__metadata=this&&this[a145_0x59a8a7(0x20d)]||function(_0x212f95,_0x351924){const _0x4c2d7b=a145_0x59a8a7;if(typeof Reflect===_0x4c2d7b(0x214)&&typeof Reflect[_0x4c2d7b(0x234)]===_0x4c2d7b(0x230))return Reflect[_0x4c2d7b(0x234)](_0x212f95,_0x351924);},__param=this&&this[a145_0x59a8a7(0x1f8)]||function(_0x693193,_0xb08e14){return function(_0x37eb70,_0x58ffef){_0xb08e14(_0x37eb70,_0x58ffef,_0x693193);};},TextToAudioController_1;Object[a145_0x59a8a7(0x1fc)](exports,a145_0x59a8a7(0x221),{'value':!![]}),exports[a145_0x59a8a7(0x20a)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a145_0x59a8a7(0x21b)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a145_0x59a8a7(0x236)),roles_decorator_1=require(a145_0x59a8a7(0x1fb)),role_enum_1=require(a145_0x59a8a7(0x22b)),jwt_guard_1=require(a145_0x59a8a7(0x1f0)),roles_guard_1=require(a145_0x59a8a7(0x224)),saveStreamToFile_1=require(a145_0x59a8a7(0x20b)),path=require(a145_0x59a8a7(0x1f3)),path_1=require('../common/path'),constants_1=require(a145_0x59a8a7(0x1fa)),file_1=require(a145_0x59a8a7(0x1f1)),audio_player_1=require(a145_0x59a8a7(0x239));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x2082cd,_0x253847){const _0x24dc0c=a145_0x59a8a7;this[_0x24dc0c(0x20c)]=_0x2082cd,this[_0x24dc0c(0x227)]=_0x253847,this['logger']=new common_1[(_0x24dc0c(0x1ea))](TextToAudioController_1[_0x24dc0c(0x1ed)]);}async['playAudioFile'](_0x1be4e1,_0x5ce40a){const _0x5426a3=a145_0x59a8a7;try{const _0x43121c=_0x5ce40a[_0x5426a3(0x22a)];if(!_0x43121c){_0x1be4e1[_0x5426a3(0x235)]('There\x20is\x20no\x20message\x20to\x20play');return;}const {id:_0x32d5d9,volume:_0x28dc36}=await this[_0x5426a3(0x20c)][_0x5426a3(0x222)](_0x43121c);!(0x0,file_1[_0x5426a3(0x215)])(constants_1[_0x5426a3(0x1ff)])&&(0x0,file_1[_0x5426a3(0x1fd)])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x12b804=path[_0x5426a3(0x232)](path_1[_0x5426a3(0x21c)],constants_1[_0x5426a3(0x1ff)]),_0x50ff2a=_0x12b804+'/'+_0x32d5d9+_0x5426a3(0x217);!(0x0,file_1[_0x5426a3(0x215)])(_0x50ff2a)?await this[_0x5426a3(0x20c)][_0x5426a3(0x229)](_0x5ce40a[_0x5426a3(0x22a)],async _0x129ea1=>{const _0x32b4d6=_0x5426a3;await(0x0,saveStreamToFile_1[_0x32b4d6(0x219)])(_0x129ea1,_0x12b804+'/'+_0x32d5d9+_0x32b4d6(0x217)),audio_player_1[_0x32b4d6(0x220)][_0x32b4d6(0x1f7)](_0x50ff2a,_0x28dc36!==null&&_0x28dc36!==void 0x0?_0x28dc36:0x32);}):audio_player_1[_0x5426a3(0x220)][_0x5426a3(0x1f7)](_0x50ff2a,_0x28dc36!==null&&_0x28dc36!==void 0x0?_0x28dc36:0x32),_0x1be4e1[_0x5426a3(0x235)](_0x5426a3(0x213)+_0x5ce40a[_0x5426a3(0x22a)]);}catch(_0x326267){return this[_0x5426a3(0x231)][_0x5426a3(0x23a)](_0x326267,_0x5426a3(0x22d)),'';}}async[a145_0x59a8a7(0x222)](_0x418cf1,_0x1c17d1){const _0x2ebc33=a145_0x59a8a7;try{const _0x317e31=_0x1c17d1['text'];if(!_0x317e31){_0x418cf1['send'](_0x2ebc33(0x21e));return;}await this[_0x2ebc33(0x20c)][_0x2ebc33(0x222)](_0x317e31),_0x418cf1[_0x2ebc33(0x235)](_0x2ebc33(0x206)+_0x1c17d1['text']);}catch(_0x173274){return this[_0x2ebc33(0x231)]['log'](_0x173274,_0x2ebc33(0x1ef)),'';}}async[a145_0x59a8a7(0x1ec)](){const _0x25eebe=a145_0x59a8a7;try{const _0x1a899a=await this[_0x25eebe(0x20c)][_0x25eebe(0x21f)]();return _0x1a899a!==null&&_0x1a899a!==void 0x0?_0x1a899a:[];}catch(_0x5553b5){return this[_0x25eebe(0x231)]['log'](_0x5553b5,_0x25eebe(0x22d)),'';}}[a145_0x59a8a7(0x1eb)](_0x37d36c){const _0x458dc8=a145_0x59a8a7;return this[_0x458dc8(0x20c)][_0x458dc8(0x1eb)](_0x37d36c);}[a145_0x59a8a7(0x209)](_0x2a36fc,_0x576c7d){const _0x188fbf=a145_0x59a8a7;var _0x200190;return this['textToAudioService'][_0x188fbf(0x209)](_0x2a36fc,Object[_0x188fbf(0x205)](Object[_0x188fbf(0x205)]({},_0x576c7d),{'volume':(_0x200190=_0x576c7d['volume'])!==null&&_0x200190!==void 0x0?_0x200190:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a145_0x59a8a7(0x225)])(jwt_guard_1[a145_0x59a8a7(0x22f)],roles_guard_1[a145_0x59a8a7(0x1f4)]),(0x0,roles_decorator_1[a145_0x59a8a7(0x21d)])(role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x22c)],role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x208)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x59a8a7(0x202),Function),__metadata(a145_0x59a8a7(0x203),[Object,text_dto_1[a145_0x59a8a7(0x226)]]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],'playAudioFile',null),__decorate([(0x0,common_1[a145_0x59a8a7(0x207)])(a145_0x59a8a7(0x222)),(0x0,common_1[a145_0x59a8a7(0x225)])(jwt_guard_1[a145_0x59a8a7(0x22f)],roles_guard_1[a145_0x59a8a7(0x1f4)]),(0x0,roles_decorator_1[a145_0x59a8a7(0x21d)])(role_enum_1['Role'][a145_0x59a8a7(0x22c)],role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x208)]),__param(0x0,(0x0,common_1[a145_0x59a8a7(0x1f2)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x59a8a7(0x202),Function),__metadata('design:paramtypes',[Object,text_dto_1[a145_0x59a8a7(0x226)]]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],a145_0x59a8a7(0x222),null),__decorate([(0x0,common_1['Get'])('/message'),(0x0,common_1['UseGuards'])(jwt_guard_1[a145_0x59a8a7(0x22f)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x59a8a7(0x21d)])(role_enum_1['Role'][a145_0x59a8a7(0x22c)],role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x208)]),__metadata('design:type',Function),__metadata(a145_0x59a8a7(0x203),[]),__metadata(a145_0x59a8a7(0x21a),Promise)],TextToAudioController[a145_0x59a8a7(0x200)],a145_0x59a8a7(0x1ec),null),__decorate([(0x0,common_1[a145_0x59a8a7(0x1f5)])(a145_0x59a8a7(0x20e)),(0x0,common_1[a145_0x59a8a7(0x225)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x59a8a7(0x21d)])(role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x22c)],role_enum_1['Role'][a145_0x59a8a7(0x208)]),__param(0x0,(0x0,common_1[a145_0x59a8a7(0x20f)])('id')),__metadata(a145_0x59a8a7(0x202),Function),__metadata(a145_0x59a8a7(0x203),[String]),__metadata('design:returntype',void 0x0)],TextToAudioController['prototype'],a145_0x59a8a7(0x1eb),null),__decorate([(0x0,common_1['Put'])(a145_0x59a8a7(0x20e)),(0x0,common_1[a145_0x59a8a7(0x225)])(jwt_guard_1[a145_0x59a8a7(0x22f)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x59a8a7(0x21d)])(role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x22c)],role_enum_1[a145_0x59a8a7(0x223)][a145_0x59a8a7(0x208)]),__param(0x0,(0x0,common_1[a145_0x59a8a7(0x20f)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x59a8a7(0x202),Function),__metadata('design:paramtypes',[String,text_dto_1[a145_0x59a8a7(0x226)]]),__metadata(a145_0x59a8a7(0x21a),void 0x0)],TextToAudioController['prototype'],a145_0x59a8a7(0x209),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0x59a8a7(0x238)])('textToAudio'),__metadata('design:paramtypes',[text_to_audio_service_1[a145_0x59a8a7(0x1ee)],streaming_service_1[a145_0x59a8a7(0x212)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;