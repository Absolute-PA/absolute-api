'use strict';const a145_0x51a4d2=a145_0x20d9;(function(_0x9a6970,_0x2fadf0){const _0x1097cb=a145_0x20d9,_0x5e08d3=_0x9a6970();while(!![]){try{const _0x1232a0=-parseInt(_0x1097cb(0x1d6))/0x1+parseInt(_0x1097cb(0x1a4))/0x2+-parseInt(_0x1097cb(0x1d1))/0x3+parseInt(_0x1097cb(0x1e9))/0x4+parseInt(_0x1097cb(0x1e8))/0x5+-parseInt(_0x1097cb(0x1e0))/0x6*(parseInt(_0x1097cb(0x1d9))/0x7)+-parseInt(_0x1097cb(0x1c1))/0x8*(-parseInt(_0x1097cb(0x1b2))/0x9);if(_0x1232a0===_0x2fadf0)break;else _0x5e08d3['push'](_0x5e08d3['shift']());}catch(_0x230fdb){_0x5e08d3['push'](_0x5e08d3['shift']());}}}(a145_0x2a7e,0x610a3));function a145_0x2a7e(){const _0x365bb5=['__metadata','../auth/enums/role.enum','TextDTO','391058qMQdkO','path','design:returntype','Success\x20save\x20text:\x20','AudioPlayer','Admin','RolesGuard','../common/audio/audio-player','name','deleteTextMessage','design:paramtypes','../streaming/streaming.service','isFileExist','volume','117BXBfew','Post','User','object','playAudioFile','Delete','saveStreamToFile','logger','processRootPath','play','UseGuards','StreamingService','decorate','design:type','__esModule','201464rdcRFD','streamingService','./text-to-audio.service','function','Param','@nestjs/common','metadata','defineProperty','There\x20is\x20no\x20message\x20to\x20play','textToAudioService','AUDIO_TO_MESSAGE_DIR','Res','textToAudio','saveMessage','getAllMessage','getOwnPropertyDescriptor','214533EwNxpV','error','prototype','log','Get','133610GSFvnB','Role','join','7fRStQL','.wav','/message','Success\x20play\x20text\x20to\x20audio:\x20','send','__decorate','updateTextMessage','1972704uQxfND','Body','getMessages','length','assign','TextToAudioController','./saveStreamToFile','Roles','348085LfYleZ','1355420mTFrbc','Put','text','../common/constants','JwtAuthGuard','TextToAudioService','../common/file'];a145_0x2a7e=function(){return _0x365bb5;};return a145_0x2a7e();}var __decorate=this&&this[a145_0x51a4d2(0x1de)]||function(_0x440f8f,_0x28bee4,_0x27c8cb,_0x2c1010){const _0x15139c=a145_0x51a4d2;var _0x49f964=arguments[_0x15139c(0x1e3)],_0x2107c0=_0x49f964<0x3?_0x28bee4:_0x2c1010===null?_0x2c1010=Object[_0x15139c(0x1d0)](_0x28bee4,_0x27c8cb):_0x2c1010,_0x532d62;if(typeof Reflect===_0x15139c(0x1b5)&&typeof Reflect[_0x15139c(0x1be)]===_0x15139c(0x1c4))_0x2107c0=Reflect[_0x15139c(0x1be)](_0x440f8f,_0x28bee4,_0x27c8cb,_0x2c1010);else{for(var _0x4c0c5c=_0x440f8f[_0x15139c(0x1e3)]-0x1;_0x4c0c5c>=0x0;_0x4c0c5c--)if(_0x532d62=_0x440f8f[_0x4c0c5c])_0x2107c0=(_0x49f964<0x3?_0x532d62(_0x2107c0):_0x49f964>0x3?_0x532d62(_0x28bee4,_0x27c8cb,_0x2107c0):_0x532d62(_0x28bee4,_0x27c8cb))||_0x2107c0;}return _0x49f964>0x3&&_0x2107c0&&Object[_0x15139c(0x1c8)](_0x28bee4,_0x27c8cb,_0x2107c0),_0x2107c0;},__metadata=this&&this[a145_0x51a4d2(0x1a1)]||function(_0x3965a6,_0x496c1e){const _0x537ed0=a145_0x51a4d2;if(typeof Reflect===_0x537ed0(0x1b5)&&typeof Reflect[_0x537ed0(0x1c7)]===_0x537ed0(0x1c4))return Reflect[_0x537ed0(0x1c7)](_0x3965a6,_0x496c1e);},__param=this&&this['__param']||function(_0x15c0a2,_0x232b1c){return function(_0x1ab212,_0xdc64d0){_0x232b1c(_0x1ab212,_0xdc64d0,_0x15c0a2);};},TextToAudioController_1;Object[a145_0x51a4d2(0x1c8)](exports,a145_0x51a4d2(0x1c0),{'value':!![]}),exports[a145_0x51a4d2(0x1e5)]=void 0x0;const common_1=require(a145_0x51a4d2(0x1c6)),text_to_audio_service_1=require(a145_0x51a4d2(0x1c3)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a145_0x51a4d2(0x1af)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a145_0x51a4d2(0x1a2)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require(a145_0x51a4d2(0x1e6)),path=require(a145_0x51a4d2(0x1a5)),path_1=require('../common/path'),constants_1=require(a145_0x51a4d2(0x19d)),file_1=require(a145_0x51a4d2(0x1a0)),audio_player_1=require(a145_0x51a4d2(0x1ab));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x46956d,_0x1a4110){const _0x79f141=a145_0x51a4d2;this[_0x79f141(0x1ca)]=_0x46956d,this[_0x79f141(0x1c2)]=_0x1a4110,this[_0x79f141(0x1b9)]=new common_1['Logger'](TextToAudioController_1[_0x79f141(0x1ac)]);}async[a145_0x51a4d2(0x1b6)](_0x7e650d,_0x5defbf){const _0xa09da=a145_0x51a4d2;try{const _0x50048d=_0x5defbf[_0xa09da(0x19c)];if(!_0x50048d){_0x7e650d['send']('There\x20is\x20no\x20message\x20to\x20play');return;}const {id:_0xe60315,volume:_0x733ed9}=await this[_0xa09da(0x1ca)][_0xa09da(0x1ce)](_0x50048d);!(0x0,file_1[_0xa09da(0x1b0)])(constants_1[_0xa09da(0x1cb)])&&(0x0,file_1['createFolder'])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x35e9eb=path[_0xa09da(0x1d8)](path_1[_0xa09da(0x1ba)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x315204=_0x35e9eb+'/'+_0xe60315+_0xa09da(0x1da);!(0x0,file_1[_0xa09da(0x1b0)])(_0x315204)?await this[_0xa09da(0x1ca)][_0xa09da(0x1cd)](_0x5defbf[_0xa09da(0x19c)],async _0x2475c0=>{const _0x1115db=_0xa09da;await(0x0,saveStreamToFile_1[_0x1115db(0x1b8)])(_0x2475c0,_0x35e9eb+'/'+_0xe60315+_0x1115db(0x1da)),audio_player_1[_0x1115db(0x1a8)]['play'](_0x315204,_0x733ed9!==null&&_0x733ed9!==void 0x0?_0x733ed9:0x32);}):audio_player_1['AudioPlayer'][_0xa09da(0x1bb)](_0x315204,_0x733ed9!==null&&_0x733ed9!==void 0x0?_0x733ed9:0x32),_0x7e650d[_0xa09da(0x1dd)](_0xa09da(0x1dc)+_0x5defbf[_0xa09da(0x19c)]);}catch(_0x7ad8dc){return this[_0xa09da(0x1b9)]['log'](_0x7ad8dc,_0xa09da(0x1d2)),'';}}async['saveMessage'](_0x23cabf,_0x2a4cd6){const _0x1c5544=a145_0x51a4d2;try{const _0x23c017=_0x2a4cd6[_0x1c5544(0x19c)];if(!_0x23c017){_0x23cabf[_0x1c5544(0x1dd)](_0x1c5544(0x1c9));return;}await this[_0x1c5544(0x1ca)][_0x1c5544(0x1ce)](_0x23c017),_0x23cabf[_0x1c5544(0x1dd)](_0x1c5544(0x1a7)+_0x2a4cd6['text']);}catch(_0x471a0a){return this[_0x1c5544(0x1b9)][_0x1c5544(0x1d4)](_0x471a0a,'error\x20'),'';}}async[a145_0x51a4d2(0x1cf)](){const _0x29ab7f=a145_0x51a4d2;try{const _0x1396fd=await this[_0x29ab7f(0x1ca)][_0x29ab7f(0x1e2)]();return _0x1396fd!==null&&_0x1396fd!==void 0x0?_0x1396fd:[];}catch(_0x773856){return this['logger'][_0x29ab7f(0x1d4)](_0x773856,_0x29ab7f(0x1d2)),'';}}[a145_0x51a4d2(0x1ad)](_0xbc69e2){const _0x27188a=a145_0x51a4d2;return this[_0x27188a(0x1ca)][_0x27188a(0x1ad)](_0xbc69e2);}[a145_0x51a4d2(0x1df)](_0x478c82,_0x17638a){const _0x27b925=a145_0x51a4d2;var _0x3d5c8f;return this[_0x27b925(0x1ca)][_0x27b925(0x1df)](_0x478c82,Object[_0x27b925(0x1e4)](Object[_0x27b925(0x1e4)]({},_0x17638a),{'volume':(_0x3d5c8f=_0x17638a[_0x27b925(0x1b1)])!==null&&_0x3d5c8f!==void 0x0?_0x3d5c8f:0x32}));}};function a145_0x20d9(_0x48402f,_0x425252){const _0x2a7e30=a145_0x2a7e();return a145_0x20d9=function(_0x20d98b,_0x5d961f){_0x20d98b=_0x20d98b-0x19c;let _0x3f0507=_0x2a7e30[_0x20d98b];return _0x3f0507;},a145_0x20d9(_0x48402f,_0x425252);}__decorate([(0x0,common_1[a145_0x51a4d2(0x1b3)])('/'),(0x0,common_1[a145_0x51a4d2(0x1bc)])(jwt_guard_1[a145_0x51a4d2(0x19e)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1a9)],role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1b4)]),__param(0x0,(0x0,common_1[a145_0x51a4d2(0x1cc)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,text_dto_1['TextDTO']]),__metadata(a145_0x51a4d2(0x1a6),Promise)],TextToAudioController[a145_0x51a4d2(0x1d3)],a145_0x51a4d2(0x1b6),null),__decorate([(0x0,common_1[a145_0x51a4d2(0x1b3)])(a145_0x51a4d2(0x1ce)),(0x0,common_1[a145_0x51a4d2(0x1bc)])(jwt_guard_1[a145_0x51a4d2(0x19e)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x51a4d2(0x1e7)])(role_enum_1['Role'][a145_0x51a4d2(0x1a9)],role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1b4)]),__param(0x0,(0x0,common_1[a145_0x51a4d2(0x1cc)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x51a4d2(0x1e1)])()),__metadata(a145_0x51a4d2(0x1bf),Function),__metadata(a145_0x51a4d2(0x1ae),[Object,text_dto_1[a145_0x51a4d2(0x1a3)]]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],a145_0x51a4d2(0x1ce),null),__decorate([(0x0,common_1[a145_0x51a4d2(0x1d5)])(a145_0x51a4d2(0x1db)),(0x0,common_1[a145_0x51a4d2(0x1bc)])(jwt_guard_1[a145_0x51a4d2(0x19e)],roles_guard_1[a145_0x51a4d2(0x1aa)]),(0x0,roles_decorator_1[a145_0x51a4d2(0x1e7)])(role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1a9)],role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1b4)]),__metadata(a145_0x51a4d2(0x1bf),Function),__metadata(a145_0x51a4d2(0x1ae),[]),__metadata(a145_0x51a4d2(0x1a6),Promise)],TextToAudioController[a145_0x51a4d2(0x1d3)],'getAllMessage',null),__decorate([(0x0,common_1[a145_0x51a4d2(0x1b7)])('/:id'),(0x0,common_1[a145_0x51a4d2(0x1bc)])(jwt_guard_1[a145_0x51a4d2(0x19e)],roles_guard_1[a145_0x51a4d2(0x1aa)]),(0x0,roles_decorator_1[a145_0x51a4d2(0x1e7)])(role_enum_1[a145_0x51a4d2(0x1d7)]['Admin'],role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1b4)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata('design:type',Function),__metadata('design:paramtypes',[String]),__metadata(a145_0x51a4d2(0x1a6),void 0x0)],TextToAudioController[a145_0x51a4d2(0x1d3)],a145_0x51a4d2(0x1ad),null),__decorate([(0x0,common_1[a145_0x51a4d2(0x1ea)])('/:id'),(0x0,common_1[a145_0x51a4d2(0x1bc)])(jwt_guard_1[a145_0x51a4d2(0x19e)],roles_guard_1[a145_0x51a4d2(0x1aa)]),(0x0,roles_decorator_1[a145_0x51a4d2(0x1e7)])(role_enum_1[a145_0x51a4d2(0x1d7)][a145_0x51a4d2(0x1a9)],role_enum_1['Role'][a145_0x51a4d2(0x1b4)]),__param(0x0,(0x0,common_1[a145_0x51a4d2(0x1c5)])('id')),__param(0x1,(0x0,common_1[a145_0x51a4d2(0x1e1)])()),__metadata(a145_0x51a4d2(0x1bf),Function),__metadata(a145_0x51a4d2(0x1ae),[String,text_dto_1[a145_0x51a4d2(0x1a3)]]),__metadata(a145_0x51a4d2(0x1a6),void 0x0)],TextToAudioController[a145_0x51a4d2(0x1d3)],a145_0x51a4d2(0x1df),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a145_0x51a4d2(0x1cd)),__metadata(a145_0x51a4d2(0x1ae),[text_to_audio_service_1[a145_0x51a4d2(0x19f)],streaming_service_1[a145_0x51a4d2(0x1bd)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;