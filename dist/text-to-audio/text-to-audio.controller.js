'use strict';const a142_0x2db6c6=a142_0x3e79;(function(_0x2dbfb8,_0x43d277){const _0x211888=a142_0x3e79,_0x40abf1=_0x2dbfb8();while(!![]){try{const _0x3d85e0=parseInt(_0x211888(0x1ce))/0x1+parseInt(_0x211888(0x1d9))/0x2*(parseInt(_0x211888(0x1fb))/0x3)+parseInt(_0x211888(0x1cd))/0x4+-parseInt(_0x211888(0x1e5))/0x5+parseInt(_0x211888(0x1ed))/0x6*(-parseInt(_0x211888(0x1df))/0x7)+parseInt(_0x211888(0x1ee))/0x8+-parseInt(_0x211888(0x1ff))/0x9;if(_0x3d85e0===_0x43d277)break;else _0x40abf1['push'](_0x40abf1['shift']());}catch(_0x5ee524){_0x40abf1['push'](_0x40abf1['shift']());}}}(a142_0x781a,0xf1eff));function a142_0x781a(){const _0xc7f776=['../common/audio/audio-player','../common/path','__esModule','deleteTextMessage','Controller','3822hZMoGG','9815400aUmLRi','send','@nestjs/common','Param','object','function','JwtAuthGuard','TextDTO','metadata','__decorate','StreamingService','./dtos/text.dto','streamingService','27426FFpBwM','error\x20','Post','../auth/guards/jwt.guard','12987639ddEcda','Role','length','play','./saveStreamToFile','Success\x20save\x20text:\x20','textToAudio','UseGuards','/message','User','text','getAllMessage','defineProperty','../common/file','saveMessage','getMessages','Delete','Admin','AudioPlayer','./text-to-audio.service','Body','updateTextMessage','design:returntype','decorate','design:paramtypes','getOwnPropertyDescriptor','/:id','design:type','Put','1014312tgrSFT','1376652FTVMPn','Roles','Logger','log','../auth/enums/role.enum','name','Success\x20play\x20text\x20to\x20audio:\x20','.wav','error','assign','textToAudioService','318luJioq','TextToAudioController','AUDIO_TO_MESSAGE_DIR','../common/constants','There\x20is\x20no\x20message\x20to\x20play','processRootPath','19607uJjqxg','logger','RolesGuard','playAudioFile','isFileExist','Res','462250eMTbaT','prototype','path'];a142_0x781a=function(){return _0xc7f776;};return a142_0x781a();}function a142_0x3e79(_0x37d8c8,_0x19d389){const _0x781a74=a142_0x781a();return a142_0x3e79=function(_0x3e7950,_0x10504f){_0x3e7950=_0x3e7950-0x1bc;let _0x34c81d=_0x781a74[_0x3e7950];return _0x34c81d;},a142_0x3e79(_0x37d8c8,_0x19d389);}var __decorate=this&&this[a142_0x2db6c6(0x1f7)]||function(_0x3b55b8,_0xcc6815,_0x36aa0a,_0x295952){const _0x5c43be=a142_0x2db6c6;var _0x4afb3d=arguments[_0x5c43be(0x201)],_0x12c91e=_0x4afb3d<0x3?_0xcc6815:_0x295952===null?_0x295952=Object[_0x5c43be(0x1c9)](_0xcc6815,_0x36aa0a):_0x295952,_0x56622b;if(typeof Reflect===_0x5c43be(0x1f2)&&typeof Reflect[_0x5c43be(0x1c7)]===_0x5c43be(0x1f3))_0x12c91e=Reflect['decorate'](_0x3b55b8,_0xcc6815,_0x36aa0a,_0x295952);else{for(var _0x4f1e3f=_0x3b55b8[_0x5c43be(0x201)]-0x1;_0x4f1e3f>=0x0;_0x4f1e3f--)if(_0x56622b=_0x3b55b8[_0x4f1e3f])_0x12c91e=(_0x4afb3d<0x3?_0x56622b(_0x12c91e):_0x4afb3d>0x3?_0x56622b(_0xcc6815,_0x36aa0a,_0x12c91e):_0x56622b(_0xcc6815,_0x36aa0a))||_0x12c91e;}return _0x4afb3d>0x3&&_0x12c91e&&Object[_0x5c43be(0x1bc)](_0xcc6815,_0x36aa0a,_0x12c91e),_0x12c91e;},__metadata=this&&this['__metadata']||function(_0x2dff50,_0x266700){const _0x1c9f36=a142_0x2db6c6;if(typeof Reflect===_0x1c9f36(0x1f2)&&typeof Reflect[_0x1c9f36(0x1f6)]==='function')return Reflect[_0x1c9f36(0x1f6)](_0x2dff50,_0x266700);},__param=this&&this['__param']||function(_0xdd303b,_0x95fb6d){return function(_0x4dfdfc,_0x426350){_0x95fb6d(_0x4dfdfc,_0x426350,_0xdd303b);};},TextToAudioController_1;Object['defineProperty'](exports,a142_0x2db6c6(0x1ea),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require(a142_0x2db6c6(0x1f0)),text_to_audio_service_1=require(a142_0x2db6c6(0x1c3)),text_dto_1=require(a142_0x2db6c6(0x1f9)),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a142_0x2db6c6(0x1d2)),jwt_guard_1=require(a142_0x2db6c6(0x1fe)),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require(a142_0x2db6c6(0x203)),path=require(a142_0x2db6c6(0x1e7)),path_1=require(a142_0x2db6c6(0x1e9)),constants_1=require(a142_0x2db6c6(0x1dc)),file_1=require(a142_0x2db6c6(0x1bd)),audio_player_1=require(a142_0x2db6c6(0x1e8));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x4bee80,_0x37cd4c){const _0xb691dd=a142_0x2db6c6;this['textToAudioService']=_0x4bee80,this[_0xb691dd(0x1fa)]=_0x37cd4c,this[_0xb691dd(0x1e0)]=new common_1[(_0xb691dd(0x1d0))](TextToAudioController_1[_0xb691dd(0x1d3)]);}async['playAudioFile'](_0x421d39,_0x409fed){const _0x543db2=a142_0x2db6c6;try{const _0x1ba945=_0x409fed[_0x543db2(0x209)];if(!_0x1ba945){_0x421d39[_0x543db2(0x1ef)]('There\x20is\x20no\x20message\x20to\x20play');return;}const {id:_0x28d715,volume:_0x3716b7}=await this[_0x543db2(0x1d8)][_0x543db2(0x1be)](_0x1ba945);!(0x0,file_1[_0x543db2(0x1e3)])(constants_1[_0x543db2(0x1db)])&&(0x0,file_1['createFolder'])(constants_1[_0x543db2(0x1db)]);const _0x360e6a=path['join'](path_1[_0x543db2(0x1de)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x2cf1b5=_0x360e6a+'/'+_0x28d715+_0x543db2(0x1d5);!(0x0,file_1['isFileExist'])(_0x2cf1b5)?await this[_0x543db2(0x1d8)]['textToAudio'](_0x409fed['text'],async _0x6daf1f=>{const _0x5a7d67=_0x543db2;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x6daf1f,_0x360e6a+'/'+_0x28d715+_0x5a7d67(0x1d5)),audio_player_1[_0x5a7d67(0x1c2)]['play'](_0x2cf1b5,_0x3716b7!==null&&_0x3716b7!==void 0x0?_0x3716b7:0x32);}):audio_player_1['AudioPlayer'][_0x543db2(0x202)](_0x2cf1b5,_0x3716b7!==null&&_0x3716b7!==void 0x0?_0x3716b7:0x32),_0x421d39[_0x543db2(0x1ef)](_0x543db2(0x1d4)+_0x409fed['text']);}catch(_0xee5654){return this[_0x543db2(0x1e0)][_0x543db2(0x1d1)](_0xee5654,'error'),'';}}async['saveMessage'](_0x2001f6,_0x9ab83c){const _0x342115=a142_0x2db6c6;try{const _0x7d486b=_0x9ab83c[_0x342115(0x209)];if(!_0x7d486b){_0x2001f6[_0x342115(0x1ef)](_0x342115(0x1dd));return;}await this[_0x342115(0x1d8)][_0x342115(0x1be)](_0x7d486b),_0x2001f6[_0x342115(0x1ef)](_0x342115(0x204)+_0x9ab83c[_0x342115(0x209)]);}catch(_0xead8a3){return this[_0x342115(0x1e0)][_0x342115(0x1d1)](_0xead8a3,_0x342115(0x1fc)),'';}}async[a142_0x2db6c6(0x20a)](){const _0x7f8b7=a142_0x2db6c6;try{const _0x39b3a9=await this['textToAudioService'][_0x7f8b7(0x1bf)]();return _0x39b3a9!==null&&_0x39b3a9!==void 0x0?_0x39b3a9:[];}catch(_0x5034ca){return this[_0x7f8b7(0x1e0)][_0x7f8b7(0x1d1)](_0x5034ca,_0x7f8b7(0x1d6)),'';}}['deleteTextMessage'](_0x5dd503){const _0xbb0935=a142_0x2db6c6;return this[_0xbb0935(0x1d8)][_0xbb0935(0x1eb)](_0x5dd503);}[a142_0x2db6c6(0x1c5)](_0x515959,_0x5367e2){const _0xdb87a6=a142_0x2db6c6;var _0x51a62d;return this[_0xdb87a6(0x1d8)][_0xdb87a6(0x1c5)](_0x515959,Object['assign'](Object[_0xdb87a6(0x1d7)]({},_0x5367e2),{'volume':(_0x51a62d=_0x5367e2['volume'])!==null&&_0x51a62d!==void 0x0?_0x51a62d:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a142_0x2db6c6(0x206)])(jwt_guard_1[a142_0x2db6c6(0x1f4)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x2db6c6(0x1cf)])(role_enum_1['Role']['Admin'],role_enum_1[a142_0x2db6c6(0x200)][a142_0x2db6c6(0x208)]),__param(0x0,(0x0,common_1[a142_0x2db6c6(0x1e4)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x2db6c6(0x1c4)])()),__metadata(a142_0x2db6c6(0x1cb),Function),__metadata(a142_0x2db6c6(0x1c8),[Object,text_dto_1[a142_0x2db6c6(0x1f5)]]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x2db6c6(0x1e6)],a142_0x2db6c6(0x1e2),null),__decorate([(0x0,common_1[a142_0x2db6c6(0x1fd)])(a142_0x2db6c6(0x1be)),(0x0,common_1[a142_0x2db6c6(0x206)])(jwt_guard_1[a142_0x2db6c6(0x1f4)],roles_guard_1[a142_0x2db6c6(0x1e1)]),(0x0,roles_decorator_1[a142_0x2db6c6(0x1cf)])(role_enum_1[a142_0x2db6c6(0x200)][a142_0x2db6c6(0x1c1)],role_enum_1['Role'][a142_0x2db6c6(0x208)]),__param(0x0,(0x0,common_1[a142_0x2db6c6(0x1e4)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x2db6c6(0x1cb),Function),__metadata(a142_0x2db6c6(0x1c8),[Object,text_dto_1[a142_0x2db6c6(0x1f5)]]),__metadata(a142_0x2db6c6(0x1c6),Promise)],TextToAudioController[a142_0x2db6c6(0x1e6)],'saveMessage',null),__decorate([(0x0,common_1['Get'])(a142_0x2db6c6(0x207)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x2db6c6(0x1f4)],roles_guard_1[a142_0x2db6c6(0x1e1)]),(0x0,roles_decorator_1[a142_0x2db6c6(0x1cf)])(role_enum_1[a142_0x2db6c6(0x200)][a142_0x2db6c6(0x1c1)],role_enum_1[a142_0x2db6c6(0x200)][a142_0x2db6c6(0x208)]),__metadata(a142_0x2db6c6(0x1cb),Function),__metadata(a142_0x2db6c6(0x1c8),[]),__metadata(a142_0x2db6c6(0x1c6),Promise)],TextToAudioController[a142_0x2db6c6(0x1e6)],'getAllMessage',null),__decorate([(0x0,common_1[a142_0x2db6c6(0x1c0)])(a142_0x2db6c6(0x1ca)),(0x0,common_1[a142_0x2db6c6(0x206)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x2db6c6(0x1e1)]),(0x0,roles_decorator_1[a142_0x2db6c6(0x1cf)])(role_enum_1['Role'][a142_0x2db6c6(0x1c1)],role_enum_1['Role'][a142_0x2db6c6(0x208)]),__param(0x0,(0x0,common_1[a142_0x2db6c6(0x1f1)])('id')),__metadata(a142_0x2db6c6(0x1cb),Function),__metadata('design:paramtypes',[String]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x2db6c6(0x1e6)],'deleteTextMessage',null),__decorate([(0x0,common_1[a142_0x2db6c6(0x1cc)])(a142_0x2db6c6(0x1ca)),(0x0,common_1[a142_0x2db6c6(0x206)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x2db6c6(0x1e1)]),(0x0,roles_decorator_1[a142_0x2db6c6(0x1cf)])(role_enum_1['Role'][a142_0x2db6c6(0x1c1)],role_enum_1[a142_0x2db6c6(0x200)][a142_0x2db6c6(0x208)]),__param(0x0,(0x0,common_1[a142_0x2db6c6(0x1f1)])('id')),__param(0x1,(0x0,common_1[a142_0x2db6c6(0x1c4)])()),__metadata(a142_0x2db6c6(0x1cb),Function),__metadata(a142_0x2db6c6(0x1c8),[String,text_dto_1[a142_0x2db6c6(0x1f5)]]),__metadata(a142_0x2db6c6(0x1c6),void 0x0)],TextToAudioController[a142_0x2db6c6(0x1e6)],a142_0x2db6c6(0x1c5),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x2db6c6(0x1ec)])(a142_0x2db6c6(0x205)),__metadata('design:paramtypes',[text_to_audio_service_1['TextToAudioService'],streaming_service_1[a142_0x2db6c6(0x1f8)]])],TextToAudioController),exports[a142_0x2db6c6(0x1da)]=TextToAudioController;