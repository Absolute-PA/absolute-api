'use strict';function a145_0x2bb1(){const _0x423990=['Param','/message','AudioPlayer','Logger','defineProperty','Delete','text','textToAudio','volume','assign','isFileExist','1164204fehtLl','deleteTextMessage','processRootPath','logger','design:returntype','Body','object','../auth/guards/jwt.guard','TextDTO','6iamLwe','../streaming/streaming.service','TextToAudioController','../auth/decorators/roles.decorator','./dtos/text.dto','__esModule','Res','log','Roles','AUDIO_TO_MESSAGE_DIR','JwtAuthGuard','Success\x20save\x20text:\x20','getAllMessage','__param','metadata','Success\x20play\x20text\x20to\x20audio:\x20','UseGuards','__decorate','/:id','RolesGuard','length','__metadata','804573kkbYhI','StreamingService','path','19831ZldaRW','164270upIjSA','There\x20is\x20no\x20message\x20to\x20play','play','function','Put','join','name','../common/constants','textToAudioService','createFolder','design:paramtypes','472RryrWr','436240VUSrVV','373773jxlMhH','send','Role','saveStreamToFile','streamingService','error','4wcWbNi','updateTextMessage','./text-to-audio.service','User','Post','decorate','../common/audio/audio-player','50mCrmcn','.wav','prototype','design:type','373710MGHVap','Admin','../auth/guards/roles.guard','Get','../common/path','playAudioFile'];a145_0x2bb1=function(){return _0x423990;};return a145_0x2bb1();}const a145_0x5fa11=a145_0x3e42;(function(_0x517996,_0x10ed43){const _0x732881=a145_0x3e42,_0x4f094a=_0x517996();while(!![]){try{const _0x3731f9=-parseInt(_0x732881(0x177))/0x1+parseInt(_0x732881(0x18a))/0x2*(parseInt(_0x732881(0x184))/0x3)+parseInt(_0x732881(0x183))/0x4+-parseInt(_0x732881(0x195))/0x5*(-parseInt(_0x732881(0x15d))/0x6)+-parseInt(_0x732881(0x176))/0x7*(-parseInt(_0x732881(0x182))/0x8)+parseInt(_0x732881(0x1a6))/0x9+parseInt(_0x732881(0x191))/0xa*(-parseInt(_0x732881(0x173))/0xb);if(_0x3731f9===_0x10ed43)break;else _0x4f094a['push'](_0x4f094a['shift']());}catch(_0x1474fc){_0x4f094a['push'](_0x4f094a['shift']());}}}(a145_0x2bb1,0x30b4e));var __decorate=this&&this[a145_0x5fa11(0x16e)]||function(_0xa4f647,_0x21dd25,_0x7971d1,_0xe0977e){const _0x4ffc54=a145_0x5fa11;var _0x3c741c=arguments[_0x4ffc54(0x171)],_0x80505=_0x3c741c<0x3?_0x21dd25:_0xe0977e===null?_0xe0977e=Object['getOwnPropertyDescriptor'](_0x21dd25,_0x7971d1):_0xe0977e,_0x708c1;if(typeof Reflect===_0x4ffc54(0x15a)&&typeof Reflect[_0x4ffc54(0x18f)]===_0x4ffc54(0x17a))_0x80505=Reflect[_0x4ffc54(0x18f)](_0xa4f647,_0x21dd25,_0x7971d1,_0xe0977e);else{for(var _0x4a7023=_0xa4f647[_0x4ffc54(0x171)]-0x1;_0x4a7023>=0x0;_0x4a7023--)if(_0x708c1=_0xa4f647[_0x4a7023])_0x80505=(_0x3c741c<0x3?_0x708c1(_0x80505):_0x3c741c>0x3?_0x708c1(_0x21dd25,_0x7971d1,_0x80505):_0x708c1(_0x21dd25,_0x7971d1))||_0x80505;}return _0x3c741c>0x3&&_0x80505&&Object[_0x4ffc54(0x19f)](_0x21dd25,_0x7971d1,_0x80505),_0x80505;},__metadata=this&&this[a145_0x5fa11(0x172)]||function(_0x3d7b23,_0x5e8a59){const _0x102578=a145_0x5fa11;if(typeof Reflect===_0x102578(0x15a)&&typeof Reflect[_0x102578(0x16b)]===_0x102578(0x17a))return Reflect[_0x102578(0x16b)](_0x3d7b23,_0x5e8a59);},__param=this&&this[a145_0x5fa11(0x16a)]||function(_0x4969d0,_0x43bd87){return function(_0x1ddfe3,_0x3d0464){_0x43bd87(_0x1ddfe3,_0x3d0464,_0x4969d0);};},TextToAudioController_1;Object['defineProperty'](exports,a145_0x5fa11(0x162),{'value':!![]}),exports[a145_0x5fa11(0x15f)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a145_0x5fa11(0x18c)),text_dto_1=require(a145_0x5fa11(0x161)),streaming_service_1=require(a145_0x5fa11(0x15e)),roles_decorator_1=require(a145_0x5fa11(0x160)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a145_0x5fa11(0x15b)),roles_guard_1=require(a145_0x5fa11(0x197)),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a145_0x5fa11(0x175)),path_1=require(a145_0x5fa11(0x199)),constants_1=require(a145_0x5fa11(0x17e)),file_1=require('../common/file'),audio_player_1=require(a145_0x5fa11(0x190));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x25dbd3,_0x322bb0){const _0x3fde16=a145_0x5fa11;this[_0x3fde16(0x17f)]=_0x25dbd3,this[_0x3fde16(0x188)]=_0x322bb0,this[_0x3fde16(0x1a9)]=new common_1[(_0x3fde16(0x19e))](TextToAudioController_1[_0x3fde16(0x17d)]);}async[a145_0x5fa11(0x19a)](_0xe9b911,_0x144211){const _0x45edf9=a145_0x5fa11;try{const _0x26ce9b=_0x144211[_0x45edf9(0x1a1)];if(!_0x26ce9b){_0xe9b911[_0x45edf9(0x185)](_0x45edf9(0x178));return;}const {id:_0x153d33,volume:_0x462d90}=await this[_0x45edf9(0x17f)]['saveMessage'](_0x26ce9b);!(0x0,file_1[_0x45edf9(0x1a5)])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1[_0x45edf9(0x180)])(constants_1[_0x45edf9(0x166)]);const _0x33be97=path[_0x45edf9(0x17c)](path_1[_0x45edf9(0x1a8)],constants_1[_0x45edf9(0x166)]),_0x5c4a72=_0x33be97+'/'+_0x153d33+_0x45edf9(0x192);!(0x0,file_1[_0x45edf9(0x1a5)])(_0x5c4a72)?await this[_0x45edf9(0x17f)][_0x45edf9(0x1a2)](_0x144211['text'],async _0x214893=>{const _0x80dff9=_0x45edf9;await(0x0,saveStreamToFile_1[_0x80dff9(0x187)])(_0x214893,_0x33be97+'/'+_0x153d33+_0x80dff9(0x192)),audio_player_1[_0x80dff9(0x19d)][_0x80dff9(0x179)](_0x5c4a72,_0x462d90!==null&&_0x462d90!==void 0x0?_0x462d90:0x32);}):audio_player_1[_0x45edf9(0x19d)][_0x45edf9(0x179)](_0x5c4a72,_0x462d90!==null&&_0x462d90!==void 0x0?_0x462d90:0x32),_0xe9b911[_0x45edf9(0x185)](_0x45edf9(0x16c)+_0x144211[_0x45edf9(0x1a1)]);}catch(_0x46ba31){return this[_0x45edf9(0x1a9)][_0x45edf9(0x164)](_0x46ba31,_0x45edf9(0x189)),'';}}async['saveMessage'](_0x38e563,_0x4e14dc){const _0x30d5b0=a145_0x5fa11;try{const _0x5bb886=_0x4e14dc[_0x30d5b0(0x1a1)];if(!_0x5bb886){_0x38e563[_0x30d5b0(0x185)](_0x30d5b0(0x178));return;}await this[_0x30d5b0(0x17f)]['saveMessage'](_0x5bb886),_0x38e563[_0x30d5b0(0x185)](_0x30d5b0(0x168)+_0x4e14dc['text']);}catch(_0x500988){return this['logger']['log'](_0x500988,'error\x20'),'';}}async[a145_0x5fa11(0x169)](){const _0x9c2db2=a145_0x5fa11;try{const _0x57803c=await this[_0x9c2db2(0x17f)]['getMessages']();return _0x57803c!==null&&_0x57803c!==void 0x0?_0x57803c:[];}catch(_0x160fbd){return this['logger']['log'](_0x160fbd,_0x9c2db2(0x189)),'';}}[a145_0x5fa11(0x1a7)](_0x14bec3){const _0x2ba031=a145_0x5fa11;return this[_0x2ba031(0x17f)]['deleteTextMessage'](_0x14bec3);}['updateTextMessage'](_0x174b43,_0x4395a2){const _0x363ce1=a145_0x5fa11;var _0x108b13;return this['textToAudioService'][_0x363ce1(0x18b)](_0x174b43,Object[_0x363ce1(0x1a4)](Object[_0x363ce1(0x1a4)]({},_0x4395a2),{'volume':(_0x108b13=_0x4395a2[_0x363ce1(0x1a3)])!==null&&_0x108b13!==void 0x0?_0x108b13:0x32}));}};function a145_0x3e42(_0x4a1e65,_0x48ba51){const _0x2bb177=a145_0x2bb1();return a145_0x3e42=function(_0x3e42b7,_0xab833c){_0x3e42b7=_0x3e42b7-0x15a;let _0x5c4026=_0x2bb177[_0x3e42b7];return _0x5c4026;},a145_0x3e42(_0x4a1e65,_0x48ba51);}__decorate([(0x0,common_1[a145_0x5fa11(0x18e)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x5fa11(0x170)]),(0x0,roles_decorator_1[a145_0x5fa11(0x165)])(role_enum_1['Role'][a145_0x5fa11(0x196)],role_enum_1[a145_0x5fa11(0x186)][a145_0x5fa11(0x18d)]),__param(0x0,(0x0,common_1[a145_0x5fa11(0x163)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x5fa11(0x1ab)])()),__metadata('design:type',Function),__metadata(a145_0x5fa11(0x181),[Object,text_dto_1[a145_0x5fa11(0x15c)]]),__metadata(a145_0x5fa11(0x1aa),Promise)],TextToAudioController[a145_0x5fa11(0x193)],'playAudioFile',null),__decorate([(0x0,common_1[a145_0x5fa11(0x18e)])('saveMessage'),(0x0,common_1[a145_0x5fa11(0x16d)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x5fa11(0x170)]),(0x0,roles_decorator_1[a145_0x5fa11(0x165)])(role_enum_1[a145_0x5fa11(0x186)]['Admin'],role_enum_1[a145_0x5fa11(0x186)]['User']),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x5fa11(0x1ab)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,text_dto_1[a145_0x5fa11(0x15c)]]),__metadata('design:returntype',Promise)],TextToAudioController[a145_0x5fa11(0x193)],'saveMessage',null),__decorate([(0x0,common_1[a145_0x5fa11(0x198)])(a145_0x5fa11(0x19c)),(0x0,common_1[a145_0x5fa11(0x16d)])(jwt_guard_1[a145_0x5fa11(0x167)],roles_guard_1[a145_0x5fa11(0x170)]),(0x0,roles_decorator_1[a145_0x5fa11(0x165)])(role_enum_1[a145_0x5fa11(0x186)][a145_0x5fa11(0x196)],role_enum_1[a145_0x5fa11(0x186)][a145_0x5fa11(0x18d)]),__metadata('design:type',Function),__metadata(a145_0x5fa11(0x181),[]),__metadata(a145_0x5fa11(0x1aa),Promise)],TextToAudioController[a145_0x5fa11(0x193)],a145_0x5fa11(0x169),null),__decorate([(0x0,common_1[a145_0x5fa11(0x1a0)])('/:id'),(0x0,common_1[a145_0x5fa11(0x16d)])(jwt_guard_1[a145_0x5fa11(0x167)],roles_guard_1[a145_0x5fa11(0x170)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x5fa11(0x186)]['Admin'],role_enum_1[a145_0x5fa11(0x186)]['User']),__param(0x0,(0x0,common_1[a145_0x5fa11(0x19b)])('id')),__metadata(a145_0x5fa11(0x194),Function),__metadata('design:paramtypes',[String]),__metadata(a145_0x5fa11(0x1aa),void 0x0)],TextToAudioController[a145_0x5fa11(0x193)],a145_0x5fa11(0x1a7),null),__decorate([(0x0,common_1[a145_0x5fa11(0x17b)])(a145_0x5fa11(0x16f)),(0x0,common_1[a145_0x5fa11(0x16d)])(jwt_guard_1[a145_0x5fa11(0x167)],roles_guard_1[a145_0x5fa11(0x170)]),(0x0,roles_decorator_1[a145_0x5fa11(0x165)])(role_enum_1[a145_0x5fa11(0x186)]['Admin'],role_enum_1[a145_0x5fa11(0x186)][a145_0x5fa11(0x18d)]),__param(0x0,(0x0,common_1[a145_0x5fa11(0x19b)])('id')),__param(0x1,(0x0,common_1[a145_0x5fa11(0x1ab)])()),__metadata(a145_0x5fa11(0x194),Function),__metadata(a145_0x5fa11(0x181),[String,text_dto_1[a145_0x5fa11(0x15c)]]),__metadata(a145_0x5fa11(0x1aa),void 0x0)],TextToAudioController[a145_0x5fa11(0x193)],a145_0x5fa11(0x18b),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a145_0x5fa11(0x1a2)),__metadata(a145_0x5fa11(0x181),[text_to_audio_service_1['TextToAudioService'],streaming_service_1[a145_0x5fa11(0x174)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;