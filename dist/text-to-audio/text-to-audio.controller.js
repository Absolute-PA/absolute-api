'use strict';const a142_0x1fda18=a142_0x32ed;(function(_0x9637ee,_0x3cf52e){const _0x523de9=a142_0x32ed,_0x563fa6=_0x9637ee();while(!![]){try{const _0x236c08=parseInt(_0x523de9(0x139))/0x1+parseInt(_0x523de9(0x15a))/0x2+-parseInt(_0x523de9(0x153))/0x3*(parseInt(_0x523de9(0x146))/0x4)+parseInt(_0x523de9(0x12f))/0x5*(-parseInt(_0x523de9(0x163))/0x6)+parseInt(_0x523de9(0x165))/0x7*(-parseInt(_0x523de9(0x14c))/0x8)+parseInt(_0x523de9(0x176))/0x9+parseInt(_0x523de9(0x15f))/0xa*(parseInt(_0x523de9(0x137))/0xb);if(_0x236c08===_0x3cf52e)break;else _0x563fa6['push'](_0x563fa6['shift']());}catch(_0x514399){_0x563fa6['push'](_0x563fa6['shift']());}}}(a142_0xe383,0xa9704));function a142_0x32ed(_0x14163d,_0x52c27a){const _0xe3839e=a142_0xe383();return a142_0x32ed=function(_0x32edc5,_0x4a8532){_0x32edc5=_0x32edc5-0x12f;let _0x352bd9=_0xe3839e[_0x32edc5];return _0x352bd9;},a142_0x32ed(_0x14163d,_0x52c27a);}var __decorate=this&&this[a142_0x1fda18(0x16e)]||function(_0x4268bb,_0x3afd9d,_0x51f5bf,_0x323bea){const _0x14208d=a142_0x1fda18;var _0x47b12f=arguments[_0x14208d(0x160)],_0x1198c0=_0x47b12f<0x3?_0x3afd9d:_0x323bea===null?_0x323bea=Object[_0x14208d(0x17a)](_0x3afd9d,_0x51f5bf):_0x323bea,_0x28c9ec;if(typeof Reflect==='object'&&typeof Reflect[_0x14208d(0x143)]===_0x14208d(0x164))_0x1198c0=Reflect[_0x14208d(0x143)](_0x4268bb,_0x3afd9d,_0x51f5bf,_0x323bea);else{for(var _0x28048f=_0x4268bb[_0x14208d(0x160)]-0x1;_0x28048f>=0x0;_0x28048f--)if(_0x28c9ec=_0x4268bb[_0x28048f])_0x1198c0=(_0x47b12f<0x3?_0x28c9ec(_0x1198c0):_0x47b12f>0x3?_0x28c9ec(_0x3afd9d,_0x51f5bf,_0x1198c0):_0x28c9ec(_0x3afd9d,_0x51f5bf))||_0x1198c0;}return _0x47b12f>0x3&&_0x1198c0&&Object[_0x14208d(0x144)](_0x3afd9d,_0x51f5bf,_0x1198c0),_0x1198c0;},__metadata=this&&this[a142_0x1fda18(0x168)]||function(_0x36babc,_0x1a378e){const _0x3d8165=a142_0x1fda18;if(typeof Reflect===_0x3d8165(0x13c)&&typeof Reflect[_0x3d8165(0x167)]===_0x3d8165(0x164))return Reflect[_0x3d8165(0x167)](_0x36babc,_0x1a378e);},__param=this&&this[a142_0x1fda18(0x14e)]||function(_0x40d60c,_0x3dc81e){return function(_0x446fb4,_0x5d0b30){_0x3dc81e(_0x446fb4,_0x5d0b30,_0x40d60c);};},TextToAudioController_1;function a142_0xe383(){const _0x3bd4ef=['decorate','defineProperty','isFileExist','2755996xdkZkt','Success\x20play\x20text\x20to\x20audio:\x20','text','playAudioFile','play','send','4854408QdQpLv','volume','__param','saveMessage','Success\x20save\x20text:\x20','getMessages','RolesGuard','3bxtXKC','path','../common/audio/audio-player','../auth/decorators/roles.decorator','Admin','../auth/guards/roles.guard','TextToAudioController','117244OkTrfu','Body','../common/file','User','UseGuards','6982310ZDgDDy','length','logger','StreamingService','6NlOKDQ','function','14UtgWFy','deleteTextMessage','metadata','__metadata','streamingService','There\x20is\x20no\x20message\x20to\x20play','updateTextMessage','error\x20','./text-to-audio.service','__decorate','AudioPlayer','Res','processRootPath','TextDTO','JwtAuthGuard','design:paramtypes','textToAudioService','8527383aPrfrF','Put','design:type','getAllMessage','getOwnPropertyDescriptor','log','AUDIO_TO_MESSAGE_DIR','Param','TextToAudioService','1519925GvrIjC','textToAudio','join','@nestjs/common','Get','../common/path','../auth/guards/jwt.guard','Roles','22sEmBJa','prototype','498035eycCtI','Delete','design:returntype','object','Role','Controller','.wav','assign','/:id','/message'];a142_0xe383=function(){return _0x3bd4ef;};return a142_0xe383();}Object[a142_0x1fda18(0x144)](exports,'__esModule',{'value':!![]}),exports[a142_0x1fda18(0x159)]=void 0x0;const common_1=require(a142_0x1fda18(0x132)),text_to_audio_service_1=require(a142_0x1fda18(0x16d)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require(a142_0x1fda18(0x156)),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a142_0x1fda18(0x135)),roles_guard_1=require(a142_0x1fda18(0x158)),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a142_0x1fda18(0x154)),path_1=require(a142_0x1fda18(0x134)),constants_1=require('../common/constants'),file_1=require(a142_0x1fda18(0x15c)),audio_player_1=require(a142_0x1fda18(0x155));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0xbe0653,_0x56c15b){const _0x3cf9d6=a142_0x1fda18;this[_0x3cf9d6(0x175)]=_0xbe0653,this[_0x3cf9d6(0x169)]=_0x56c15b,this[_0x3cf9d6(0x161)]=new common_1['Logger'](TextToAudioController_1['name']);}async['playAudioFile'](_0x12ed61,_0x4814e5){const _0x40ea50=a142_0x1fda18;try{const _0x55967a=_0x4814e5['text'];if(!_0x55967a){_0x12ed61[_0x40ea50(0x14b)](_0x40ea50(0x16a));return;}const {id:_0x497bf6,volume:_0x33f130}=await this[_0x40ea50(0x175)]['saveMessage'](_0x55967a);!(0x0,file_1[_0x40ea50(0x145)])(constants_1[_0x40ea50(0x17c)])&&(0x0,file_1['createFolder'])(constants_1[_0x40ea50(0x17c)]);const _0x24a471=path[_0x40ea50(0x131)](path_1[_0x40ea50(0x171)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x417249=_0x24a471+'/'+_0x497bf6+_0x40ea50(0x13f);!(0x0,file_1[_0x40ea50(0x145)])(_0x417249)?await this[_0x40ea50(0x175)][_0x40ea50(0x130)](_0x4814e5[_0x40ea50(0x148)],async _0x298e07=>{const _0x316798=_0x40ea50;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x298e07,_0x24a471+'/'+_0x497bf6+_0x316798(0x13f)),audio_player_1[_0x316798(0x16f)]['play'](_0x417249,_0x33f130!==null&&_0x33f130!==void 0x0?_0x33f130:0x32);}):audio_player_1['AudioPlayer'][_0x40ea50(0x14a)](_0x417249,_0x33f130!==null&&_0x33f130!==void 0x0?_0x33f130:0x32),_0x12ed61[_0x40ea50(0x14b)](_0x40ea50(0x147)+_0x4814e5[_0x40ea50(0x148)]);}catch(_0x24a39f){return this[_0x40ea50(0x161)][_0x40ea50(0x17b)](_0x24a39f,'error'),'';}}async[a142_0x1fda18(0x14f)](_0x1564c5,_0x405dc6){const _0x59d90f=a142_0x1fda18;try{const _0x360541=_0x405dc6['text'];if(!_0x360541){_0x1564c5[_0x59d90f(0x14b)]('There\x20is\x20no\x20message\x20to\x20play');return;}await this[_0x59d90f(0x175)][_0x59d90f(0x14f)](_0x360541),_0x1564c5[_0x59d90f(0x14b)](_0x59d90f(0x150)+_0x405dc6['text']);}catch(_0xee2528){return this[_0x59d90f(0x161)]['log'](_0xee2528,_0x59d90f(0x16c)),'';}}async[a142_0x1fda18(0x179)](){const _0x25b636=a142_0x1fda18;try{const _0xd5bd28=await this[_0x25b636(0x175)][_0x25b636(0x151)]();return _0xd5bd28!==null&&_0xd5bd28!==void 0x0?_0xd5bd28:[];}catch(_0x3805ba){return this['logger'][_0x25b636(0x17b)](_0x3805ba,'error'),'';}}['deleteTextMessage'](_0x449c80){const _0x2503ac=a142_0x1fda18;return this[_0x2503ac(0x175)][_0x2503ac(0x166)](_0x449c80);}['updateTextMessage'](_0x168b58,_0x55822d){const _0x335166=a142_0x1fda18;var _0x7b1d44;return this['textToAudioService'][_0x335166(0x16b)](_0x168b58,Object[_0x335166(0x140)](Object[_0x335166(0x140)]({},_0x55822d),{'volume':(_0x7b1d44=_0x55822d[_0x335166(0x14d)])!==null&&_0x7b1d44!==void 0x0?_0x7b1d44:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a142_0x1fda18(0x15e)])(jwt_guard_1[a142_0x1fda18(0x173)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x1fda18(0x136)])(role_enum_1[a142_0x1fda18(0x13d)]['Admin'],role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x15d)]),__param(0x0,(0x0,common_1[a142_0x1fda18(0x170)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x1fda18(0x15b)])()),__metadata(a142_0x1fda18(0x178),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x1fda18(0x172)]]),__metadata(a142_0x1fda18(0x13b),Promise)],TextToAudioController[a142_0x1fda18(0x138)],a142_0x1fda18(0x149),null),__decorate([(0x0,common_1['Post'])(a142_0x1fda18(0x14f)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x1fda18(0x173)],roles_guard_1[a142_0x1fda18(0x152)]),(0x0,roles_decorator_1[a142_0x1fda18(0x136)])(role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x157)],role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x15d)]),__param(0x0,(0x0,common_1[a142_0x1fda18(0x170)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x1fda18(0x15b)])()),__metadata(a142_0x1fda18(0x178),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x1fda18(0x172)]]),__metadata(a142_0x1fda18(0x13b),Promise)],TextToAudioController[a142_0x1fda18(0x138)],a142_0x1fda18(0x14f),null),__decorate([(0x0,common_1[a142_0x1fda18(0x133)])(a142_0x1fda18(0x142)),(0x0,common_1[a142_0x1fda18(0x15e)])(jwt_guard_1[a142_0x1fda18(0x173)],roles_guard_1[a142_0x1fda18(0x152)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x157)],role_enum_1['Role'][a142_0x1fda18(0x15d)]),__metadata(a142_0x1fda18(0x178),Function),__metadata(a142_0x1fda18(0x174),[]),__metadata(a142_0x1fda18(0x13b),Promise)],TextToAudioController[a142_0x1fda18(0x138)],a142_0x1fda18(0x179),null),__decorate([(0x0,common_1[a142_0x1fda18(0x13a)])(a142_0x1fda18(0x141)),(0x0,common_1[a142_0x1fda18(0x15e)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x1fda18(0x152)]),(0x0,roles_decorator_1[a142_0x1fda18(0x136)])(role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x157)],role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x15d)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x1fda18(0x178),Function),__metadata(a142_0x1fda18(0x174),[String]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x1fda18(0x138)],a142_0x1fda18(0x166),null),__decorate([(0x0,common_1[a142_0x1fda18(0x177)])('/:id'),(0x0,common_1[a142_0x1fda18(0x15e)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x1fda18(0x152)]),(0x0,roles_decorator_1[a142_0x1fda18(0x136)])(role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x157)],role_enum_1[a142_0x1fda18(0x13d)][a142_0x1fda18(0x15d)]),__param(0x0,(0x0,common_1[a142_0x1fda18(0x17d)])('id')),__param(0x1,(0x0,common_1[a142_0x1fda18(0x15b)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[String,text_dto_1[a142_0x1fda18(0x172)]]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x1fda18(0x138)],a142_0x1fda18(0x16b),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x1fda18(0x13e)])(a142_0x1fda18(0x130)),__metadata('design:paramtypes',[text_to_audio_service_1[a142_0x1fda18(0x17e)],streaming_service_1[a142_0x1fda18(0x162)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;