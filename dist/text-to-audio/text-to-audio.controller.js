'use strict';const a142_0x2c6f79=a142_0x3522;(function(_0x46a33d,_0x5821f1){const _0x3087b3=a142_0x3522,_0x521042=_0x46a33d();while(!![]){try{const _0x5bd8b5=parseInt(_0x3087b3(0x14f))/0x1*(-parseInt(_0x3087b3(0x146))/0x2)+parseInt(_0x3087b3(0x156))/0x3+-parseInt(_0x3087b3(0x18d))/0x4+-parseInt(_0x3087b3(0x187))/0x5*(-parseInt(_0x3087b3(0x162))/0x6)+parseInt(_0x3087b3(0x18a))/0x7*(-parseInt(_0x3087b3(0x16f))/0x8)+-parseInt(_0x3087b3(0x150))/0x9*(-parseInt(_0x3087b3(0x155))/0xa)+parseInt(_0x3087b3(0x177))/0xb*(parseInt(_0x3087b3(0x169))/0xc);if(_0x5bd8b5===_0x5821f1)break;else _0x521042['push'](_0x521042['shift']());}catch(_0x591069){_0x521042['push'](_0x521042['shift']());}}}(a142_0x4e33,0xed430));var __decorate=this&&this[a142_0x2c6f79(0x188)]||function(_0x1ba240,_0x58f270,_0x3edc77,_0x4bd3ba){const _0xb1ba9=a142_0x2c6f79;var _0x491fa2=arguments[_0xb1ba9(0x17d)],_0xde694d=_0x491fa2<0x3?_0x58f270:_0x4bd3ba===null?_0x4bd3ba=Object[_0xb1ba9(0x15b)](_0x58f270,_0x3edc77):_0x4bd3ba,_0x9dd4bd;if(typeof Reflect==='object'&&typeof Reflect[_0xb1ba9(0x161)]==='function')_0xde694d=Reflect[_0xb1ba9(0x161)](_0x1ba240,_0x58f270,_0x3edc77,_0x4bd3ba);else{for(var _0x379ebe=_0x1ba240['length']-0x1;_0x379ebe>=0x0;_0x379ebe--)if(_0x9dd4bd=_0x1ba240[_0x379ebe])_0xde694d=(_0x491fa2<0x3?_0x9dd4bd(_0xde694d):_0x491fa2>0x3?_0x9dd4bd(_0x58f270,_0x3edc77,_0xde694d):_0x9dd4bd(_0x58f270,_0x3edc77))||_0xde694d;}return _0x491fa2>0x3&&_0xde694d&&Object[_0xb1ba9(0x149)](_0x58f270,_0x3edc77,_0xde694d),_0xde694d;},__metadata=this&&this[a142_0x2c6f79(0x17f)]||function(_0x3de780,_0xcbdbd9){const _0x4b112c=a142_0x2c6f79;if(typeof Reflect===_0x4b112c(0x17a)&&typeof Reflect[_0x4b112c(0x15a)]===_0x4b112c(0x166))return Reflect[_0x4b112c(0x15a)](_0x3de780,_0xcbdbd9);},__param=this&&this[a142_0x2c6f79(0x180)]||function(_0x177977,_0x5f39b1){return function(_0x4ef65c,_0x579e78){_0x5f39b1(_0x4ef65c,_0x579e78,_0x177977);};},TextToAudioController_1;Object[a142_0x2c6f79(0x149)](exports,'__esModule',{'value':!![]}),exports[a142_0x2c6f79(0x16a)]=void 0x0;function a142_0x4e33(){const _0x5f19c2=['There\x20is\x20no\x20message\x20to\x20play','defineProperty','isFileExist','error\x20','join','../auth/enums/role.enum','send','54154Ghuhfq','15840gJwyWP','textToAudio','../common/constants','TextDTO','name','9010DiOWKF','1089396dgFnzo','Get','./dtos/text.dto','JwtAuthGuard','metadata','getOwnPropertyDescriptor','Admin','AUDIO_TO_MESSAGE_DIR','volume','assign','log','decorate','42TLAASl','path','Roles','textToAudioService','function','../common/file','../auth/decorators/roles.decorator','1764qDtcgq','TextToAudioController','@nestjs/common','text','Res','Param','440dpWXbc','Logger','./text-to-audio.service','design:paramtypes','logger','Post','createFolder','getAllMessage','135586KnjlId','Role','UseGuards','object','prototype','User','length','Put','__metadata','__param','.wav','../auth/guards/roles.guard','Success\x20save\x20text:\x20','../common/path','Controller','/:id','109025xEhDLY','__decorate','Delete','141617twJtbp','./saveStreamToFile','playAudioFile','3199976Kscexi','updateTextMessage','StreamingService','../streaming/streaming.service','error','deleteTextMessage','play','design:type','RolesGuard','../common/audio/audio-player','38iaadBr','saveMessage'];a142_0x4e33=function(){return _0x5f19c2;};return a142_0x4e33();}const common_1=require(a142_0x2c6f79(0x16b)),text_to_audio_service_1=require(a142_0x2c6f79(0x171)),text_dto_1=require(a142_0x2c6f79(0x158)),streaming_service_1=require(a142_0x2c6f79(0x190)),roles_decorator_1=require(a142_0x2c6f79(0x168)),role_enum_1=require(a142_0x2c6f79(0x14d)),jwt_guard_1=require('../auth/guards/jwt.guard'),roles_guard_1=require(a142_0x2c6f79(0x182)),saveStreamToFile_1=require(a142_0x2c6f79(0x18b)),path=require(a142_0x2c6f79(0x163)),path_1=require(a142_0x2c6f79(0x184)),constants_1=require(a142_0x2c6f79(0x152)),file_1=require(a142_0x2c6f79(0x167)),audio_player_1=require(a142_0x2c6f79(0x145));function a142_0x3522(_0x2de648,_0x5329a1){const _0x4e331b=a142_0x4e33();return a142_0x3522=function(_0x35229a,_0x3fdad4){_0x35229a=_0x35229a-0x143;let _0xbdb5e3=_0x4e331b[_0x35229a];return _0xbdb5e3;},a142_0x3522(_0x2de648,_0x5329a1);}let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x2e07db,_0xe828bb){const _0x16f474=a142_0x2c6f79;this[_0x16f474(0x165)]=_0x2e07db,this['streamingService']=_0xe828bb,this[_0x16f474(0x173)]=new common_1[(_0x16f474(0x170))](TextToAudioController_1[_0x16f474(0x154)]);}async[a142_0x2c6f79(0x18c)](_0x189ed6,_0x360d94){const _0x285806=a142_0x2c6f79;try{const _0x1dc885=_0x360d94[_0x285806(0x16c)];if(!_0x1dc885){_0x189ed6['send'](_0x285806(0x148));return;}const {id:_0x4c99fb,volume:_0x59a0c0}=await this[_0x285806(0x165)][_0x285806(0x147)](_0x1dc885);!(0x0,file_1[_0x285806(0x14a)])(constants_1[_0x285806(0x15d)])&&(0x0,file_1[_0x285806(0x175)])(constants_1[_0x285806(0x15d)]);const _0x4d7c9b=path[_0x285806(0x14c)](path_1['processRootPath'],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x4281dc=_0x4d7c9b+'/'+_0x4c99fb+_0x285806(0x181);!(0x0,file_1['isFileExist'])(_0x4281dc)?await this[_0x285806(0x165)][_0x285806(0x151)](_0x360d94[_0x285806(0x16c)],async _0x18d15c=>{const _0x541687=_0x285806;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x18d15c,_0x4d7c9b+'/'+_0x4c99fb+_0x541687(0x181)),audio_player_1['AudioPlayer'][_0x541687(0x193)](_0x4281dc,_0x59a0c0!==null&&_0x59a0c0!==void 0x0?_0x59a0c0:0x32);}):audio_player_1['AudioPlayer'][_0x285806(0x193)](_0x4281dc,_0x59a0c0!==null&&_0x59a0c0!==void 0x0?_0x59a0c0:0x32),_0x189ed6['send']('Success\x20play\x20text\x20to\x20audio:\x20'+_0x360d94[_0x285806(0x16c)]);}catch(_0x194a3d){return this[_0x285806(0x173)]['log'](_0x194a3d,'error'),'';}}async['saveMessage'](_0x37eb18,_0x5382e7){const _0x3a37d6=a142_0x2c6f79;try{const _0x58d4dc=_0x5382e7[_0x3a37d6(0x16c)];if(!_0x58d4dc){_0x37eb18[_0x3a37d6(0x14e)](_0x3a37d6(0x148));return;}await this[_0x3a37d6(0x165)][_0x3a37d6(0x147)](_0x58d4dc),_0x37eb18[_0x3a37d6(0x14e)](_0x3a37d6(0x183)+_0x5382e7[_0x3a37d6(0x16c)]);}catch(_0x952da9){return this[_0x3a37d6(0x173)][_0x3a37d6(0x160)](_0x952da9,_0x3a37d6(0x14b)),'';}}async[a142_0x2c6f79(0x176)](){const _0x231bc3=a142_0x2c6f79;try{const _0xf20d7b=await this[_0x231bc3(0x165)]['getMessages']();return _0xf20d7b!==null&&_0xf20d7b!==void 0x0?_0xf20d7b:[];}catch(_0x2d7529){return this[_0x231bc3(0x173)][_0x231bc3(0x160)](_0x2d7529,_0x231bc3(0x191)),'';}}[a142_0x2c6f79(0x192)](_0x424625){const _0x4cde72=a142_0x2c6f79;return this[_0x4cde72(0x165)]['deleteTextMessage'](_0x424625);}['updateTextMessage'](_0x237113,_0x448361){const _0x3aa0a3=a142_0x2c6f79;var _0x5f4be0;return this['textToAudioService']['updateTextMessage'](_0x237113,Object[_0x3aa0a3(0x15f)](Object[_0x3aa0a3(0x15f)]({},_0x448361),{'volume':(_0x5f4be0=_0x448361[_0x3aa0a3(0x15e)])!==null&&_0x5f4be0!==void 0x0?_0x5f4be0:0x32}));}};__decorate([(0x0,common_1[a142_0x2c6f79(0x174)])('/'),(0x0,common_1[a142_0x2c6f79(0x179)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x2c6f79(0x144)]),(0x0,roles_decorator_1[a142_0x2c6f79(0x164)])(role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x15c)],role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x17c)]),__param(0x0,(0x0,common_1[a142_0x2c6f79(0x16d)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x2c6f79(0x143),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x2c6f79(0x153)]]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],'playAudioFile',null),__decorate([(0x0,common_1['Post'])(a142_0x2c6f79(0x147)),(0x0,common_1[a142_0x2c6f79(0x179)])(jwt_guard_1[a142_0x2c6f79(0x159)],roles_guard_1[a142_0x2c6f79(0x144)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x15c)],role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x17c)]),__param(0x0,(0x0,common_1[a142_0x2c6f79(0x16d)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x2c6f79(0x143),Function),__metadata(a142_0x2c6f79(0x172),[Object,text_dto_1[a142_0x2c6f79(0x153)]]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x2c6f79(0x17b)],a142_0x2c6f79(0x147),null),__decorate([(0x0,common_1[a142_0x2c6f79(0x157)])('/message'),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x2c6f79(0x159)],roles_guard_1[a142_0x2c6f79(0x144)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x15c)],role_enum_1['Role']['User']),__metadata(a142_0x2c6f79(0x143),Function),__metadata(a142_0x2c6f79(0x172),[]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],a142_0x2c6f79(0x176),null),__decorate([(0x0,common_1[a142_0x2c6f79(0x189)])(a142_0x2c6f79(0x186)),(0x0,common_1[a142_0x2c6f79(0x179)])(jwt_guard_1[a142_0x2c6f79(0x159)],roles_guard_1[a142_0x2c6f79(0x144)]),(0x0,roles_decorator_1[a142_0x2c6f79(0x164)])(role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x15c)],role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x17c)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x2c6f79(0x143),Function),__metadata(a142_0x2c6f79(0x172),[String]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x2c6f79(0x17b)],a142_0x2c6f79(0x192),null),__decorate([(0x0,common_1[a142_0x2c6f79(0x17e)])('/:id'),(0x0,common_1[a142_0x2c6f79(0x179)])(jwt_guard_1[a142_0x2c6f79(0x159)],roles_guard_1[a142_0x2c6f79(0x144)]),(0x0,roles_decorator_1[a142_0x2c6f79(0x164)])(role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x15c)],role_enum_1[a142_0x2c6f79(0x178)][a142_0x2c6f79(0x17c)]),__param(0x0,(0x0,common_1[a142_0x2c6f79(0x16e)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x2c6f79(0x143),Function),__metadata('design:paramtypes',[String,text_dto_1[a142_0x2c6f79(0x153)]]),__metadata('design:returntype',void 0x0)],TextToAudioController[a142_0x2c6f79(0x17b)],a142_0x2c6f79(0x18e),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x2c6f79(0x185)])(a142_0x2c6f79(0x151)),__metadata(a142_0x2c6f79(0x172),[text_to_audio_service_1['TextToAudioService'],streaming_service_1[a142_0x2c6f79(0x18f)]])],TextToAudioController),exports[a142_0x2c6f79(0x16a)]=TextToAudioController;