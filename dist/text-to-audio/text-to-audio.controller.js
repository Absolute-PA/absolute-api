'use strict';const a142_0x1e0c25=a142_0x296f;(function(_0x32c2fd,_0x453c56){const _0x4461db=a142_0x296f,_0x17547e=_0x32c2fd();while(!![]){try{const _0x1ade45=parseInt(_0x4461db(0x150))/0x1+-parseInt(_0x4461db(0x166))/0x2+-parseInt(_0x4461db(0x174))/0x3*(parseInt(_0x4461db(0x15c))/0x4)+-parseInt(_0x4461db(0x15e))/0x5+parseInt(_0x4461db(0x171))/0x6+-parseInt(_0x4461db(0x167))/0x7*(parseInt(_0x4461db(0x158))/0x8)+parseInt(_0x4461db(0x16d))/0x9;if(_0x1ade45===_0x453c56)break;else _0x17547e['push'](_0x17547e['shift']());}catch(_0x3e5c42){_0x17547e['push'](_0x17547e['shift']());}}}(a142_0x717c,0x19698));function a142_0x717c(){const _0x205357=['play','createFolder','AudioPlayer','Param','saveMessage','decorate','Post','./text-to-audio.service','function','design:returntype','97361cwrsEO','assign','isFileExist','__esModule','textToAudioService','../auth/guards/roles.guard','error\x20','Admin','73968TgHCmq','metadata','TextToAudioController','.wav','4RRZDtT','getMessages','1040175dxvjYi','updateTextMessage','volume','saveStreamToFile','../common/file','AUDIO_TO_MESSAGE_DIR','Success\x20save\x20text:\x20','path','295624qfkfgy','21dtuKyU','Res','Roles','Role','deleteTextMessage','defineProperty','2797380Poajpk','logger','getAllMessage','/:id','1112694oCdhZx','object','error','317871VaTEcn','Controller','There\x20is\x20no\x20message\x20to\x20play','design:paramtypes','prototype','/message','Body','processRootPath','UseGuards','./dtos/text.dto','Success\x20play\x20text\x20to\x20audio:\x20','Get','JwtAuthGuard','RolesGuard','send','../common/constants','@nestjs/common','Delete','streamingService','design:type','name','../auth/guards/jwt.guard','playAudioFile','TextToAudioService','getOwnPropertyDescriptor','textToAudio','TextDTO','text','User','log','length'];a142_0x717c=function(){return _0x205357;};return a142_0x717c();}function a142_0x296f(_0x47b245,_0x2dc6c2){const _0x717cd7=a142_0x717c();return a142_0x296f=function(_0x296f92,_0x307950){_0x296f92=_0x296f92-0x12a;let _0x771315=_0x717cd7[_0x296f92];return _0x771315;},a142_0x296f(_0x47b245,_0x2dc6c2);}var __decorate=this&&this['__decorate']||function(_0xcb9226,_0x5d0af6,_0xefbef6,_0x2c34ac){const _0x3a0728=a142_0x296f;var _0x324a7=arguments['length'],_0x43e24b=_0x324a7<0x3?_0x5d0af6:_0x2c34ac===null?_0x2c34ac=Object[_0x3a0728(0x13f)](_0x5d0af6,_0xefbef6):_0x2c34ac,_0x23ebaf;if(typeof Reflect===_0x3a0728(0x172)&&typeof Reflect[_0x3a0728(0x14b)]===_0x3a0728(0x14e))_0x43e24b=Reflect[_0x3a0728(0x14b)](_0xcb9226,_0x5d0af6,_0xefbef6,_0x2c34ac);else{for(var _0x3faffe=_0xcb9226[_0x3a0728(0x145)]-0x1;_0x3faffe>=0x0;_0x3faffe--)if(_0x23ebaf=_0xcb9226[_0x3faffe])_0x43e24b=(_0x324a7<0x3?_0x23ebaf(_0x43e24b):_0x324a7>0x3?_0x23ebaf(_0x5d0af6,_0xefbef6,_0x43e24b):_0x23ebaf(_0x5d0af6,_0xefbef6))||_0x43e24b;}return _0x324a7>0x3&&_0x43e24b&&Object[_0x3a0728(0x16c)](_0x5d0af6,_0xefbef6,_0x43e24b),_0x43e24b;},__metadata=this&&this['__metadata']||function(_0x42c8cd,_0x30b1ca){const _0x4b1575=a142_0x296f;if(typeof Reflect===_0x4b1575(0x172)&&typeof Reflect[_0x4b1575(0x159)]==='function')return Reflect['metadata'](_0x42c8cd,_0x30b1ca);},__param=this&&this['__param']||function(_0x2eaa16,_0x98aef2){return function(_0x33ec93,_0x3c7377){_0x98aef2(_0x33ec93,_0x3c7377,_0x2eaa16);};},TextToAudioController_1;Object[a142_0x1e0c25(0x16c)](exports,a142_0x1e0c25(0x153),{'value':!![]}),exports[a142_0x1e0c25(0x15a)]=void 0x0;const common_1=require(a142_0x1e0c25(0x137)),text_to_audio_service_1=require(a142_0x1e0c25(0x14d)),text_dto_1=require(a142_0x1e0c25(0x130)),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require('../auth/enums/role.enum'),jwt_guard_1=require(a142_0x1e0c25(0x13c)),roles_guard_1=require(a142_0x1e0c25(0x155)),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a142_0x1e0c25(0x165)),path_1=require('../common/path'),constants_1=require(a142_0x1e0c25(0x136)),file_1=require(a142_0x1e0c25(0x162)),audio_player_1=require('../common/audio/audio-player');let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x4d324e,_0x5d5dfa){const _0x148ab2=a142_0x1e0c25;this[_0x148ab2(0x154)]=_0x4d324e,this[_0x148ab2(0x139)]=_0x5d5dfa,this['logger']=new common_1['Logger'](TextToAudioController_1[_0x148ab2(0x13b)]);}async['playAudioFile'](_0x4dcc6d,_0x1ceb4f){const _0x4f5136=a142_0x1e0c25;try{const _0x1a4343=_0x1ceb4f[_0x4f5136(0x142)];if(!_0x1a4343){_0x4dcc6d['send'](_0x4f5136(0x176));return;}const {id:_0x167b6f,volume:_0x4d07ae}=await this[_0x4f5136(0x154)]['saveMessage'](_0x1a4343);!(0x0,file_1[_0x4f5136(0x152)])(constants_1[_0x4f5136(0x163)])&&(0x0,file_1[_0x4f5136(0x147)])(constants_1[_0x4f5136(0x163)]);const _0x82f2fc=path['join'](path_1[_0x4f5136(0x12e)],constants_1[_0x4f5136(0x163)]),_0x33eb28=_0x82f2fc+'/'+_0x167b6f+_0x4f5136(0x15b);!(0x0,file_1[_0x4f5136(0x152)])(_0x33eb28)?await this[_0x4f5136(0x154)][_0x4f5136(0x140)](_0x1ceb4f['text'],async _0x50c65c=>{const _0x38910b=_0x4f5136;await(0x0,saveStreamToFile_1[_0x38910b(0x161)])(_0x50c65c,_0x82f2fc+'/'+_0x167b6f+'.wav'),audio_player_1[_0x38910b(0x148)][_0x38910b(0x146)](_0x33eb28,_0x4d07ae!==null&&_0x4d07ae!==void 0x0?_0x4d07ae:0x32);}):audio_player_1['AudioPlayer'][_0x4f5136(0x146)](_0x33eb28,_0x4d07ae!==null&&_0x4d07ae!==void 0x0?_0x4d07ae:0x32),_0x4dcc6d[_0x4f5136(0x135)](_0x4f5136(0x131)+_0x1ceb4f[_0x4f5136(0x142)]);}catch(_0x6b83d9){return this[_0x4f5136(0x16e)]['log'](_0x6b83d9,_0x4f5136(0x173)),'';}}async[a142_0x1e0c25(0x14a)](_0x2e7a96,_0xdbde10){const _0x2b33a3=a142_0x1e0c25;try{const _0x22784f=_0xdbde10[_0x2b33a3(0x142)];if(!_0x22784f){_0x2e7a96[_0x2b33a3(0x135)]('There\x20is\x20no\x20message\x20to\x20play');return;}await this[_0x2b33a3(0x154)][_0x2b33a3(0x14a)](_0x22784f),_0x2e7a96[_0x2b33a3(0x135)](_0x2b33a3(0x164)+_0xdbde10['text']);}catch(_0x4facba){return this[_0x2b33a3(0x16e)][_0x2b33a3(0x144)](_0x4facba,_0x2b33a3(0x156)),'';}}async[a142_0x1e0c25(0x16f)](){const _0x1593dd=a142_0x1e0c25;try{const _0x52e29b=await this[_0x1593dd(0x154)][_0x1593dd(0x15d)]();return _0x52e29b!==null&&_0x52e29b!==void 0x0?_0x52e29b:[];}catch(_0x3d27d2){return this[_0x1593dd(0x16e)][_0x1593dd(0x144)](_0x3d27d2,_0x1593dd(0x173)),'';}}[a142_0x1e0c25(0x16b)](_0x2a4024){const _0x18ab9a=a142_0x1e0c25;return this['textToAudioService'][_0x18ab9a(0x16b)](_0x2a4024);}[a142_0x1e0c25(0x15f)](_0x5d6627,_0x5b0684){const _0xf4d8fd=a142_0x1e0c25;var _0x5e74a6;return this[_0xf4d8fd(0x154)]['updateTextMessage'](_0x5d6627,Object['assign'](Object[_0xf4d8fd(0x151)]({},_0x5b0684),{'volume':(_0x5e74a6=_0x5b0684[_0xf4d8fd(0x160)])!==null&&_0x5e74a6!==void 0x0?_0x5e74a6:0x32}));}};__decorate([(0x0,common_1[a142_0x1e0c25(0x14c)])('/'),(0x0,common_1[a142_0x1e0c25(0x12f)])(jwt_guard_1[a142_0x1e0c25(0x133)],roles_guard_1[a142_0x1e0c25(0x134)]),(0x0,roles_decorator_1[a142_0x1e0c25(0x169)])(role_enum_1[a142_0x1e0c25(0x16a)][a142_0x1e0c25(0x157)],role_enum_1[a142_0x1e0c25(0x16a)][a142_0x1e0c25(0x143)]),__param(0x0,(0x0,common_1[a142_0x1e0c25(0x168)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x1e0c25(0x12d)])()),__metadata(a142_0x1e0c25(0x13a),Function),__metadata(a142_0x1e0c25(0x12a),[Object,text_dto_1[a142_0x1e0c25(0x141)]]),__metadata(a142_0x1e0c25(0x14f),Promise)],TextToAudioController[a142_0x1e0c25(0x12b)],a142_0x1e0c25(0x13d),null),__decorate([(0x0,common_1[a142_0x1e0c25(0x14c)])(a142_0x1e0c25(0x14a)),(0x0,common_1[a142_0x1e0c25(0x12f)])(jwt_guard_1[a142_0x1e0c25(0x133)],roles_guard_1[a142_0x1e0c25(0x134)]),(0x0,roles_decorator_1[a142_0x1e0c25(0x169)])(role_enum_1[a142_0x1e0c25(0x16a)][a142_0x1e0c25(0x157)],role_enum_1[a142_0x1e0c25(0x16a)][a142_0x1e0c25(0x143)]),__param(0x0,(0x0,common_1[a142_0x1e0c25(0x168)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x1e0c25(0x13a),Function),__metadata(a142_0x1e0c25(0x12a),[Object,text_dto_1[a142_0x1e0c25(0x141)]]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],'saveMessage',null),__decorate([(0x0,common_1[a142_0x1e0c25(0x132)])(a142_0x1e0c25(0x12c)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x1e0c25(0x133)],roles_guard_1[a142_0x1e0c25(0x134)]),(0x0,roles_decorator_1[a142_0x1e0c25(0x169)])(role_enum_1['Role']['Admin'],role_enum_1['Role']['User']),__metadata(a142_0x1e0c25(0x13a),Function),__metadata(a142_0x1e0c25(0x12a),[]),__metadata(a142_0x1e0c25(0x14f),Promise)],TextToAudioController[a142_0x1e0c25(0x12b)],'getAllMessage',null),__decorate([(0x0,common_1[a142_0x1e0c25(0x138)])(a142_0x1e0c25(0x170)),(0x0,common_1[a142_0x1e0c25(0x12f)])(jwt_guard_1[a142_0x1e0c25(0x133)],roles_guard_1[a142_0x1e0c25(0x134)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a142_0x1e0c25(0x157)],role_enum_1[a142_0x1e0c25(0x16a)][a142_0x1e0c25(0x143)]),__param(0x0,(0x0,common_1[a142_0x1e0c25(0x149)])('id')),__metadata(a142_0x1e0c25(0x13a),Function),__metadata(a142_0x1e0c25(0x12a),[String]),__metadata(a142_0x1e0c25(0x14f),void 0x0)],TextToAudioController[a142_0x1e0c25(0x12b)],'deleteTextMessage',null),__decorate([(0x0,common_1['Put'])(a142_0x1e0c25(0x170)),(0x0,common_1[a142_0x1e0c25(0x12f)])(jwt_guard_1[a142_0x1e0c25(0x133)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x1e0c25(0x169)])(role_enum_1['Role'][a142_0x1e0c25(0x157)],role_enum_1[a142_0x1e0c25(0x16a)]['User']),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x1e0c25(0x13a),Function),__metadata('design:paramtypes',[String,text_dto_1['TextDTO']]),__metadata(a142_0x1e0c25(0x14f),void 0x0)],TextToAudioController[a142_0x1e0c25(0x12b)],a142_0x1e0c25(0x15f),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x1e0c25(0x175)])(a142_0x1e0c25(0x140)),__metadata(a142_0x1e0c25(0x12a),[text_to_audio_service_1[a142_0x1e0c25(0x13e)],streaming_service_1['StreamingService']])],TextToAudioController),exports[a142_0x1e0c25(0x15a)]=TextToAudioController;