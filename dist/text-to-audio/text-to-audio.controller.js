'use strict';function a142_0x51b4(_0x38a219,_0x1c175b){const _0x12c979=a142_0x12c9();return a142_0x51b4=function(_0x51b49e,_0x40bd0a){_0x51b49e=_0x51b49e-0x167;let _0x3700cc=_0x12c979[_0x51b49e];return _0x3700cc;},a142_0x51b4(_0x38a219,_0x1c175b);}function a142_0x12c9(){const _0x18c773=['TextDTO','6788508jwbsCX','textToAudio','../common/path','volume','decorate','Success\x20save\x20text:\x20','design:returntype','deleteTextMessage','2050263jycvKV','/message','path','Logger','Roles','StreamingService','length','AudioPlayer','__decorate','AUDIO_TO_MESSAGE_DIR','object','User','function','./dtos/text.dto','Success\x20play\x20text\x20to\x20audio:\x20','__esModule','Admin','.wav','Post','isFileExist','assign','name','/:id','RolesGuard','../common/constants','../common/audio/audio-player','8242888KgHOLA','processRootPath','saveMessage','saveStreamToFile','updateTextMessage','__metadata','getOwnPropertyDescriptor','design:paramtypes','textToAudioService','error','send','4458wFrBUN','getMessages','Delete','text','Body','There\x20is\x20no\x20message\x20to\x20play','logger','Res','Get','995qvXtQY','114432qmVRDU','error\x20','defineProperty','./saveStreamToFile','../auth/enums/role.enum','../auth/decorators/roles.decorator','../auth/guards/jwt.guard','Role','streamingService','./text-to-audio.service','metadata','TextToAudioService','3088736BwPGyo','playAudioFile','prototype','play','19428aUzjbS','1200JyHWoX','design:type','createFolder','JwtAuthGuard','log','TextToAudioController'];a142_0x12c9=function(){return _0x18c773;};return a142_0x12c9();}const a142_0x528376=a142_0x51b4;(function(_0x100b49,_0x45a78d){const _0x1434d4=a142_0x51b4,_0x38b023=_0x100b49();while(!![]){try{const _0x508822=parseInt(_0x1434d4(0x1b1))/0x1+-parseInt(_0x1434d4(0x173))/0x2*(-parseInt(_0x1434d4(0x1a7))/0x3)+-parseInt(_0x1434d4(0x172))/0x4*(parseInt(_0x1434d4(0x1b0))/0x5)+-parseInt(_0x1434d4(0x17a))/0x6+parseInt(_0x1434d4(0x16e))/0x7+parseInt(_0x1434d4(0x19c))/0x8+parseInt(_0x1434d4(0x182))/0x9;if(_0x508822===_0x45a78d)break;else _0x38b023['push'](_0x38b023['shift']());}catch(_0x2cd01d){_0x38b023['push'](_0x38b023['shift']());}}}(a142_0x12c9,0x944ff));var __decorate=this&&this[a142_0x528376(0x18a)]||function(_0x2aa5e1,_0x14b8e7,_0x3f384f,_0x4dcc1a){const _0x69fe65=a142_0x528376;var _0x26758c=arguments[_0x69fe65(0x188)],_0x4ea6e5=_0x26758c<0x3?_0x14b8e7:_0x4dcc1a===null?_0x4dcc1a=Object[_0x69fe65(0x1a2)](_0x14b8e7,_0x3f384f):_0x4dcc1a,_0x327676;if(typeof Reflect==='object'&&typeof Reflect[_0x69fe65(0x17e)]===_0x69fe65(0x18e))_0x4ea6e5=Reflect[_0x69fe65(0x17e)](_0x2aa5e1,_0x14b8e7,_0x3f384f,_0x4dcc1a);else{for(var _0x3b6a1c=_0x2aa5e1[_0x69fe65(0x188)]-0x1;_0x3b6a1c>=0x0;_0x3b6a1c--)if(_0x327676=_0x2aa5e1[_0x3b6a1c])_0x4ea6e5=(_0x26758c<0x3?_0x327676(_0x4ea6e5):_0x26758c>0x3?_0x327676(_0x14b8e7,_0x3f384f,_0x4ea6e5):_0x327676(_0x14b8e7,_0x3f384f))||_0x4ea6e5;}return _0x26758c>0x3&&_0x4ea6e5&&Object['defineProperty'](_0x14b8e7,_0x3f384f,_0x4ea6e5),_0x4ea6e5;},__metadata=this&&this[a142_0x528376(0x1a1)]||function(_0x473b61,_0x572e67){const _0x5588de=a142_0x528376;if(typeof Reflect===_0x5588de(0x18c)&&typeof Reflect[_0x5588de(0x16c)]==='function')return Reflect['metadata'](_0x473b61,_0x572e67);},__param=this&&this['__param']||function(_0x5606aa,_0x2f6c99){return function(_0x41faeb,_0x1123a4){_0x2f6c99(_0x41faeb,_0x1123a4,_0x5606aa);};},TextToAudioController_1;Object[a142_0x528376(0x1b3)](exports,a142_0x528376(0x191),{'value':!![]}),exports[a142_0x528376(0x178)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a142_0x528376(0x16b)),text_dto_1=require(a142_0x528376(0x18f)),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require(a142_0x528376(0x167)),role_enum_1=require(a142_0x528376(0x1b5)),jwt_guard_1=require(a142_0x528376(0x168)),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require(a142_0x528376(0x1b4)),path=require(a142_0x528376(0x184)),path_1=require(a142_0x528376(0x17c)),constants_1=require(a142_0x528376(0x19a)),file_1=require('../common/file'),audio_player_1=require(a142_0x528376(0x19b));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x2672bf,_0x3560a9){const _0x27423b=a142_0x528376;this[_0x27423b(0x1a4)]=_0x2672bf,this[_0x27423b(0x16a)]=_0x3560a9,this[_0x27423b(0x1ad)]=new common_1[(_0x27423b(0x185))](TextToAudioController_1[_0x27423b(0x197)]);}async[a142_0x528376(0x16f)](_0x524337,_0x31384c){const _0x10d5cb=a142_0x528376;try{const _0x1998f1=_0x31384c[_0x10d5cb(0x1aa)];if(!_0x1998f1){_0x524337[_0x10d5cb(0x1a6)](_0x10d5cb(0x1ac));return;}const {id:_0x18acd8,volume:_0x4516fa}=await this[_0x10d5cb(0x1a4)][_0x10d5cb(0x19e)](_0x1998f1);!(0x0,file_1[_0x10d5cb(0x195)])(constants_1[_0x10d5cb(0x18b)])&&(0x0,file_1[_0x10d5cb(0x175)])(constants_1[_0x10d5cb(0x18b)]);const _0x174701=path['join'](path_1[_0x10d5cb(0x19d)],constants_1[_0x10d5cb(0x18b)]),_0x5f4510=_0x174701+'/'+_0x18acd8+_0x10d5cb(0x193);!(0x0,file_1[_0x10d5cb(0x195)])(_0x5f4510)?await this[_0x10d5cb(0x1a4)][_0x10d5cb(0x17b)](_0x31384c[_0x10d5cb(0x1aa)],async _0x1e494a=>{const _0x113559=_0x10d5cb;await(0x0,saveStreamToFile_1[_0x113559(0x19f)])(_0x1e494a,_0x174701+'/'+_0x18acd8+'.wav'),audio_player_1[_0x113559(0x189)][_0x113559(0x171)](_0x5f4510,_0x4516fa!==null&&_0x4516fa!==void 0x0?_0x4516fa:0x32);}):audio_player_1[_0x10d5cb(0x189)][_0x10d5cb(0x171)](_0x5f4510,_0x4516fa!==null&&_0x4516fa!==void 0x0?_0x4516fa:0x32),_0x524337[_0x10d5cb(0x1a6)](_0x10d5cb(0x190)+_0x31384c[_0x10d5cb(0x1aa)]);}catch(_0x4559c5){return this[_0x10d5cb(0x1ad)][_0x10d5cb(0x177)](_0x4559c5,_0x10d5cb(0x1a5)),'';}}async[a142_0x528376(0x19e)](_0x265507,_0x317839){const _0x16ff5a=a142_0x528376;try{const _0x3ca4af=_0x317839['text'];if(!_0x3ca4af){_0x265507['send'](_0x16ff5a(0x1ac));return;}await this['textToAudioService'][_0x16ff5a(0x19e)](_0x3ca4af),_0x265507[_0x16ff5a(0x1a6)](_0x16ff5a(0x17f)+_0x317839[_0x16ff5a(0x1aa)]);}catch(_0xad5a60){return this[_0x16ff5a(0x1ad)][_0x16ff5a(0x177)](_0xad5a60,_0x16ff5a(0x1b2)),'';}}async['getAllMessage'](){const _0x4e2694=a142_0x528376;try{const _0x1525da=await this[_0x4e2694(0x1a4)][_0x4e2694(0x1a8)]();return _0x1525da!==null&&_0x1525da!==void 0x0?_0x1525da:[];}catch(_0x54b677){return this[_0x4e2694(0x1ad)][_0x4e2694(0x177)](_0x54b677,_0x4e2694(0x1a5)),'';}}[a142_0x528376(0x181)](_0x3b74c3){const _0x372928=a142_0x528376;return this['textToAudioService'][_0x372928(0x181)](_0x3b74c3);}[a142_0x528376(0x1a0)](_0x178882,_0x149b35){const _0x482d3e=a142_0x528376;var _0x301671;return this[_0x482d3e(0x1a4)][_0x482d3e(0x1a0)](_0x178882,Object[_0x482d3e(0x196)](Object[_0x482d3e(0x196)]({},_0x149b35),{'volume':(_0x301671=_0x149b35[_0x482d3e(0x17d)])!==null&&_0x301671!==void 0x0?_0x301671:0x32}));}};__decorate([(0x0,common_1[a142_0x528376(0x194)])('/'),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x528376(0x176)],roles_guard_1[a142_0x528376(0x199)]),(0x0,roles_decorator_1[a142_0x528376(0x186)])(role_enum_1['Role'][a142_0x528376(0x192)],role_enum_1[a142_0x528376(0x169)][a142_0x528376(0x18d)]),__param(0x0,(0x0,common_1[a142_0x528376(0x1ae)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x528376(0x1ab)])()),__metadata(a142_0x528376(0x174),Function),__metadata(a142_0x528376(0x1a3),[Object,text_dto_1[a142_0x528376(0x179)]]),__metadata(a142_0x528376(0x180),Promise)],TextToAudioController[a142_0x528376(0x170)],a142_0x528376(0x16f),null),__decorate([(0x0,common_1[a142_0x528376(0x194)])('saveMessage'),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x528376(0x176)],roles_guard_1[a142_0x528376(0x199)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x528376(0x169)]['Admin'],role_enum_1[a142_0x528376(0x169)][a142_0x528376(0x18d)]),__param(0x0,(0x0,common_1[a142_0x528376(0x1ae)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x528376(0x1ab)])()),__metadata('design:type',Function),__metadata(a142_0x528376(0x1a3),[Object,text_dto_1['TextDTO']]),__metadata(a142_0x528376(0x180),Promise)],TextToAudioController['prototype'],'saveMessage',null),__decorate([(0x0,common_1[a142_0x528376(0x1af)])(a142_0x528376(0x183)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x528376(0x176)],roles_guard_1[a142_0x528376(0x199)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x528376(0x169)]['Admin'],role_enum_1[a142_0x528376(0x169)][a142_0x528376(0x18d)]),__metadata(a142_0x528376(0x174),Function),__metadata(a142_0x528376(0x1a3),[]),__metadata(a142_0x528376(0x180),Promise)],TextToAudioController['prototype'],'getAllMessage',null),__decorate([(0x0,common_1[a142_0x528376(0x1a9)])(a142_0x528376(0x198)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x528376(0x176)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x528376(0x186)])(role_enum_1[a142_0x528376(0x169)]['Admin'],role_enum_1[a142_0x528376(0x169)][a142_0x528376(0x18d)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x528376(0x174),Function),__metadata(a142_0x528376(0x1a3),[String]),__metadata(a142_0x528376(0x180),void 0x0)],TextToAudioController['prototype'],'deleteTextMessage',null),__decorate([(0x0,common_1['Put'])(a142_0x528376(0x198)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x528376(0x176)],roles_guard_1[a142_0x528376(0x199)]),(0x0,roles_decorator_1[a142_0x528376(0x186)])(role_enum_1['Role'][a142_0x528376(0x192)],role_enum_1[a142_0x528376(0x169)][a142_0x528376(0x18d)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1[a142_0x528376(0x1ab)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[String,text_dto_1['TextDTO']]),__metadata(a142_0x528376(0x180),void 0x0)],TextToAudioController['prototype'],a142_0x528376(0x1a0),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a142_0x528376(0x17b)),__metadata(a142_0x528376(0x1a3),[text_to_audio_service_1[a142_0x528376(0x16d)],streaming_service_1[a142_0x528376(0x187)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;