'use strict';const a142_0x341ada=a142_0x374a;function a142_0x374a(_0x4b8a92,_0x34d789){const _0x18c68b=a142_0x18c6();return a142_0x374a=function(_0x374a0d,_0x2b2406){_0x374a0d=_0x374a0d-0x189;let _0x96b69c=_0x18c68b[_0x374a0d];return _0x96b69c;},a142_0x374a(_0x4b8a92,_0x34d789);}function a142_0x18c6(){const _0x5411e7=['../common/audio/audio-player','playAudioFile','UseGuards','textToAudio','volume','saveMessage','object','Body','assign','JwtAuthGuard','decorate','error\x20','__metadata','Param','getAllMessage','prototype','design:type','../auth/guards/jwt.guard','../auth/guards/roles.guard','8659oasTVx','name','786621DoRHtk','../common/file','AudioPlayer','TextDTO','streamingService','Post','238567XuAfck','1386AxKAcq','play','path','Put','../auth/enums/role.enum','AUDIO_TO_MESSAGE_DIR','9YAqOJl','Roles','text','createFolder','function','logger','./dtos/text.dto','Delete','955825vRxTdj','228936RsLMgI','__param','isFileExist','updateTextMessage','Success\x20save\x20text:\x20','Logger','join','__esModule','design:paramtypes','../common/path','../auth/decorators/roles.decorator','Res','getOwnPropertyDescriptor','length','TextToAudioController','processRootPath','.wav','log','TextToAudioService','There\x20is\x20no\x20message\x20to\x20play','User','send','95380OJrrAY','metadata','StreamingService','/:id','design:returntype','../streaming/streaming.service','deleteTextMessage','./text-to-audio.service','textToAudioService','error','Admin','RolesGuard','Role','691964ncrZDU'];a142_0x18c6=function(){return _0x5411e7;};return a142_0x18c6();}(function(_0x2d2ea5,_0x50b020){const _0x5b3a5c=a142_0x374a,_0x456d2d=_0x2d2ea5();while(!![]){try{const _0x4fe178=-parseInt(_0x5b3a5c(0x1c8))/0x1+parseInt(_0x5b3a5c(0x19f))/0x2+-parseInt(_0x5b3a5c(0x1c2))/0x3+parseInt(_0x5b3a5c(0x1ac))/0x4+parseInt(_0x5b3a5c(0x1d7))/0x5+-parseInt(_0x5b3a5c(0x1c9))/0x6*(-parseInt(_0x5b3a5c(0x1c0))/0x7)+parseInt(_0x5b3a5c(0x189))/0x8*(-parseInt(_0x5b3a5c(0x1cf))/0x9);if(_0x4fe178===_0x50b020)break;else _0x456d2d['push'](_0x456d2d['shift']());}catch(_0x10e9e7){_0x456d2d['push'](_0x456d2d['shift']());}}}(a142_0x18c6,0x2910a));var __decorate=this&&this['__decorate']||function(_0x437670,_0x33cf4e,_0x535699,_0xfadd2e){const _0x294658=a142_0x374a;var _0x1e9c21=arguments['length'],_0x4c5be8=_0x1e9c21<0x3?_0x33cf4e:_0xfadd2e===null?_0xfadd2e=Object[_0x294658(0x195)](_0x33cf4e,_0x535699):_0xfadd2e,_0x42b320;if(typeof Reflect===_0x294658(0x1b3)&&typeof Reflect['decorate']===_0x294658(0x1d3))_0x4c5be8=Reflect[_0x294658(0x1b7)](_0x437670,_0x33cf4e,_0x535699,_0xfadd2e);else{for(var _0x29edc2=_0x437670[_0x294658(0x196)]-0x1;_0x29edc2>=0x0;_0x29edc2--)if(_0x42b320=_0x437670[_0x29edc2])_0x4c5be8=(_0x1e9c21<0x3?_0x42b320(_0x4c5be8):_0x1e9c21>0x3?_0x42b320(_0x33cf4e,_0x535699,_0x4c5be8):_0x42b320(_0x33cf4e,_0x535699))||_0x4c5be8;}return _0x1e9c21>0x3&&_0x4c5be8&&Object['defineProperty'](_0x33cf4e,_0x535699,_0x4c5be8),_0x4c5be8;},__metadata=this&&this[a142_0x341ada(0x1b9)]||function(_0x3be86c,_0x2ea258){const _0x1247b1=a142_0x341ada;if(typeof Reflect===_0x1247b1(0x1b3)&&typeof Reflect[_0x1247b1(0x1a0)]===_0x1247b1(0x1d3))return Reflect[_0x1247b1(0x1a0)](_0x3be86c,_0x2ea258);},__param=this&&this[a142_0x341ada(0x18a)]||function(_0x2ef981,_0x9d9570){return function(_0x42ce18,_0x235bd4){_0x9d9570(_0x42ce18,_0x235bd4,_0x2ef981);};},TextToAudioController_1;Object['defineProperty'](exports,a142_0x341ada(0x190),{'value':!![]}),exports[a142_0x341ada(0x197)]=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a142_0x341ada(0x1a6)),text_dto_1=require(a142_0x341ada(0x1d5)),streaming_service_1=require(a142_0x341ada(0x1a4)),roles_decorator_1=require(a142_0x341ada(0x193)),role_enum_1=require(a142_0x341ada(0x1cd)),jwt_guard_1=require(a142_0x341ada(0x1be)),roles_guard_1=require(a142_0x341ada(0x1bf)),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a142_0x341ada(0x1cb)),path_1=require(a142_0x341ada(0x192)),constants_1=require('../common/constants'),file_1=require(a142_0x341ada(0x1c3)),audio_player_1=require(a142_0x341ada(0x1ad));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x3f52c2,_0x1c1cde){const _0xb55b9b=a142_0x341ada;this['textToAudioService']=_0x3f52c2,this[_0xb55b9b(0x1c6)]=_0x1c1cde,this['logger']=new common_1[(_0xb55b9b(0x18e))](TextToAudioController_1[_0xb55b9b(0x1c1)]);}async['playAudioFile'](_0x400d9a,_0x3fb9ee){const _0x565d05=a142_0x341ada;try{const _0x237f1c=_0x3fb9ee[_0x565d05(0x1d1)];if(!_0x237f1c){_0x400d9a[_0x565d05(0x19e)](_0x565d05(0x19c));return;}const {id:_0xc75d15,volume:_0x15a593}=await this[_0x565d05(0x1a7)][_0x565d05(0x1b2)](_0x237f1c);!(0x0,file_1['isFileExist'])(constants_1[_0x565d05(0x1ce)])&&(0x0,file_1[_0x565d05(0x1d2)])(constants_1[_0x565d05(0x1ce)]);const _0x5898df=path[_0x565d05(0x18f)](path_1[_0x565d05(0x198)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x270b32=_0x5898df+'/'+_0xc75d15+_0x565d05(0x199);!(0x0,file_1[_0x565d05(0x18b)])(_0x270b32)?await this[_0x565d05(0x1a7)][_0x565d05(0x1b0)](_0x3fb9ee[_0x565d05(0x1d1)],async _0x147b37=>{const _0x177c64=_0x565d05;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x147b37,_0x5898df+'/'+_0xc75d15+_0x177c64(0x199)),audio_player_1[_0x177c64(0x1c4)][_0x177c64(0x1ca)](_0x270b32,_0x15a593!==null&&_0x15a593!==void 0x0?_0x15a593:0x32);}):audio_player_1[_0x565d05(0x1c4)][_0x565d05(0x1ca)](_0x270b32,_0x15a593!==null&&_0x15a593!==void 0x0?_0x15a593:0x32),_0x400d9a[_0x565d05(0x19e)]('Success\x20play\x20text\x20to\x20audio:\x20'+_0x3fb9ee[_0x565d05(0x1d1)]);}catch(_0x552619){return this[_0x565d05(0x1d4)][_0x565d05(0x19a)](_0x552619,_0x565d05(0x1a8)),'';}}async[a142_0x341ada(0x1b2)](_0x211fe1,_0x23e9a0){const _0x2cd9f8=a142_0x341ada;try{const _0x85f937=_0x23e9a0[_0x2cd9f8(0x1d1)];if(!_0x85f937){_0x211fe1[_0x2cd9f8(0x19e)](_0x2cd9f8(0x19c));return;}await this[_0x2cd9f8(0x1a7)][_0x2cd9f8(0x1b2)](_0x85f937),_0x211fe1[_0x2cd9f8(0x19e)](_0x2cd9f8(0x18d)+_0x23e9a0[_0x2cd9f8(0x1d1)]);}catch(_0x2048c5){return this[_0x2cd9f8(0x1d4)]['log'](_0x2048c5,_0x2cd9f8(0x1b8)),'';}}async[a142_0x341ada(0x1bb)](){const _0xceb838=a142_0x341ada;try{const _0x4486c2=await this[_0xceb838(0x1a7)]['getMessages']();return _0x4486c2!==null&&_0x4486c2!==void 0x0?_0x4486c2:[];}catch(_0x16a606){return this[_0xceb838(0x1d4)][_0xceb838(0x19a)](_0x16a606,_0xceb838(0x1a8)),'';}}['deleteTextMessage'](_0xc41f51){const _0x5ee164=a142_0x341ada;return this[_0x5ee164(0x1a7)][_0x5ee164(0x1a5)](_0xc41f51);}['updateTextMessage'](_0x221e69,_0x27e0e9){const _0x233fbb=a142_0x341ada;var _0x17c9bb;return this['textToAudioService'][_0x233fbb(0x18c)](_0x221e69,Object['assign'](Object[_0x233fbb(0x1b5)]({},_0x27e0e9),{'volume':(_0x17c9bb=_0x27e0e9[_0x233fbb(0x1b1)])!==null&&_0x17c9bb!==void 0x0?_0x17c9bb:0x32}));}};__decorate([(0x0,common_1[a142_0x341ada(0x1c7)])('/'),(0x0,common_1[a142_0x341ada(0x1af)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x341ada(0x1aa)]),(0x0,roles_decorator_1[a142_0x341ada(0x1d0)])(role_enum_1['Role'][a142_0x341ada(0x1a9)],role_enum_1[a142_0x341ada(0x1ab)][a142_0x341ada(0x19d)]),__param(0x0,(0x0,common_1[a142_0x341ada(0x194)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x341ada(0x1b4)])()),__metadata(a142_0x341ada(0x1bd),Function),__metadata(a142_0x341ada(0x191),[Object,text_dto_1[a142_0x341ada(0x1c5)]]),__metadata('design:returntype',Promise)],TextToAudioController['prototype'],a142_0x341ada(0x1ae),null),__decorate([(0x0,common_1[a142_0x341ada(0x1c7)])('saveMessage'),(0x0,common_1[a142_0x341ada(0x1af)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x341ada(0x1ab)][a142_0x341ada(0x1a9)],role_enum_1['Role'][a142_0x341ada(0x19d)]),__param(0x0,(0x0,common_1[a142_0x341ada(0x194)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x341ada(0x1b4)])()),__metadata('design:type',Function),__metadata(a142_0x341ada(0x191),[Object,text_dto_1[a142_0x341ada(0x1c5)]]),__metadata(a142_0x341ada(0x1a3),Promise)],TextToAudioController[a142_0x341ada(0x1bc)],a142_0x341ada(0x1b2),null),__decorate([(0x0,common_1['Get'])('/message'),(0x0,common_1[a142_0x341ada(0x1af)])(jwt_guard_1[a142_0x341ada(0x1b6)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x341ada(0x1d0)])(role_enum_1[a142_0x341ada(0x1ab)][a142_0x341ada(0x1a9)],role_enum_1[a142_0x341ada(0x1ab)][a142_0x341ada(0x19d)]),__metadata(a142_0x341ada(0x1bd),Function),__metadata(a142_0x341ada(0x191),[]),__metadata(a142_0x341ada(0x1a3),Promise)],TextToAudioController[a142_0x341ada(0x1bc)],a142_0x341ada(0x1bb),null),__decorate([(0x0,common_1[a142_0x341ada(0x1d6)])(a142_0x341ada(0x1a2)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x341ada(0x1b6)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x341ada(0x1d0)])(role_enum_1[a142_0x341ada(0x1ab)]['Admin'],role_enum_1[a142_0x341ada(0x1ab)][a142_0x341ada(0x19d)]),__param(0x0,(0x0,common_1[a142_0x341ada(0x1ba)])('id')),__metadata(a142_0x341ada(0x1bd),Function),__metadata(a142_0x341ada(0x191),[String]),__metadata(a142_0x341ada(0x1a3),void 0x0)],TextToAudioController[a142_0x341ada(0x1bc)],a142_0x341ada(0x1a5),null),__decorate([(0x0,common_1[a142_0x341ada(0x1cc)])(a142_0x341ada(0x1a2)),(0x0,common_1[a142_0x341ada(0x1af)])(jwt_guard_1[a142_0x341ada(0x1b6)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x341ada(0x1ab)]['Admin'],role_enum_1[a142_0x341ada(0x1ab)][a142_0x341ada(0x19d)]),__param(0x0,(0x0,common_1[a142_0x341ada(0x1ba)])('id')),__param(0x1,(0x0,common_1[a142_0x341ada(0x1b4)])()),__metadata(a142_0x341ada(0x1bd),Function),__metadata(a142_0x341ada(0x191),[String,text_dto_1[a142_0x341ada(0x1c5)]]),__metadata(a142_0x341ada(0x1a3),void 0x0)],TextToAudioController['prototype'],'updateTextMessage',null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a142_0x341ada(0x1b0)),__metadata(a142_0x341ada(0x191),[text_to_audio_service_1[a142_0x341ada(0x19b)],streaming_service_1[a142_0x341ada(0x1a1)]])],TextToAudioController),exports[a142_0x341ada(0x197)]=TextToAudioController;