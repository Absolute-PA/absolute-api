'use strict';const a145_0x519aee=a145_0x8401;(function(_0x4b37d2,_0x575629){const _0x31d76d=a145_0x8401,_0x31c086=_0x4b37d2();while(!![]){try{const _0x19546b=parseInt(_0x31d76d(0x18f))/0x1+-parseInt(_0x31d76d(0x1d9))/0x2*(parseInt(_0x31d76d(0x1a4))/0x3)+parseInt(_0x31d76d(0x1bf))/0x4*(-parseInt(_0x31d76d(0x1db))/0x5)+parseInt(_0x31d76d(0x1d0))/0x6+parseInt(_0x31d76d(0x1aa))/0x7+-parseInt(_0x31d76d(0x1d3))/0x8+-parseInt(_0x31d76d(0x19d))/0x9;if(_0x19546b===_0x575629)break;else _0x31c086['push'](_0x31c086['shift']());}catch(_0x1c4dff){_0x31c086['push'](_0x31c086['shift']());}}}(a145_0x3ee9,0xee57b));var __decorate=this&&this[a145_0x519aee(0x1dc)]||function(_0x2bdb11,_0x28a105,_0x437ccc,_0x36f0bf){const _0x33f084=a145_0x519aee;var _0x54f20a=arguments[_0x33f084(0x1ce)],_0x4ad474=_0x54f20a<0x3?_0x28a105:_0x36f0bf===null?_0x36f0bf=Object['getOwnPropertyDescriptor'](_0x28a105,_0x437ccc):_0x36f0bf,_0x19aea8;if(typeof Reflect==='object'&&typeof Reflect[_0x33f084(0x1a9)]==='function')_0x4ad474=Reflect[_0x33f084(0x1a9)](_0x2bdb11,_0x28a105,_0x437ccc,_0x36f0bf);else{for(var _0x19714c=_0x2bdb11[_0x33f084(0x1ce)]-0x1;_0x19714c>=0x0;_0x19714c--)if(_0x19aea8=_0x2bdb11[_0x19714c])_0x4ad474=(_0x54f20a<0x3?_0x19aea8(_0x4ad474):_0x54f20a>0x3?_0x19aea8(_0x28a105,_0x437ccc,_0x4ad474):_0x19aea8(_0x28a105,_0x437ccc))||_0x4ad474;}return _0x54f20a>0x3&&_0x4ad474&&Object[_0x33f084(0x1c9)](_0x28a105,_0x437ccc,_0x4ad474),_0x4ad474;},__metadata=this&&this[a145_0x519aee(0x1c2)]||function(_0x31051a,_0x31cd44){const _0x2df959=a145_0x519aee;if(typeof Reflect===_0x2df959(0x1a0)&&typeof Reflect['metadata']===_0x2df959(0x193))return Reflect['metadata'](_0x31051a,_0x31cd44);},__param=this&&this[a145_0x519aee(0x1b1)]||function(_0x3d0b0c,_0x39039f){return function(_0x3c1507,_0x1825ae){_0x39039f(_0x3c1507,_0x1825ae,_0x3d0b0c);};},TextToAudioController_1;Object['defineProperty'](exports,a145_0x519aee(0x1be),{'value':!![]}),exports[a145_0x519aee(0x19a)]=void 0x0;function a145_0x3ee9(){const _0x36401a=['Logger','error\x20','AUDIO_TO_MESSAGE_DIR','__param','play','Param','textToAudio','Success\x20save\x20text:\x20','../common/audio/audio-player','UseGuards','AudioPlayer','playAudioFile','send','path','Delete','Role','__esModule','22296VgKsbi','volume','TextDTO','__metadata','getMessages','There\x20is\x20no\x20message\x20to\x20play','JwtAuthGuard','textToAudioService','TextToAudioService','log','defineProperty','prototype','design:returntype','Roles','Get','length','../auth/guards/jwt.guard','10875906brlhcL','design:type','processRootPath','3870216KDEZdr','../common/path','@nestjs/common','isFileExist','streamingService','deleteTextMessage','3590PsuRiL','saveStreamToFile','60IwEetZ','__decorate','../streaming/streaming.service','1395261qroQvO','./text-to-audio.service','Res','Post','function','/message','.wav','saveMessage','design:paramtypes','updateTextMessage','/:id','TextToAudioController','Success\x20play\x20text\x20to\x20audio:\x20','error','19182114Bcmjaj','../common/constants','name','object','logger','Put','RolesGuard','336tLelvA','Body','getAllMessage','../auth/enums/role.enum','Admin','decorate','4559730sGwWsC','User','assign','text'];a145_0x3ee9=function(){return _0x36401a;};return a145_0x3ee9();}const common_1=require(a145_0x519aee(0x1d5)),text_to_audio_service_1=require(a145_0x519aee(0x190)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a145_0x519aee(0x18e)),roles_decorator_1=require('../auth/decorators/roles.decorator'),role_enum_1=require(a145_0x519aee(0x1a7)),jwt_guard_1=require(a145_0x519aee(0x1cf)),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require('./saveStreamToFile'),path=require(a145_0x519aee(0x1bb)),path_1=require(a145_0x519aee(0x1d4)),constants_1=require(a145_0x519aee(0x19e)),file_1=require('../common/file'),audio_player_1=require(a145_0x519aee(0x1b6));function a145_0x8401(_0x399a77,_0x1224b3){const _0x3ee928=a145_0x3ee9();return a145_0x8401=function(_0x840151,_0xaaa891){_0x840151=_0x840151-0x18e;let _0x2046f5=_0x3ee928[_0x840151];return _0x2046f5;},a145_0x8401(_0x399a77,_0x1224b3);}let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x523e00,_0x37c1dd){const _0x5e6621=a145_0x519aee;this[_0x5e6621(0x1c6)]=_0x523e00,this[_0x5e6621(0x1d7)]=_0x37c1dd,this[_0x5e6621(0x1a1)]=new common_1[(_0x5e6621(0x1ae))](TextToAudioController_1[_0x5e6621(0x19f)]);}async[a145_0x519aee(0x1b9)](_0x49c74c,_0x2d5a09){const _0x4f5002=a145_0x519aee;try{const _0x166fdc=_0x2d5a09['text'];if(!_0x166fdc){_0x49c74c[_0x4f5002(0x1ba)](_0x4f5002(0x1c4));return;}const {id:_0x2fc00f,volume:_0x22ffd8}=await this[_0x4f5002(0x1c6)]['saveMessage'](_0x166fdc);!(0x0,file_1[_0x4f5002(0x1d6)])(constants_1[_0x4f5002(0x1b0)])&&(0x0,file_1['createFolder'])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x1208c8=path['join'](path_1[_0x4f5002(0x1d2)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x1a3203=_0x1208c8+'/'+_0x2fc00f+_0x4f5002(0x195);!(0x0,file_1[_0x4f5002(0x1d6)])(_0x1a3203)?await this['textToAudioService']['textToAudio'](_0x2d5a09[_0x4f5002(0x1ad)],async _0x5085c1=>{const _0x128967=_0x4f5002;await(0x0,saveStreamToFile_1[_0x128967(0x1da)])(_0x5085c1,_0x1208c8+'/'+_0x2fc00f+_0x128967(0x195)),audio_player_1[_0x128967(0x1b8)][_0x128967(0x1b2)](_0x1a3203,_0x22ffd8!==null&&_0x22ffd8!==void 0x0?_0x22ffd8:0x32);}):audio_player_1[_0x4f5002(0x1b8)][_0x4f5002(0x1b2)](_0x1a3203,_0x22ffd8!==null&&_0x22ffd8!==void 0x0?_0x22ffd8:0x32),_0x49c74c[_0x4f5002(0x1ba)](_0x4f5002(0x19b)+_0x2d5a09['text']);}catch(_0x349143){return this[_0x4f5002(0x1a1)][_0x4f5002(0x1c8)](_0x349143,_0x4f5002(0x19c)),'';}}async[a145_0x519aee(0x196)](_0x50b743,_0x4cf031){const _0x249d24=a145_0x519aee;try{const _0x54cfb9=_0x4cf031[_0x249d24(0x1ad)];if(!_0x54cfb9){_0x50b743[_0x249d24(0x1ba)](_0x249d24(0x1c4));return;}await this[_0x249d24(0x1c6)][_0x249d24(0x196)](_0x54cfb9),_0x50b743['send'](_0x249d24(0x1b5)+_0x4cf031[_0x249d24(0x1ad)]);}catch(_0x43c116){return this[_0x249d24(0x1a1)][_0x249d24(0x1c8)](_0x43c116,_0x249d24(0x1af)),'';}}async[a145_0x519aee(0x1a6)](){const _0x503cbb=a145_0x519aee;try{const _0x42eb62=await this['textToAudioService'][_0x503cbb(0x1c3)]();return _0x42eb62!==null&&_0x42eb62!==void 0x0?_0x42eb62:[];}catch(_0x3e5c99){return this[_0x503cbb(0x1a1)][_0x503cbb(0x1c8)](_0x3e5c99,'error'),'';}}[a145_0x519aee(0x1d8)](_0x30cccd){const _0x159653=a145_0x519aee;return this[_0x159653(0x1c6)][_0x159653(0x1d8)](_0x30cccd);}['updateTextMessage'](_0x4aeb8d,_0xa655af){const _0x1a0a3b=a145_0x519aee;var _0x1162c1;return this[_0x1a0a3b(0x1c6)][_0x1a0a3b(0x198)](_0x4aeb8d,Object[_0x1a0a3b(0x1ac)](Object[_0x1a0a3b(0x1ac)]({},_0xa655af),{'volume':(_0x1162c1=_0xa655af[_0x1a0a3b(0x1c0)])!==null&&_0x1162c1!==void 0x0?_0x1162c1:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a145_0x519aee(0x1b7)])(jwt_guard_1[a145_0x519aee(0x1c5)],roles_guard_1[a145_0x519aee(0x1a3)]),(0x0,roles_decorator_1[a145_0x519aee(0x1cc)])(role_enum_1['Role'][a145_0x519aee(0x1a8)],role_enum_1[a145_0x519aee(0x1bd)][a145_0x519aee(0x1ab)]),__param(0x0,(0x0,common_1[a145_0x519aee(0x191)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(a145_0x519aee(0x197),[Object,text_dto_1['TextDTO']]),__metadata(a145_0x519aee(0x1cb),Promise)],TextToAudioController[a145_0x519aee(0x1ca)],'playAudioFile',null),__decorate([(0x0,common_1[a145_0x519aee(0x192)])(a145_0x519aee(0x196)),(0x0,common_1[a145_0x519aee(0x1b7)])(jwt_guard_1[a145_0x519aee(0x1c5)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0x519aee(0x1cc)])(role_enum_1[a145_0x519aee(0x1bd)]['Admin'],role_enum_1[a145_0x519aee(0x1bd)][a145_0x519aee(0x1ab)]),__param(0x0,(0x0,common_1[a145_0x519aee(0x191)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0x519aee(0x1a5)])()),__metadata(a145_0x519aee(0x1d1),Function),__metadata(a145_0x519aee(0x197),[Object,text_dto_1['TextDTO']]),__metadata(a145_0x519aee(0x1cb),Promise)],TextToAudioController['prototype'],a145_0x519aee(0x196),null),__decorate([(0x0,common_1[a145_0x519aee(0x1cd)])(a145_0x519aee(0x194)),(0x0,common_1[a145_0x519aee(0x1b7)])(jwt_guard_1[a145_0x519aee(0x1c5)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x519aee(0x1bd)]['Admin'],role_enum_1[a145_0x519aee(0x1bd)]['User']),__metadata('design:type',Function),__metadata(a145_0x519aee(0x197),[]),__metadata(a145_0x519aee(0x1cb),Promise)],TextToAudioController[a145_0x519aee(0x1ca)],a145_0x519aee(0x1a6),null),__decorate([(0x0,common_1[a145_0x519aee(0x1bc)])(a145_0x519aee(0x199)),(0x0,common_1[a145_0x519aee(0x1b7)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a145_0x519aee(0x1a3)]),(0x0,roles_decorator_1[a145_0x519aee(0x1cc)])(role_enum_1[a145_0x519aee(0x1bd)][a145_0x519aee(0x1a8)],role_enum_1[a145_0x519aee(0x1bd)][a145_0x519aee(0x1ab)]),__param(0x0,(0x0,common_1[a145_0x519aee(0x1b3)])('id')),__metadata('design:type',Function),__metadata(a145_0x519aee(0x197),[String]),__metadata(a145_0x519aee(0x1cb),void 0x0)],TextToAudioController[a145_0x519aee(0x1ca)],a145_0x519aee(0x1d8),null),__decorate([(0x0,common_1[a145_0x519aee(0x1a2)])(a145_0x519aee(0x199)),(0x0,common_1[a145_0x519aee(0x1b7)])(jwt_guard_1[a145_0x519aee(0x1c5)],roles_guard_1[a145_0x519aee(0x1a3)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a145_0x519aee(0x1bd)][a145_0x519aee(0x1a8)],role_enum_1[a145_0x519aee(0x1bd)][a145_0x519aee(0x1ab)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0x519aee(0x1d1),Function),__metadata(a145_0x519aee(0x197),[String,text_dto_1[a145_0x519aee(0x1c1)]]),__metadata('design:returntype',void 0x0)],TextToAudioController['prototype'],a145_0x519aee(0x198),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a145_0x519aee(0x1b4)),__metadata(a145_0x519aee(0x197),[text_to_audio_service_1[a145_0x519aee(0x1c7)],streaming_service_1['StreamingService']])],TextToAudioController),exports[a145_0x519aee(0x19a)]=TextToAudioController;