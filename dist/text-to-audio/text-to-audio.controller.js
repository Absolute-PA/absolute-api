'use strict';const a142_0x20973f=a142_0x2695;(function(_0x3b7600,_0x319a6f){const _0x5c2e8c=a142_0x2695,_0x217b2e=_0x3b7600();while(!![]){try{const _0x2724c0=-parseInt(_0x5c2e8c(0x19d))/0x1+-parseInt(_0x5c2e8c(0x1b1))/0x2+-parseInt(_0x5c2e8c(0x1bf))/0x3+-parseInt(_0x5c2e8c(0x1a5))/0x4*(-parseInt(_0x5c2e8c(0x1b6))/0x5)+parseInt(_0x5c2e8c(0x18a))/0x6*(parseInt(_0x5c2e8c(0x1c4))/0x7)+-parseInt(_0x5c2e8c(0x181))/0x8*(-parseInt(_0x5c2e8c(0x1c9))/0x9)+-parseInt(_0x5c2e8c(0x1c5))/0xa*(parseInt(_0x5c2e8c(0x1ae))/0xb);if(_0x2724c0===_0x319a6f)break;else _0x217b2e['push'](_0x217b2e['shift']());}catch(_0x580bbd){_0x217b2e['push'](_0x217b2e['shift']());}}}(a142_0x3724,0x71b77));function a142_0x2695(_0x37f73b,_0x41c7c6){const _0x372436=a142_0x3724();return a142_0x2695=function(_0x269526,_0x378b75){_0x269526=_0x269526-0x179;let _0x2410f1=_0x372436[_0x269526];return _0x2410f1;},a142_0x2695(_0x37f73b,_0x41c7c6);}function a142_0x3724(){const _0x40d743=['join','logger','error','length','saveMessage','Admin','JwtAuthGuard','Res','processRootPath','design:returntype','volume','TextDTO','decorate','Role','prototype','139696TwxVxv','Post','text','Roles','./saveStreamToFile','design:paramtypes','Controller','Body','8mfsPDn','Put','isFileExist','defineProperty','@nestjs/common','There\x20is\x20no\x20message\x20to\x20play','./dtos/text.dto','Success\x20save\x20text:\x20','../auth/decorators/roles.decorator','11QLUspU','User','textToAudioService','1658360fSZtEn','getOwnPropertyDescriptor','deleteTextMessage','error\x20','AudioPlayer','1653975ORYBTO','UseGuards','log','__metadata','Param','name','../streaming/streaming.service','playAudioFile','/:id','1204338WHFvPQ','.wav','__esModule','streamingService','updateTextMessage','7xtIeBu','4650210gkRVNi','textToAudio','createFolder','Success\x20play\x20text\x20to\x20audio:\x20','261UUujUn','../common/audio/audio-player','object','assign','getAllMessage','AUDIO_TO_MESSAGE_DIR','Delete','design:type','function','StreamingService','../common/constants','../common/file','244472jjpBxI','play','/message','../auth/guards/jwt.guard','./text-to-audio.service','../auth/enums/role.enum','RolesGuard','__param','TextToAudioService','4519950iClASk','metadata','send','Get'];a142_0x3724=function(){return _0x40d743;};return a142_0x3724();}var __decorate=this&&this['__decorate']||function(_0x2968ea,_0x1447b6,_0x4af2e2,_0x2ed85c){const _0x930c3d=a142_0x2695;var _0x1fde7b=arguments[_0x930c3d(0x191)],_0x4ca1e2=_0x1fde7b<0x3?_0x1447b6:_0x2ed85c===null?_0x2ed85c=Object[_0x930c3d(0x1b2)](_0x1447b6,_0x4af2e2):_0x2ed85c,_0x229f43;if(typeof Reflect==='object'&&typeof Reflect[_0x930c3d(0x19a)]==='function')_0x4ca1e2=Reflect[_0x930c3d(0x19a)](_0x2968ea,_0x1447b6,_0x4af2e2,_0x2ed85c);else{for(var _0x293614=_0x2968ea[_0x930c3d(0x191)]-0x1;_0x293614>=0x0;_0x293614--)if(_0x229f43=_0x2968ea[_0x293614])_0x4ca1e2=(_0x1fde7b<0x3?_0x229f43(_0x4ca1e2):_0x1fde7b>0x3?_0x229f43(_0x1447b6,_0x4af2e2,_0x4ca1e2):_0x229f43(_0x1447b6,_0x4af2e2))||_0x4ca1e2;}return _0x1fde7b>0x3&&_0x4ca1e2&&Object['defineProperty'](_0x1447b6,_0x4af2e2,_0x4ca1e2),_0x4ca1e2;},__metadata=this&&this[a142_0x20973f(0x1b9)]||function(_0x3f0541,_0xa119d1){const _0x5039ef=a142_0x20973f;if(typeof Reflect===_0x5039ef(0x1cb)&&typeof Reflect[_0x5039ef(0x18b)]===_0x5039ef(0x17d))return Reflect['metadata'](_0x3f0541,_0xa119d1);},__param=this&&this[a142_0x20973f(0x188)]||function(_0x309e90,_0x12eaf2){return function(_0x594f09,_0x315c6d){_0x12eaf2(_0x594f09,_0x315c6d,_0x309e90);};},TextToAudioController_1;Object[a142_0x20973f(0x1a8)](exports,a142_0x20973f(0x1c1),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require(a142_0x20973f(0x1a9)),text_to_audio_service_1=require(a142_0x20973f(0x185)),text_dto_1=require(a142_0x20973f(0x1ab)),streaming_service_1=require(a142_0x20973f(0x1bc)),roles_decorator_1=require(a142_0x20973f(0x1ad)),role_enum_1=require(a142_0x20973f(0x186)),jwt_guard_1=require(a142_0x20973f(0x184)),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require(a142_0x20973f(0x1a1)),path=require('path'),path_1=require('../common/path'),constants_1=require(a142_0x20973f(0x17f)),file_1=require(a142_0x20973f(0x180)),audio_player_1=require(a142_0x20973f(0x1ca));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x1daa40,_0x23f7cf){const _0x3b3f3e=a142_0x20973f;this[_0x3b3f3e(0x1b0)]=_0x1daa40,this[_0x3b3f3e(0x1c2)]=_0x23f7cf,this[_0x3b3f3e(0x18f)]=new common_1['Logger'](TextToAudioController_1[_0x3b3f3e(0x1bb)]);}async[a142_0x20973f(0x1bd)](_0x464ed8,_0x15016e){const _0x4c407c=a142_0x20973f;try{const _0xcdc115=_0x15016e[_0x4c407c(0x19f)];if(!_0xcdc115){_0x464ed8['send'](_0x4c407c(0x1aa));return;}const {id:_0x27d9c4,volume:_0x360f1e}=await this['textToAudioService'][_0x4c407c(0x192)](_0xcdc115);!(0x0,file_1['isFileExist'])(constants_1[_0x4c407c(0x17a)])&&(0x0,file_1[_0x4c407c(0x1c7)])(constants_1['AUDIO_TO_MESSAGE_DIR']);const _0x57c22a=path[_0x4c407c(0x18e)](path_1[_0x4c407c(0x196)],constants_1['AUDIO_TO_MESSAGE_DIR']),_0x2ac195=_0x57c22a+'/'+_0x27d9c4+_0x4c407c(0x1c0);!(0x0,file_1[_0x4c407c(0x1a7)])(_0x2ac195)?await this['textToAudioService'][_0x4c407c(0x1c6)](_0x15016e[_0x4c407c(0x19f)],async _0x4ccf96=>{const _0x2f6aae=_0x4c407c;await(0x0,saveStreamToFile_1['saveStreamToFile'])(_0x4ccf96,_0x57c22a+'/'+_0x27d9c4+_0x2f6aae(0x1c0)),audio_player_1[_0x2f6aae(0x1b5)]['play'](_0x2ac195,_0x360f1e!==null&&_0x360f1e!==void 0x0?_0x360f1e:0x32);}):audio_player_1[_0x4c407c(0x1b5)][_0x4c407c(0x182)](_0x2ac195,_0x360f1e!==null&&_0x360f1e!==void 0x0?_0x360f1e:0x32),_0x464ed8[_0x4c407c(0x18c)](_0x4c407c(0x1c8)+_0x15016e[_0x4c407c(0x19f)]);}catch(_0x5bfd56){return this[_0x4c407c(0x18f)][_0x4c407c(0x1b8)](_0x5bfd56,_0x4c407c(0x190)),'';}}async[a142_0x20973f(0x192)](_0x4edd16,_0x552e20){const _0x31bff3=a142_0x20973f;try{const _0x2b6a92=_0x552e20['text'];if(!_0x2b6a92){_0x4edd16[_0x31bff3(0x18c)](_0x31bff3(0x1aa));return;}await this[_0x31bff3(0x1b0)]['saveMessage'](_0x2b6a92),_0x4edd16[_0x31bff3(0x18c)](_0x31bff3(0x1ac)+_0x552e20[_0x31bff3(0x19f)]);}catch(_0xc8754e){return this['logger'][_0x31bff3(0x1b8)](_0xc8754e,_0x31bff3(0x1b4)),'';}}async[a142_0x20973f(0x179)](){const _0x7919fa=a142_0x20973f;try{const _0xcb7fdf=await this[_0x7919fa(0x1b0)]['getMessages']();return _0xcb7fdf!==null&&_0xcb7fdf!==void 0x0?_0xcb7fdf:[];}catch(_0x26495a){return this[_0x7919fa(0x18f)][_0x7919fa(0x1b8)](_0x26495a,_0x7919fa(0x190)),'';}}[a142_0x20973f(0x1b3)](_0xb9b2c3){const _0x4ae1ec=a142_0x20973f;return this[_0x4ae1ec(0x1b0)][_0x4ae1ec(0x1b3)](_0xb9b2c3);}[a142_0x20973f(0x1c3)](_0x57fb7f,_0x34efdd){const _0x256773=a142_0x20973f;var _0x457e8a;return this['textToAudioService'][_0x256773(0x1c3)](_0x57fb7f,Object[_0x256773(0x1cc)](Object[_0x256773(0x1cc)]({},_0x34efdd),{'volume':(_0x457e8a=_0x34efdd[_0x256773(0x198)])!==null&&_0x457e8a!==void 0x0?_0x457e8a:0x32}));}};__decorate([(0x0,common_1[a142_0x20973f(0x19e)])('/'),(0x0,common_1[a142_0x20973f(0x1b7)])(jwt_guard_1[a142_0x20973f(0x194)],roles_guard_1[a142_0x20973f(0x187)]),(0x0,roles_decorator_1[a142_0x20973f(0x1a0)])(role_enum_1['Role'][a142_0x20973f(0x193)],role_enum_1['Role'][a142_0x20973f(0x1af)]),__param(0x0,(0x0,common_1[a142_0x20973f(0x195)])({'passthrough':!![]})),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(a142_0x20973f(0x1a2),[Object,text_dto_1['TextDTO']]),__metadata(a142_0x20973f(0x197),Promise)],TextToAudioController[a142_0x20973f(0x19c)],a142_0x20973f(0x1bd),null),__decorate([(0x0,common_1[a142_0x20973f(0x19e)])('saveMessage'),(0x0,common_1['UseGuards'])(jwt_guard_1['JwtAuthGuard'],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x20973f(0x1a0)])(role_enum_1['Role'][a142_0x20973f(0x193)],role_enum_1[a142_0x20973f(0x19b)]['User']),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x20973f(0x1a4)])()),__metadata(a142_0x20973f(0x17c),Function),__metadata(a142_0x20973f(0x1a2),[Object,text_dto_1[a142_0x20973f(0x199)]]),__metadata(a142_0x20973f(0x197),Promise)],TextToAudioController[a142_0x20973f(0x19c)],'saveMessage',null),__decorate([(0x0,common_1[a142_0x20973f(0x18d)])(a142_0x20973f(0x183)),(0x0,common_1[a142_0x20973f(0x1b7)])(jwt_guard_1[a142_0x20973f(0x194)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x20973f(0x1a0)])(role_enum_1[a142_0x20973f(0x19b)][a142_0x20973f(0x193)],role_enum_1[a142_0x20973f(0x19b)][a142_0x20973f(0x1af)]),__metadata(a142_0x20973f(0x17c),Function),__metadata('design:paramtypes',[]),__metadata(a142_0x20973f(0x197),Promise)],TextToAudioController[a142_0x20973f(0x19c)],a142_0x20973f(0x179),null),__decorate([(0x0,common_1[a142_0x20973f(0x17b)])(a142_0x20973f(0x1be)),(0x0,common_1[a142_0x20973f(0x1b7)])(jwt_guard_1[a142_0x20973f(0x194)],roles_guard_1[a142_0x20973f(0x187)]),(0x0,roles_decorator_1['Roles'])(role_enum_1['Role'][a142_0x20973f(0x193)],role_enum_1[a142_0x20973f(0x19b)][a142_0x20973f(0x1af)]),__param(0x0,(0x0,common_1[a142_0x20973f(0x1ba)])('id')),__metadata(a142_0x20973f(0x17c),Function),__metadata(a142_0x20973f(0x1a2),[String]),__metadata(a142_0x20973f(0x197),void 0x0)],TextToAudioController[a142_0x20973f(0x19c)],a142_0x20973f(0x1b3),null),__decorate([(0x0,common_1[a142_0x20973f(0x1a6)])(a142_0x20973f(0x1be)),(0x0,common_1['UseGuards'])(jwt_guard_1[a142_0x20973f(0x194)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a142_0x20973f(0x1a0)])(role_enum_1[a142_0x20973f(0x19b)][a142_0x20973f(0x193)],role_enum_1[a142_0x20973f(0x19b)][a142_0x20973f(0x1af)]),__param(0x0,(0x0,common_1[a142_0x20973f(0x1ba)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x20973f(0x17c),Function),__metadata(a142_0x20973f(0x1a2),[String,text_dto_1['TextDTO']]),__metadata(a142_0x20973f(0x197),void 0x0)],TextToAudioController[a142_0x20973f(0x19c)],a142_0x20973f(0x1c3),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x20973f(0x1a3)])(a142_0x20973f(0x1c6)),__metadata(a142_0x20973f(0x1a2),[text_to_audio_service_1[a142_0x20973f(0x189)],streaming_service_1[a142_0x20973f(0x17e)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;