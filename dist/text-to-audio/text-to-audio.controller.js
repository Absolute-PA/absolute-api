'use strict';function a142_0x46e2(){const _0x1e364e=['JwtAuthGuard','text','design:type','Body','Success\x20save\x20text:\x20','updateTextMessage','TextDTO','getAllMessage','85414Yhtsut','isFileExist','log','design:returntype','2587550nFiHRS','design:paramtypes','701898muykrA','3659805CyMRRm','AUDIO_TO_MESSAGE_DIR','saveMessage','../common/file','Param','StreamingService','@nestjs/common','AudioPlayer','path','There\x20is\x20no\x20message\x20to\x20play','Logger','4uVSnZP','../streaming/streaming.service','Success\x20play\x20text\x20to\x20audio:\x20','955368Nzgxjv','playAudioFile','saveStreamToFile','__esModule','UseGuards','play','Res','./saveStreamToFile','textToAudioService','332405kmReKV','textToAudio','User','defineProperty','length','processRootPath','__param','2ATgNrN','../auth/guards/jwt.guard','streamingService','../auth/enums/role.enum','../common/path','createFolder','.wav','name','../common/audio/audio-player','metadata','TextToAudioController','decorate','function','deleteTextMessage','send','RolesGuard','getOwnPropertyDescriptor','__decorate','volume','1279596QavVUb','Roles','../auth/decorators/roles.decorator','object','Get','logger','Role','../auth/guards/roles.guard','./dtos/text.dto','Put','Post','error','/message','assign','prototype','Admin'];a142_0x46e2=function(){return _0x1e364e;};return a142_0x46e2();}const a142_0x4a6a95=a142_0x46d9;(function(_0x4ad49e,_0x174a95){const _0xe41ce=a142_0x46d9,_0x22597=_0x4ad49e();while(!![]){try{const _0x495ebf=parseInt(_0xe41ce(0x97))/0x1*(parseInt(_0xe41ce(0xc2))/0x2)+parseInt(_0xe41ce(0xaa))/0x3+parseInt(_0xe41ce(0x84))/0x4*(parseInt(_0xe41ce(0x90))/0x5)+-parseInt(_0xe41ce(0x78))/0x6+parseInt(_0xe41ce(0xc6))/0x7+-parseInt(_0xe41ce(0x87))/0x8+-parseInt(_0xe41ce(0x79))/0x9;if(_0x495ebf===_0x174a95)break;else _0x22597['push'](_0x22597['shift']());}catch(_0x305b6b){_0x22597['push'](_0x22597['shift']());}}}(a142_0x46e2,0x4a784));var __decorate=this&&this[a142_0x4a6a95(0xa8)]||function(_0x48a2a1,_0x295bba,_0xf6b666,_0x389a75){const _0x29d085=a142_0x4a6a95;var _0x3356ef=arguments['length'],_0x17de19=_0x3356ef<0x3?_0x295bba:_0x389a75===null?_0x389a75=Object[_0x29d085(0xa7)](_0x295bba,_0xf6b666):_0x389a75,_0x49b751;if(typeof Reflect===_0x29d085(0xad)&&typeof Reflect[_0x29d085(0xa2)]===_0x29d085(0xa3))_0x17de19=Reflect[_0x29d085(0xa2)](_0x48a2a1,_0x295bba,_0xf6b666,_0x389a75);else{for(var _0x5a52d9=_0x48a2a1[_0x29d085(0x94)]-0x1;_0x5a52d9>=0x0;_0x5a52d9--)if(_0x49b751=_0x48a2a1[_0x5a52d9])_0x17de19=(_0x3356ef<0x3?_0x49b751(_0x17de19):_0x3356ef>0x3?_0x49b751(_0x295bba,_0xf6b666,_0x17de19):_0x49b751(_0x295bba,_0xf6b666))||_0x17de19;}return _0x3356ef>0x3&&_0x17de19&&Object[_0x29d085(0x93)](_0x295bba,_0xf6b666,_0x17de19),_0x17de19;},__metadata=this&&this['__metadata']||function(_0x47fe4f,_0x3cec4a){const _0x3e6b38=a142_0x4a6a95;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x3e6b38(0xa3))return Reflect[_0x3e6b38(0xa0)](_0x47fe4f,_0x3cec4a);},__param=this&&this[a142_0x4a6a95(0x96)]||function(_0x473ca7,_0x4652a8){return function(_0x36c5ec,_0x4f8c9e){_0x4652a8(_0x36c5ec,_0x4f8c9e,_0x473ca7);};},TextToAudioController_1;Object[a142_0x4a6a95(0x93)](exports,a142_0x4a6a95(0x8a),{'value':!![]}),exports[a142_0x4a6a95(0xa1)]=void 0x0;const common_1=require(a142_0x4a6a95(0x7f)),text_to_audio_service_1=require('./text-to-audio.service'),text_dto_1=require(a142_0x4a6a95(0xb2)),streaming_service_1=require(a142_0x4a6a95(0x85)),roles_decorator_1=require(a142_0x4a6a95(0xac)),role_enum_1=require(a142_0x4a6a95(0x9a)),jwt_guard_1=require(a142_0x4a6a95(0x98)),roles_guard_1=require(a142_0x4a6a95(0xb1)),saveStreamToFile_1=require(a142_0x4a6a95(0x8e)),path=require(a142_0x4a6a95(0x81)),path_1=require(a142_0x4a6a95(0x9b)),constants_1=require('../common/constants'),file_1=require(a142_0x4a6a95(0x7c)),audio_player_1=require(a142_0x4a6a95(0x9f));function a142_0x46d9(_0x15d814,_0x124d98){const _0x46e2bf=a142_0x46e2();return a142_0x46d9=function(_0x46d91f,_0x56aa49){_0x46d91f=_0x46d91f-0x78;let _0x1a7b8e=_0x46e2bf[_0x46d91f];return _0x1a7b8e;},a142_0x46d9(_0x15d814,_0x124d98);}let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x26314e,_0x2eb288){const _0x1cbbeb=a142_0x4a6a95;this[_0x1cbbeb(0x8f)]=_0x26314e,this[_0x1cbbeb(0x99)]=_0x2eb288,this[_0x1cbbeb(0xaf)]=new common_1[(_0x1cbbeb(0x83))](TextToAudioController_1[_0x1cbbeb(0x9e)]);}async[a142_0x4a6a95(0x88)](_0x260e26,_0x44ab85){const _0x428efc=a142_0x4a6a95;try{const _0x3a23b1=_0x44ab85[_0x428efc(0xbb)];if(!_0x3a23b1){_0x260e26[_0x428efc(0xa5)](_0x428efc(0x82));return;}const {id:_0xbdafc2,volume:_0x369ff7}=await this[_0x428efc(0x8f)][_0x428efc(0x7b)](_0x3a23b1);!(0x0,file_1[_0x428efc(0xc3)])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1[_0x428efc(0x9c)])(constants_1[_0x428efc(0x7a)]);const _0x58f1c2=path['join'](path_1[_0x428efc(0x95)],constants_1[_0x428efc(0x7a)]),_0x1d6d52=_0x58f1c2+'/'+_0xbdafc2+_0x428efc(0x9d);!(0x0,file_1[_0x428efc(0xc3)])(_0x1d6d52)?await this['textToAudioService'][_0x428efc(0x91)](_0x44ab85[_0x428efc(0xbb)],async _0x462cf0=>{const _0x587791=_0x428efc;await(0x0,saveStreamToFile_1[_0x587791(0x89)])(_0x462cf0,_0x58f1c2+'/'+_0xbdafc2+_0x587791(0x9d)),audio_player_1[_0x587791(0x80)][_0x587791(0x8c)](_0x1d6d52,_0x369ff7!==null&&_0x369ff7!==void 0x0?_0x369ff7:0x32);}):audio_player_1[_0x428efc(0x80)][_0x428efc(0x8c)](_0x1d6d52,_0x369ff7!==null&&_0x369ff7!==void 0x0?_0x369ff7:0x32),_0x260e26[_0x428efc(0xa5)](_0x428efc(0x86)+_0x44ab85['text']);}catch(_0x4e9bc0){return this[_0x428efc(0xaf)][_0x428efc(0xc4)](_0x4e9bc0,'error'),'';}}async[a142_0x4a6a95(0x7b)](_0xbf2c0c,_0x5e5dda){const _0x521896=a142_0x4a6a95;try{const _0xa5d3af=_0x5e5dda[_0x521896(0xbb)];if(!_0xa5d3af){_0xbf2c0c[_0x521896(0xa5)](_0x521896(0x82));return;}await this[_0x521896(0x8f)]['saveMessage'](_0xa5d3af),_0xbf2c0c['send'](_0x521896(0xbe)+_0x5e5dda['text']);}catch(_0x4ccdad){return this['logger'][_0x521896(0xc4)](_0x4ccdad,'error\x20'),'';}}async[a142_0x4a6a95(0xc1)](){const _0x286b9f=a142_0x4a6a95;try{const _0x3876dd=await this[_0x286b9f(0x8f)]['getMessages']();return _0x3876dd!==null&&_0x3876dd!==void 0x0?_0x3876dd:[];}catch(_0x13156d){return this['logger'][_0x286b9f(0xc4)](_0x13156d,_0x286b9f(0xb5)),'';}}['deleteTextMessage'](_0x3963be){return this['textToAudioService']['deleteTextMessage'](_0x3963be);}[a142_0x4a6a95(0xbf)](_0x8fd175,_0x39113a){const _0x31807d=a142_0x4a6a95;var _0x34ed89;return this[_0x31807d(0x8f)][_0x31807d(0xbf)](_0x8fd175,Object[_0x31807d(0xb7)](Object[_0x31807d(0xb7)]({},_0x39113a),{'volume':(_0x34ed89=_0x39113a[_0x31807d(0xa9)])!==null&&_0x34ed89!==void 0x0?_0x34ed89:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a142_0x4a6a95(0x8b)])(jwt_guard_1[a142_0x4a6a95(0xba)],roles_guard_1[a142_0x4a6a95(0xa6)]),(0x0,roles_decorator_1[a142_0x4a6a95(0xab)])(role_enum_1[a142_0x4a6a95(0xb0)]['Admin'],role_enum_1[a142_0x4a6a95(0xb0)][a142_0x4a6a95(0x92)]),__param(0x0,(0x0,common_1[a142_0x4a6a95(0x8d)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x4a6a95(0xbd)])()),__metadata(a142_0x4a6a95(0xbc),Function),__metadata(a142_0x4a6a95(0xc7),[Object,text_dto_1['TextDTO']]),__metadata(a142_0x4a6a95(0xc5),Promise)],TextToAudioController['prototype'],a142_0x4a6a95(0x88),null),__decorate([(0x0,common_1[a142_0x4a6a95(0xb4)])(a142_0x4a6a95(0x7b)),(0x0,common_1[a142_0x4a6a95(0x8b)])(jwt_guard_1[a142_0x4a6a95(0xba)],roles_guard_1[a142_0x4a6a95(0xa6)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x4a6a95(0xb0)][a142_0x4a6a95(0xb9)],role_enum_1[a142_0x4a6a95(0xb0)]['User']),__param(0x0,(0x0,common_1[a142_0x4a6a95(0x8d)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x4a6a95(0xbd)])()),__metadata(a142_0x4a6a95(0xbc),Function),__metadata(a142_0x4a6a95(0xc7),[Object,text_dto_1[a142_0x4a6a95(0xc0)]]),__metadata(a142_0x4a6a95(0xc5),Promise)],TextToAudioController[a142_0x4a6a95(0xb8)],a142_0x4a6a95(0x7b),null),__decorate([(0x0,common_1[a142_0x4a6a95(0xae)])(a142_0x4a6a95(0xb6)),(0x0,common_1[a142_0x4a6a95(0x8b)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x4a6a95(0xa6)]),(0x0,roles_decorator_1[a142_0x4a6a95(0xab)])(role_enum_1[a142_0x4a6a95(0xb0)]['Admin'],role_enum_1[a142_0x4a6a95(0xb0)][a142_0x4a6a95(0x92)]),__metadata(a142_0x4a6a95(0xbc),Function),__metadata(a142_0x4a6a95(0xc7),[]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x4a6a95(0xb8)],a142_0x4a6a95(0xc1),null),__decorate([(0x0,common_1['Delete'])('/:id'),(0x0,common_1[a142_0x4a6a95(0x8b)])(jwt_guard_1[a142_0x4a6a95(0xba)],roles_guard_1[a142_0x4a6a95(0xa6)]),(0x0,roles_decorator_1[a142_0x4a6a95(0xab)])(role_enum_1['Role'][a142_0x4a6a95(0xb9)],role_enum_1[a142_0x4a6a95(0xb0)][a142_0x4a6a95(0x92)]),__param(0x0,(0x0,common_1['Param'])('id')),__metadata(a142_0x4a6a95(0xbc),Function),__metadata(a142_0x4a6a95(0xc7),[String]),__metadata(a142_0x4a6a95(0xc5),void 0x0)],TextToAudioController[a142_0x4a6a95(0xb8)],a142_0x4a6a95(0xa4),null),__decorate([(0x0,common_1[a142_0x4a6a95(0xb3)])('/:id'),(0x0,common_1[a142_0x4a6a95(0x8b)])(jwt_guard_1[a142_0x4a6a95(0xba)],roles_guard_1[a142_0x4a6a95(0xa6)]),(0x0,roles_decorator_1[a142_0x4a6a95(0xab)])(role_enum_1[a142_0x4a6a95(0xb0)][a142_0x4a6a95(0xb9)],role_enum_1['Role']['User']),__param(0x0,(0x0,common_1[a142_0x4a6a95(0x7d)])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a142_0x4a6a95(0xbc),Function),__metadata('design:paramtypes',[String,text_dto_1[a142_0x4a6a95(0xc0)]]),__metadata(a142_0x4a6a95(0xc5),void 0x0)],TextToAudioController['prototype'],a142_0x4a6a95(0xbf),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1['Controller'])(a142_0x4a6a95(0x91)),__metadata(a142_0x4a6a95(0xc7),[text_to_audio_service_1['TextToAudioService'],streaming_service_1[a142_0x4a6a95(0x7e)]])],TextToAudioController),exports[a142_0x4a6a95(0xa1)]=TextToAudioController;