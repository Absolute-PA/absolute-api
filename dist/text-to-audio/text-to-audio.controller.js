'use strict';const a142_0x491334=a142_0x327f;function a142_0x327f(_0x47dc75,_0x488d73){const _0x16e0f9=a142_0x16e0();return a142_0x327f=function(_0x327f11,_0x669a4e){_0x327f11=_0x327f11-0xaa;let _0x592664=_0x16e0f9[_0x327f11];return _0x592664;},a142_0x327f(_0x47dc75,_0x488d73);}(function(_0x1985a0,_0x368d20){const _0x504fcd=a142_0x327f,_0x297931=_0x1985a0();while(!![]){try{const _0x14b6e4=parseInt(_0x504fcd(0xbc))/0x1+-parseInt(_0x504fcd(0xdb))/0x2*(-parseInt(_0x504fcd(0xd8))/0x3)+-parseInt(_0x504fcd(0xee))/0x4*(parseInt(_0x504fcd(0xb3))/0x5)+parseInt(_0x504fcd(0xde))/0x6+parseInt(_0x504fcd(0xb9))/0x7+parseInt(_0x504fcd(0xd1))/0x8+-parseInt(_0x504fcd(0xb6))/0x9;if(_0x14b6e4===_0x368d20)break;else _0x297931['push'](_0x297931['shift']());}catch(_0x1ddd66){_0x297931['push'](_0x297931['shift']());}}}(a142_0x16e0,0xbb3f2));function a142_0x16e0(){const _0x255de9=['4205772RUYFeC','../common/path','/message','./saveStreamToFile','Role','play','log','design:returntype','design:type','createFolder','send','prototype','User','../auth/decorators/roles.decorator','length','TextDTO','2141060xaZMqY','design:paramtypes','assign','logger','./text-to-audio.service','../auth/guards/roles.guard','StreamingService','../auth/guards/jwt.guard','Param','isFileExist','AUDIO_TO_MESSAGE_DIR','saveMessage','../common/constants','.wav','10xoIuZn','Put','__esModule','15461109DodEoO','Body','deleteTextMessage','4283468mUgtDo','metadata','error','1054306nkFhPE','processRootPath','getOwnPropertyDescriptor','object','Success\x20play\x20text\x20to\x20audio:\x20','Get','saveStreamToFile','/:id','textToAudioService','../common/audio/audio-player','TextToAudioService','decorate','join','Controller','There\x20is\x20no\x20message\x20to\x20play','Admin','JwtAuthGuard','defineProperty','../streaming/streaming.service','function','updateTextMessage','5396072MSRgFN','textToAudio','AudioPlayer','RolesGuard','streamingService','playAudioFile','Roles','1002rZrmQK','../auth/enums/role.enum','text','3076GemRsO','Post','UseGuards'];a142_0x16e0=function(){return _0x255de9;};return a142_0x16e0();}var __decorate=this&&this['__decorate']||function(_0x571ce7,_0x1d25d0,_0x450b77,_0x14a344){const _0x2b1418=a142_0x327f;var _0x4147d5=arguments[_0x2b1418(0xec)],_0xfcdbec=_0x4147d5<0x3?_0x1d25d0:_0x14a344===null?_0x14a344=Object[_0x2b1418(0xbe)](_0x1d25d0,_0x450b77):_0x14a344,_0x3286f9;if(typeof Reflect===_0x2b1418(0xbf)&&typeof Reflect[_0x2b1418(0xc7)]===_0x2b1418(0xcf))_0xfcdbec=Reflect[_0x2b1418(0xc7)](_0x571ce7,_0x1d25d0,_0x450b77,_0x14a344);else{for(var _0x13ebff=_0x571ce7['length']-0x1;_0x13ebff>=0x0;_0x13ebff--)if(_0x3286f9=_0x571ce7[_0x13ebff])_0xfcdbec=(_0x4147d5<0x3?_0x3286f9(_0xfcdbec):_0x4147d5>0x3?_0x3286f9(_0x1d25d0,_0x450b77,_0xfcdbec):_0x3286f9(_0x1d25d0,_0x450b77))||_0xfcdbec;}return _0x4147d5>0x3&&_0xfcdbec&&Object['defineProperty'](_0x1d25d0,_0x450b77,_0xfcdbec),_0xfcdbec;},__metadata=this&&this['__metadata']||function(_0x2b67fa,_0x768d26){const _0x51cd91=a142_0x327f;if(typeof Reflect==='object'&&typeof Reflect[_0x51cd91(0xba)]==='function')return Reflect[_0x51cd91(0xba)](_0x2b67fa,_0x768d26);},__param=this&&this['__param']||function(_0x5a67d2,_0x1e3537){return function(_0xff0f5a,_0x49e218){_0x1e3537(_0xff0f5a,_0x49e218,_0x5a67d2);};},TextToAudioController_1;Object[a142_0x491334(0xcd)](exports,a142_0x491334(0xb5),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require('@nestjs/common'),text_to_audio_service_1=require(a142_0x491334(0xf2)),text_dto_1=require('./dtos/text.dto'),streaming_service_1=require(a142_0x491334(0xce)),roles_decorator_1=require(a142_0x491334(0xeb)),role_enum_1=require(a142_0x491334(0xd9)),jwt_guard_1=require(a142_0x491334(0xac)),roles_guard_1=require(a142_0x491334(0xaa)),saveStreamToFile_1=require(a142_0x491334(0xe1)),path=require('path'),path_1=require(a142_0x491334(0xdf)),constants_1=require(a142_0x491334(0xb1)),file_1=require('../common/file'),audio_player_1=require(a142_0x491334(0xc5));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x1d1ac6,_0x138355){const _0x3c449a=a142_0x491334;this['textToAudioService']=_0x1d1ac6,this[_0x3c449a(0xd5)]=_0x138355,this['logger']=new common_1['Logger'](TextToAudioController_1['name']);}async[a142_0x491334(0xd6)](_0x1b2bf5,_0x5d3c99){const _0x266c2b=a142_0x491334;try{const _0x5d23a9=_0x5d3c99[_0x266c2b(0xda)];if(!_0x5d23a9){_0x1b2bf5[_0x266c2b(0xe8)]('There\x20is\x20no\x20message\x20to\x20play');return;}const {id:_0xfef6d8,volume:_0xfa565}=await this['textToAudioService'][_0x266c2b(0xb0)](_0x5d23a9);!(0x0,file_1[_0x266c2b(0xae)])(constants_1['AUDIO_TO_MESSAGE_DIR'])&&(0x0,file_1[_0x266c2b(0xe7)])(constants_1[_0x266c2b(0xaf)]);const _0x4993f3=path[_0x266c2b(0xc8)](path_1[_0x266c2b(0xbd)],constants_1[_0x266c2b(0xaf)]),_0x58428f=_0x4993f3+'/'+_0xfef6d8+_0x266c2b(0xb2);!(0x0,file_1[_0x266c2b(0xae)])(_0x58428f)?await this['textToAudioService'][_0x266c2b(0xd2)](_0x5d3c99[_0x266c2b(0xda)],async _0x22d389=>{const _0x5b5f42=_0x266c2b;await(0x0,saveStreamToFile_1[_0x5b5f42(0xc2)])(_0x22d389,_0x4993f3+'/'+_0xfef6d8+_0x5b5f42(0xb2)),audio_player_1[_0x5b5f42(0xd3)][_0x5b5f42(0xe3)](_0x58428f,_0xfa565!==null&&_0xfa565!==void 0x0?_0xfa565:0x32);}):audio_player_1[_0x266c2b(0xd3)][_0x266c2b(0xe3)](_0x58428f,_0xfa565!==null&&_0xfa565!==void 0x0?_0xfa565:0x32),_0x1b2bf5[_0x266c2b(0xe8)](_0x266c2b(0xc0)+_0x5d3c99[_0x266c2b(0xda)]);}catch(_0x3c1e18){return this[_0x266c2b(0xf1)][_0x266c2b(0xe4)](_0x3c1e18,_0x266c2b(0xbb)),'';}}async[a142_0x491334(0xb0)](_0xc72ec1,_0x31becf){const _0x4e779e=a142_0x491334;try{const _0x25ab08=_0x31becf['text'];if(!_0x25ab08){_0xc72ec1[_0x4e779e(0xe8)](_0x4e779e(0xca));return;}await this[_0x4e779e(0xc4)][_0x4e779e(0xb0)](_0x25ab08),_0xc72ec1[_0x4e779e(0xe8)]('Success\x20save\x20text:\x20'+_0x31becf['text']);}catch(_0x179728){return this[_0x4e779e(0xf1)]['log'](_0x179728,'error\x20'),'';}}async['getAllMessage'](){const _0x422ce4=a142_0x491334;try{const _0x7d252f=await this[_0x422ce4(0xc4)]['getMessages']();return _0x7d252f!==null&&_0x7d252f!==void 0x0?_0x7d252f:[];}catch(_0x5ac5a7){return this[_0x422ce4(0xf1)][_0x422ce4(0xe4)](_0x5ac5a7,_0x422ce4(0xbb)),'';}}[a142_0x491334(0xb8)](_0xfa4c4d){const _0x598cf7=a142_0x491334;return this[_0x598cf7(0xc4)][_0x598cf7(0xb8)](_0xfa4c4d);}['updateTextMessage'](_0x3c2d63,_0x54a53d){const _0x1a54c0=a142_0x491334;var _0x435244;return this[_0x1a54c0(0xc4)][_0x1a54c0(0xd0)](_0x3c2d63,Object[_0x1a54c0(0xf0)](Object['assign']({},_0x54a53d),{'volume':(_0x435244=_0x54a53d['volume'])!==null&&_0x435244!==void 0x0?_0x435244:0x32}));}};__decorate([(0x0,common_1[a142_0x491334(0xdc)])('/'),(0x0,common_1[a142_0x491334(0xdd)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x491334(0xd4)]),(0x0,roles_decorator_1[a142_0x491334(0xd7)])(role_enum_1[a142_0x491334(0xe2)][a142_0x491334(0xcb)],role_enum_1[a142_0x491334(0xe2)][a142_0x491334(0xea)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x491334(0xb7)])()),__metadata(a142_0x491334(0xe6),Function),__metadata('design:paramtypes',[Object,text_dto_1[a142_0x491334(0xed)]]),__metadata(a142_0x491334(0xe5),Promise)],TextToAudioController[a142_0x491334(0xe9)],a142_0x491334(0xd6),null),__decorate([(0x0,common_1[a142_0x491334(0xdc)])(a142_0x491334(0xb0)),(0x0,common_1[a142_0x491334(0xdd)])(jwt_guard_1[a142_0x491334(0xcc)],roles_guard_1[a142_0x491334(0xd4)]),(0x0,roles_decorator_1[a142_0x491334(0xd7)])(role_enum_1[a142_0x491334(0xe2)]['Admin'],role_enum_1[a142_0x491334(0xe2)][a142_0x491334(0xea)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a142_0x491334(0xb7)])()),__metadata(a142_0x491334(0xe6),Function),__metadata(a142_0x491334(0xef),[Object,text_dto_1[a142_0x491334(0xed)]]),__metadata('design:returntype',Promise)],TextToAudioController[a142_0x491334(0xe9)],a142_0x491334(0xb0),null),__decorate([(0x0,common_1[a142_0x491334(0xc1)])(a142_0x491334(0xe0)),(0x0,common_1[a142_0x491334(0xdd)])(jwt_guard_1['JwtAuthGuard'],roles_guard_1[a142_0x491334(0xd4)]),(0x0,roles_decorator_1[a142_0x491334(0xd7)])(role_enum_1[a142_0x491334(0xe2)]['Admin'],role_enum_1[a142_0x491334(0xe2)][a142_0x491334(0xea)]),__metadata(a142_0x491334(0xe6),Function),__metadata('design:paramtypes',[]),__metadata(a142_0x491334(0xe5),Promise)],TextToAudioController[a142_0x491334(0xe9)],'getAllMessage',null),__decorate([(0x0,common_1['Delete'])('/:id'),(0x0,common_1[a142_0x491334(0xdd)])(jwt_guard_1[a142_0x491334(0xcc)],roles_guard_1[a142_0x491334(0xd4)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x491334(0xe2)][a142_0x491334(0xcb)],role_enum_1['Role'][a142_0x491334(0xea)]),__param(0x0,(0x0,common_1[a142_0x491334(0xad)])('id')),__metadata(a142_0x491334(0xe6),Function),__metadata(a142_0x491334(0xef),[String]),__metadata(a142_0x491334(0xe5),void 0x0)],TextToAudioController['prototype'],'deleteTextMessage',null),__decorate([(0x0,common_1[a142_0x491334(0xb4)])(a142_0x491334(0xc3)),(0x0,common_1[a142_0x491334(0xdd)])(jwt_guard_1[a142_0x491334(0xcc)],roles_guard_1[a142_0x491334(0xd4)]),(0x0,roles_decorator_1['Roles'])(role_enum_1[a142_0x491334(0xe2)]['Admin'],role_enum_1[a142_0x491334(0xe2)][a142_0x491334(0xea)]),__param(0x0,(0x0,common_1[a142_0x491334(0xad)])('id')),__param(0x1,(0x0,common_1[a142_0x491334(0xb7)])()),__metadata(a142_0x491334(0xe6),Function),__metadata(a142_0x491334(0xef),[String,text_dto_1[a142_0x491334(0xed)]]),__metadata(a142_0x491334(0xe5),void 0x0)],TextToAudioController[a142_0x491334(0xe9)],a142_0x491334(0xd0),null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a142_0x491334(0xc9)])(a142_0x491334(0xd2)),__metadata(a142_0x491334(0xef),[text_to_audio_service_1[a142_0x491334(0xc6)],streaming_service_1[a142_0x491334(0xab)]])],TextToAudioController),exports['TextToAudioController']=TextToAudioController;