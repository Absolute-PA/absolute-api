'use strict';const a145_0xb735da=a145_0x2ed7;function a145_0x273b(){const _0x50d76c=['Delete','log','1049714PbPIxV','Put','isFileExist','assign','saveMessage','processRootPath','13346608YrwrAs','856343ZbCkpK','../auth/decorators/roles.decorator','../auth/guards/jwt.guard','./text-to-audio.service','design:returntype','function','1953908HSRnCT','Controller','3281823ePVqJy','JwtAuthGuard','text','Admin','__param','There\x20is\x20no\x20message\x20to\x20play','TextDTO','updateTextMessage','Roles','@nestjs/common','../common/audio/audio-player','/:id','StreamingService','streamingService','6799790OAZEuU','saveStreamToFile','AUDIO_TO_MESSAGE_DIR','Role','play','./saveStreamToFile','RolesGuard','design:type','design:paramtypes','../common/constants','logger','../auth/enums/role.enum','TextToAudioService','textToAudio','textToAudioService','User','../common/file','send','TextToAudioController','Get','join','getAllMessage','Res','UseGuards','__metadata','.wav','error','getMessages','548556ZgDuzp','Post','__esModule','7TsPYco','getOwnPropertyDescriptor','Param','playAudioFile','Body','defineProperty','object','metadata','prototype','AudioPlayer','deleteTextMessage','./dtos/text.dto','length','/message','../common/path'];a145_0x273b=function(){return _0x50d76c;};return a145_0x273b();}function a145_0x2ed7(_0x3198c5,_0x21a5cc){const _0x273b5e=a145_0x273b();return a145_0x2ed7=function(_0x2ed76c,_0x3ae19e){_0x2ed76c=_0x2ed76c-0x1ad;let _0x5b1304=_0x273b5e[_0x2ed76c];return _0x5b1304;},a145_0x2ed7(_0x3198c5,_0x21a5cc);}(function(_0x4a520a,_0x35b22f){const _0x21547e=a145_0x2ed7,_0x3ecff3=_0x4a520a();while(!![]){try{const _0x140932=parseInt(_0x21547e(0x1dd))/0x1+-parseInt(_0x21547e(0x1d6))/0x2+parseInt(_0x21547e(0x1e5))/0x3+-parseInt(_0x21547e(0x1e3))/0x4+parseInt(_0x21547e(0x1f3))/0x5+parseInt(_0x21547e(0x1c2))/0x6+parseInt(_0x21547e(0x1c5))/0x7*(-parseInt(_0x21547e(0x1dc))/0x8);if(_0x140932===_0x35b22f)break;else _0x3ecff3['push'](_0x3ecff3['shift']());}catch(_0x47aa1f){_0x3ecff3['push'](_0x3ecff3['shift']());}}}(a145_0x273b,0xafc88));var __decorate=this&&this['__decorate']||function(_0x4b348e,_0x4bbe52,_0x48e963,_0x2fe41f){const _0x307314=a145_0x2ed7;var _0x457420=arguments[_0x307314(0x1d1)],_0x3b13db=_0x457420<0x3?_0x4bbe52:_0x2fe41f===null?_0x2fe41f=Object[_0x307314(0x1c6)](_0x4bbe52,_0x48e963):_0x2fe41f,_0x5d49c3;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x307314(0x1e2))_0x3b13db=Reflect['decorate'](_0x4b348e,_0x4bbe52,_0x48e963,_0x2fe41f);else{for(var _0x1544f6=_0x4b348e[_0x307314(0x1d1)]-0x1;_0x1544f6>=0x0;_0x1544f6--)if(_0x5d49c3=_0x4b348e[_0x1544f6])_0x3b13db=(_0x457420<0x3?_0x5d49c3(_0x3b13db):_0x457420>0x3?_0x5d49c3(_0x4bbe52,_0x48e963,_0x3b13db):_0x5d49c3(_0x4bbe52,_0x48e963))||_0x3b13db;}return _0x457420>0x3&&_0x3b13db&&Object[_0x307314(0x1ca)](_0x4bbe52,_0x48e963,_0x3b13db),_0x3b13db;},__metadata=this&&this[a145_0xb735da(0x1be)]||function(_0x5434bc,_0x21831c){const _0x5e1d71=a145_0xb735da;if(typeof Reflect===_0x5e1d71(0x1cb)&&typeof Reflect[_0x5e1d71(0x1cc)]===_0x5e1d71(0x1e2))return Reflect[_0x5e1d71(0x1cc)](_0x5434bc,_0x21831c);},__param=this&&this[a145_0xb735da(0x1e9)]||function(_0xdd3dd5,_0x224bca){return function(_0x5bde60,_0x4641b7){_0x224bca(_0x5bde60,_0x4641b7,_0xdd3dd5);};},TextToAudioController_1;Object['defineProperty'](exports,a145_0xb735da(0x1c4),{'value':!![]}),exports['TextToAudioController']=void 0x0;const common_1=require(a145_0xb735da(0x1ee)),text_to_audio_service_1=require(a145_0xb735da(0x1e0)),text_dto_1=require(a145_0xb735da(0x1d0)),streaming_service_1=require('../streaming/streaming.service'),roles_decorator_1=require(a145_0xb735da(0x1de)),role_enum_1=require(a145_0xb735da(0x1b1)),jwt_guard_1=require(a145_0xb735da(0x1df)),roles_guard_1=require('../auth/guards/roles.guard'),saveStreamToFile_1=require(a145_0xb735da(0x1f8)),path=require('path'),path_1=require(a145_0xb735da(0x1d3)),constants_1=require(a145_0xb735da(0x1af)),file_1=require(a145_0xb735da(0x1b6)),audio_player_1=require(a145_0xb735da(0x1ef));let TextToAudioController=TextToAudioController_1=class TextToAudioController{constructor(_0x42a05a,_0x294117){const _0x401bd2=a145_0xb735da;this[_0x401bd2(0x1b4)]=_0x42a05a,this[_0x401bd2(0x1f2)]=_0x294117,this['logger']=new common_1['Logger'](TextToAudioController_1['name']);}async['playAudioFile'](_0x21be4a,_0x484f41){const _0x3b4343=a145_0xb735da;try{const _0x238e65=_0x484f41[_0x3b4343(0x1e7)];if(!_0x238e65){_0x21be4a[_0x3b4343(0x1b7)](_0x3b4343(0x1ea));return;}const {id:_0xf43c68,volume:_0x373f54}=await this[_0x3b4343(0x1b4)][_0x3b4343(0x1da)](_0x238e65);!(0x0,file_1[_0x3b4343(0x1d8)])(constants_1[_0x3b4343(0x1f5)])&&(0x0,file_1['createFolder'])(constants_1[_0x3b4343(0x1f5)]);const _0x210dff=path[_0x3b4343(0x1ba)](path_1[_0x3b4343(0x1db)],constants_1[_0x3b4343(0x1f5)]),_0x3fd3f3=_0x210dff+'/'+_0xf43c68+_0x3b4343(0x1bf);!(0x0,file_1[_0x3b4343(0x1d8)])(_0x3fd3f3)?await this[_0x3b4343(0x1b4)][_0x3b4343(0x1b3)](_0x484f41[_0x3b4343(0x1e7)],async _0x31fc12=>{const _0x424bb1=_0x3b4343;await(0x0,saveStreamToFile_1[_0x424bb1(0x1f4)])(_0x31fc12,_0x210dff+'/'+_0xf43c68+'.wav'),audio_player_1[_0x424bb1(0x1ce)][_0x424bb1(0x1f7)](_0x3fd3f3,_0x373f54!==null&&_0x373f54!==void 0x0?_0x373f54:0x32);}):audio_player_1[_0x3b4343(0x1ce)][_0x3b4343(0x1f7)](_0x3fd3f3,_0x373f54!==null&&_0x373f54!==void 0x0?_0x373f54:0x32),_0x21be4a[_0x3b4343(0x1b7)]('Success\x20play\x20text\x20to\x20audio:\x20'+_0x484f41[_0x3b4343(0x1e7)]);}catch(_0x4f8266){return this[_0x3b4343(0x1b0)][_0x3b4343(0x1d5)](_0x4f8266,_0x3b4343(0x1c0)),'';}}async[a145_0xb735da(0x1da)](_0x4f0749,_0x3b7795){const _0x49c33b=a145_0xb735da;try{const _0x5cd7b6=_0x3b7795[_0x49c33b(0x1e7)];if(!_0x5cd7b6){_0x4f0749[_0x49c33b(0x1b7)](_0x49c33b(0x1ea));return;}await this['textToAudioService'][_0x49c33b(0x1da)](_0x5cd7b6),_0x4f0749['send']('Success\x20save\x20text:\x20'+_0x3b7795[_0x49c33b(0x1e7)]);}catch(_0x2b4ef2){return this[_0x49c33b(0x1b0)]['log'](_0x2b4ef2,'error\x20'),'';}}async[a145_0xb735da(0x1bb)](){const _0x1e8e58=a145_0xb735da;try{const _0x3e1b15=await this['textToAudioService'][_0x1e8e58(0x1c1)]();return _0x3e1b15!==null&&_0x3e1b15!==void 0x0?_0x3e1b15:[];}catch(_0x23ba26){return this[_0x1e8e58(0x1b0)][_0x1e8e58(0x1d5)](_0x23ba26,_0x1e8e58(0x1c0)),'';}}[a145_0xb735da(0x1cf)](_0x2f13a1){const _0x3314c2=a145_0xb735da;return this[_0x3314c2(0x1b4)][_0x3314c2(0x1cf)](_0x2f13a1);}[a145_0xb735da(0x1ec)](_0x3a4922,_0x2b836a){const _0x3850f7=a145_0xb735da;var _0x449501;return this[_0x3850f7(0x1b4)][_0x3850f7(0x1ec)](_0x3a4922,Object[_0x3850f7(0x1d9)](Object[_0x3850f7(0x1d9)]({},_0x2b836a),{'volume':(_0x449501=_0x2b836a['volume'])!==null&&_0x449501!==void 0x0?_0x449501:0x32}));}};__decorate([(0x0,common_1['Post'])('/'),(0x0,common_1[a145_0xb735da(0x1bd)])(jwt_guard_1[a145_0xb735da(0x1e6)],roles_guard_1['RolesGuard']),(0x0,roles_decorator_1[a145_0xb735da(0x1ed)])(role_enum_1[a145_0xb735da(0x1f6)][a145_0xb735da(0x1e8)],role_enum_1[a145_0xb735da(0x1f6)][a145_0xb735da(0x1b5)]),__param(0x0,(0x0,common_1['Res'])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0xb735da(0x1c9)])()),__metadata(a145_0xb735da(0x1ad),Function),__metadata(a145_0xb735da(0x1ae),[Object,text_dto_1['TextDTO']]),__metadata(a145_0xb735da(0x1e1),Promise)],TextToAudioController[a145_0xb735da(0x1cd)],a145_0xb735da(0x1c8),null),__decorate([(0x0,common_1[a145_0xb735da(0x1c3)])(a145_0xb735da(0x1da)),(0x0,common_1[a145_0xb735da(0x1bd)])(jwt_guard_1[a145_0xb735da(0x1e6)],roles_guard_1[a145_0xb735da(0x1f9)]),(0x0,roles_decorator_1[a145_0xb735da(0x1ed)])(role_enum_1[a145_0xb735da(0x1f6)][a145_0xb735da(0x1e8)],role_enum_1[a145_0xb735da(0x1f6)][a145_0xb735da(0x1b5)]),__param(0x0,(0x0,common_1[a145_0xb735da(0x1bc)])({'passthrough':!![]})),__param(0x1,(0x0,common_1[a145_0xb735da(0x1c9)])()),__metadata(a145_0xb735da(0x1ad),Function),__metadata(a145_0xb735da(0x1ae),[Object,text_dto_1[a145_0xb735da(0x1eb)]]),__metadata(a145_0xb735da(0x1e1),Promise)],TextToAudioController[a145_0xb735da(0x1cd)],'saveMessage',null),__decorate([(0x0,common_1[a145_0xb735da(0x1b9)])(a145_0xb735da(0x1d2)),(0x0,common_1[a145_0xb735da(0x1bd)])(jwt_guard_1[a145_0xb735da(0x1e6)],roles_guard_1[a145_0xb735da(0x1f9)]),(0x0,roles_decorator_1[a145_0xb735da(0x1ed)])(role_enum_1[a145_0xb735da(0x1f6)]['Admin'],role_enum_1[a145_0xb735da(0x1f6)][a145_0xb735da(0x1b5)]),__metadata(a145_0xb735da(0x1ad),Function),__metadata('design:paramtypes',[]),__metadata(a145_0xb735da(0x1e1),Promise)],TextToAudioController[a145_0xb735da(0x1cd)],'getAllMessage',null),__decorate([(0x0,common_1[a145_0xb735da(0x1d4)])(a145_0xb735da(0x1f0)),(0x0,common_1[a145_0xb735da(0x1bd)])(jwt_guard_1[a145_0xb735da(0x1e6)],roles_guard_1[a145_0xb735da(0x1f9)]),(0x0,roles_decorator_1[a145_0xb735da(0x1ed)])(role_enum_1['Role'][a145_0xb735da(0x1e8)],role_enum_1[a145_0xb735da(0x1f6)][a145_0xb735da(0x1b5)]),__param(0x0,(0x0,common_1[a145_0xb735da(0x1c7)])('id')),__metadata('design:type',Function),__metadata('design:paramtypes',[String]),__metadata(a145_0xb735da(0x1e1),void 0x0)],TextToAudioController['prototype'],a145_0xb735da(0x1cf),null),__decorate([(0x0,common_1[a145_0xb735da(0x1d7)])(a145_0xb735da(0x1f0)),(0x0,common_1['UseGuards'])(jwt_guard_1[a145_0xb735da(0x1e6)],roles_guard_1[a145_0xb735da(0x1f9)]),(0x0,roles_decorator_1[a145_0xb735da(0x1ed)])(role_enum_1['Role'][a145_0xb735da(0x1e8)],role_enum_1['Role'][a145_0xb735da(0x1b5)]),__param(0x0,(0x0,common_1['Param'])('id')),__param(0x1,(0x0,common_1['Body'])()),__metadata(a145_0xb735da(0x1ad),Function),__metadata('design:paramtypes',[String,text_dto_1[a145_0xb735da(0x1eb)]]),__metadata(a145_0xb735da(0x1e1),void 0x0)],TextToAudioController[a145_0xb735da(0x1cd)],'updateTextMessage',null),TextToAudioController=TextToAudioController_1=__decorate([(0x0,common_1[a145_0xb735da(0x1e4)])('textToAudio'),__metadata(a145_0xb735da(0x1ae),[text_to_audio_service_1[a145_0xb735da(0x1b2)],streaming_service_1[a145_0xb735da(0x1f1)]])],TextToAudioController),exports[a145_0xb735da(0x1b8)]=TextToAudioController;