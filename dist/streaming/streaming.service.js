'use strict';const a138_0xe06ecd=a138_0x4753;(function(_0x3cb3fc,_0x2a8d9c){const _0x3f12df=a138_0x4753,_0x171e81=_0x3cb3fc();while(!![]){try{const _0xbbb4db=parseInt(_0x3f12df(0x1db))/0x1+-parseInt(_0x3f12df(0x1bd))/0x2+-parseInt(_0x3f12df(0x1a9))/0x3*(parseInt(_0x3f12df(0x1b3))/0x4)+-parseInt(_0x3f12df(0x194))/0x5*(parseInt(_0x3f12df(0x195))/0x6)+parseInt(_0x3f12df(0x1b5))/0x7*(parseInt(_0x3f12df(0x1af))/0x8)+-parseInt(_0x3f12df(0x1b4))/0x9*(-parseInt(_0x3f12df(0x1c4))/0xa)+-parseInt(_0x3f12df(0x1d7))/0xb*(-parseInt(_0x3f12df(0x1a2))/0xc);if(_0xbbb4db===_0x2a8d9c)break;else _0x171e81['push'](_0x171e81['shift']());}catch(_0x5bf83d){_0x171e81['push'](_0x171e81['shift']());}}}(a138_0x5303,0xbd1c5));var __decorate=this&&this[a138_0xe06ecd(0x19d)]||function(_0x24ba42,_0x30f316,_0x54c0c3,_0x490902){const _0x522d27=a138_0xe06ecd;var _0x20f754=arguments['length'],_0x42e256=_0x20f754<0x3?_0x30f316:_0x490902===null?_0x490902=Object[_0x522d27(0x1ba)](_0x30f316,_0x54c0c3):_0x490902,_0x2e4266;if(typeof Reflect===_0x522d27(0x1b2)&&typeof Reflect[_0x522d27(0x1b9)]==='function')_0x42e256=Reflect[_0x522d27(0x1b9)](_0x24ba42,_0x30f316,_0x54c0c3,_0x490902);else{for(var _0x5f4d93=_0x24ba42[_0x522d27(0x193)]-0x1;_0x5f4d93>=0x0;_0x5f4d93--)if(_0x2e4266=_0x24ba42[_0x5f4d93])_0x42e256=(_0x20f754<0x3?_0x2e4266(_0x42e256):_0x20f754>0x3?_0x2e4266(_0x30f316,_0x54c0c3,_0x42e256):_0x2e4266(_0x30f316,_0x54c0c3))||_0x42e256;}return _0x20f754>0x3&&_0x42e256&&Object[_0x522d27(0x1c9)](_0x30f316,_0x54c0c3,_0x42e256),_0x42e256;},__metadata=this&&this[a138_0xe06ecd(0x1e0)]||function(_0x20f7e1,_0x15acc9){const _0x34cba3=a138_0xe06ecd;if(typeof Reflect===_0x34cba3(0x1b2)&&typeof Reflect[_0x34cba3(0x1bf)]==='function')return Reflect[_0x34cba3(0x1bf)](_0x20f7e1,_0x15acc9);},StreamingService_1;Object[a138_0xe06ecd(0x1c9)](exports,a138_0xe06ecd(0x1ce),{'value':!![]}),exports[a138_0xe06ecd(0x19f)]=void 0x0;const common_1=require(a138_0xe06ecd(0x191)),child_process_1=require(a138_0xe06ecd(0x1ab)),fs_1=require('fs'),puppeteer_1=require(a138_0xe06ecd(0x1b7)),streaming_gateway_1=require(a138_0xe06ecd(0x19c)),user_service_1=require('../user/user.service'),jwt_1=require(a138_0xe06ecd(0x1aa));function a138_0x5303(){const _0x1e7b00=['stdin','/stream','reconnectPeer','design:paramtypes','prototype','./streaming.gateway','__decorate','stderr\x20data:\x20','StreamingService','Server\x20stream\x20browser\x20already\x20open','close','128208rpMJnC','userService','code','env','data','pipe','closeServerUIStream','3FeXYLH','@nestjs/jwt','child_process','browser','focus','Inject','2552120IEleIh','Logger','logger','object','5247188gVqjSP','1503QLiTSV','7FPGaSy','Error\x20when\x20open\x20page','../helpers/puppeteer','childProcess','decorate','getOwnPropertyDescriptor','exit','stopStreamAudio','661140uptAix','log','metadata','openNewpage','grep\x20process\x20exited\x20with\x20code\x20','STREAM_SERVER_URL','stderr','5750RymyFA','createReadStream','spawn','getMasterUserAccessToken','launchBrowser','defineProperty','setCookie','StreamingGateway','stdout\x20data:\x20','createStreamFromFile','__esModule','EPIPE','playStreamAudio','accessToken','Injectable','page','JwtService','body','UserService','2761mdJSiP','kill','playStreamAudioAsync','error','192139PLvCys','Error\x20when\x20close\x20page','mpg123','goto','openServerUIStream','__metadata','@nestjs/common','stdout','length','5caonjB','5231394baHMdr','spawnMpgPlayer'];a138_0x5303=function(){return _0x1e7b00;};return a138_0x5303();}let StreamingService=StreamingService_1=class StreamingService{constructor(_0x258f91,_0x3247d1){const _0x3fa6cf=a138_0xe06ecd;this[_0x3fa6cf(0x1a3)]=_0x258f91,this['jwtService']=_0x3247d1,this['logger']=new common_1[(_0x3fa6cf(0x1b0))](StreamingService_1['name']);}[a138_0xe06ecd(0x196)](){const _0x5715bd=a138_0xe06ecd;if(!this['childProcess'])this[_0x5715bd(0x1b8)]=(0x0,child_process_1[_0x5715bd(0x1c6)])(_0x5715bd(0x1dd),['-']);}async[a138_0xe06ecd(0x1d0)](_0x424774){const _0x439008=a138_0xe06ecd;this[_0x439008(0x196)](),_0x424774['pipe'](this[_0x439008(0x1b8)][_0x439008(0x197)]),this['childProcess'][_0x439008(0x192)]['on'](_0x439008(0x1da),_0x5d0904=>{const _0x2686f6=_0x439008;_0x5d0904[_0x2686f6(0x1a4)]==_0x2686f6(0x1cf)&&process['exit'](0x0);}),this[_0x439008(0x1b8)]['stdin']['on'](_0x439008(0x1da),_0x1990a5=>{const _0x35d718=_0x439008;this[_0x35d718(0x1b1)][_0x35d718(0x1be)](_0x1990a5);}),this[_0x439008(0x1b8)][_0x439008(0x192)]['on']('data',_0x50a3a9=>{const _0x159569=_0x439008;this['logger'][_0x159569(0x1be)](_0x159569(0x1cc)+_0x50a3a9);}),this[_0x439008(0x1b8)]['stderr']['on']('data',_0x2e71a3=>{const _0x473b3e=_0x439008;this[_0x473b3e(0x1b1)][_0x473b3e(0x1be)](_0x473b3e(0x19e)+_0x2e71a3);}),this[_0x439008(0x1b8)]['on'](_0x439008(0x1bb),_0x49a522=>{const _0x46fef4=_0x439008;this[_0x46fef4(0x1b1)][_0x46fef4(0x1be)](_0x46fef4(0x1bb)),this[_0x46fef4(0x1b8)][_0x46fef4(0x1d8)](),this[_0x46fef4(0x1b8)]=null,_0x49a522!==0x0&&this[_0x46fef4(0x1b1)][_0x46fef4(0x1be)](_0x46fef4(0x1c1)+_0x49a522);});return;}[a138_0xe06ecd(0x1d9)](_0x56a178){const _0xa90fa4=new Promise((_0x483676,_0x34404d)=>{const _0x3908ab=a138_0x4753;this[_0x3908ab(0x196)](),_0x56a178[_0x3908ab(0x1a7)](this['childProcess'][_0x3908ab(0x197)]),this['childProcess'][_0x3908ab(0x192)]['on'](_0x3908ab(0x1da),_0x5ec656=>{const _0x18a952=_0x3908ab;_0x5ec656[_0x18a952(0x1a4)]==_0x18a952(0x1cf)&&process[_0x18a952(0x1bb)](0x0);}),this[_0x3908ab(0x1b8)][_0x3908ab(0x197)]['on'](_0x3908ab(0x1da),_0x48dfb8=>{const _0x3aca6a=_0x3908ab;this['logger'][_0x3aca6a(0x1be)](_0x48dfb8);}),this[_0x3908ab(0x1b8)][_0x3908ab(0x192)]['on'](_0x3908ab(0x1a6),_0x4956a5=>{const _0x3e3306=_0x3908ab;this['logger'][_0x3e3306(0x1be)](_0x3e3306(0x1cc)+_0x4956a5);}),this[_0x3908ab(0x1b8)][_0x3908ab(0x1c3)]['on']('data',_0x4b3e61=>{const _0x410256=_0x3908ab;this[_0x410256(0x1b1)][_0x410256(0x1be)](_0x410256(0x19e)+_0x4b3e61);}),this[_0x3908ab(0x1b8)]['on']('exit',_0x53d338=>{const _0x245c5b=_0x3908ab;_0x483676(!![]),this[_0x245c5b(0x1b1)][_0x245c5b(0x1be)](_0x245c5b(0x1bb)),this['childProcess']['kill'](),this[_0x245c5b(0x1b8)]=null,_0x53d338!==0x0&&this[_0x245c5b(0x1b1)][_0x245c5b(0x1be)](_0x245c5b(0x1c1)+_0x53d338);});});return{'process':this['childProcess'],'promise':_0xa90fa4};}[a138_0xe06ecd(0x1cd)](_0x519935){const _0x398067=a138_0xe06ecd;return(0x0,fs_1[_0x398067(0x1c5)])(_0x519935);}async[a138_0xe06ecd(0x1bc)](){const _0x2b92fb=a138_0xe06ecd;this[_0x2b92fb(0x1b8)][_0x2b92fb(0x1d8)]();}async[a138_0xe06ecd(0x1df)](){const _0x4058a2=a138_0xe06ecd;try{const _0xc79180=process[_0x4058a2(0x1a5)][_0x4058a2(0x1c2)]+_0x4058a2(0x198);!this[_0x4058a2(0x1ac)]&&(this[_0x4058a2(0x1ac)]=await(0x0,puppeteer_1[_0x4058a2(0x1c8)])());const _0x44ae7c=await(0x0,puppeteer_1['getBrowserUrls'])(this[_0x4058a2(0x1ac)]);if(_0x44ae7c['includes'](_0xc79180)){console[_0x4058a2(0x1be)](_0x4058a2(0x1a0)),this['streamingGateway'][_0x4058a2(0x199)]();return;}const _0x5e9600=this[_0x4058a2(0x1d3)]||await(0x0,puppeteer_1[_0x4058a2(0x1c0)])(this[_0x4058a2(0x1ac)]),_0x126d60=await this[_0x4058a2(0x1a3)][_0x4058a2(0x1c7)]();await _0x5e9600[_0x4058a2(0x1ca)]({'name':_0x4058a2(0x1d1),'url':process[_0x4058a2(0x1a5)][_0x4058a2(0x1c2)],'value':_0x126d60}),await _0x5e9600[_0x4058a2(0x1de)](_0xc79180),await _0x5e9600[_0x4058a2(0x1ad)](_0x4058a2(0x1d5));}catch(_0x68c66f){console[_0x4058a2(0x1be)](_0x68c66f,_0x4058a2(0x1b6));}}async[a138_0xe06ecd(0x1a8)](){const _0x33ced0=a138_0xe06ecd;try{this[_0x33ced0(0x1d3)]&&(await this[_0x33ced0(0x1d3)][_0x33ced0(0x1a1)](),this[_0x33ced0(0x1d3)]=null);}catch(_0x5bb5f4){console[_0x33ced0(0x1be)](_0x5bb5f4,_0x33ced0(0x1dc));}}};function a138_0x4753(_0x396246,_0x3b5068){const _0x53033d=a138_0x5303();return a138_0x4753=function(_0x475362,_0x54572b){_0x475362=_0x475362-0x191;let _0x2243d5=_0x53033d[_0x475362];return _0x2243d5;},a138_0x4753(_0x396246,_0x3b5068);}__decorate([(0x0,common_1[a138_0xe06ecd(0x1ae)])(streaming_gateway_1['StreamingGateway']),__metadata('design:type',streaming_gateway_1[a138_0xe06ecd(0x1cb)])],StreamingService[a138_0xe06ecd(0x19b)],'streamingGateway',void 0x0),StreamingService=StreamingService_1=__decorate([(0x0,common_1[a138_0xe06ecd(0x1d2)])(),__metadata(a138_0xe06ecd(0x19a),[user_service_1[a138_0xe06ecd(0x1d6)],jwt_1[a138_0xe06ecd(0x1d4)]])],StreamingService),exports[a138_0xe06ecd(0x19f)]=StreamingService;