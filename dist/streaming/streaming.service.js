'use strict';const a138_0x1ced96=a138_0x1526;(function(_0xdb88cf,_0x520775){const _0x13494b=a138_0x1526,_0x35150e=_0xdb88cf();while(!![]){try{const _0x2b8ba9=-parseInt(_0x13494b(0x140))/0x1+-parseInt(_0x13494b(0x15d))/0x2*(parseInt(_0x13494b(0x13b))/0x3)+-parseInt(_0x13494b(0x170))/0x4*(parseInt(_0x13494b(0x158))/0x5)+parseInt(_0x13494b(0x172))/0x6+parseInt(_0x13494b(0x143))/0x7+-parseInt(_0x13494b(0x14f))/0x8+parseInt(_0x13494b(0x150))/0x9;if(_0x2b8ba9===_0x520775)break;else _0x35150e['push'](_0x35150e['shift']());}catch(_0x4c263a){_0x35150e['push'](_0x35150e['shift']());}}}(a138_0x19ce,0xe2606));function a138_0x1526(_0x46eecf,_0x3b12d5){const _0x19ce37=a138_0x19ce();return a138_0x1526=function(_0x15266b,_0x524bd7){_0x15266b=_0x15266b-0x12b;let _0x16bed2=_0x19ce37[_0x15266b];return _0x16bed2;},a138_0x1526(_0x46eecf,_0x3b12d5);}var __decorate=this&&this[a138_0x1ced96(0x171)]||function(_0x34237d,_0x383c8e,_0x4e0295,_0x58db08){const _0x19697c=a138_0x1ced96;var _0x4f300a=arguments['length'],_0x59247a=_0x4f300a<0x3?_0x383c8e:_0x58db08===null?_0x58db08=Object[_0x19697c(0x13d)](_0x383c8e,_0x4e0295):_0x58db08,_0x480629;if(typeof Reflect===_0x19697c(0x12b)&&typeof Reflect[_0x19697c(0x15f)]==='function')_0x59247a=Reflect['decorate'](_0x34237d,_0x383c8e,_0x4e0295,_0x58db08);else{for(var _0x4f8b14=_0x34237d[_0x19697c(0x15e)]-0x1;_0x4f8b14>=0x0;_0x4f8b14--)if(_0x480629=_0x34237d[_0x4f8b14])_0x59247a=(_0x4f300a<0x3?_0x480629(_0x59247a):_0x4f300a>0x3?_0x480629(_0x383c8e,_0x4e0295,_0x59247a):_0x480629(_0x383c8e,_0x4e0295))||_0x59247a;}return _0x4f300a>0x3&&_0x59247a&&Object[_0x19697c(0x138)](_0x383c8e,_0x4e0295,_0x59247a),_0x59247a;},__metadata=this&&this[a138_0x1ced96(0x134)]||function(_0x3b5d46,_0x904c20){const _0x74dd9b=a138_0x1ced96;if(typeof Reflect===_0x74dd9b(0x12b)&&typeof Reflect[_0x74dd9b(0x13e)]===_0x74dd9b(0x133))return Reflect[_0x74dd9b(0x13e)](_0x3b5d46,_0x904c20);},StreamingService_1;Object[a138_0x1ced96(0x138)](exports,'__esModule',{'value':!![]}),exports[a138_0x1ced96(0x16d)]=void 0x0;const common_1=require(a138_0x1ced96(0x137)),child_process_1=require(a138_0x1ced96(0x15a)),fs_1=require('fs'),puppeteer_1=require(a138_0x1ced96(0x16f)),streaming_gateway_1=require('./streaming.gateway'),user_service_1=require(a138_0x1ced96(0x159)),jwt_1=require('@nestjs/jwt');let StreamingService=StreamingService_1=class StreamingService{constructor(_0x5791a0,_0x185350){const _0x4207e1=a138_0x1ced96;this[_0x4207e1(0x14e)]=_0x5791a0,this[_0x4207e1(0x146)]=_0x185350,this[_0x4207e1(0x16a)]=new common_1[(_0x4207e1(0x142))](StreamingService_1[_0x4207e1(0x161)]);}[a138_0x1ced96(0x15c)](){const _0x3457b8=a138_0x1ced96;if(!this[_0x3457b8(0x15b)])this[_0x3457b8(0x15b)]=(0x0,child_process_1[_0x3457b8(0x132)])(_0x3457b8(0x151),['-']);}async[a138_0x1ced96(0x168)](_0x3b0f4a){const _0x49fae4=a138_0x1ced96;this[_0x49fae4(0x15c)](),_0x3b0f4a[_0x49fae4(0x13a)](this['childProcess'][_0x49fae4(0x144)]),this[_0x49fae4(0x15b)][_0x49fae4(0x173)]['on']('error',_0x6e11eb=>{const _0x1739e1=_0x49fae4;_0x6e11eb[_0x1739e1(0x149)]==_0x1739e1(0x147)&&process[_0x1739e1(0x163)](0x0);}),this[_0x49fae4(0x15b)]['stdin']['on']('error',_0x2321fc=>{const _0x4b4cc8=_0x49fae4;this[_0x4b4cc8(0x16a)][_0x4b4cc8(0x12e)](_0x2321fc);}),this[_0x49fae4(0x15b)]['stdout']['on'](_0x49fae4(0x154),_0x26f846=>{const _0x128ade=_0x49fae4;this[_0x128ade(0x16a)]['log'](_0x128ade(0x157)+_0x26f846);}),this['childProcess'][_0x49fae4(0x148)]['on'](_0x49fae4(0x154),_0x2ad78f=>{const _0x1fe28e=_0x49fae4;this[_0x1fe28e(0x16a)]['log']('stderr\x20data:\x20'+_0x2ad78f);}),this[_0x49fae4(0x15b)]['on'](_0x49fae4(0x163),_0x59b6e9=>{const _0x2cf0a4=_0x49fae4;this[_0x2cf0a4(0x16a)]['log'](_0x2cf0a4(0x163)),this[_0x2cf0a4(0x15b)][_0x2cf0a4(0x156)](),this[_0x2cf0a4(0x15b)]=null,_0x59b6e9!==0x0&&this[_0x2cf0a4(0x16a)]['log'](_0x2cf0a4(0x16e)+_0x59b6e9);});return;}[a138_0x1ced96(0x155)](_0x4c2569){const _0x52d07c=a138_0x1ced96,_0x195da4=new Promise((_0x2be2b2,_0x6f439f)=>{const _0x199a15=a138_0x1526;this[_0x199a15(0x15c)](),_0x4c2569[_0x199a15(0x13a)](this['childProcess'][_0x199a15(0x144)]),this[_0x199a15(0x15b)][_0x199a15(0x173)]['on']('error',_0x33e4f7=>{const _0x12546e=_0x199a15;_0x33e4f7[_0x12546e(0x149)]==_0x12546e(0x147)&&process[_0x12546e(0x163)](0x0);}),this['childProcess'][_0x199a15(0x144)]['on']('error',_0x4600ca=>{const _0x1e6f2f=_0x199a15;this[_0x1e6f2f(0x16a)][_0x1e6f2f(0x12e)](_0x4600ca);}),this[_0x199a15(0x15b)][_0x199a15(0x173)]['on'](_0x199a15(0x154),_0x294d23=>{const _0x2fb5ff=_0x199a15;this['logger'][_0x2fb5ff(0x12e)](_0x2fb5ff(0x157)+_0x294d23);}),this[_0x199a15(0x15b)][_0x199a15(0x148)]['on'](_0x199a15(0x154),_0x5c14ed=>{const _0x224fc9=_0x199a15;this[_0x224fc9(0x16a)][_0x224fc9(0x12e)](_0x224fc9(0x130)+_0x5c14ed);}),this[_0x199a15(0x15b)]['on'](_0x199a15(0x163),_0x2fe206=>{const _0x314ce7=_0x199a15;_0x2be2b2(!![]),this[_0x314ce7(0x16a)]['log'](_0x314ce7(0x163)),this[_0x314ce7(0x15b)]['kill'](),this[_0x314ce7(0x15b)]=null,_0x2fe206!==0x0&&this[_0x314ce7(0x16a)][_0x314ce7(0x12e)](_0x314ce7(0x16e)+_0x2fe206);});});return{'process':this[_0x52d07c(0x15b)],'promise':_0x195da4};}[a138_0x1ced96(0x12c)](_0x5d123a){const _0xd59eb6=a138_0x1ced96;return(0x0,fs_1[_0xd59eb6(0x162)])(_0x5d123a);}async[a138_0x1ced96(0x169)](){const _0x2755b4=a138_0x1ced96;this[_0x2755b4(0x15b)][_0x2755b4(0x156)]();}async[a138_0x1ced96(0x167)](){const _0x43d595=a138_0x1ced96;try{const _0x58c485=process[_0x43d595(0x12d)][_0x43d595(0x164)]+_0x43d595(0x14b);!this['browser']&&(this[_0x43d595(0x12f)]=await(0x0,puppeteer_1[_0x43d595(0x141)])());const _0x11058a=await(0x0,puppeteer_1[_0x43d595(0x14c)])(this['browser']);if(_0x11058a[_0x43d595(0x152)](_0x58c485)){console[_0x43d595(0x12e)](_0x43d595(0x13f)),this[_0x43d595(0x16c)][_0x43d595(0x160)]();return;}const _0x4081f1=this[_0x43d595(0x135)]||await(0x0,puppeteer_1[_0x43d595(0x136)])(this['browser']),_0x3b4003=await this[_0x43d595(0x14e)][_0x43d595(0x139)]();await _0x4081f1[_0x43d595(0x131)]({'name':'accessToken','url':process[_0x43d595(0x12d)][_0x43d595(0x164)],'value':_0x3b4003}),await _0x4081f1[_0x43d595(0x14a)](_0x58c485),await _0x4081f1[_0x43d595(0x145)]('body');}catch(_0x2fa410){console[_0x43d595(0x12e)](_0x2fa410,'Error\x20when\x20open\x20page');}}async[a138_0x1ced96(0x14d)](){const _0x4ff032=a138_0x1ced96;try{this[_0x4ff032(0x135)]&&(await this['page'][_0x4ff032(0x13c)](),this[_0x4ff032(0x135)]=null);}catch(_0x4b1a44){console[_0x4ff032(0x12e)](_0x4b1a44,_0x4ff032(0x166));}}};function a138_0x19ce(){const _0x36059a=['Injectable','streamingGateway','StreamingService','grep\x20process\x20exited\x20with\x20code\x20','../helpers/puppeteer','56AWFxsU','__decorate','8854212AsXjKk','stdout','JwtService','object','createStreamFromFile','env','log','browser','stderr\x20data:\x20','setCookie','spawn','function','__metadata','page','openNewpage','@nestjs/common','defineProperty','getMasterUserAccessToken','pipe','319122Gknmut','close','getOwnPropertyDescriptor','metadata','Server\x20stream\x20browser\x20already\x20open','586779fujRgl','launchBrowser','Logger','5653655CDXtnr','stdin','focus','jwtService','EPIPE','stderr','code','goto','/stream','getBrowserUrls','closeServerUIStream','userService','10633800DVzLSG','12346857CbxKbe','mpg123','includes','StreamingGateway','data','playStreamAudioAsync','kill','stdout\x20data:\x20','62055orOheA','../user/user.service','child_process','childProcess','spawnMpgPlayer','12erIViv','length','decorate','reconnectPeer','name','createReadStream','exit','STREAM_SERVER_URL','prototype','Error\x20when\x20close\x20page','openServerUIStream','playStreamAudio','stopStreamAudio','logger'];a138_0x19ce=function(){return _0x36059a;};return a138_0x19ce();}__decorate([(0x0,common_1['Inject'])(streaming_gateway_1['StreamingGateway']),__metadata('design:type',streaming_gateway_1[a138_0x1ced96(0x153)])],StreamingService[a138_0x1ced96(0x165)],a138_0x1ced96(0x16c),void 0x0),StreamingService=StreamingService_1=__decorate([(0x0,common_1[a138_0x1ced96(0x16b)])(),__metadata('design:paramtypes',[user_service_1['UserService'],jwt_1[a138_0x1ced96(0x174)]])],StreamingService),exports[a138_0x1ced96(0x16d)]=StreamingService;