'use strict';const a141_0x5dad64=a141_0x4cc9;function a141_0x16c5(){const _0x1919e0=['Error\x20when\x20close\x20page','1196483MHVLuP','childProcess','429VZZfvO','Injectable','streamingGateway','goto','stdout','design:paramtypes','reconnectPeer','kill','env','closeServerUIStream','accessToken','Server\x20stream\x20browser\x20already\x20open','stdin','__decorate','../helpers/puppeteer','playStreamAudioAsync','data','2jrQRvu','page','getOwnPropertyDescriptor','defineProperty','launchBrowser','StreamingService','includes','playStreamAudio','Logger','grep\x20process\x20exited\x20with\x20code\x20','openNewpage','log','25817CytYjQ','__esModule','close','child_process','./streaming.gateway','EPIPE','mpg123','openServerUIStream','getMasterUserAccessToken','prototype','setCookie','userService','STREAM_SERVER_URL','exit','error','5931366zMSSxs','/stream','pipe','StreamingGateway','length','name','object','stderr','spawnMpgPlayer','@nestjs/jwt','144OdgcJg','556912DrioQU','stopStreamAudio','Error\x20when\x20open\x20page','126130pnHEio','564qeMFyg','design:type','code','createReadStream','function','stderr\x20data:\x20','metadata','browser','168Eolymg','182740qRDASD','../user/user.service','logger','createStreamFromFile','focus','11864VHZwPV','UserService'];a141_0x16c5=function(){return _0x1919e0;};return a141_0x16c5();}(function(_0x40af7c,_0xddf7c9){const _0x310a11=a141_0x4cc9,_0x332e64=_0x40af7c();while(!![]){try{const _0x2978b2=-parseInt(_0x310a11(0x15a))/0x1*(-parseInt(_0x310a11(0x16d))/0x2)+parseInt(_0x310a11(0x15c))/0x3*(-parseInt(_0x310a11(0x157))/0x4)+parseInt(_0x310a11(0x152))/0x5*(-parseInt(_0x310a11(0x151))/0x6)+parseInt(_0x310a11(0x13a))/0x7+-parseInt(_0x310a11(0x145))/0x8+parseInt(_0x310a11(0x144))/0x9*(parseInt(_0x310a11(0x148))/0xa)+-parseInt(_0x310a11(0x12b))/0xb*(parseInt(_0x310a11(0x149))/0xc);if(_0x2978b2===_0xddf7c9)break;else _0x332e64['push'](_0x332e64['shift']());}catch(_0x286791){_0x332e64['push'](_0x332e64['shift']());}}}(a141_0x16c5,0x96ef0));var __decorate=this&&this[a141_0x5dad64(0x169)]||function(_0x3914eb,_0x178956,_0x2f520a,_0x43473e){const _0x272361=a141_0x5dad64;var _0x4e37cf=arguments['length'],_0x38a0c7=_0x4e37cf<0x3?_0x178956:_0x43473e===null?_0x43473e=Object[_0x272361(0x16f)](_0x178956,_0x2f520a):_0x43473e,_0xe15fe0;if(typeof Reflect===_0x272361(0x140)&&typeof Reflect['decorate']===_0x272361(0x14d))_0x38a0c7=Reflect['decorate'](_0x3914eb,_0x178956,_0x2f520a,_0x43473e);else{for(var _0x183bea=_0x3914eb[_0x272361(0x13e)]-0x1;_0x183bea>=0x0;_0x183bea--)if(_0xe15fe0=_0x3914eb[_0x183bea])_0x38a0c7=(_0x4e37cf<0x3?_0xe15fe0(_0x38a0c7):_0x4e37cf>0x3?_0xe15fe0(_0x178956,_0x2f520a,_0x38a0c7):_0xe15fe0(_0x178956,_0x2f520a))||_0x38a0c7;}return _0x4e37cf>0x3&&_0x38a0c7&&Object['defineProperty'](_0x178956,_0x2f520a,_0x38a0c7),_0x38a0c7;},__metadata=this&&this['__metadata']||function(_0x198e45,_0x4f520d){const _0x278efe=a141_0x5dad64;if(typeof Reflect==='object'&&typeof Reflect[_0x278efe(0x14f)]===_0x278efe(0x14d))return Reflect[_0x278efe(0x14f)](_0x198e45,_0x4f520d);},StreamingService_1;Object[a141_0x5dad64(0x170)](exports,a141_0x5dad64(0x12c),{'value':!![]}),exports[a141_0x5dad64(0x172)]=void 0x0;const common_1=require('@nestjs/common'),child_process_1=require(a141_0x5dad64(0x12e)),fs_1=require('fs'),puppeteer_1=require(a141_0x5dad64(0x16a)),streaming_gateway_1=require(a141_0x5dad64(0x12f)),user_service_1=require(a141_0x5dad64(0x153)),jwt_1=require(a141_0x5dad64(0x143));function a141_0x4cc9(_0x1e34fd,_0x376925){const _0x16c5de=a141_0x16c5();return a141_0x4cc9=function(_0x4cc940,_0x53ffab){_0x4cc940=_0x4cc940-0x127;let _0x5c2b30=_0x16c5de[_0x4cc940];return _0x5c2b30;},a141_0x4cc9(_0x1e34fd,_0x376925);}let StreamingService=StreamingService_1=class StreamingService{constructor(_0x2a3f4f,_0x5e562a){const _0x1f8078=a141_0x5dad64;this[_0x1f8078(0x136)]=_0x2a3f4f,this['jwtService']=_0x5e562a,this['logger']=new common_1[(_0x1f8078(0x127))](StreamingService_1[_0x1f8078(0x13f)]);}[a141_0x5dad64(0x142)](){const _0x5e86c2=a141_0x5dad64;if(!this['childProcess'])this[_0x5e86c2(0x15b)]=(0x0,child_process_1['spawn'])(_0x5e86c2(0x131),['-']);}async[a141_0x5dad64(0x174)](_0x1ee50c){const _0x49ef5c=a141_0x5dad64;this[_0x49ef5c(0x142)](),_0x1ee50c[_0x49ef5c(0x13c)](this[_0x49ef5c(0x15b)][_0x49ef5c(0x168)]),this['childProcess'][_0x49ef5c(0x160)]['on'](_0x49ef5c(0x139),_0x2622e2=>{const _0x3039d2=_0x49ef5c;_0x2622e2['code']==_0x3039d2(0x130)&&process['exit'](0x0);}),this[_0x49ef5c(0x15b)][_0x49ef5c(0x168)]['on'](_0x49ef5c(0x139),_0x33b291=>{const _0x2efda9=_0x49ef5c;this['logger'][_0x2efda9(0x12a)](_0x33b291);}),this[_0x49ef5c(0x15b)][_0x49ef5c(0x160)]['on'](_0x49ef5c(0x16c),_0x296079=>{const _0x1d5cb1=_0x49ef5c;this['logger'][_0x1d5cb1(0x12a)]('stdout\x20data:\x20'+_0x296079);}),this[_0x49ef5c(0x15b)]['stderr']['on'](_0x49ef5c(0x16c),_0x3d4a9b=>{const _0x5e09b3=_0x49ef5c;this[_0x5e09b3(0x154)][_0x5e09b3(0x12a)](_0x5e09b3(0x14e)+_0x3d4a9b);}),this['childProcess']['on'](_0x49ef5c(0x138),_0x4a70a2=>{const _0x323eb7=_0x49ef5c;this['logger'][_0x323eb7(0x12a)](_0x323eb7(0x138)),this[_0x323eb7(0x15b)][_0x323eb7(0x163)](),this['childProcess']=null,_0x4a70a2!==0x0&&this['logger'][_0x323eb7(0x12a)](_0x323eb7(0x128)+_0x4a70a2);});return;}[a141_0x5dad64(0x16b)](_0x33dca5){const _0x127ed8=a141_0x5dad64,_0xd202da=new Promise((_0x1f308a,_0x8d8c9f)=>{const _0x12ac3a=a141_0x4cc9;this[_0x12ac3a(0x142)](),_0x33dca5[_0x12ac3a(0x13c)](this[_0x12ac3a(0x15b)]['stdin']),this[_0x12ac3a(0x15b)][_0x12ac3a(0x160)]['on']('error',_0x219f09=>{const _0x560bcd=_0x12ac3a;_0x219f09[_0x560bcd(0x14b)]==_0x560bcd(0x130)&&process[_0x560bcd(0x138)](0x0);}),this[_0x12ac3a(0x15b)][_0x12ac3a(0x168)]['on'](_0x12ac3a(0x139),_0x4caa3a=>{const _0x4dad67=_0x12ac3a;this['logger'][_0x4dad67(0x12a)](_0x4caa3a);}),this[_0x12ac3a(0x15b)]['stdout']['on'](_0x12ac3a(0x16c),_0x3f6d61=>{const _0x31b073=_0x12ac3a;this[_0x31b073(0x154)][_0x31b073(0x12a)]('stdout\x20data:\x20'+_0x3f6d61);}),this[_0x12ac3a(0x15b)][_0x12ac3a(0x141)]['on'](_0x12ac3a(0x16c),_0x2e8d51=>{const _0x52a42e=_0x12ac3a;this[_0x52a42e(0x154)][_0x52a42e(0x12a)]('stderr\x20data:\x20'+_0x2e8d51);}),this[_0x12ac3a(0x15b)]['on'](_0x12ac3a(0x138),_0xbd0dfa=>{const _0x21ee6a=_0x12ac3a;_0x1f308a(!![]),this[_0x21ee6a(0x154)]['log'](_0x21ee6a(0x138)),this[_0x21ee6a(0x15b)][_0x21ee6a(0x163)](),this[_0x21ee6a(0x15b)]=null,_0xbd0dfa!==0x0&&this[_0x21ee6a(0x154)]['log'](_0x21ee6a(0x128)+_0xbd0dfa);});});return{'process':this[_0x127ed8(0x15b)],'promise':_0xd202da};}[a141_0x5dad64(0x155)](_0x508e5c){const _0x492358=a141_0x5dad64;return(0x0,fs_1[_0x492358(0x14c)])(_0x508e5c);}async[a141_0x5dad64(0x146)](){this['childProcess']['kill']();}async[a141_0x5dad64(0x132)](){const _0x3ec2cc=a141_0x5dad64;try{const _0x33462e=process[_0x3ec2cc(0x164)][_0x3ec2cc(0x137)]+_0x3ec2cc(0x13b);!this[_0x3ec2cc(0x150)]&&(this[_0x3ec2cc(0x150)]=await(0x0,puppeteer_1[_0x3ec2cc(0x171)])());const _0x304786=await(0x0,puppeteer_1['getBrowserUrls'])(this[_0x3ec2cc(0x150)]);if(_0x304786[_0x3ec2cc(0x173)](_0x33462e)){console[_0x3ec2cc(0x12a)](_0x3ec2cc(0x167)),this[_0x3ec2cc(0x15e)][_0x3ec2cc(0x162)]();return;}const _0x5619bc=this[_0x3ec2cc(0x16e)]||await(0x0,puppeteer_1[_0x3ec2cc(0x129)])(this[_0x3ec2cc(0x150)]),_0x582751=await this[_0x3ec2cc(0x136)][_0x3ec2cc(0x133)]();await _0x5619bc[_0x3ec2cc(0x135)]({'name':_0x3ec2cc(0x166),'url':process[_0x3ec2cc(0x164)][_0x3ec2cc(0x137)],'value':_0x582751}),await _0x5619bc[_0x3ec2cc(0x15f)](_0x33462e),await _0x5619bc[_0x3ec2cc(0x156)]('body');}catch(_0x11da3f){console['log'](_0x11da3f,_0x3ec2cc(0x147));}}async[a141_0x5dad64(0x165)](){const _0x349e3c=a141_0x5dad64;try{this['page']&&(await this[_0x349e3c(0x16e)][_0x349e3c(0x12d)](),this['page']=null);}catch(_0x40a313){console[_0x349e3c(0x12a)](_0x40a313,_0x349e3c(0x159));}}};__decorate([(0x0,common_1['Inject'])(streaming_gateway_1['StreamingGateway']),__metadata(a141_0x5dad64(0x14a),streaming_gateway_1[a141_0x5dad64(0x13d)])],StreamingService[a141_0x5dad64(0x134)],a141_0x5dad64(0x15e),void 0x0),StreamingService=StreamingService_1=__decorate([(0x0,common_1[a141_0x5dad64(0x15d)])(),__metadata(a141_0x5dad64(0x161),[user_service_1[a141_0x5dad64(0x158)],jwt_1['JwtService']])],StreamingService),exports[a141_0x5dad64(0x172)]=StreamingService;