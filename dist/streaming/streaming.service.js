'use strict';function a141_0x42c8(){const _0x3d00ce=['8371860MjJFJB','5063150VrocLm','openServerUIStream','1042320hzEcSo','openNewpage','getOwnPropertyDescriptor','playStreamAudioAsync','playStreamAudio','spawn','stdout\x20data:\x20','186tZONeV','childProcess','5108tGAMzj','2201BEXgkN','stdin','StreamingService','function','stdout','launchBrowser','exit','6jitSMD','92skWdMg','/stream','includes','5775903RNufqo','jwtService','stopStreamAudio','Server\x20stream\x20browser\x20already\x20open','object','STREAM_SERVER_URL','getBrowserUrls','grep\x20process\x20exited\x20with\x20code\x20','stderr','code','setCookie','pipe','streamingGateway','page','error','kill','length','design:paramtypes','closeServerUIStream','focus','stderr\x20data:\x20','decorate','env','Logger','Inject','close','../helpers/puppeteer','Injectable','createReadStream','data','prototype','userService','accessToken','body','442485YNxTvq','Error\x20when\x20open\x20page','logger','name','defineProperty','getMasterUserAccessToken','./streaming.gateway','__decorate','reconnectPeer','JwtService','EPIPE','spawnMpgPlayer','__esModule','log','browser','StreamingGateway'];a141_0x42c8=function(){return _0x3d00ce;};return a141_0x42c8();}const a141_0xb49a9a=a141_0x499a;function a141_0x499a(_0x24bb2d,_0x21a8f8){const _0x42c891=a141_0x42c8();return a141_0x499a=function(_0x499ace,_0x275c84){_0x499ace=_0x499ace-0x189;let _0xcdf288=_0x42c891[_0x499ace];return _0xcdf288;},a141_0x499a(_0x24bb2d,_0x21a8f8);}(function(_0x377f45,_0x3715ad){const _0x1ba880=a141_0x499a,_0x5d0bca=_0x377f45();while(!![]){try{const _0x4658c8=-parseInt(_0x1ba880(0x1a7))/0x1*(parseInt(_0x1ba880(0x1af))/0x2)+parseInt(_0x1ba880(0x1a4))/0x3*(parseInt(_0x1ba880(0x1a6))/0x4)+-parseInt(_0x1ba880(0x19b))/0x5+parseInt(_0x1ba880(0x1ae))/0x6*(parseInt(_0x1ba880(0x1b2))/0x7)+-parseInt(_0x1ba880(0x19d))/0x8+parseInt(_0x1ba880(0x18a))/0x9+parseInt(_0x1ba880(0x19a))/0xa;if(_0x4658c8===_0x3715ad)break;else _0x5d0bca['push'](_0x5d0bca['shift']());}catch(_0x272627){_0x5d0bca['push'](_0x5d0bca['shift']());}}}(a141_0x42c8,0x856b8));var __decorate=this&&this[a141_0xb49a9a(0x191)]||function(_0x5d171c,_0x30c9e9,_0x1eb6b6,_0x55dbfb){const _0x27ff8d=a141_0xb49a9a;var _0x2a4bed=arguments[_0x27ff8d(0x1c2)],_0xe22368=_0x2a4bed<0x3?_0x30c9e9:_0x55dbfb===null?_0x55dbfb=Object[_0x27ff8d(0x19f)](_0x30c9e9,_0x1eb6b6):_0x55dbfb,_0x1e419b;if(typeof Reflect===_0x27ff8d(0x1b6)&&typeof Reflect['decorate']===_0x27ff8d(0x1aa))_0xe22368=Reflect[_0x27ff8d(0x1c7)](_0x5d171c,_0x30c9e9,_0x1eb6b6,_0x55dbfb);else{for(var _0x2a7a57=_0x5d171c[_0x27ff8d(0x1c2)]-0x1;_0x2a7a57>=0x0;_0x2a7a57--)if(_0x1e419b=_0x5d171c[_0x2a7a57])_0xe22368=(_0x2a4bed<0x3?_0x1e419b(_0xe22368):_0x2a4bed>0x3?_0x1e419b(_0x30c9e9,_0x1eb6b6,_0xe22368):_0x1e419b(_0x30c9e9,_0x1eb6b6))||_0xe22368;}return _0x2a4bed>0x3&&_0xe22368&&Object[_0x27ff8d(0x18e)](_0x30c9e9,_0x1eb6b6,_0xe22368),_0xe22368;},__metadata=this&&this['__metadata']||function(_0x3f54d2,_0x337951){const _0x33e940=a141_0xb49a9a;if(typeof Reflect===_0x33e940(0x1b6)&&typeof Reflect['metadata']===_0x33e940(0x1aa))return Reflect['metadata'](_0x3f54d2,_0x337951);},StreamingService_1;Object['defineProperty'](exports,a141_0xb49a9a(0x196),{'value':!![]}),exports['StreamingService']=void 0x0;const common_1=require('@nestjs/common'),child_process_1=require('child_process'),fs_1=require('fs'),puppeteer_1=require(a141_0xb49a9a(0x1cc)),streaming_gateway_1=require(a141_0xb49a9a(0x190)),user_service_1=require('../user/user.service'),jwt_1=require('@nestjs/jwt');let StreamingService=StreamingService_1=class StreamingService{constructor(_0x39d330,_0x1dbecf){const _0x2c474d=a141_0xb49a9a;this['userService']=_0x39d330,this[_0x2c474d(0x1b3)]=_0x1dbecf,this['logger']=new common_1[(_0x2c474d(0x1c9))](StreamingService_1[_0x2c474d(0x18d)]);}[a141_0xb49a9a(0x195)](){const _0x12c959=a141_0xb49a9a;if(!this['childProcess'])this[_0x12c959(0x1a5)]=(0x0,child_process_1[_0x12c959(0x1a2)])('mpg123',['-']);}async[a141_0xb49a9a(0x1a1)](_0x2c42de){const _0x3fbfb2=a141_0xb49a9a;this[_0x3fbfb2(0x195)](),_0x2c42de[_0x3fbfb2(0x1bd)](this[_0x3fbfb2(0x1a5)][_0x3fbfb2(0x1a8)]),this[_0x3fbfb2(0x1a5)]['stdout']['on'](_0x3fbfb2(0x1c0),_0x29f0d0=>{const _0x774109=_0x3fbfb2;_0x29f0d0[_0x774109(0x1bb)]==_0x774109(0x194)&&process['exit'](0x0);}),this['childProcess'][_0x3fbfb2(0x1a8)]['on']('error',_0x3d6277=>{const _0x57e908=_0x3fbfb2;this[_0x57e908(0x18c)][_0x57e908(0x197)](_0x3d6277);}),this[_0x3fbfb2(0x1a5)][_0x3fbfb2(0x1ab)]['on'](_0x3fbfb2(0x1cf),_0x674a39=>{const _0x4c4722=_0x3fbfb2;this[_0x4c4722(0x18c)][_0x4c4722(0x197)]('stdout\x20data:\x20'+_0x674a39);}),this['childProcess'][_0x3fbfb2(0x1ba)]['on'](_0x3fbfb2(0x1cf),_0x594b4c=>{const _0x29d765=_0x3fbfb2;this[_0x29d765(0x18c)][_0x29d765(0x197)](_0x29d765(0x1c6)+_0x594b4c);}),this[_0x3fbfb2(0x1a5)]['on']('exit',_0x4cc49f=>{const _0x4adb69=_0x3fbfb2;this[_0x4adb69(0x18c)]['log'](_0x4adb69(0x1ad)),this[_0x4adb69(0x1a5)][_0x4adb69(0x1c1)](),this[_0x4adb69(0x1a5)]=null,_0x4cc49f!==0x0&&this[_0x4adb69(0x18c)]['log']('grep\x20process\x20exited\x20with\x20code\x20'+_0x4cc49f);});return;}[a141_0xb49a9a(0x1a0)](_0x285a95){const _0x3f8e71=a141_0xb49a9a,_0x99800e=new Promise((_0xdbe730,_0x21c48a)=>{const _0x577765=a141_0x499a;this[_0x577765(0x195)](),_0x285a95[_0x577765(0x1bd)](this[_0x577765(0x1a5)][_0x577765(0x1a8)]),this['childProcess'][_0x577765(0x1ab)]['on']('error',_0xa18c56=>{const _0x6e58a8=_0x577765;_0xa18c56[_0x6e58a8(0x1bb)]==_0x6e58a8(0x194)&&process[_0x6e58a8(0x1ad)](0x0);}),this[_0x577765(0x1a5)][_0x577765(0x1a8)]['on']('error',_0x5f3bfe=>{this['logger']['log'](_0x5f3bfe);}),this[_0x577765(0x1a5)][_0x577765(0x1ab)]['on'](_0x577765(0x1cf),_0x370c56=>{const _0x1f68f9=_0x577765;this['logger'][_0x1f68f9(0x197)](_0x1f68f9(0x1a3)+_0x370c56);}),this[_0x577765(0x1a5)][_0x577765(0x1ba)]['on'](_0x577765(0x1cf),_0x2bcb04=>{const _0x160c05=_0x577765;this[_0x160c05(0x18c)][_0x160c05(0x197)](_0x160c05(0x1c6)+_0x2bcb04);}),this[_0x577765(0x1a5)]['on'](_0x577765(0x1ad),_0x58782f=>{const _0x3218e4=_0x577765;_0xdbe730(!![]),this[_0x3218e4(0x18c)]['log']('exit'),this['childProcess']['kill'](),this[_0x3218e4(0x1a5)]=null,_0x58782f!==0x0&&this[_0x3218e4(0x18c)][_0x3218e4(0x197)](_0x3218e4(0x1b9)+_0x58782f);});});return{'process':this[_0x3f8e71(0x1a5)],'promise':_0x99800e};}['createStreamFromFile'](_0x210183){const _0x3ae423=a141_0xb49a9a;return(0x0,fs_1[_0x3ae423(0x1ce)])(_0x210183);}async[a141_0xb49a9a(0x1b4)](){const _0x8019c5=a141_0xb49a9a;this[_0x8019c5(0x1a5)][_0x8019c5(0x1c1)]();}async[a141_0xb49a9a(0x19c)](){const _0x304a2e=a141_0xb49a9a;try{const _0x3c214e=process[_0x304a2e(0x1c8)][_0x304a2e(0x1b7)]+_0x304a2e(0x1b0);!this[_0x304a2e(0x198)]&&(this[_0x304a2e(0x198)]=await(0x0,puppeteer_1[_0x304a2e(0x1ac)])());const _0x26a204=await(0x0,puppeteer_1[_0x304a2e(0x1b8)])(this[_0x304a2e(0x198)]);if(_0x26a204[_0x304a2e(0x1b1)](_0x3c214e)){console[_0x304a2e(0x197)](_0x304a2e(0x1b5)),this[_0x304a2e(0x1be)][_0x304a2e(0x192)]();return;}const _0x25e898=this['page']||await(0x0,puppeteer_1[_0x304a2e(0x19e)])(this[_0x304a2e(0x198)]),_0x5c4b01=await this[_0x304a2e(0x1d1)][_0x304a2e(0x18f)]();await _0x25e898[_0x304a2e(0x1bc)]({'name':_0x304a2e(0x1d2),'url':process[_0x304a2e(0x1c8)][_0x304a2e(0x1b7)],'value':_0x5c4b01}),await _0x25e898['goto'](_0x3c214e),await _0x25e898[_0x304a2e(0x1c5)](_0x304a2e(0x189));}catch(_0x5e3e43){console[_0x304a2e(0x197)](_0x5e3e43,_0x304a2e(0x18b));}}async[a141_0xb49a9a(0x1c4)](){const _0x2f4bdc=a141_0xb49a9a;try{this[_0x2f4bdc(0x1bf)]&&(await this[_0x2f4bdc(0x1bf)][_0x2f4bdc(0x1cb)](),this[_0x2f4bdc(0x1bf)]=null);}catch(_0x20bae5){console[_0x2f4bdc(0x197)](_0x20bae5,'Error\x20when\x20close\x20page');}}};__decorate([(0x0,common_1[a141_0xb49a9a(0x1ca)])(streaming_gateway_1[a141_0xb49a9a(0x199)]),__metadata('design:type',streaming_gateway_1[a141_0xb49a9a(0x199)])],StreamingService[a141_0xb49a9a(0x1d0)],a141_0xb49a9a(0x1be),void 0x0),StreamingService=StreamingService_1=__decorate([(0x0,common_1[a141_0xb49a9a(0x1cd)])(),__metadata(a141_0xb49a9a(0x1c3),[user_service_1['UserService'],jwt_1[a141_0xb49a9a(0x193)]])],StreamingService),exports[a141_0xb49a9a(0x1a9)]=StreamingService;