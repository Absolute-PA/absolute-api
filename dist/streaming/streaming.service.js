'use strict';function a141_0xec0a(){const _0x50677c=['spawnMpgPlayer','launchBrowser','stdin','log','grep\x20process\x20exited\x20with\x20code\x20','16034337tzvddT','design:type','metadata','object','./streaming.gateway','getBrowserUrls','exit','Inject','/stream','stdout','__metadata','prototype','kill','close','createReadStream','body','code','data','browser','mpg123','EPIPE','stdout\x20data:\x20','getOwnPropertyDescriptor','1285676ZHHGjB','1072oHbtfq','playStreamAudio','userService','reconnectPeer','streamingGateway','getMasterUserAccessToken','../user/user.service','@nestjs/common','stopStreamAudio','112QdKCpp','86418MxbDbA','Logger','logger','function','StreamingService','363601atvfOx','Injectable','defineProperty','stderr\x20data:\x20','3173796lRVxSp','childProcess','error','createStreamFromFile','spawn','__decorate','setCookie','page','StreamingGateway','playStreamAudioAsync','decorate','STREAM_SERVER_URL','name','stderr','openServerUIStream','1080czeMaW','4067250UJUimN','includes','design:paramtypes','goto','pipe','env','Server\x20stream\x20browser\x20already\x20open','Error\x20when\x20open\x20page'];a141_0xec0a=function(){return _0x50677c;};return a141_0xec0a();}const a141_0x248b88=a141_0x35fa;(function(_0x41a975,_0x1ca548){const _0x5868eb=a141_0x35fa,_0x2feea3=_0x41a975();while(!![]){try{const _0x22694c=parseInt(_0x5868eb(0x145))/0x1*(-parseInt(_0x5868eb(0x123))/0x2)+parseInt(_0x5868eb(0x12d))/0x3+-parseInt(_0x5868eb(0x122))/0x4+parseInt(_0x5868eb(0x146))/0x5+-parseInt(_0x5868eb(0x136))/0x6+-parseInt(_0x5868eb(0x132))/0x7*(parseInt(_0x5868eb(0x12c))/0x8)+parseInt(_0x5868eb(0x153))/0x9;if(_0x22694c===_0x1ca548)break;else _0x2feea3['push'](_0x2feea3['shift']());}catch(_0x5b17e5){_0x2feea3['push'](_0x2feea3['shift']());}}}(a141_0xec0a,0x721b6));var __decorate=this&&this[a141_0x248b88(0x13b)]||function(_0x2dbf9d,_0xd58c5,_0x6939a6,_0x2fdd40){const _0x5ae471=a141_0x248b88;var _0x5a31f2=arguments['length'],_0x5bd7da=_0x5a31f2<0x3?_0xd58c5:_0x2fdd40===null?_0x2fdd40=Object[_0x5ae471(0x121)](_0xd58c5,_0x6939a6):_0x2fdd40,_0x507e01;if(typeof Reflect==='object'&&typeof Reflect[_0x5ae471(0x140)]===_0x5ae471(0x130))_0x5bd7da=Reflect[_0x5ae471(0x140)](_0x2dbf9d,_0xd58c5,_0x6939a6,_0x2fdd40);else{for(var _0x49de7b=_0x2dbf9d['length']-0x1;_0x49de7b>=0x0;_0x49de7b--)if(_0x507e01=_0x2dbf9d[_0x49de7b])_0x5bd7da=(_0x5a31f2<0x3?_0x507e01(_0x5bd7da):_0x5a31f2>0x3?_0x507e01(_0xd58c5,_0x6939a6,_0x5bd7da):_0x507e01(_0xd58c5,_0x6939a6))||_0x5bd7da;}return _0x5a31f2>0x3&&_0x5bd7da&&Object[_0x5ae471(0x134)](_0xd58c5,_0x6939a6,_0x5bd7da),_0x5bd7da;},__metadata=this&&this[a141_0x248b88(0x15d)]||function(_0x414119,_0x371f7f){const _0x58ce1a=a141_0x248b88;if(typeof Reflect===_0x58ce1a(0x156)&&typeof Reflect['metadata']===_0x58ce1a(0x130))return Reflect[_0x58ce1a(0x155)](_0x414119,_0x371f7f);},StreamingService_1;Object[a141_0x248b88(0x134)](exports,'__esModule',{'value':!![]}),exports[a141_0x248b88(0x131)]=void 0x0;function a141_0x35fa(_0x58d4bd,_0x5787f0){const _0xec0a28=a141_0xec0a();return a141_0x35fa=function(_0x35fa3e,_0x185793){_0x35fa3e=_0x35fa3e-0x11b;let _0x4ca9c0=_0xec0a28[_0x35fa3e];return _0x4ca9c0;},a141_0x35fa(_0x58d4bd,_0x5787f0);}const common_1=require(a141_0x248b88(0x12a)),child_process_1=require('child_process'),fs_1=require('fs'),puppeteer_1=require('../helpers/puppeteer'),streaming_gateway_1=require(a141_0x248b88(0x157)),user_service_1=require(a141_0x248b88(0x129)),jwt_1=require('@nestjs/jwt');let StreamingService=StreamingService_1=class StreamingService{constructor(_0x19c747,_0x3aeb29){const _0x3d4802=a141_0x248b88;this[_0x3d4802(0x125)]=_0x19c747,this['jwtService']=_0x3aeb29,this[_0x3d4802(0x12f)]=new common_1[(_0x3d4802(0x12e))](StreamingService_1[_0x3d4802(0x142)]);}[a141_0x248b88(0x14e)](){const _0x9179c7=a141_0x248b88;if(!this[_0x9179c7(0x137)])this[_0x9179c7(0x137)]=(0x0,child_process_1[_0x9179c7(0x13a)])(_0x9179c7(0x11e),['-']);}async[a141_0x248b88(0x124)](_0x31e643){const _0x3085dd=a141_0x248b88;this['spawnMpgPlayer'](),_0x31e643['pipe'](this[_0x3085dd(0x137)][_0x3085dd(0x150)]),this[_0x3085dd(0x137)][_0x3085dd(0x15c)]['on'](_0x3085dd(0x138),_0x5a8b56=>{const _0x4a9adf=_0x3085dd;_0x5a8b56[_0x4a9adf(0x11b)]==_0x4a9adf(0x11f)&&process[_0x4a9adf(0x159)](0x0);}),this[_0x3085dd(0x137)][_0x3085dd(0x150)]['on']('error',_0x466866=>{const _0x17514c=_0x3085dd;this[_0x17514c(0x12f)][_0x17514c(0x151)](_0x466866);}),this[_0x3085dd(0x137)][_0x3085dd(0x15c)]['on'](_0x3085dd(0x11c),_0x92efd=>{const _0x8d2a67=_0x3085dd;this[_0x8d2a67(0x12f)][_0x8d2a67(0x151)](_0x8d2a67(0x120)+_0x92efd);}),this['childProcess'][_0x3085dd(0x143)]['on'](_0x3085dd(0x11c),_0x4457ae=>{const _0x1b63ba=_0x3085dd;this['logger'][_0x1b63ba(0x151)](_0x1b63ba(0x135)+_0x4457ae);}),this[_0x3085dd(0x137)]['on'](_0x3085dd(0x159),_0x3c719f=>{const _0x13e8fb=_0x3085dd;this['logger'][_0x13e8fb(0x151)](_0x13e8fb(0x159)),this[_0x13e8fb(0x137)]['kill'](),this[_0x13e8fb(0x137)]=null,_0x3c719f!==0x0&&this[_0x13e8fb(0x12f)][_0x13e8fb(0x151)](_0x13e8fb(0x152)+_0x3c719f);});return;}[a141_0x248b88(0x13f)](_0x546d5c){const _0x26481d=a141_0x248b88,_0x59f4c7=new Promise((_0x453645,_0x161a3f)=>{const _0x2326ff=a141_0x35fa;this['spawnMpgPlayer'](),_0x546d5c[_0x2326ff(0x14a)](this[_0x2326ff(0x137)][_0x2326ff(0x150)]),this[_0x2326ff(0x137)][_0x2326ff(0x15c)]['on'](_0x2326ff(0x138),_0x4bcba6=>{const _0x36cd05=_0x2326ff;_0x4bcba6['code']==_0x36cd05(0x11f)&&process[_0x36cd05(0x159)](0x0);}),this[_0x2326ff(0x137)][_0x2326ff(0x150)]['on']('error',_0x49705a=>{const _0x956a56=_0x2326ff;this[_0x956a56(0x12f)]['log'](_0x49705a);}),this[_0x2326ff(0x137)]['stdout']['on'](_0x2326ff(0x11c),_0x12c266=>{const _0x52a080=_0x2326ff;this[_0x52a080(0x12f)][_0x52a080(0x151)](_0x52a080(0x120)+_0x12c266);}),this[_0x2326ff(0x137)][_0x2326ff(0x143)]['on']('data',_0x5ef1e1=>{const _0x16852c=_0x2326ff;this['logger'][_0x16852c(0x151)]('stderr\x20data:\x20'+_0x5ef1e1);}),this[_0x2326ff(0x137)]['on']('exit',_0xd34a66=>{const _0x4f2c87=_0x2326ff;_0x453645(!![]),this[_0x4f2c87(0x12f)][_0x4f2c87(0x151)]('exit'),this[_0x4f2c87(0x137)][_0x4f2c87(0x15f)](),this[_0x4f2c87(0x137)]=null,_0xd34a66!==0x0&&this[_0x4f2c87(0x12f)][_0x4f2c87(0x151)](_0x4f2c87(0x152)+_0xd34a66);});});return{'process':this[_0x26481d(0x137)],'promise':_0x59f4c7};}[a141_0x248b88(0x139)](_0x33cbbd){const _0x3ee151=a141_0x248b88;return(0x0,fs_1[_0x3ee151(0x161)])(_0x33cbbd);}async[a141_0x248b88(0x12b)](){const _0x5daf61=a141_0x248b88;this[_0x5daf61(0x137)][_0x5daf61(0x15f)]();}async[a141_0x248b88(0x144)](){const _0x57a5c9=a141_0x248b88;try{const _0x5e4b67=process[_0x57a5c9(0x14b)][_0x57a5c9(0x141)]+_0x57a5c9(0x15b);!this[_0x57a5c9(0x11d)]&&(this[_0x57a5c9(0x11d)]=await(0x0,puppeteer_1[_0x57a5c9(0x14f)])());const _0x17e0db=await(0x0,puppeteer_1[_0x57a5c9(0x158)])(this[_0x57a5c9(0x11d)]);if(_0x17e0db[_0x57a5c9(0x147)](_0x5e4b67)){console['log'](_0x57a5c9(0x14c)),this[_0x57a5c9(0x127)][_0x57a5c9(0x126)]();return;}const _0x5ef120=this[_0x57a5c9(0x13d)]||await(0x0,puppeteer_1['openNewpage'])(this['browser']),_0xec5d46=await this[_0x57a5c9(0x125)][_0x57a5c9(0x128)]();await _0x5ef120[_0x57a5c9(0x13c)]({'name':'accessToken','url':process['env'][_0x57a5c9(0x141)],'value':_0xec5d46}),await _0x5ef120[_0x57a5c9(0x149)](_0x5e4b67),await _0x5ef120['focus'](_0x57a5c9(0x162));}catch(_0x4d3f46){console[_0x57a5c9(0x151)](_0x4d3f46,_0x57a5c9(0x14d));}}async['closeServerUIStream'](){const _0x495027=a141_0x248b88;try{this[_0x495027(0x13d)]&&(await this['page'][_0x495027(0x160)](),this[_0x495027(0x13d)]=null);}catch(_0x3f98fc){console[_0x495027(0x151)](_0x3f98fc,'Error\x20when\x20close\x20page');}}};__decorate([(0x0,common_1[a141_0x248b88(0x15a)])(streaming_gateway_1[a141_0x248b88(0x13e)]),__metadata(a141_0x248b88(0x154),streaming_gateway_1[a141_0x248b88(0x13e)])],StreamingService[a141_0x248b88(0x15e)],a141_0x248b88(0x127),void 0x0),StreamingService=StreamingService_1=__decorate([(0x0,common_1[a141_0x248b88(0x133)])(),__metadata(a141_0x248b88(0x148),[user_service_1['UserService'],jwt_1['JwtService']])],StreamingService),exports[a141_0x248b88(0x131)]=StreamingService;