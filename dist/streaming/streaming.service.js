'use strict';function a141_0x2757(_0x1ad570,_0x279865){const _0x9a1dd4=a141_0x9a1d();return a141_0x2757=function(_0x2757af,_0x4733b4){_0x2757af=_0x2757af-0xce;let _0x44e3c0=_0x9a1dd4[_0x2757af];return _0x44e3c0;},a141_0x2757(_0x1ad570,_0x279865);}const a141_0x1edd43=a141_0x2757;(function(_0x34c95b,_0x4644f5){const _0x155f6c=a141_0x2757,_0x1eaabb=_0x34c95b();while(!![]){try{const _0x197c39=-parseInt(_0x155f6c(0x101))/0x1*(parseInt(_0x155f6c(0x109))/0x2)+parseInt(_0x155f6c(0x10e))/0x3+parseInt(_0x155f6c(0x103))/0x4*(parseInt(_0x155f6c(0x11c))/0x5)+parseInt(_0x155f6c(0x118))/0x6*(-parseInt(_0x155f6c(0x100))/0x7)+-parseInt(_0x155f6c(0xea))/0x8*(-parseInt(_0x155f6c(0x119))/0x9)+-parseInt(_0x155f6c(0xf0))/0xa*(-parseInt(_0x155f6c(0xd9))/0xb)+-parseInt(_0x155f6c(0x115))/0xc*(parseInt(_0x155f6c(0xe6))/0xd);if(_0x197c39===_0x4644f5)break;else _0x1eaabb['push'](_0x1eaabb['shift']());}catch(_0x3d5e78){_0x1eaabb['push'](_0x1eaabb['shift']());}}}(a141_0x9a1d,0xf3e01));function a141_0x9a1d(){const _0xf8ccbd=['stderr\x20data:\x20','332mJGDzf','Logger','@nestjs/jwt','__metadata','setCookie','pipe','2hPiDTE','logger','close','createStreamFromFile','@nestjs/common','5214387frVvyZ','getMasterUserAccessToken','streamingGateway','function','userService','STREAM_SERVER_URL','StreamingService','1572FqTCAY','log','stdout\x20data:\x20','566868phdKwn','3069XIqLSu','name','__decorate','95490COolzz','page','reconnectPeer','env','object','grep\x20process\x20exited\x20with\x20code\x20','stopStreamAudio','stdin','design:paramtypes','kill','design:type','goto','prototype','childProcess','11eeUhIa','stdout','Injectable','spawnMpgPlayer','EPIPE','stderr','/stream','spawn','data','mpg123','includes','error','openNewpage','272909QTAarv','__esModule','getOwnPropertyDescriptor','getBrowserUrls','25416BAHwzd','defineProperty','code','UserService','browser','child_process','10608980dVlpDK','decorate','jwtService','exit','Error\x20when\x20close\x20page','../helpers/puppeteer','Server\x20stream\x20browser\x20already\x20open','createReadStream','./streaming.gateway','closeServerUIStream','JwtService','focus','length','metadata','playStreamAudio','openServerUIStream','70bWCOul','773742MeePjl'];a141_0x9a1d=function(){return _0xf8ccbd;};return a141_0x9a1d();}var __decorate=this&&this[a141_0x1edd43(0x11b)]||function(_0x4e88bf,_0x2a938b,_0xbec58a,_0x1413eb){const _0x14526e=a141_0x1edd43;var _0x3a23ba=arguments[_0x14526e(0xfc)],_0x4c6fd1=_0x3a23ba<0x3?_0x2a938b:_0x1413eb===null?_0x1413eb=Object[_0x14526e(0xe8)](_0x2a938b,_0xbec58a):_0x1413eb,_0x2b96d0;if(typeof Reflect===_0x14526e(0xcf)&&typeof Reflect[_0x14526e(0xf1)]===_0x14526e(0x111))_0x4c6fd1=Reflect['decorate'](_0x4e88bf,_0x2a938b,_0xbec58a,_0x1413eb);else{for(var _0x5c0ea0=_0x4e88bf[_0x14526e(0xfc)]-0x1;_0x5c0ea0>=0x0;_0x5c0ea0--)if(_0x2b96d0=_0x4e88bf[_0x5c0ea0])_0x4c6fd1=(_0x3a23ba<0x3?_0x2b96d0(_0x4c6fd1):_0x3a23ba>0x3?_0x2b96d0(_0x2a938b,_0xbec58a,_0x4c6fd1):_0x2b96d0(_0x2a938b,_0xbec58a))||_0x4c6fd1;}return _0x3a23ba>0x3&&_0x4c6fd1&&Object[_0x14526e(0xeb)](_0x2a938b,_0xbec58a,_0x4c6fd1),_0x4c6fd1;},__metadata=this&&this[a141_0x1edd43(0x106)]||function(_0x1572ea,_0x2417c0){const _0x47a89e=a141_0x1edd43;if(typeof Reflect===_0x47a89e(0xcf)&&typeof Reflect[_0x47a89e(0xfd)]==='function')return Reflect[_0x47a89e(0xfd)](_0x1572ea,_0x2417c0);},StreamingService_1;Object[a141_0x1edd43(0xeb)](exports,a141_0x1edd43(0xe7),{'value':!![]}),exports[a141_0x1edd43(0x114)]=void 0x0;const common_1=require(a141_0x1edd43(0x10d)),child_process_1=require(a141_0x1edd43(0xef)),fs_1=require('fs'),puppeteer_1=require(a141_0x1edd43(0xf5)),streaming_gateway_1=require(a141_0x1edd43(0xf8)),user_service_1=require('../user/user.service'),jwt_1=require(a141_0x1edd43(0x105));let StreamingService=StreamingService_1=class StreamingService{constructor(_0x1bd6fd,_0x364a1e){const _0x3af992=a141_0x1edd43;this[_0x3af992(0x112)]=_0x1bd6fd,this[_0x3af992(0xf2)]=_0x364a1e,this[_0x3af992(0x10a)]=new common_1[(_0x3af992(0x104))](StreamingService_1[_0x3af992(0x11a)]);}[a141_0x1edd43(0xdc)](){const _0x5b9512=a141_0x1edd43;if(!this[_0x5b9512(0xd8)])this[_0x5b9512(0xd8)]=(0x0,child_process_1[_0x5b9512(0xe0)])(_0x5b9512(0xe2),['-']);}async[a141_0x1edd43(0xfe)](_0x195ec1){const _0x35d9b0=a141_0x1edd43;this[_0x35d9b0(0xdc)](),_0x195ec1[_0x35d9b0(0x108)](this[_0x35d9b0(0xd8)][_0x35d9b0(0xd2)]),this['childProcess'][_0x35d9b0(0xda)]['on'](_0x35d9b0(0xe4),_0x2df87a=>{const _0x256428=_0x35d9b0;_0x2df87a['code']==_0x256428(0xdd)&&process[_0x256428(0xf3)](0x0);}),this['childProcess'][_0x35d9b0(0xd2)]['on'](_0x35d9b0(0xe4),_0x47f1a1=>{const _0x3d193b=_0x35d9b0;this[_0x3d193b(0x10a)][_0x3d193b(0x116)](_0x47f1a1);}),this[_0x35d9b0(0xd8)]['stdout']['on']('data',_0x2f7aaa=>{const _0x470067=_0x35d9b0;this[_0x470067(0x10a)][_0x470067(0x116)](_0x470067(0x117)+_0x2f7aaa);}),this['childProcess'][_0x35d9b0(0xde)]['on'](_0x35d9b0(0xe1),_0x5ed5f1=>{const _0x2acaf2=_0x35d9b0;this[_0x2acaf2(0x10a)][_0x2acaf2(0x116)](_0x2acaf2(0x102)+_0x5ed5f1);}),this[_0x35d9b0(0xd8)]['on'](_0x35d9b0(0xf3),_0x50ab8a=>{const _0x42ee11=_0x35d9b0;this[_0x42ee11(0x10a)][_0x42ee11(0x116)]('exit'),this[_0x42ee11(0xd8)][_0x42ee11(0xd4)](),this[_0x42ee11(0xd8)]=null,_0x50ab8a!==0x0&&this[_0x42ee11(0x10a)][_0x42ee11(0x116)](_0x42ee11(0xd0)+_0x50ab8a);});return;}['playStreamAudioAsync'](_0x1ba739){const _0x1eb21a=a141_0x1edd43,_0x410536=new Promise((_0xcb261,_0x1aabe0)=>{const _0x1156cd=a141_0x2757;this['spawnMpgPlayer'](),_0x1ba739[_0x1156cd(0x108)](this[_0x1156cd(0xd8)][_0x1156cd(0xd2)]),this[_0x1156cd(0xd8)]['stdout']['on'](_0x1156cd(0xe4),_0x546882=>{const _0x556683=_0x1156cd;_0x546882[_0x556683(0xec)]==_0x556683(0xdd)&&process[_0x556683(0xf3)](0x0);}),this['childProcess'][_0x1156cd(0xd2)]['on'](_0x1156cd(0xe4),_0x21380b=>{this['logger']['log'](_0x21380b);}),this[_0x1156cd(0xd8)][_0x1156cd(0xda)]['on'](_0x1156cd(0xe1),_0x3e9981=>{const _0x51602a=_0x1156cd;this['logger'][_0x51602a(0x116)](_0x51602a(0x117)+_0x3e9981);}),this[_0x1156cd(0xd8)][_0x1156cd(0xde)]['on'](_0x1156cd(0xe1),_0x407495=>{const _0x386f9f=_0x1156cd;this[_0x386f9f(0x10a)][_0x386f9f(0x116)](_0x386f9f(0x102)+_0x407495);}),this[_0x1156cd(0xd8)]['on'](_0x1156cd(0xf3),_0x4b9335=>{const _0x25dd25=_0x1156cd;_0xcb261(!![]),this[_0x25dd25(0x10a)][_0x25dd25(0x116)](_0x25dd25(0xf3)),this[_0x25dd25(0xd8)]['kill'](),this[_0x25dd25(0xd8)]=null,_0x4b9335!==0x0&&this['logger'][_0x25dd25(0x116)]('grep\x20process\x20exited\x20with\x20code\x20'+_0x4b9335);});});return{'process':this[_0x1eb21a(0xd8)],'promise':_0x410536};}[a141_0x1edd43(0x10c)](_0xc042e2){const _0x50c464=a141_0x1edd43;return(0x0,fs_1[_0x50c464(0xf7)])(_0xc042e2);}async[a141_0x1edd43(0xd1)](){const _0x2f8377=a141_0x1edd43;this[_0x2f8377(0xd8)][_0x2f8377(0xd4)]();}async[a141_0x1edd43(0xff)](){const _0x23353d=a141_0x1edd43;try{const _0x4e5e8d=process[_0x23353d(0xce)]['STREAM_SERVER_URL']+_0x23353d(0xdf);!this['browser']&&(this[_0x23353d(0xee)]=await(0x0,puppeteer_1['launchBrowser'])());const _0x5424fa=await(0x0,puppeteer_1[_0x23353d(0xe9)])(this[_0x23353d(0xee)]);if(_0x5424fa[_0x23353d(0xe3)](_0x4e5e8d)){console['log'](_0x23353d(0xf6)),this[_0x23353d(0x110)][_0x23353d(0x11e)]();return;}const _0xc5aff9=this['page']||await(0x0,puppeteer_1[_0x23353d(0xe5)])(this[_0x23353d(0xee)]),_0xfca29a=await this[_0x23353d(0x112)][_0x23353d(0x10f)]();await _0xc5aff9[_0x23353d(0x107)]({'name':'accessToken','url':process[_0x23353d(0xce)][_0x23353d(0x113)],'value':_0xfca29a}),await _0xc5aff9[_0x23353d(0xd6)](_0x4e5e8d),await _0xc5aff9[_0x23353d(0xfb)]('body');}catch(_0x1d84fc){console['log'](_0x1d84fc,'Error\x20when\x20open\x20page');}}async[a141_0x1edd43(0xf9)](){const _0x4646f1=a141_0x1edd43;try{this['page']&&(await this[_0x4646f1(0x11d)][_0x4646f1(0x10b)](),this['page']=null);}catch(_0x3389be){console[_0x4646f1(0x116)](_0x3389be,_0x4646f1(0xf4));}}};__decorate([(0x0,common_1['Inject'])(streaming_gateway_1['StreamingGateway']),__metadata(a141_0x1edd43(0xd5),streaming_gateway_1['StreamingGateway'])],StreamingService[a141_0x1edd43(0xd7)],a141_0x1edd43(0x110),void 0x0),StreamingService=StreamingService_1=__decorate([(0x0,common_1[a141_0x1edd43(0xdb)])(),__metadata(a141_0x1edd43(0xd3),[user_service_1[a141_0x1edd43(0xed)],jwt_1[a141_0x1edd43(0xfa)]])],StreamingService),exports[a141_0x1edd43(0x114)]=StreamingService;